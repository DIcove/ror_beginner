function jivo_onLoadCallback(){window.jivo_cstm_widget=document.createElement("div"),jivo_cstm_widget.setAttribute("id","jivo_custom_widget"),document.body.appendChild(jivo_cstm_widget),jivo_cstm_widget.onclick=function(){jivo_api.open()},"online"==jivo_config.chat_mode&&jivo_cstm_widget.setAttribute("class","jivo_online"),window.jivo_cstm_widget.style.display="block",pi.app.jivo_user!=undefined&&null!=pi.app.jivo_user&&jivo_api.setContactInfo(pi.app.jivo_user),pi.app.jivo_data!=undefined&&null!=pi.app.jivo_data&&jivo_api.setCustomData(pi.app.jivo_data)}function jivo_onOpen(){jivo_cstm_widget&&(jivo_cstm_widget.style.display="none")}function jivo_onClose(){jivo_cstm_widget&&(jivo_cstm_widget.style.display="block")}var scormRTE=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){if(!e)return null;var i=n?e.getElementsByTagNameNS(n,t)[0]:e.getElementsByTagName(t)[0];return i?i.childNodes[0].nodeValue:null}function o(e){var t=e?e.getElementsByTagNameNS(y.imsss,"sequencing")[0]:null,n=t?t.getElementsByTagNameNS(y.imsss,"objectives")[0]:null,i=n?n.getElementsByTagNameNS(y.imsss,"primaryObjective")[0]:null,o=n?n.getElementsByTagNameNS(y.imsss,"objective"):[],a=[].map.call(o,function(e){return{id:e.getAttribute("objectiveID")}}),s=r(i,"minNormalizedMeasure",y.imsss),c=t?t.getElementsByTagNameNS(y.imsss,"limitConditions")[0]:null;return{scaledPassingScore:s,objectives:a,maxTimeAllowed:c?c.getAttribute("attemptAbsoluteDurationLimit"):null}}function a(e){var t=r(e,"dataFromLMS",y.adlcp),n=r(e,"timeLimitAction",y.adlcp),i=r(e,"completionThreshold",y.adlcp),a=r(e,"masteryscore",y.adlcp),s=r(e,"maxTimeAllowed",y.adlcp);return Object.assign({timeLimitAction:n,maxTimeAllowed:s,masteryScore:a,completionThreshold:i,launchData:t},o(e))}function s(e,t){return x("resources list",e),[].slice.call(e).filter(function(e,n){return x("index - ",n,"curId - ",e.getAttribute("identifier")),e.getAttribute("identifier")===t})[0]}function c(e){var t=e.getAttribute("identifierref"),n=e.getAttribute("parameters")||"";x("idRef",t);var i=s(_,t);x("resource",i);var r=i.getAttribute("href");return h+"/"+r+n}Object.defineProperty(t,"__esModule",{value:!0});var u=i(n(3)),d=i(n(4)),f={PARSE_XML:"Error occured while parsing imsmanifest.xml",FORMAT_XML:"Wrong imsmanifest.xml format"},p=null,v=null,_=null,g=null,h=null,b=!1,y={},x=function(){var e;b&&console&&(e=console).log.apply(e,arguments)};t["default"]={init:function(e,t,n){return h="/"===t[t.length-1]?t.slice(0,-1):t,(v=document.createElement("iframe")).style.width="100%",v.style.height="100%",document.getElementById(e).appendChild(v),b=n.debug,fetch(h+"/imsmanifest.xml").then(function(e){return e.text().then(function(e){var t=new DOMParser;"parsererror"===(p=t.parseFromString(e,"text/xml")).documentElement.nodeName&&x(f.PARSE_XML);var i=r(p,"schemaversion");x("Schema version",i);var o="1.2"===i||"1.1"===i?"1.2":"2004",s=p.getElementsByTagName("manifest")[0];y.imsss=s?s.getAttribute("xmlns:imsss"):"",y.adlcp=s?s.getAttribute("xmlns:adlcp"):"",_=p.getElementsByTagName("resources")[0].getElementsByTagName("resource");var l=(g=new d["default"](p.getElementsByTagName("organization")[0])).current(),m=Object.assign({},n.initModel||{},a(l));return u["default"].init(Object.assign({},n,{schemaVersion:o,initModel:m,callbacks:{onTerminate:function(){v.src=""}}})).then(function(){v.src=c(l)})})})},previous:function(){var e=g.shiftPrev();if(!e)throw new Error("No previous item provided");v.src=c(e)},"continue":function(){var e=g.shiftNext();if(!e)throw new Error("No next item provided");v.src=c(e)},exit:function(){},abandon:function(){},hasPrevious:function(){return g.hasPrev()},hasContinue:function(){return g.hasNext()},hasExit:function(){return!1},hasAbandon:function(){return!1}},e.exports=t["default"]},function(e,t,n){"use strict";function i(e){var t=void 0,n=void 0;if("1.2"===v){var i=e?"cmi.objectives."+e+".status":"cmi.core.lesson_status";t=["browsed","incomplete","failed"].indexOf(p[i])>=0?"incomplete":["passed","completed"].indexOf(p[i])>=0?"completed":"unknown",n=["passed","failed"].indexOf(p[i])>=0?p[i]:"unknown"}else{var r=e?"cmi.objectives."+e+".":"cmi.";t=p[r+"completion_status"],n=p[r+"success_status"]}return[t,n]}function r(){var e=p["cmi.objectives._count"],t=[];if(console.log(e),!e||!Number.isInteger(e))return t;for(var n=0;n<e;n+=1){var i=h(n),r=m(i,2),o=r[0],a=r[1];t.push({id:p["cmi.objectives."+n+".id"],score:{raw:p["cmi.objectives."+n+".score.raw"],min:p["cmi.objectives."+n+".score.min"],max:p["cmi.objectives."+n+".score.max"]},completion_status:o,success_status:a,description:p["cmi.objectives."+n+".description"]||""})}return t}function o(){var e=p[g[v].session_time];if(!e)return 0;if("1.2"===v)return e.split(":").reduceRight(function(e,t){return 1*e+60*t});var t=e.match(/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)$/),n=m(t,4);return 3600*(n[1]||0)+60*(n[2]||0)+1*(n[3]||0)}function a(e){var t=e.objectives,n=e.launchData,i=e.scaledPassingScore,r=e.masteryScore,o=e.completionThreshold,a=e.timeLimitAction,s=e.maxTimeAllowed,c=e.totalTime,l=e.learnerId,u=e.learnerName,m={};return o&&"2004"===v&&(m["cmi.completion_threshold"]=o),s&&(m[g[v].max_time_allowed]=s),a&&(m[g[v].time_limit_action]=a),l&&(m[g[v].learner_id]=u),u&&(m[g[v].learner_name]=u),c&&(m[g[v].total_time]=c),n&&(m["cmi.launch_data"]=n),(i||r)&&(m[g[v].passing_score]=i||r),t&&Array.isArray(t)&&(m["cmi.objectives._children"]="id,score,success_status,completion_status,description",m["cmi.objectives._count"]=t.length,t.map(function(e,t){return m["cmi.objectives."+t+".id"]=e.id,null})),m}function s(e,t){v="1.2"===e?"1.2":"2004";var n=a(t);p=Object.assign({},_[v],n)}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p=Object.assign({},JSON.parse(e),a({totalTime:t.total_time}))}function l(){var e=g[v],t=i(),n=m(t,2),a=n[0],s=n[1];return{score_raw:p[e.score_raw],score_max:p[e.score_max],score_min:p[e.score_min],score_scaled:p["cmi.score.scaled"],session_time:o(),total_time:p[e.total_time],success_status:s,completion_status:a,objectives:r()}}function u(){var e=void 0;switch(p[g[v].exit]){case"":e=!1;break;case"suspend":case"logout":p[g[v].entry]="resume",e=!0;break;case"normal":case"time-out":default:p[g[v].entry]="",e=!0}return{save:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getJSONString=t.set=t.get=void 0;var m=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s["return"]&&s["return"]()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.init=s,t.restore=c,t.getResults=l,t.exit=u;var f=function(e){return e&&e.__esModule?e:{"default":e}}(n(5)),p={},v="2004",_={1.2:{"cmi.core.lesson_mode":"normal","cmi.core.credit":"credit","cmi.core.entry":"ab-initio","cmi.core.lesson_status":"not attempted","cmi.core.lesson_location":"","cmi.core.total_time":0,"cmi.student_data.time_limit_action":"continue,no message","cmi.interactions._count":0},2004:{"cmi._version":f["default"].version,"cmi.mode":"normal","cmi.credit":"credit","cmi.entry":"ab-initio","cmi.success_status":"unknown","cmi.completion_status":"unknown","cmi.location":"","cmi.total_time":0,"cmi.time_limit_action":"continue,no message","cmi.interactions._count":0}},g={1.2:{enry:"cmi.core.entry",exit:"cmi.core.exit",learner_id:"cmi.core.student_id",learner_name:"cmi.core.student_name",max_time_allowed:"cmi.max_time_allowed",passing_score:"cmi.student_data.mastery_score",score_raw:"cmi.core.score.raw",score_max:"cmi.core.score.max",score_min:"cmi.core.score.min",session_time:"cmi.core.session_time",time_limit_action:"cmi.student_data.time_limit_action",total_time:"cmi.core.total_time"},2004:{entry:"cmi.entry",exit:"cmi.exit",learner_id:"cmi.learner_id",learner_name:"cmi.learner_name",max_time_allowed:"cmi.student_data.max_time_allowed",passing_score:"cmi.scaled_passing_score",score_raw:"cmi.score.raw",score_max:"cmi.score.max",score_min:"cmi.score.min",session_time:"cmi.session_time",time_limit_action:"cmi.time_limit_action",total_time:"cmi.total_time"}},h=i;t.get=function(e){return p[e]},t.set=function(e,t){/^cmi\.objectives\.([1-9]\d*|0)\.id$/.test(e)&&!p[e]&&(p["cmi.objectives._count"]=(p["cmi.objectives._count"]||0)+1),/^cmi.interactions\.([1-9]\d*|0)\.id$/.test(e)&&!p[e]&&(console.log("int ID"),p["cmi.interactions._count"]=(p["cmi.interactions._count"]||0)+1),p[e]=t},t.getJSONString=function(){return JSON.stringify(p)}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={1.2:{0:"No error",101:"General Exception",201:"Invalid argument error",202:"Element cannot have children",203:"Element not an array. Cannot have count",301:"Not initialized",401:"Not implemented error",402:"Invalid set value, element is a keyword",403:"Element is read only",404:"Element is write only",405:"Incorrect Data Type"},2004:{0:"No error",101:"General Exception",102:"General Initialization Failure",103:"Already Initialized",104:"Content Instance Terminated",111:"General Termination Failure",112:"Termination Before Initialization",113:"Termination After Termination",122:"Retrieve Data Before Initialization",123:"Retrieve Data After Termination",132:"Store Data Before Initialization",133:"Store Data After Termination",142:"Commit Before Initialization",143:"Commit After Termination",201:"General Argument Error",301:"General Get Failure",351:"General Set Failure",391:"General Commit Failure",401:"Undefined Data Model Element",402:"Unimplemented Data Model Element",403:"Data Model Element Value Not Initialized",404:"Data Model Element Is Read Only",405:"Data Model Element Is Write Only",406:"Data Model Element Type Mismatch",407:"Data Model Element Value Out Of Range",408:"Data Model Dependency Not Established",1000:"General communication failure"}},r=(t.getErrorStrings=function(e){return i[e]},{2004:{Initialize:"Initialize",Terminate:"Terminate",GetValue:"GetValue",SetValue:"SetValue",Commit:"Commit",GetLastError:"GetLastError",GetErrorString:"GetErrorString",GetDiagnostic:"GetDiagnostic"},1.2:{Initialize:"LMSInitialize",Terminate:"LMSFinish",GetValue:"LMSGetValue",SetValue:"LMSSetValue",Commit:"LMSCommit",GetLastError:"LMSGetLastError",GetErrorString:"LMSGetErrorString",GetDiagnostic:"LMSGetDiagnostic"}});t.getFunctionNames=function(e){return r[e]}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(2)),s=i(n(1)),c={NOT_INITIALIZED:"Not Initialized",RUNNING:"Running",TERMINATED:"Terminated"},l=null,u=0,m=/^(cmi||adl)\.(\w|\.)+$/,d=function(e,t){return e.length>=t.length&&e.substr(e.length-t.length)===t},f=function(e){if(!e)return!1;var t=e.match(/^(?:https?:\/\/|\/\/)?([^\/]+)\//),n=t&&t[1];return!n||".."===n||"."===n||(n=n.split(":"),window.location.hostname===n[0]&&(window.location.port||"80")===(n[1]||"80"))},p=function(e){return 0==(u=0===e.search(m)?0:401)},v=function(e){return u=0,d(e,"._children")&&(u=403),0===u},_=function(e,t){return 0===(u=l===c.NOT_INITIALIZED?e:l===c.TERMINATED?t:0)};t["default"]={init:function(e){var t=e.dataUrl,n=e.postHeaders,i=e.schemaVersion,r=void 0===i?"2004":i,a=e.debug,m=void 0!==a&&a,d=e.autoCommitInterval,g=void 0===d?-1:d,h=e.callbacks,b=e.initModel;l=c.NOT_INITIALIZED;var y=function(){var e;m&&console&&(e=console).log.apply(e,arguments)},x=f(t),S=x?Object.assign({Accept:"application/json","Content-Type":"application/json"},n):n;y("Same host:",x),y(t);var E=t?function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return fetch(t,{headers:S,credentials:"same-origin",method:"POST",body:JSON.stringify({scorm_stat:{cmiString:e?s.getJSONString():"",results:s.getResults()}})})}:function(){return Promise.resolve()};return s.init(r,b),(t?fetch(t,{headers:{Accept:"application/json"},credentials:"same-origin"}).then(function(e){return e.json()}).then(function(e){return e.scorm_stat}).then(function(e){y("Fetched info from server",e),s.restore(e.cmiString,e.data)})["catch"](y):Promise.resolve()).then(function(){h&&h.preInitialize&&h.preInitialize();var e=o.getErrorStrings(r),t=o.getFunctionNames(r),n={},a=(Date.now(),null);"number"==typeof g&&g>0&&(y("Auto-commit enabled",setInterval),a=setInterval(function(){},100*g)),n[t.Initialize]=function(){if(y("LMS Initialize"),l===c.RUNNING||l===c.TERMINATED)return u=103,"false";l=c.RUNNING,u=0;var e="true";return h&&h.onInitialize&&(e=h.onInitialize()),"false"===e?(u=102,"false"):"true"},n[t.Terminate]=function(){if(y("LMS Terminate"),!_(112,113))return"false";E(s.exit().save)["catch"](y);var e="true";return h&&h.onTerminate&&(e=h.onTerminate()),"false"===e?(u=111,"false"):(clearInterval(a),l=c.TERMINATED,"true")},n[t.GetValue]=function(e){if(y("LMS GetValue",e),!_(122,123))return"";if(!p(e))return"";var t=s.get(e);return void 0===t&&(t="",u=403),y("LMS GetValue returns: ",t),t},n[t.SetValue]=function(e,t){return y("LMS SetValue",e,t),_(132,133)&&p(e)&&v(e)?(s.set(e,t),"true"):"false"},n[t.Commit]=function(){if(y("LMS Commit"),!_(142,143))return"false";E()["catch"](function(){u=1e3});var e="true";return h&&h.onCommit&&(e=h.onCommit()),"false"===e?"false":(Date.now(),"true")},n[t.GetDiagnostic]=function(i){return y("LMS GetDiagnostic",i),i?e[i]?e[i]:"Uknown error":n[t.GetLastError]()},n[t.GetErrorString]=function(t){return y("LMS GetErrorString",t),e[t]?e[t]:"Uknown error"},n[t.GetLastError]=function(){return 0!==u&&y("LMS GetLastError return",u),u},"1.2"===r?window.API=n:window.API_1484_11=n})},getCmi:function(){return s},getProgressMeasure:function(){return s.get("cmi.progress_measure")},getResults:function(){return s.getResults()}},e.exports=t["default"]},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){var n=t.parent,r=t.value,o=t.index;i(this,e),this.parent=n,this.index=o,this.value=r}return r(e,[{key:"setChildren",value:function(e){return this.children=e,this}}]),e}(),a=function e(t){return t.children?e(t.children[0]):t},s=function e(t){return t.children?e(t.children[t.children.length-1]):t},c=function(){function e(t){if(i(this,e),!t||!t.children)throw new Error("Bad organization tag format");this._root=function e(t,n,i){var r=new o({value:t,parent:n,index:i}),a=[].map.call(t.children||[],function(e){return"item"===e.tagName?e:null}).filter(function(e){return null!==e}).map(function(t,n){return e(t,r,n)});return 0===a.length?r:r.setChildren(a)}(t,null,0),this._pointer=a(this._root)}return r(e,[{key:"current",value:function(){return this._pointer.value}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=function e(t){return t.parent?t.parent.children.length===t.index+1?e(t.parent):a(t.parent.children[t.index+1]):null}(this._pointer);return e&&(this._pointer=t||this._pointer),t&&t.value}},{key:"prev",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=function e(t){return t.parent?0===t.index?e(t.parent):s(t.parent.children[t.index-1]):null}(this._pointer);return e&&(this._pointer=t||this._pointer),t&&t.value}},{key:"hasNext",value:function(){return!!this.next()}},{key:"hasPrev",value:function(){return!!this.prev()}},{key:"shiftNext",value:function(){return this.next(!0)}},{key:"shiftPrev",value:function(){return this.prev(!0)}}]),e}();t["default"]=c,e.exports=t["default"]},function(e){e.exports={name:"scorm-rte",version:"1.0.0",description:"'Libs for SCORM interaction with player and lms'",main:"gulpfile.js",dependencies:{"@babel/polyfill":"^7.2.5","babel-polyfill":"^6.26.0","whatwg-fetch":"^2.0.3"},devDependencies:{"babel-core":"^6.24.0","babel-loader":"^6.4.0","babel-plugin-add-module-exports":"^0.2.1","babel-preset-es2015":"^6.22.0",eslint:"^3.17.1","eslint-config-airbnb":"^14.1.0","eslint-loader":"^1.7.0","eslint-plugin-import":"^2.2.0","eslint-plugin-jsx-a11y":"^4.0.0","eslint-plugin-react":"^6.10.0","exports-loader":"^0.6.4",gulp:"^3.9.1","gulp-shell":"^0.6.3","imports-loader":"^0.7.1",webpack:"^2.2.1"},scripts:{test:'echo "Error: no test specified" && exit 1',compile:"./node_modules/.bin/webpack"},author:"Alexander Kaminskiy <alex.kaminsky.11@gmail.com>",license:"ISC"}},function(e,t,n){e.exports=n(0)}]);if(Function.prototype.bind||(Function.prototype.bind=function(oThis){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};return fNOP.prototype=this.prototype,fBound.prototype=new fNOP,fBound}),Element&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector||function(selector){return Array.prototype.indexOf.call(document.documentElement.querySelectorAll(selector),this)>-1}}HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(callback,type,quality){for(var binStr=atob(this.toDataURL(type,quality).split(",")[1]),len=binStr.length,arr=new Uint8Array(len),i=0;i<len;i++)arr[i]=binStr.charCodeAt(i);callback(new Blob([arr],{type:type||"image/png"}))}})
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/,"undefined"==typeof document||"classList"in document.createElement("a")||function(view){"use strict";if("HTMLElement"in view||"Element"in view){var classListProp="classList",protoProp="prototype",elemCtrProto=(view.HTMLElement||view.Element)[protoProp],objCtr=Object,strTrim=String[protoProp].trim||function(){return this.replace(/^\s+|\s+$/g,"")},arrIndexOf=Array[protoProp].indexOf||function(item){for(var i=0,len=this.length;i<len;i++)if(i in this&&this[i]===item)return i;return-1},DOMEx=function(type,message){this.name=type,this.code=DOMException[type],this.message=message},checkTokenAndGetIndex=function(classList,token){if(""===token)throw new DOMEx("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(token))throw new DOMEx("INVALID_CHARACTER_ERR","String contains an invalid character");return arrIndexOf.call(classList,token)},ClassList=function(elem){for(var trimmedClasses=strTrim.call(elem.className),classes=trimmedClasses?trimmedClasses.split(/\s+/):[],i=0,len=classes.length;i<len;i++)this.push(classes[i]);this._updateClassName=function(){elem.className=this.toString()}},classListProto=ClassList[protoProp]=[],classListGetter=function(){return new ClassList(this)};if(DOMEx[protoProp]=Error[protoProp],classListProto.item=function(i){return this[i]||null},classListProto.contains=function(token){return-1!==checkTokenAndGetIndex(this,token+="")},classListProto.add=function(){var token,tokens=arguments,i=0,l=tokens.length,updated=!1;do{token=tokens[i]+"",-1===checkTokenAndGetIndex(this,token)&&(this.push(token),updated=!0)}while(++i<l);updated&&this._updateClassName()},classListProto.remove=function(){var token,tokens=arguments,i=0,l=tokens.length,updated=!1;do{token=tokens[i]+"";var index=checkTokenAndGetIndex(this,token);-1!==index&&(this.splice(index,1),updated=!0)}while(++i<l);updated&&this._updateClassName()},classListProto.toggle=function(token,forse){token+="";var result=this.contains(token),method=result?!0!==forse&&"remove":!1!==forse&&"add";return method&&this[method](token),!result},classListProto.toString=function(){return this.join(" ")},objCtr.defineProperty){var classListPropDesc={get:classListGetter,enumerable:!0,configurable:!0};try{objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc)}catch(ex){-2146823252===ex.number&&(classListPropDesc.enumerable=!1,objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc))}}else objCtr[protoProp].__defineGetter__&&elemCtrProto.__defineGetter__(classListProp,classListGetter)}}(self),function(){var a,b,d,e,f;e={},f={},a=function(a,b,c){e[a]={deps:b,callback:c}},d=b=function(a){function c(b){if("."!==b.charAt(0))return b;for(var c=b.split("/"),d=a.split("/").slice(0,-1),e=0,f=c.length;f>e;e++){var g=c[e];if(".."===g)d.pop();else{if("."===g)continue;d.push(g)}}return d.join("/")}if(d._eak_seen=e,f[a])return f[a];if(f[a]={},!e[a])throw new Error("Could not find module "+a);for(var g,h=e[a],i=h.deps,j=h.callback,k=[],l=0,m=i.length;m>l;l++)"exports"===i[l]?k.push(g={}):k.push(b(c(i[l])));var n=j.apply(this,k);return f[a]=g||n},a("promise/all",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to all.");return new b(function(b,c){function d(a){return function(b){f(a,b)}}function f(a,c){h[a]=c,0==--i&&b(h)}var g,h=[],i=a.length;0===i&&b([]);for(var j=0;j<a.length;j++)(g=a[j])&&e(g.then)?g.then(d(j),c):f(j,g)})}var d=a.isArray,e=a.isFunction;b.all=c}),a("promise/asap",["exports"],function(a){"use strict";function b(){return function(){process.nextTick(e)}}function c(){var a=0,b=new i(e),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function d(){return function(){j.setTimeout(e,1)}}function e(){for(var a=0;a<k.length;a++){var b=k[a];(0,b[0])(b[1])}k=[]}function f(a,b){1===k.push([a,b])&&g()}var g,h="undefined"!=typeof window?window:{},i=h.MutationObserver||h.WebKitMutationObserver,j="undefined"!=typeof global?global:this,k=[];g="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?b():i?c():d(),a.asap=f}),a("promise/cast",["exports"],function(a){"use strict";function b(a){return a&&"object"==typeof a&&a.constructor===this?a:new this(function(b){b(a)})}a.cast=b}),a("promise/config",["exports"],function(a){"use strict";function b(a,b){return 2!==arguments.length?c[a]:void(c[a]=b)}var c={instrument:!1};a.config=c,a.configure=b}),a("promise/polyfill",["./promise","./utils","exports"],function(a,b,c){"use strict";function d(){"Promise"in window&&"cast"in window.Promise&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&function(){var a;return new window.Promise(function(b){a=b}),f(a)}()||(window.Promise=e)}var e=a.Promise,f=b.isFunction;c.polyfill=d}),a("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){if(!w(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof j))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],k(a,this)}function k(a,b){function c(a){p(b,a)}function d(a){r(b,a)}try{a(c,d)}catch(e){d(e)}}function l(a,b,c,d){var e,f,g,h,i=w(c);if(i)try{e=c(d),g=!0}catch(j){h=!0,f=j}else e=d,g=!0;o(b,e)||(i&&g?p(b,e):h?r(b,f):a===F?p(b,e):a===G&&r(b,e))}function m(a,b,c,d){var e=a._subscribers,f=e.length;e[f]=b,e[f+F]=c,e[f+G]=d}function n(a,b){for(var e=a._subscribers,f=a._detail,g=0;g<e.length;g+=3)l(b,e[g],e[g+b],f);a._subscribers=null}function o(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(v(b)&&(d=b.then,w(d)))return d.call(b,function(d){return!!c||(c=!0,void(b!==d?p(a,d):q(a,d)))},function(b){return!!c||(c=!0,void r(a,b))}),!0}catch(e){return!!c||(r(a,e),!0)}return!1}function p(a,b){a===b?q(a,b):o(a,b)||q(a,b)}function q(a,b){a._state===D&&(a._state=E,a._detail=b,u.async(s,a))}function r(a,b){a._state===D&&(a._state=E,a._detail=b,u.async(t,a))}function s(a){n(a,a._state=F)}function t(a){n(a,a._state=G)}var u=a.config,v=(a.configure,b.objectOrFunction),w=b.isFunction,x=(b.now,c.cast),y=d.all,z=e.race,A=f.resolve,B=g.reject,C=h.asap;u.async=C;var D=void 0,E=0,F=1,G=2;j.prototype={constructor:j,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(a,b){var c=this,d=new this.constructor(function(){});if(this._state){var e=arguments;u.async(function(){l(c._state,d,e[c._state-1],c._detail)})}else m(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}},j.all=y,j.cast=x,j.race=z,j.resolve=A,j.reject=B,i.Promise=j}),a("promise/race",["./utils","exports"],function(a,b){"use strict";function c(a){var b=this;if(!d(a))throw new TypeError("You must pass an array to race.");return new b(function(b,c){for(var d,e=0;e<a.length;e++)(d=a[e])&&"function"==typeof d.then?d.then(b,c):b(d)})}var d=a.isArray;b.race=c}),a("promise/reject",["exports"],function(a){"use strict";function b(a){return new this(function(b,c){c(a)})}a.reject=b}),a("promise/resolve",["exports"],function(a){"use strict";function b(a){return new this(function(b){b(a)})}a.resolve=b}),a("promise/utils",["exports"],function(a){"use strict";function b(a){return c(a)||"object"==typeof a&&null!==a}function c(a){return"function"==typeof a}function d(a){return"[object Array]"===Object.prototype.toString.call(a)}var e=Date.now||function(){return(new Date).getTime()};a.objectOrFunction=b,a.isFunction=c,a.isArray=d,a.now=e}),b("promise/polyfill").polyfill()}(),function(){this.Skim={access:function(name){var value;return"function"==typeof(value=this[name])&&(value=value.call(this)),!0===value?[this]:!1!==value&&null!=value&&("[object Array]"!==Object.prototype.toString.call(value)?[value]:0!==value.length&&value)},withContext:function(context,block){var flatten;return(context=function(o){var F;return(F=function(){}).prototype=o,new F}(context)).safe||(context.safe=this.safe||function(value){var result;return(null!=value?value.skimSafe:void 0)?value:((result=new String(null!=value?value:"")).skimSafe=!0,result)}),context.isArray=Array.isArray||function(value){return"[object Array]"==={}.toString.call(value)},context.flatten=flatten=function(array){var element,flattened,i,len;for(flattened=[],i=0,len=array.length;i<len;i++)(element=array[i])instanceof Array?flattened=flattened.concat(flatten(element)):flattened.push(element);return flattened},context.escape||(context.escape=this.escape||function(string){return null==string?"":string.skimSafe||!/[&<>\"]/.test(string)?string:this.safe((""+string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"))}),block.call(context)}}}.call(this),function(window){"use strict";var fromHash,toHash,hash=(fromHash=function(){for(var params=window.location.hash?window.location.hash.substr(1).split("&"):[],paramsObject={},i=0;i<params.length;i++){var a=params[i].split("=");paramsObject[a[0]]=decodeURIComponent(a[1])}return paramsObject},toHash=function(params){var str=[];for(var p in params)p&&str.push(p+"="+encodeURIComponent(params[p]));window.location.hash=str.length?str.join("&"):""},{get:function(param){var params=fromHash();return param?params[param]:params},add:function(newParams){var params=fromHash();for(var p in newParams)params[p]=newParams[p];toHash(params)},remove:function(removeParams){removeParams="string"==typeof removeParams?[removeParams]:removeParams;for(var params=fromHash(),i=0;i<removeParams.length;i++)delete params[removeParams[i]];toHash(params)},clear:function(){toHash({})}});window.hash=hash}(window),
/*!
 * Javascript Cookie v1.5.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
function(factory){var jQuery;if("function"==typeof define&&define.amd)define(["jquery"],factory);else if("object"==typeof exports){try{jQuery=require("jquery")}catch(e){}module.exports=factory(jQuery)}else{var _OldCookies=window.Cookies,api=window.Cookies=factory(window.jQuery);api.noConflict=function(){return window.Cookies=_OldCookies,api}}}(function($){function encode(s){return api.raw?s:encodeURIComponent(s)}function decode(s){return api.raw?s:decodeURIComponent(s)}function stringifyCookieValue(value){return encode(api.json?JSON.stringify(value):String(value))}function parseCookieValue(s){0===s.indexOf('"')&&(s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s=decodeURIComponent(s.replace(pluses," ")),api.json?JSON.parse(s):s}catch(e){}}function read(s,converter){var value=api.raw?s:parseCookieValue(s);return isFunction(converter)?converter(value):value}function extend(){for(var key,options,i=0,result={};i<arguments.length;i++)for(key in options=arguments[i])result[key]=options[key];return result}function isFunction(obj){return"[object Function]"===Object.prototype.toString.call(obj)}var pluses=/\+/g,api=function(key,value,options){if(arguments.length>1&&!isFunction(value)){if("number"==typeof(options=extend(api.defaults,options)).expires){var days=options.expires,t=options.expires=new Date;t.setMilliseconds(t.getMilliseconds()+864e5*days)}return document.cookie=[encode(key),"=",stringifyCookieValue(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}for(var result=key?undefined:{},cookies=document.cookie?document.cookie.split("; "):[],i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=parts.join("=");if(key===name){result=read(cookie,value);break}key||(cookie=read(cookie))===undefined||(result[name]=cookie)}return result};return api.get=api.set=api,api.defaults={},api.remove=function(key,options){return api(key,"",extend(options,{expires:-1})),!api(key)},$&&($.cookie=api,$.removeCookie=api.remove),api}),
//! moment.js
//! version : 2.8.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function printMsg(msg){!1===moment.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function Locale(){}function Moment(config,skipOverflow){!1!==skipOverflow&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=from._pf),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)void 0!==(val=from[prop=momentProperties[i]])&&(to[prop]=val);return to}function absRound(number){return number<0?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=makeAs(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,addOrSubtractDurationFromMoment(this,moment.duration(val,period),direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset||updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)inputObject.hasOwnProperty(prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;i<count;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(j=(split=normalizeLocale(names[i]).split("-")).length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;i<length;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:return new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){var possibleTzMatches=(string=string||"").match(parseTokenTimezone)||[],parts=((possibleTzMatches[possibleTzMatches.length-1]||[])+"").match(parseTimezoneChunker)||["-",0,0],minutes=60*parts[1]+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":null!=(a=config._locale.monthsParse(input))?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input,10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=config._locale.isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"dd":case"ddd":case"dddd":null!=(a=config._locale.weekdaysParse(input))?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;null!=(w=config._w).GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d)<dow&&++week:weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f!==moment.ISO_8601){config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._isPm&&config._a[HOUR]<12&&(config._a[HOUR]+=12),!1===config._isPm&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}else parseISO(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,(tempConfig=copyConfig({},config))._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||currentScore<scoreToBeat)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),!1===config._isValid&&(delete config._isValid,moment.createFromInputFallback(config))}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromConfig(config)):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return y<1970&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return y<1970&&date.setUTCFullYear(y),date}function parseWeekday(input,locale){if("string"==typeof input)if(isNaN(input)){if("number"!=typeof(input=locale.weekdaysParse(input)))return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),daysToDayOfWeek<end-7&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return{year:(dayOfYear=7*(week-1)+((weekday=null!=weekday?weekday:firstDayOfWeek)-firstDayOfWeek)+(firstDayOfWeek-(d=0===d?7:d)+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0))+1)>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config)))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&"number"!=typeof(value=mom.localeData().monthsParse(value))?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,oldGlobalMoment,i,VERSION="2.8.1",globalScope="undefined"!=typeof global?global:this,round=Math.round,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year();return(y>=0?"+":"-")+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)"function"==typeof(prop=config[i])?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;i<12;i++)if(this._monthsParse[i]||(mom=moment.utc([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;i<7;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),(moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),(c={})._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)}).suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)}),moment.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},moment.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),(c={})._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:(parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign})(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(moment(duration.from),moment(duration.to)),(duration={}).ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&input.hasOwnProperty("_locale")&&(ret._locale=input._locale),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]!==undefined&&(limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0))},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data=void 0!==values?moment.defineLocale(key,values):moment.localeData(key))&&(moment.duration._locale=moment._locale=data),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&obj.hasOwnProperty("_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration},i=lists.length-1;i>=0;--i)makeList(lists[i])
;for(i in moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(NaN);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0)},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.zone(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.zone(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone());return"year"===(units=normalizeUnits(units))||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var sod=makeAs(time||moment(),this).startOf("day"),diff=this.diff(sod,"days",!0),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){return units=void 0!==units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units=void 0!==units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units=units||"ms",+this.clone().startOf(units)==+makeAs(input,this).startOf(units)},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return(other=moment.apply(null,arguments))<this?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return(other=moment.apply(null,arguments))>this?this:other}),zone:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input*=60),!this._isUTC&&keepLocalTime&&(localAdjust=this._d.getTimezoneOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.subtract(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,(this.zone()-input)%60==0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return this[units=normalizeUnits(units)]()},set:function(units,value){return"function"==typeof this[units=normalizeUnits(units)]&&this[units](value),this},locale:function(key){return key===undefined?this._locale._abbr:(this._locale=moment.localeData(key),this)},lang:deprecate("moment().lang() is deprecated. Use moment().localeData() instead.",function(key){return key===undefined?this.localeData():(this._locale=moment.localeData(key),this)}),localeData:function(){return this._locale}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),months+=absRound((days-=absRound(yearsToDays(years=absRound(daysToYears(days)))))/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return this[(units=normalizeUnits(units)).toLowerCase()+"s"]()},as:function(units){var days,months;if(units=normalizeUnits(units),days=this._days+this._milliseconds/864e5,"month"===units||"year"===units)return months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days+=yearsToDays(this._months/12),units){case"week":return days/7;case"day":return days;case"hour":return 24*days;case"minute":return 24*days*60;case"second":return 24*days*60*60;case"millisecond":return 24*days*60*60*1e3;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale}}),unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&makeDurationGetter(i.toLowerCase());moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinal:function(number){var b=number%10;return number+(1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",function(require,exports,module){return module.config&&module.config()&&!0===module.config().noGlobal&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}.call(this),
/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
function(root,factory){"use strict";var moment;if("object"==typeof exports){try{moment=require("moment")}catch(e){}module.exports=factory(moment)}else"function"==typeof define&&define.amd?define(function(req){var id="moment";return moment=req.defined&&req.defined(id)?req(id):undefined,factory(moment)}):root.Pikaday=factory(root.moment)}(this,function(moment){"use strict";var hasMoment="function"==typeof moment,hasEventListeners=!!window.addEventListener,document=window.document,sto=window.setTimeout,addEvent=function(el,e,callback,capture){hasEventListeners?el.addEventListener(e,callback,!!capture):el.attachEvent("on"+e,callback)},removeEvent=function(el,e,callback,capture){hasEventListeners?el.removeEventListener(e,callback,!!capture):el.detachEvent("on"+e,callback)},fireEvent=function(el,eventName,data){var ev;document.createEvent?((ev=document.createEvent("HTMLEvents")).initEvent(eventName,!0,!1),ev=extend(ev,data),el.dispatchEvent(ev)):document.createEventObject&&(ev=document.createEventObject(),ev=extend(ev,data),el.fireEvent("on"+eventName,ev))},trim=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")},hasClass=function(el,cn){return-1!==(" "+el.className+" ").indexOf(" "+cn+" ")},addClass=function(el,cn){hasClass(el,cn)||(el.className=""===el.className?cn:el.className+" "+cn)},removeClass=function(el,cn){el.className=trim((" "+el.className+" ").replace(" "+cn+" "," "))},isArray=function(obj){return/Array/.test(Object.prototype.toString.call(obj))},isDate=function(obj){return/Date/.test(Object.prototype.toString.call(obj))&&!isNaN(obj.getTime())},isLeapYear=function(year){return year%4==0&&year%100!=0||year%400==0},getDaysInMonth=function(year,month){return[31,isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},setToStartOfDay=function(date){isDate(date)&&date.setHours(0,0,0,0)},compareDates=function(a,b){return a.getTime()===b.getTime()},extend=function(to,from,overwrite){var prop,hasProp;for(prop in from)(hasProp=to[prop]!==undefined)&&"object"==typeof from[prop]&&from[prop].nodeName===undefined?isDate(from[prop])?overwrite&&(to[prop]=new Date(from[prop].getTime())):isArray(from[prop])?overwrite&&(to[prop]=from[prop].slice(0)):to[prop]=extend({},from[prop],overwrite):!overwrite&&hasProp||(to[prop]=from[prop]);return to},adjustCalendar=function(calendar){return calendar.month<0&&(calendar.year-=Math.ceil(Math.abs(calendar.month)/12),calendar.month+=12),calendar.month>11&&(calendar.year+=Math.floor(Math.abs(calendar.month)/12),calendar.month-=12),calendar},defaults={field:null,bound:undefined,position:"bottom left",format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},onSelect:null,onOpen:null,onClose:null,onDraw:null},renderDayName=function(opts,day,abbr){for(day+=opts.firstDay;day>=7;)day-=7;return abbr?opts.i18n.weekdaysShort[day]:opts.i18n.weekdays[day]},renderDay=function(d,m,y,isSelected,isToday,isDisabled,isEmpty){if(isEmpty)return'<td class="is-empty"></td>';var arr=[];return isDisabled&&arr.push("is-disabled"),isToday&&arr.push("is-today"),isSelected&&arr.push("is-selected"),'<td data-day="'+d+'" class="'+arr.join(" ")+'"><button class="pika-button pika-day" type="button" data-pika-year="'+y+'" data-pika-month="'+m+'" data-pika-day="'+d+'">'+d+"</button></td>"},renderWeek=function(d,m,y){var onejan=new Date(y,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(y,m,d)-onejan)/864e5+onejan.getDay()+1)/7)+"</td>"},renderRow=function(days,isRTL){return"<tr>"+(isRTL?days.reverse():days).join("")+"</tr>"},renderBody=function(rows){return"<tbody>"+rows.join("")+"</tbody>"},renderHead=function(opts){var i,arr=[];for(opts.showWeekNumber&&arr.push("<th></th>"),i=0;i<7;i++)arr.push('<th scope="col"><abbr title="'+renderDayName(opts,i)+'">'+renderDayName(opts,i,!0)+"</abbr></th>");return"<thead>"+(opts.isRTL?arr.reverse():arr).join("")+"</thead>"},renderTitle=function(instance,c,year,month,refYear){var i,j,arr,monthHtml,yearHtml,opts=instance._o,isMinYear=year===opts.minYear,isMaxYear=year===opts.maxYear,html='<div class="pika-title">',prev=!0,next=!0;for(arr=[],i=0;i<12;i++)arr.push('<option value="'+(year===refYear?i-c:12+i-c)+'"'+(i===month?" selected":"")+(isMinYear&&i<opts.minMonth||isMaxYear&&i>opts.maxMonth?"disabled":"")+">"+opts.i18n.months[i]+"</option>");for(monthHtml='<div class="pika-label">'+opts.i18n.months[month]+'<select class="pika-select pika-select-month">'+arr.join("")+"</select></div>",isArray(opts.yearRange)?(i=opts.yearRange[0],j=opts.yearRange[1]+1):(i=year-opts.yearRange,j=1+year+opts.yearRange),arr=[];i<j&&i<=opts.maxYear;i++)i>=opts.minYear&&arr.push('<option value="'+i+'"'+(i===year?" selected":"")+">"+i+"</option>");return yearHtml='<div class="pika-label">'+year+opts.yearSuffix+'<select class="pika-select pika-select-year">'+arr.join("")+"</select></div>",opts.showMonthAfterYear?html+=yearHtml+monthHtml:html+=monthHtml+yearHtml,isMinYear&&(0===month||opts.minMonth>=month)&&(prev=!1),isMaxYear&&(11===month||opts.maxMonth<=month)&&(next=!1),0===c&&(html+='<button class="pika-prev'+(prev?"":" is-disabled")+'" type="button">'+opts.i18n.previousMonth+"</button>"),c===instance._o.numberOfMonths-1&&(html+='<button class="pika-next'+(next?"":" is-disabled")+'" type="button">'+opts.i18n.nextMonth+"</button>"),html+"</div>"},renderTable=function(opts,data){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+renderHead(opts)+renderBody(data)+"</table>"},Pikaday=function(options){var self=this,opts=self.config(options);self._onMouseDown=function(e){if(self._v){var target=(e=e||window.event).target||e.srcElement;if(target){if(!hasClass(target,"is-disabled")){if(hasClass(target,"pika-button")&&!hasClass(target,"is-empty"))return self.setDate(new Date(target.getAttribute("data-pika-year"),target.getAttribute("data-pika-month"),target.getAttribute("data-pika-day"))),void(opts.bound&&sto(function(){self.hide(),opts.field&&opts.field.blur()},100));hasClass(target,"pika-prev")?self.prevMonth():hasClass(target,"pika-next")&&self.nextMonth()}if(hasClass(target,"pika-select"))self._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}}},self._onChange=function(e){var target=(e=e||window.event).target||e.srcElement;target&&(hasClass(target,"pika-select-month")?self.gotoMonth(target.value):hasClass(target,"pika-select-year")&&self.gotoYear(target.value))},self._onInputChange=function(e){var date;e.firedBy!==self&&(date=hasMoment?(date=moment(opts.field.value,opts.format))&&date.isValid()?date.toDate():null:new Date(Date.parse(opts.field.value)),self.setDate(isDate(date)?date:null),self._v||self.show())},self._onInputFocus=function(){self.show()},self._onInputClick=function(){self.show()},self._onInputBlur=function(){self._c||(self._b=sto(function(){self.hide()},50)),self._c=!1},self._onClick=function(e){var target=(e=e||window.event).target||e.srcElement,pEl=target;if(target){!hasEventListeners&&hasClass(target,"pika-select")&&(target.onchange||(target.setAttribute("onchange","return;"),addEvent(target,"change",self._onChange)));do{if(hasClass(pEl,"pika-single"))return}while(pEl=pEl.parentNode);self._v&&target!==opts.trigger&&self.hide()}},self.el=document.createElement("div"),self.el.className="pika-single"+(opts.isRTL?" is-rtl":""),addEvent(self.el,"mousedown",self._onMouseDown,!0),addEvent(self.el,"change",self._onChange),opts.field&&(opts.container?opts.container.appendChild(self.el):opts.bound?document.body.appendChild(self.el):opts.field.parentNode.insertBefore(self.el,opts.field.nextSibling),addEvent(opts.field,"change",self._onInputChange),opts.defaultDate||(hasMoment&&opts.field.value?opts.defaultDate=moment(opts.field.value,opts.format).toDate():opts.defaultDate=new Date(Date.parse(opts.field.value)),opts.setDefaultDate=!0));var defDate=opts.defaultDate;isDate(defDate)?opts.setDefaultDate?self.setDate(defDate,!0):self.gotoDate(defDate):self.gotoDate(new Date),opts.bound?(this.hide(),self.el.className+=" is-bound",addEvent(opts.trigger,"click",self._onInputClick),addEvent(opts.trigger,"focus",self._onInputFocus),addEvent(opts.trigger,"blur",self._onInputBlur)):this.show()};return Pikaday.prototype={config:function(options){this._o||(this._o=extend({},defaults,!0));var opts=extend(this._o,options,!0);opts.isRTL=!!opts.isRTL,opts.field=opts.field&&opts.field.nodeName?opts.field:null,opts.bound=!!(opts.bound!==undefined?opts.field&&opts.bound:opts.field),opts.trigger=opts.trigger&&opts.trigger.nodeName?opts.trigger:opts.field;var nom=parseInt(opts.numberOfMonths,10)||1;if(opts.numberOfMonths=nom>4?4:nom,isDate(opts.minDate)||(opts.minDate=!1),isDate(opts.maxDate)||(opts.maxDate=!1),opts.minDate&&opts.maxDate&&opts.maxDate<opts.minDate&&(opts.maxDate=opts.minDate=!1),opts.minDate&&(setToStartOfDay(opts.minDate),opts.minYear=opts.minDate.getFullYear(),opts.minMonth=opts.minDate.getMonth()),opts.maxDate&&(setToStartOfDay(opts.maxDate),opts.maxYear=opts.maxDate.getFullYear(),opts.maxMonth=opts.maxDate.getMonth()),isArray(opts.yearRange)){var fallback=(new Date).getFullYear()-10;opts.yearRange[0]=parseInt(opts.yearRange[0],10)||fallback,opts.yearRange[1]=parseInt(opts.yearRange[1],10)||fallback}else opts.yearRange=Math.abs(parseInt(opts.yearRange,10))||defaults.yearRange,opts.yearRange>100&&(opts.yearRange=100);return opts},toString:function(format){return isDate(this._d)?hasMoment?moment(this._d).format(format||this._o.format):this._d.toDateString():""},getMoment:function(){return hasMoment?moment(this._d):null},setMoment:function(date,preventOnSelect){hasMoment&&moment.isMoment(date)&&this.setDate(date.toDate(),preventOnSelect)},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(date,preventOnSelect){if(!date)return this._d=null,this.draw();if("string"==typeof date&&(date=new Date(Date.parse(date))),isDate(date)){var min=this._o.minDate,max=this._o.maxDate;isDate(min)&&date<min?date=min:isDate(max)&&date>max&&(date=max),this._d=new Date(date.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),preventOnSelect||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(date){var newCalendar=!0;if(isDate(date)){if(this.calendars){var firstVisibleDate=new Date(this.calendars[0].year,this.calendars[0].month,1),lastVisibleDate=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),visibleDate=date.getTime();lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1),lastVisibleDate.setDate(lastVisibleDate.getDate()-1),newCalendar=visibleDate<firstVisibleDate.getTime()||lastVisibleDate.getTime()<visibleDate}newCalendar&&(this.calendars=[{month:date.getMonth(),year:date.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(var c=1;c<this._o.numberOfMonths;c++)this.calendars[c]=adjustCalendar({month:this.calendars[0].month+c,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(month){isNaN(month)||(this.calendars[0].month=parseInt(month,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(year){isNaN(year)||(this.calendars[0].year=parseInt(year,10),this.adjustCalendars())},setMinDate:function(value){this._o.minDate=value},setMaxDate:function(value){this._o.maxDate=value},draw:function(force){if(this._v||force){var opts=this._o,minYear=opts.minYear,maxYear=opts.maxYear,minMonth=opts.minMonth,maxMonth=opts.maxMonth,html="";this._y<=minYear&&(this._y=minYear,!isNaN(minMonth)&&this._m<minMonth&&(this._m=minMonth)),this._y>=maxYear&&(this._y=maxYear,!isNaN(maxMonth)&&this._m>maxMonth&&(this._m=maxMonth));for(var c=0;c<opts.numberOfMonths;c++)html+='<div class="pika-lendar">'+renderTitle(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year)+this.render(this.calendars[c].year,this.calendars[c].month)+"</div>";if(this.el.innerHTML=html,opts.bound&&"hidden"!==opts.field.type&&sto(function(){opts.trigger.focus()},1),"function"==typeof this._o.onDraw){var self=this;sto(function(){self._o.onDraw.call(self)},0)}}},adjustPosition:function(){if(!this._o.container){var left,top,clientRect,field=this._o.trigger,pEl=field,width=this.el.offsetWidth,height=this.el.offsetHeight,viewportWidth=window.innerWidth||document.documentElement.clientWidth,viewportHeight=window.innerHeight||document.documentElement.clientHeight,scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;if("function"==typeof field.getBoundingClientRect)left=(clientRect=field.getBoundingClientRect()).left+window.pageXOffset,top=clientRect.bottom+window.pageYOffset;else for(left=pEl.offsetLeft,top=pEl.offsetTop+pEl.offsetHeight;pEl=pEl.offsetParent;)left+=pEl.offsetLeft,top+=pEl.offsetTop;(left+width>viewportWidth||this._o.position.indexOf("right")>-1&&left-width+field.offsetWidth>0)&&(left=left-width+field.offsetWidth),(top+height>viewportHeight+scrollTop||this._o.position.indexOf("top")>-1&&top-height-field.offsetHeight>0)&&(top=top-height-field.offsetHeight),this.el.style.cssText=["position: absolute","left: "+left+"px","top: "+top+"px"].join(";")}},render:function(year,month){var opts=this._o,now=new Date,days=getDaysInMonth(year,month),before=new Date(year,month,1).getDay(),data=[],row=[];setToStartOfDay(now),opts.firstDay>0&&(before-=opts.firstDay)<0&&(before+=7);for(var cells=days+before,after=cells;after>7;)after-=7;cells+=7-after;for(var i=0,r=0;i<cells;i++){var day=new Date(year,month,i-before+1),isDisabled=opts.minDate&&day<opts.minDate||opts.maxDate&&day>opts.maxDate,isSelected=!!isDate(this._d)&&compareDates(day,this._d),isToday=compareDates(day,now),isEmpty=i<before||i>=days+before;row.push(renderDay(i-before+1,month,year,isSelected,isToday,isDisabled,isEmpty)),7==++r&&(opts.showWeekNumber&&row.unshift(renderWeek(i-before,month,year)),data.push(renderRow(row,opts.isRTL)),row=[],r=0)}return renderTable(opts,data)},isVisible:function(){return this._v},show:function(){this._v||(removeClass(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(addEvent(document,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var v=this._v;!1!==v&&(this._o.bound&&removeEvent(document,"click",this._onClick),this.el.style.cssText="",addClass(this.el,"is-hidden"),this._v=!1,v!==undefined&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),this._o.field&&(removeEvent(this._o.field,"change",this._onInputChange),this._o.bound&&(removeEvent(this._o.trigger,"click",this._onInputClick),removeEvent(this._o.trigger,"focus",this._onInputFocus),removeEvent(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Pikaday}),function(window,document,navigator,undefined){"use strict";var debounce=function(callback,wait,cancelprevious){var timeout;return function(){if(timeout){if(!cancelprevious)return;clearTimeout(timeout)}var context=this,args=arguments;timeout=setTimeout(function(){timeout=null,callback.apply(context,args)},wait)}},addEvent=function(element,type,handler,useCapture){element.addEventListener?element.addEventListener(type,handler,!!useCapture):element.attachEvent?element.attachEvent("on"+type,handler):element!=window&&(element["on"+type]=handler)},removeEvent=function(element,type,handler,useCapture){element.removeEventListener?element.removeEventListener(type,handler,!!useCapture):element.detachEvent?element.detachEvent("on"+type,handler):element!=window&&(element["on"+type]=null)},fireEvent=function(element,type,bubbles,cancelable){if(document.createEvent)(event=document.createEvent("Event")).initEvent(type,bubbles===undefined||bubbles,cancelable!==undefined&&cancelable),element.dispatchEvent(event);else if(document.createEventObject){var event=document.createEventObject();element.fireEvent("on"+type,event)}else"function"==typeof element["on"+type]&&element["on"+type]()},cancelEvent=function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},Node_ELEMENT_NODE="undefined"!=typeof Node?Node.ELEMENT_NODE:1,Node_TEXT_NODE="undefined"!=typeof Node?Node.TEXT_NODE:3,isOrContainsNode=function(ancestor,descendant){for(var node=descendant;node;){if(node===ancestor)return!0;node=node.parentNode}return!1},nextNode=function(node,container){if(node.firstChild)return node.firstChild;for(;node;){if(node==container)return null;if(node.nextSibling)return node.nextSibling;node=node.parentNode}return null},saveSelection=function(){if(window.getSelection){if((sel=window.getSelection()).rangeCount>0)return sel.getRangeAt(0)}else if(document.selection){var sel;return(sel=document.selection).createRange()}return null},restoreSelection=function(containerNode,savedSel){if(savedSel)if(window.getSelection){var sel=window.getSelection();sel.removeAllRanges(),sel.addRange(savedSel)}else document.selection&&savedSel.select()},getSelectionRect=function(){if(window.getSelection){if(!(sel=window.getSelection()).rangeCount)return!1;if((range=sel.getRangeAt(0).cloneRange()).getBoundingClientRect){if((rect=range.getBoundingClientRect())&&rect.left&&rect.top&&rect.right&&rect.bottom)return{left:parseInt(rect.left),top:parseInt(rect.top),width:parseInt(rect.right-rect.left),height:parseInt(rect.bottom-rect.top)};for(var rects=range.getClientRects?range.getClientRects():[],i=0;i<rects.length;++i){var rect;if((rect=rects[i]).left&&rect.top&&rect.right&&rect.bottom)return{left:parseInt(rect.left),top:parseInt(rect.top),width:parseInt(rect.right-rect.left),height:parseInt(rect.bottom-rect.top)}}}}else if(document.selection){var sel,range;if("Control"!=(sel=document.selection).type)if((range=sel.createRange()).boundingLeft||range.boundingTop||range.boundingWidth||range.boundingHeight)return{left:range.boundingLeft,top:range.boundingTop,width:range.boundingWidth,height:range.boundingHeight}}return!1},getSelectionCollapsed=function(containerNode){if(window.getSelection)return!!(sel=window.getSelection()).isCollapsed;if(document.selection){var sel;if("Text"==(sel=document.selection).type){var range=document.selection.createRange(),textrange=document.body.createTextRange();return textrange.moveToElementText(containerNode),textrange.setEndPoint("EndToStart",range),0==range.htmlText.length}if("Control"==sel.type)return!1}return!0},getSelectedNodes=function(containerNode){if(window.getSelection){if(!(sel=window.getSelection()).rangeCount)return[];for(var nodes=[],i=0;i<sel.rangeCount;++i)for(var node=(range=sel.getRangeAt(i)).startContainer,endNode=range.endContainer;node;){if(node!=containerNode){var node_inside_selection=!1;if(sel.containsNode)node_inside_selection=sel.containsNode(node,!0);else{(noderange=document.createRange()).selectNodeContents(node);for(i=0;i<sel.rangeCount;++i){if((range=sel.getRangeAt(i)).compareBoundaryPoints(range.END_TO_START,noderange)>=0&&range.compareBoundaryPoints(range.START_TO_END,noderange)<=0){node_inside_selection=!0;break}}}node_inside_selection&&nodes.push(node)}node=nextNode(node,node==endNode?endNode:containerNode)}return 0==nodes.length&&isOrContainsNode(containerNode,sel.focusNode)&&sel.focusNode!=containerNode&&nodes.push(sel.focusNode),nodes}if(document.selection){var sel;if("Text"==(sel=document.selection).type){nodes=[];var ranges=sel.createRangeCollection();for(i=0;i<ranges.length;++i){var parentNode=(range=ranges[i]).parentElement();for(node=parentNode;node;){var noderange;if((noderange=range.duplicate()).moveToElementText(node.nodeType!=Node_ELEMENT_NODE?node.parentNode:node),noderange.compareEndPoints("EndToStart",range)>=0&&noderange.compareEndPoints("StartToEnd",range)<=0){for(var in_array=!1,j=0;j<nodes.length;++j)if(nodes[j]===node){in_array=!0;break}in_array||nodes.push(node)}node=nextNode(node,parentNode)}}return 0==nodes.length&&isOrContainsNode(containerNode,document.activeElement)&&document.activeElement!=containerNode&&nodes.push(document.activeElement),nodes}if("Control"==sel.type){nodes=[];var range=sel.createRange();for(i=0;i<range.length;++i)nodes.push(range(i));return nodes}}return[]},collapseSelectionEnd=function(){if(window.getSelection){if(!(sel=window.getSelection()).isCollapsed)try{sel.collapseToEnd()}catch(e){}}else if(document.selection){var sel;if("Control"!=(sel=document.selection).type){var range=sel.createRange();range.collapse(!1),range.select()}}},expandSelectionCaret=function(containerNode,preceding,following){if(window.getSelection)if((sel=window.getSelection()).modify){for(var i=0;i<preceding;++i)sel.modify("extend","backward","character");for(i=0;i<following;++i)sel.modify("extend","forward","character")}else{(range=sel.getRangeAt(0)).setStart(range.startContainer,range.startOffset-preceding),range.setEnd(range.endContainer,range.endOffset+following),sel.removeAllRanges(),sel.addRange(range)}else if(document.selection){var sel,range;if("Control"!=(sel=document.selection).type)(range=sel.createRange()).collapse(!0),range.moveStart("character",-preceding),range.moveEnd("character",following),range.select()}},getSelectionHtml=function(containerNode){if(getSelectionCollapsed(containerNode))return null;if(window.getSelection){if((sel=window.getSelection()).rangeCount){for(var container=document.createElement("div"),len=sel.rangeCount,i=0;i<len;++i){var contents=sel.getRangeAt(i).cloneContents();container.appendChild(contents)}return container.innerHTML}}else if(document.selection){var sel;if("Text"==(sel=document.selection).type)return sel.createRange().htmlText}return null},selectionInside=function(containerNode,force){if(window.getSelection){var sel=window.getSelection();if(isOrContainsNode(containerNode,sel.anchorNode)&&isOrContainsNode(containerNode,sel.focusNode))return!0;if(!force)return!1;(range=document.createRange()).selectNodeContents(containerNode),range.collapse(!1),sel.removeAllRanges(),sel.addRange(range)}else if(document.selection){if("Control"==(sel=document.selection).type){if(0!=(range=sel.createRange()).length&&isOrContainsNode(containerNode,range(0)))return!0}else{var rangeContainer=document.body.createTextRange();rangeContainer.moveToElementText(containerNode);var range=sel.createRange();if(rangeContainer.inRange(range))return!0}if(!force)return!1;(range=document.body.createTextRange()).moveToElementText(containerNode),range.setEndPoint("StartToEnd",range),range.select()}return!0},pasteHtmlAtCaret=function(containerNode,html){if(window.getSelection){if((sel=window.getSelection()).getRangeAt&&sel.rangeCount){var range=sel.getRangeAt(0),el=document.createElement("div");el.innerHTML=html;for(var node,lastNode,frag=document.createDocumentFragment();node=el.firstChild;)lastNode=frag.appendChild(node);isOrContainsNode(containerNode,range.commonAncestorContainer)?(range.deleteContents(),range.insertNode(frag)):containerNode.appendChild(frag),lastNode&&((range=range.cloneRange()).setStartAfter(lastNode),range.collapse(!0),sel.removeAllRanges(),sel.addRange(range))}}else if(document.selection){var sel;if("Control"!=(sel=document.selection).type){var originalRange=sel.createRange();originalRange.collapse(!0);range=sel.createRange();if(isOrContainsNode(containerNode,range.parentElement()))range.pasteHTML(html);else{var textRange=document.body.createTextRange();textRange.moveToElementText(containerNode),textRange.collapse(!1),textRange.select(),textRange.pasteHTML(html)}(range=sel.createRange()).setEndPoint("StartToEnd",originalRange),range.select()}}};window.wysiwyg=function(option){var option_element=(option=option||{}).element||null;"string"==typeof option_element&&(option_element=document.getElementById(option_element));var option_onkeydown=option.onKeyDown||null,option_onkeypress=option.onKeyPress||null,option_onkeyup=option.onKeyUp||null,option_onselection=option.onSelection||null,option_onplaceholder=option.onPlaceholder||null,option_onclosepopup=option.onClosepopup||null,option_hijackcontextmenu=option.hijackContextmenu||!1,is_textarea="TEXTAREA"==option_element.nodeName||"INPUT"==option_element.nodeName;if(is_textarea){var canContentEditable="contentEditable"in document.body;if(canContentEditable){var webkit=navigator.userAgent.match(/(?:iPad|iPhone|Android).* AppleWebKit\/([^ ]+)/);webkit&&420<=parseInt(webkit[1])&&parseInt(webkit[1])<534&&(canContentEditable=!1)}if(!canContentEditable){var newlineAfterBR=function(html){return html.replace(/<br[ \/]*>\n?/gi,"<br>\n")};(node_textarea=option_element).value=newlineAfterBR(node_textarea.value);var dummy_this=function(){return this},dummy_null=function(){return null};return{legacy:!0,getElement:function(){return node_textarea},getHTML:function(){return node_textarea.value},setHTML:function(html){return node_textarea.value=newlineAfterBR(html),this},getSelectedHTML:dummy_null,sync:dummy_this,collapseSelection:dummy_this,expandSelection:dummy_this,openPopup:dummy_null,closePopup:dummy_this,removeFormat:dummy_this,bold:dummy_this,italic:dummy_this,underline:dummy_this,strikethrough:dummy_this,forecolor:dummy_this,highlight:dummy_this,fontName:dummy_this,fontSize:dummy_this,subscript:dummy_this,superscript:dummy_this,align:dummy_this,format:dummy_this,indent:dummy_this,insertLink:dummy_this,insertImage:dummy_this,insertHTML:dummy_this,insertList:dummy_this}}}var node_textarea=null,node_wysiwyg=null;if(is_textarea){(node_textarea=option_element).style.display="none",(node_wysiwyg=document.createElement("DIV")).innerHTML=node_textarea.value;var parent=node_textarea.parentNode,next=node_textarea.nextSibling;next?parent.insertBefore(node_wysiwyg,next):parent.appendChild(node_wysiwyg)}else node_wysiwyg=option_element;node_wysiwyg.setAttribute("contentEditable","true");var showPlaceholder,window_ie8=document.all&&!document.addEventListener?document:window,syncTextarea=null;if(is_textarea){var previous_html=node_wysiwyg.innerHTML;syncTextarea=function(){var new_html=node_wysiwyg.innerHTML;new_html!=previous_html&&(node_textarea.value=new_html,previous_html=new_html,fireEvent(node_textarea,"change",!1))}}if(option_onplaceholder){var placeholder_visible=!1;(showPlaceholder=function(){for(var wysiwyg_empty=!0,node=node_wysiwyg;node;)if(node=nextNode(node,node_wysiwyg)){if(node.nodeType==Node_ELEMENT_NODE){if("IMG"==node.nodeName){wysiwyg_empty=!1;break}}else if(node.nodeType==Node_TEXT_NODE){var text=node.nodeValue;if(text&&-1!=text.search(/[^\s]/)){wysiwyg_empty=!1;break}}}else;placeholder_visible!=wysiwyg_empty&&(option_onplaceholder(wysiwyg_empty),placeholder_visible=wysiwyg_empty)})()}var popup_saved_selection=null,debounced_handleSelection=null;option_onselection&&(debounced_handleSelection=debounce(function(clientX,clientY,rightclick){var collapsed=getSelectionCollapsed(node_wysiwyg),nodes=getSelectedNodes(node_wysiwyg),rect=null===clientX||null===clientY?null:{left:clientX,top:clientY,width:0,height:0},selectionRect=getSelectionRect();if(selectionRect&&(rect=selectionRect),rect){if(node_wysiwyg.getBoundingClientRect){var boundingrect=node_wysiwyg.getBoundingClientRect();rect.left-=parseInt(boundingrect.left),rect.top-=parseInt(boundingrect.top)}else{var node=node_wysiwyg,offsetLeft=0,offsetTop=0,fixed=!1;do{offsetLeft+=node.offsetLeft?parseInt(node.offsetLeft):0,offsetTop+=node.offsetTop?parseInt(node.offsetTop):0,"fixed"==node.style.position&&(fixed=!0)}while(node=node.offsetParent);rect.left-=offsetLeft-(fixed?0:window.pageXOffset),rect.top-=offsetTop-(fixed?0:window.pageYOffset)}rect.left<0&&(rect.left=0),rect.top<0&&(rect.top=0),rect.width>node_wysiwyg.offsetWidth&&(rect.width=node_wysiwyg.offsetWidth),rect.height>node_wysiwyg.offsetHeight&&(rect.height=node_wysiwyg.offsetHeight)}else if(nodes.length)for(var i=0;i<nodes.length;++i){if((node=nodes[i]).nodeType==Node_ELEMENT_NODE){rect={left:node.offsetLeft,top:node.offsetTop,width:node.offsetWidth,height:node.offsetHeight};break}}option_onselection(collapsed,rect,nodes,rightclick)},1));var node_popup=null,popupClickClose=function(e){if(!e)e=window.event;var target=e.target||e.srcElement;target.nodeType==Node_TEXT_NODE&&(target=target.parentNode),isOrContainsNode(node_popup,target)||popupClose()},popupOpen=function(){if(node_popup)return node_popup;addEvent(window_ie8,"mousedown",popupClickClose,!0),node_popup=document.createElement("DIV");var parent=node_wysiwyg.parentNode,next=node_wysiwyg.nextSibling;return next?parent.insertBefore(node_popup,next):parent.appendChild(node_popup),node_popup},popupClose=function(){node_popup&&(node_popup.parentNode.removeChild(node_popup),node_popup=null,removeEvent(window_ie8,"mousedown",popupClickClose,!0),option_onclosepopup&&option_onclosepopup())};addEvent(node_wysiwyg,"focus",function(){node_textarea&&fireEvent(node_textarea,"focus",!1)}),addEvent(node_wysiwyg,"blur",function(){syncTextarea&&syncTextarea(),node_textarea&&fireEvent(node_textarea,"blur",!1)});var debounced_changeHandler=null;if(showPlaceholder||syncTextarea){var debounced_syncTextarea=syncTextarea?debounce(syncTextarea,250,!0):null;debounced_changeHandler=debounce(function(){showPlaceholder&&showPlaceholder(),debounced_syncTextarea&&debounced_syncTextarea()},1),addEvent(node_wysiwyg,"input",debounced_changeHandler),addEvent(node_wysiwyg,"DOMNodeInserted",debounced_changeHandler),addEvent(node_wysiwyg,"DOMNodeRemoved",debounced_changeHandler),addEvent(node_wysiwyg,"DOMSubtreeModified",debounced_changeHandler),addEvent(node_wysiwyg,"DOMCharacterDataModified",debounced_changeHandler),addEvent(node_wysiwyg,"propertychange",debounced_changeHandler),addEvent(node_wysiwyg,"textInput",debounced_changeHandler),addEvent(node_wysiwyg,"paste",debounced_changeHandler),addEvent(node_wysiwyg,"cut",debounced_changeHandler),addEvent(node_wysiwyg,"drop",debounced_changeHandler)}var keyHandler=function(e,phase){if(!e)e=window.event;var key=e.which||e.keyCode,character=String.fromCharCode(key||e.charCode),shiftKey=e.shiftKey||!1,altKey=e.altKey||!1,ctrlKey=e.ctrlKey||!1,metaKey=e.metaKey||!1;if(1==phase){if(option_onkeydown&&!1===option_onkeydown(key,character,shiftKey,altKey,ctrlKey,metaKey))return cancelEvent(e)}else if(2==phase){if(option_onkeypress&&!1===option_onkeypress(key,character,shiftKey,altKey,ctrlKey,metaKey))return cancelEvent(e)}else if(3==phase&&option_onkeyup&&!1===option_onkeyup(key,character,shiftKey,altKey,ctrlKey,metaKey))return cancelEvent(e);if(2!=phase&&3!=phase||(popup_saved_selection=null,debounced_handleSelection&&debounced_handleSelection(null,null,!1)),2==phase&&debounced_changeHandler)switch(key){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:break;default:debounced_changeHandler()}};addEvent(node_wysiwyg,"keydown",function(e){return keyHandler(e,1)}),addEvent(node_wysiwyg,"keypress",function(e){return keyHandler(e,2)}),addEvent(node_wysiwyg,"keyup",function(e){return keyHandler(e,3)});var mouseHandler=function(e,rightclick){if(!e)e=window.event;var clientX=null,clientY=null;e.clientX&&e.clientY?(clientX=e.clientX,clientY=e.clientY):e.pageX&&e.pageY&&(clientX=e.pageX-window.pageXOffset,clientY=e.pageY-window.pageYOffset),e.which&&3==e.which?rightclick=!0:e.button&&2==e.button&&(rightclick=!0),removeEvent(window_ie8,"mouseup",mouseHandler),popup_saved_selection=null,!option_hijackcontextmenu&&rightclick||debounced_handleSelection&&debounced_handleSelection(clientX,clientY,rightclick)};addEvent(node_wysiwyg,"mousedown",function(){removeEvent(window_ie8,"mouseup",mouseHandler),addEvent(window_ie8,"mouseup",mouseHandler)}),addEvent(node_wysiwyg,"mouseup",function(e){mouseHandler(e),debounced_changeHandler&&debounced_changeHandler()}),addEvent(node_wysiwyg,"dblclick",function(e){mouseHandler(e)}),addEvent(node_wysiwyg,"selectionchange",function(e){mouseHandler(e)}),option_hijackcontextmenu&&addEvent(node_wysiwyg,"contextmenu",function(e){
return mouseHandler(e,!0),cancelEvent(e)});var execCommand=function(command,param,force_selection){if(restoreSelection(node_wysiwyg,popup_saved_selection),!selectionInside(node_wysiwyg,force_selection))return!1;if(window.getSelection)try{return!(document.queryCommandSupported&&!document.queryCommandSupported(command))&&document.execCommand(command,!1,param)}catch(e){}else if(document.selection){var sel=document.selection;if("None"!=sel.type){var range=sel.createRange();try{return!!range.queryCommandEnabled(command)&&range.execCommand(command,!1,param)}catch(e){}}}return!1},trailingDiv=null,IEtrailingDIV=function(){(document.all||window.MSInputMethodContext)&&(trailingDiv=document.createElement("DIV"),node_wysiwyg.appendChild(trailingDiv))},callUpdates=function(selection_destroyed){trailingDiv&&(node_wysiwyg.removeChild(trailingDiv),trailingDiv=null),debounced_changeHandler&&debounced_changeHandler(),selection_destroyed?(collapseSelectionEnd(),popup_saved_selection=null):popup_saved_selection&&(popup_saved_selection=saveSelection(node_wysiwyg))};return{getElement:function(){return node_wysiwyg},getHTML:function(){return node_wysiwyg.innerHTML},setHTML:function(html){return node_wysiwyg.innerHTML=html,callUpdates(!0),this},getSelectedHTML:function(){return restoreSelection(node_wysiwyg,popup_saved_selection),selectionInside(node_wysiwyg)?getSelectionHtml(node_wysiwyg):null},sync:function(){return syncTextarea&&syncTextarea(),this},collapseSelection:function(){return collapseSelectionEnd(),popup_saved_selection=null,this},expandSelection:function(preceding,following){return restoreSelection(node_wysiwyg,popup_saved_selection),selectionInside(node_wysiwyg)?(expandSelectionCaret(node_wysiwyg,preceding,following),popup_saved_selection=saveSelection(node_wysiwyg),this):this},openPopup:function(){return popup_saved_selection||(popup_saved_selection=saveSelection(node_wysiwyg)),popupOpen()},closePopup:function(){return popupClose(),this},removeFormat:function(){return execCommand("removeFormat"),execCommand("unlink"),callUpdates(),this},bold:function(){return execCommand("bold"),callUpdates(),this},italic:function(){return execCommand("italic"),callUpdates(),this},underline:function(){return execCommand("underline"),callUpdates(),this},strikethrough:function(){return execCommand("strikeThrough"),callUpdates(),this},forecolor:function(color){return execCommand("foreColor",color),callUpdates(),this},highlight:function(color){return execCommand("hiliteColor",color)||execCommand("backColor",color),callUpdates(),this},fontName:function(name){return execCommand("fontName",name),callUpdates(),this},fontSize:function(size){return execCommand("fontSize",size),callUpdates(),this},subscript:function(){return execCommand("subscript"),callUpdates(),this},superscript:function(){return execCommand("superscript"),callUpdates(),this},align:function(align){return IEtrailingDIV(),"left"==align?execCommand("justifyLeft"):"center"==align?execCommand("justifyCenter"):"right"==align?execCommand("justifyRight"):"justify"==align&&execCommand("justifyFull"),callUpdates(),this},format:function(tagname){return IEtrailingDIV(),execCommand("formatBlock",tagname),callUpdates(),this},indent:function(outdent){return IEtrailingDIV(),execCommand(outdent?"outdent":"indent"),callUpdates(),this},insertLink:function(url){return execCommand("createLink",url),callUpdates(!0),this},insertImage:function(url){return execCommand("insertImage",url,!0),callUpdates(!0),this},insertHTML:function(html){return execCommand("insertHTML",html,!0)||(restoreSelection(node_wysiwyg,popup_saved_selection),selectionInside(node_wysiwyg,!0),pasteHtmlAtCaret(node_wysiwyg,html)),callUpdates(!0),this},insertList:function(ordered){return IEtrailingDIV(),execCommand(ordered?"insertOrderedList":"insertUnorderedList"),callUpdates(),this}}}}(window,document,navigator),
/**
 * Timing.js 1.0.1
 * Copyright 2014 Addy Osmani
 */
function(window){"use strict";window.timing=window.timing||{getTimes:function(opts){var timing=(window.performance||window.webkitPerformance||window.msPerformance||window.mozPerformance).timing,api={};if(opts=opts||{},timing){if(opts&&!opts.simple)for(var k in timing)timing.hasOwnProperty(k)&&(api[k]=timing[k]);if(api.firstPaint===undefined){var firstPaint=0;window.chrome&&window.chrome.loadTimes?(firstPaint=1e3*window.chrome.loadTimes().firstPaintTime,api.firstPaintTime=firstPaint-1e3*window.chrome.loadTimes().startLoadTime):"number"==typeof window.performance.timing.msFirstPaint&&(firstPaint=window.performance.timing.msFirstPaint,api.firstPaintTime=firstPaint-window.performance.timing.navigationStart),opts&&!opts.simple&&(api.firstPaint=firstPaint)}api.loadTime=timing.loadEventEnd-timing.navigationStart,api.domReadyTime=timing.domComplete-timing.domInteractive,api.readyStart=timing.fetchStart-timing.navigationStart,api.redirectTime=timing.redirectEnd-timing.redirectStart,api.appcacheTime=timing.domainLookupStart-timing.fetchStart,api.unloadEventTime=timing.unloadEventEnd-timing.unloadEventStart,api.lookupDomainTime=timing.domainLookupEnd-timing.domainLookupStart,api.connectTime=timing.connectEnd-timing.connectStart,api.requestTime=timing.responseEnd-timing.requestStart,api.initDomTreeTime=timing.domInteractive-timing.responseEnd,api.loadEventTime=timing.loadEventEnd-timing.loadEventStart}return api},printTable:function(opts){var table={},data=this.getTimes(opts);Object.keys(data).sort().forEach(function(k){table[k]={ms:data[k],s:+(data[k]/1e3).toFixed(2)}}),console.table(table)},printSimpleTable:function(){this.printTable({simple:!0})}}}(this);
/*
	Copyright (c) 2013 Ivan Kuckir  ( ivan@kuckir.com )

	Permission is hereby granted, free of charge, to any person
	obtaining a copy of this software and associated documentation
	files (the "Software"), to deal in the Software without
	restriction, including without limitation the rights to use,
	copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the
	Software is furnished to do so, subject to the following
	conditions:

	The above copyright notice and this permission notice shall be
	included in all copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
	EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
	OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
	NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
	HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
	WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
	FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
	OTHER DEALINGS IN THE SOFTWARE.
	
	
	History:
	
	22. 10. 2103
		Bug with delay removed.
	
	11. 10. 2013
		Implementing onStart, onStartParams, onUpdate, onUpdateParams, onComplete, onCompleteParams
	
	1. 3. 2013
		Tweener depends on framerate now, not expecting 60 fps 
	
	6. 6. 2012
		First version, addTween with time, delay and transition parameters
*/
var Tweener={twns:[],looping:!1,_ptime:0,def:{time:1,transition:"easeOutExpo",delay:0,onStart:null,onStartParams:null,onUpdate:null,onUpdateParams:null,onComplete:null,onCompleteParams:null},addTween:function(o,ps){var T=Tweener,tp={},prms=[],tgts=[];for(var p in T.def)tp[p]=ps[p]?ps[p]:T.def[p];for(var p in ps)T.def[p]||(prms.push(p),tgts.push(ps[p]));tp.onStart&&(tp.onStartParams?tp.onStart.apply(null,tp.onStartParams):tp.onStart()),T.twns.push(new T.Tween(o,tp,prms,tgts)),T.loop()},loop:function(){var T=Tweener;T.looping||(T._ptime=(new Date).getTime(),requestAnimFrame(T.step)),T.looping=!0},step:function(){var T=Tweener,ptime=T._ptime;T._ptime=(new Date).getTime();for(var step=.001*(T._ptime-ptime),i=0;i<T.twns.length;i++){var t=T.twns[i];if(t.tp.delay>0)t.tp.delay-=step;else{if(0==t.bgns.length)for(var j=0;j<t.prms.length;j++)t.bgns.push(t.obj[t.prms[j]]),t.cngs.push(t.tgts[j]-t.bgns[j]);t.t+=step;var dur=t.tp.time;for(j=0;j<t.prms.length;j++)t.t>dur?t.obj[t.prms[j]]=t.bgns[j]+t.cngs[j]:t.obj[t.prms[j]]=Tweener.easingFunctions[t.tp.transition](t.t,t.bgns[j],t.cngs[j],dur);t.tp.onUpdate&&(t.tp.onUpdateParams?t.tp.onUpdate.apply(null,t.tp.onUpdateParams):t.tp.onUpdate()),t.t>dur&&(T.twns.splice(i--,1),t.tp.onComplete&&(t.tp.onCompleteParams?t.tp.onComplete.apply(null,t.tp.onCompleteParams):t.tp.onComplete()))}}T.twns.length>0?requestAnimFrame(T.step):T.looping=!1}};null==window.requestAnimFrame&&(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}),Tweener.Tween=function(obj,tp,prms,tgts){this.t=0,this.obj=obj,this.tp=tp,this.prms=prms,this.tgts=tgts,this.bgns=[],this.cngs=[]},Tweener.easingFunctions={easeNone:function(t,b,c,d){return c*t/d+b},easeInQuad:function(t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},easeInCubic:function(t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t+b:c/2*((t-=2)*t*t+2)+b},easeOutInCubic:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutCubic(2*t,b,c/2,d):Tweener.easingFunctions.easeInCubic(2*t-d,b+c/2,c/2,d)},easeInQuart:function(t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t+b:-c/2*((t-=2)*t*t*t-2)+b},easeOutInQuart:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutQuart(2*t,b,c/2,d):Tweener.easingFunctions.easeInQuart(2*t-d,b+c/2,c/2,d)},easeInQuint:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},easeOutInQuint:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutQuint(2*t,b,c/2,d):Tweener.easingFunctions.easeInQuint(2*t-d,b+c/2,c/2,d)},easeInSine:function(t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeOutInSine:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutSine(2*t,b,c/2,d):Tweener.easingFunctions.easeInSine(2*t-d,b+c/2,c/2,d)},easeInExpo:function(t,b,c,d){return 0==t?b:c*Math.pow(2,10*(t/d-1))+b-.001*c},easeOutExpo:function(t,b,c,d){return t==d?b+c:1.001*c*(1-Math.pow(2,-10*t/d))+b},easeInOutExpo:function(t,b,c,d){return 0==t?b:t==d?b+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+b-5e-4*c:c/2*1.0005*(2-Math.pow(2,-10*--t))+b},easeOutInExpo:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutExpo(2*t,b,c/2,d):Tweener.easingFunctions.easeInExpo(2*t-d,b+c/2,c/2,d)},easeInCirc:function(t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(t,b,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+b:c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeOutInCirc:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutCirc(2*t,b,c/2,d):Tweener.easingFunctions.easeInCirc(2*t-d,b+c/2,c/2,d)},easeInElastic:function(t,b,c,d,a,p){var s;return 0==t?b:1==(t/=d)?b+c:(p||(p=.3*d),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b)},easeOutElastic:function(t,b,c,d,a,p){var s;return 0==t?b:1==(t/=d)?b+c:(p||(p=.3*d),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b)},easeInOutElastic:function(t,b,c,d,a,p){var s;return 0==t?b:2==(t/=d/2)?b+c:(p||(p=d*(.3*1.5)),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b)},easeOutInElastic:function(t,b,c,d,a,p){return t<d/2?Tweener.easingFunctions.easeOutElastic(2*t,b,c/2,d,a,p):Tweener.easingFunctions.easeInElastic(2*t-d,b+c/2,c/2,d,a,p)},easeInBack:function(t,b,c,d,s){return s==undefined&&(s=1.70158),c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(t,b,c,d,s){return s==undefined&&(s=1.70158),c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(t,b,c,d,s){return s==undefined&&(s=1.70158),(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},easeOutInBack:function(t,b,c,d,s){return t<d/2?Tweener.easingFunctions.easeOutBack(2*t,b,c/2,d,s):Tweener.easingFunctions.easeInBack(2*t-d,b+c/2,c/2,d,s)},easeInBounce:function(t,b,c,d){return c-Tweener.easingFunctions.easeOutBounce(d-t,0,c,d)+b},easeOutBounce:function(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},easeInOutBounce:function(t,b,c,d){return t<d/2?.5*Tweener.easingFunctions.easeInBounce(2*t,0,c,d)+b:.5*Tweener.easingFunctions.easeOutBounce(2*t-d,0,c,d)+.5*c+b},easeOutInBounce:function(t,b,c,d){return t<d/2?Tweener.easingFunctions.easeOutBounce(2*t,b,c/2,d):Tweener.easingFunctions.easeInBounce(2*t-d,b+c/2,c/2,d)}},Tweener.easingFunctions.linear=Tweener.easingFunctions.easeNone,function(name,definition){"undefined"!=typeof module&&module.exports?module.exports.browser=definition():"function"==typeof define?define(definition):this[name]=definition()}("bowser",function(){function detect(ua){function getFirstMatch(regex){var match=ua.match(regex);return match&&match.length>1&&match[1]||""}var result,iosdevice=getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase(),android=!/like android/i.test(ua)&&/android/i.test(ua),versionIdentifier=getFirstMatch(/version\/(\d+(\.\d+)?)/i),tablet=/tablet/i.test(ua),mobile=!tablet&&/[^-]mobi/i.test(ua);/opera|opr/i.test(ua)?result={name:"Opera",opera:t,version:versionIdentifier||getFirstMatch(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(ua)?result={name:"Windows Phone",windowsphone:t,msie:t,version:getFirstMatch(/iemobile\/(\d+(\.\d+)?)/i)}:/msie|trident/i.test(ua)?result={name:"Internet Explorer",msie:t,version:getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:/chrome|crios|crmo/i.test(ua)?result={name:"Chrome",chrome:t,version:getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:iosdevice?(result={name:"iphone"==iosdevice?"iPhone":"ipad"==iosdevice?"iPad":"iPod"},versionIdentifier&&(result.version=versionIdentifier)):/sailfish/i.test(ua)?result={name:"Sailfish",sailfish:t,version:getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(ua)?result={name:"SeaMonkey",seamonkey:t,version:getFirstMatch(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(ua)?(result={name:"Firefox",firefox:t,version:getFirstMatch(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(ua)&&(result.firefoxos=t)):/silk/i.test(ua)?result={name:"Amazon Silk",silk:t,version:getFirstMatch(/silk\/(\d+(\.\d+)?)/i)}:android?result={name:"Android",version:versionIdentifier}:/phantom/i.test(ua)?result={name:"PhantomJS",phantom:t,version:getFirstMatch(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(ua)||/rim\stablet/i.test(ua)?result={name:"BlackBerry",blackberry:t,version:versionIdentifier||getFirstMatch(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(ua)?(result={name:"WebOS",webos:t,version:versionIdentifier||getFirstMatch(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(ua)&&(result.touchpad=t)):result=/bada/i.test(ua)?{name:"Bada",bada:t,version:getFirstMatch(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(ua)?{name:"Tizen",tizen:t,version:getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||versionIdentifier}:/safari/i.test(ua)?{name:"Safari",safari:t,version:versionIdentifier}:{},/(apple)?webkit/i.test(ua)?(result.name=result.name||"Webkit",result.webkit=t,!result.version&&versionIdentifier&&(result.version=versionIdentifier)):!result.opera&&/gecko\//i.test(ua)&&(result.name=result.name||"Gecko",result.gecko=t,result.version=result.version||getFirstMatch(/gecko\/(\d+(\.\d+)?)/i)),android||result.silk?result.android=t:iosdevice&&(result[iosdevice]=t,result.ios=t);var osVersion="";iosdevice?osVersion=(osVersion=getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):android?osVersion=getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i):result.windowsphone?osVersion=getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):result.webos?osVersion=getFirstMatch(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):result.blackberry?osVersion=getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i):result.bada?osVersion=getFirstMatch(/bada\/(\d+(\.\d+)*)/i):result.tizen&&(osVersion=getFirstMatch(/tizen[\/\s](\d+(\.\d+)*)/i)),osVersion&&(result.osversion=osVersion);var osMajorVersion=osVersion.split(".")[0];return tablet||"ipad"==iosdevice||android&&(3==osMajorVersion||4==osMajorVersion&&!mobile)||result.silk?result.tablet=t:(mobile||"iphone"==iosdevice||"ipod"==iosdevice||android||result.blackberry||result.webos||result.bada)&&(result.mobile=t),result.msie&&result.version>=10||result.chrome&&result.version>=20||result.firefox&&result.version>=20||result.safari&&result.version>=6||result.opera&&result.version>=10||result.ios&&result.osversion&&result.osversion.split(".")[0]>=6?result.a=t:result.msie&&result.version<10||result.chrome&&result.version<20||result.firefox&&result.version<20||result.safari&&result.version<6||result.opera&&result.version<10||result.ios&&result.osversion&&result.osversion.split(".")[0]<6?result.c=t:result.x=t,result}var t=!0,bowser=detect("undefined"!=typeof navigator?navigator.userAgent:"");return bowser._detect=detect,bowser}),function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/list"),require("../plugins/list"),pi.utils,pi.ActionList=function(_super){function ActionList(){return ActionList.__super__.constructor.apply(this,arguments)}return __extends(ActionList,_super),ActionList.include_plugins(pi.List.Selectable,pi.List.Sortable,pi.List.Searchable,pi.List.Filterable,pi.List.ScrollEnd),ActionList}(pi.List),pi.Guesser.rules_for("action_list",["pi-action-list"])},{"../core":46,"../plugins/list":66,"./base/list":6}],2:[function(require,module){"use strict";var pi;pi=require("../core/pi"),require("./pieces"),pi.utils,pi.App=function(){function App(){}return App.prototype.initialize=function(nod){var _ref;return this.view=pi.piecify(nod||pi.Nod.root),null!=(_ref=this.page)?_ref.initialize():void 0},App}(),pi.app=new pi.App,module.exports=pi.app},{"../core/pi":48,"./pieces":17}],3:[function(require){"use strict";var pi,utils,_pass,_serialize,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../pieces"),require("../events/input_events"),utils=pi.utils,_pass=function(val){return val},_serialize=function(val){return utils.serialize(val)},pi.BaseInput=function(_super){function BaseInput(){return BaseInput.__super__.constructor.apply(this,arguments)}return __extends(BaseInput,_super),BaseInput.prototype.postinitialize=function(){if(this.input||(this.input="INPUT"===this.node.nodeName?this:this.find("input")),!0===this.options.serialize?this._serializer=_serialize:this._serializer=_pass,null!=this.options.default_value&&!utils.serialize(this.value()))return this.value(this.options.default_value)},BaseInput.prototype.value=function(val){return null!=val?(this.input.node.value=val,this):this._serializer(this.input.node.value)},BaseInput.prototype.clear=function(silent){if(null==silent&&(silent=!1),null!=this.options.default_value?this.value(this.options.default_value):this.value(""),!silent)return this.trigger(pi.InputEvent.Clear)},BaseInput}(pi.Base)},{"../../core":46,"../events/input_events":12,"../pieces":17}],4:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../pieces"),pi.utils,pi.Button=function(_super){function Button(){return Button.__super__.constructor.apply(this,arguments)}return __extends(Button,_super),Button}(pi.Base),pi.Guesser.rules_for("button",["pi-button"],["button","a","input[button]"])},{"../../core":46,"../pieces":17}],5:[function(require){"use strict";require("./base_input"),require("./button"),require("./list"),require("./textinput")},{"./base_input":3,"./button":4,"./list":6,"./textinput":7}],6:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};pi=require("../../core"),require("../pieces"),require("../../plugins/base/renderable"),utils=pi.utils,pi.List=function(_super){function List(){return List.__super__.constructor.apply(this,arguments)}return __extends(List,_super),List.include_plugins(pi.Base.Renderable),List.prototype.merge_classes=["is-disabled","is-active","is-hidden"],List.prototype.preinitialize=function(){return List.__super__.preinitialize.apply(this,arguments),this.list_klass=this.options.list_klass||"list",this.item_klass=this.options.item_klass||"item",this.items=[],this.buffer=document.createDocumentFragment()},List.prototype.initialize=function(){return List.__super__.initialize.apply(this,arguments),this.items_cont=this.find("."+this.list_klass)||this,this.parse_html_items()},List.prototype.postinitialize=function(){if(this._check_empty(),null==this.options.noclick)return this.listen("."+this.item_klass,"click",(_this=this,function(e){if(!utils.clickable(e.origTarget)&&_this._item_clicked(e.target))return e.cancel()}));var _this},List.prototype.parse_html_items=function(){var _this;return this.items_cont.each("."+this.item_klass,(_this=this,function(node){return _this.add_item(pi.Nod.create(node),!0)})),this._flush_buffer()},List.prototype.data_provider=function(data,silent,remove){var item,_i,_len;if(null==data&&(data=null),null==silent&&(silent=!1),null==remove&&(remove=!0),this.items.length&&this.clear(silent,remove),null!=data)for(_i=0,_len=data.length;_i<_len;_i++)item=data[_i],this.add_item(item,!0);return this.update("load",silent),this},List.prototype.add_item=function(data,silent){var item;if(null==silent&&(silent=!1),null!=(item=this._create_item(data,this.items.length)))return this.items.push(item),this._check_empty(),silent?this.buffer.appendChild(item.node):this.items_cont.append(item),silent||this.trigger("update",{type:"item_added",item:item}),item},List.prototype.add_item_at=function(data,index,silent){var item,_after;return null==silent&&(silent=!1),this.items.length-1<index?this.add_item(data,silent):(item=this._create_item(data,index),this.items.splice(index,0,item),_after=this.items[index+1],item.record.__list_index__=index,_after.insertBefore(item),this._need_update_indeces=!0,silent||(this._update_indeces(),this.trigger("update",{type:"item_added",item:item})),item)},List.prototype.remove_item=function(item,silent,destroy){var index;return null==silent&&(silent=!1),null==destroy&&(destroy=!0),(index=this.items.indexOf(item))>-1&&(this.items.splice(index,1),destroy?this._destroy_item(item):item.detach(),this._check_empty(),this._need_update_indeces=!0,silent||(this._update_indeces(),this.trigger("update",{type:"item_removed",item:item})),!0)},List.prototype.remove_item_at=function(index,silent){var item;if(null==silent&&(silent=!1),!(this.items.length-1<index))return item=this.items[index],this.remove_item(item,silent)},List.prototype.remove_items=function(items){var item,_i,_len;for(_i=0,_len=items.length;_i<_len;_i++)item=items[_i],this.remove_item(item,!0);this.update()},List.prototype.update_item=function(item,data,silent){var klass,new_item,_i,_len,_ref;for(null==silent&&(silent=!1),new_item=this._renderer.render(data,!1),utils.extend(item.record,new_item.record,!0),item.remove_children(),item.html(new_item.html()),_i=0,_len=(_ref=item.node.className.split(/\s+/)).length;_i<_len;_i++)!(klass=_ref[_i])||__indexOf.call(this.merge_classes,klass)>=0||item.removeClass(klass);return item.mergeClasses(new_item),item.piecify(),item.postinitialize(),silent||this.trigger("update",{type:"item_updated",item:item}),item},List.prototype.move_item=function(item,index){if(!(item.record.__list_index__===index||index>this.items.length-1))return this.items.splice(this.items.indexOf(item),1),index===this.items.length?(this.items.push(item),this.items_cont.append(item)):(this.items.splice(index,0,item),this.items[index+1].insertBefore(item)),this._need_update_indeces=!0,this._update_indeces(),item},List.prototype.where=function(query){var item,matcher,_i,_len,_ref,_results;for(matcher="string"==typeof query?utils.matchers.nod(query):utils.matchers.object(query),_results=[],_i=0,_len=(_ref=this.items).length;_i<_len;_i++)matcher(item=_ref[_i])&&_results.push(item);return _results},List.prototype.records=function(){return this.items.map(function(item){return item.record})},List.prototype.size=function(){return this.items.length},List.prototype.update=function(type,silent){if(null==silent&&(silent=!1),this._flush_buffer(),this._need_update_indeces&&this._update_indeces(),this._check_empty(silent),!silent)return this.trigger("update",{type:type})},List.prototype.clear=function(silent,remove){return null==silent&&(silent=!1),null==remove&&(remove=!0),remove||this.items_cont.detach_children(),remove&&this.items_cont.remove_children(),this.items.length=0,silent||this.trigger("update",{type:"clear"}),this._check_empty(silent)},List.prototype._update_indeces=function(){var i,item,_i,_len,_ref;for(i=_i=0,_len=(_ref=this.items).length;_i<_len;i=++_i)(item=_ref[i]).data("list-index",i),item.record.__list_index__=i;return this._need_update_indeces=!1},List.prototype._check_empty=function(silent){if(null==silent&&(silent=!1),this.empty||0!==this.items.length){if(this.empty&&this.items.length>0&&(this.removeClass("is-empty"),this.empty=!1,!silent))return this.trigger("empty",!1)}else if(this.addClass("is-empty"),this.empty=!0,!silent)return this.trigger("empty",!0)},List.prototype._create_item=function(data,index){var item;return null==data&&(data={}),data instanceof pi.Nod&&data.is_list_item?data.host===this?(data.__list_index__=index,data):null:(data instanceof pi.Nod?data.data("__list_index__",index):data.__list_index__=index,null!=(item=this._renderer.render(data,!0,this))?(item.record||(item.record={}),item.is_list_item=!0,item):void 0)},List.prototype._destroy_item=function(item){return item.remove()},List.prototype._flush_buffer=function(append){var _results;for(null==append&&(append=!0),append&&this.items_cont.append(this.buffer),_results=[];this.buffer.firstChild;)_results.push(this.buffer.removeChild(this.buffer.firstChild));return _results},List.prototype._item_clicked=function(target){var item;if(target.is_list_item)return(item=target)&&item.host===this?(this.trigger("item_click",{item:item}),!0):void 0},List}(pi.Base),pi.Guesser.rules_for("list",["pi-list"],["ul"],function(nod){return 1===nod.children("ul").length})},{"../../core":46,"../../plugins/base/renderable":61,"../pieces":17}],7:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../pieces"),require("./base_input"),require("../events/input_events"),pi.utils,pi.TextInput=function(_super){function TextInput(){return TextInput.__super__.constructor.apply(this,arguments)}return __extends(TextInput,_super),TextInput.prototype.postinitialize=function(){return TextInput.__super__.postinitialize.apply(this,arguments),this.editable=!0,(this.options.readonly||this.hasClass("is-readonly"))&&this.readonly(),this.input.on("change",(_this=this,function(e){return e.cancel(),_this.trigger(pi.InputEvent.Change,_this.value())}));var _this},TextInput.prototype.edit=function(){return this.editable||(this.input.attr("readonly",null),this.removeClass("is-readonly"),this.editable=!0,this.trigger(pi.InputEvent.Editable,!0)),this},TextInput.prototype.readonly=function(){return this.editable&&(this.input.attr("readonly","readonly"),this.addClass("is-readonly"),this.editable=!1,this.blur(),this.trigger(pi.InputEvent.Editable,!1)),this},TextInput}(pi.BaseInput),pi.Guesser.rules_for("text_input",["pi-text-input-wrap"],["input[text]"])},{"../../core":46,"../events/input_events":12,"../pieces":17,"./base_input":3}],8:[function(require){"use strict";var pi,utils,_type_rxp;pi=require("../../core"),require("./base_input"),utils=pi.utils,_type_rxp=/(\w+)(?:\(([\w\-\/]+)\))/,pi.BaseInput.Validator=function(){function Validator(){}return Validator.add=function(name,fun){return this[name]=fun},Validator.validate=function(type,nod,form){var data,matches;return(matches=type.match(_type_rxp))&&(type=matches[1],data=utils.serialize(matches[2])),this[type](nod.value(),nod,form,data)},Validator.email=function(val){return utils.is_email(val)},Validator.len=function(val,nod,form,data){return(val+"").length>=data},Validator.truth=function(val){return!!utils.serialize(val)},Validator.presence=function(val){return val&&(val+"").length>0},Validator.digital=function(val){return utils.is_digital(val+"")},Validator.confirm=function(val,nod,form){var conf_nod,confirm_name;return confirm_name=nod.name().replace(/([\]]+)?$/,"_confirmation$1"),null!=(conf_nod=form.find_by_name(confirm_name))&&conf_nod.value()===val},Validator}()},{"../../core":46,"./base_input":3}],9:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/base_input"),require("./events/input_events"),pi.utils,pi.Checkbox=function(_super){function Checkbox(){return Checkbox.__super__.constructor.apply(this,arguments)}return __extends(Checkbox,_super),Checkbox.prototype.postinitialize=function(){return this._true_val=null!=this.options.true_value?this.options.true_value:1,this._false_val=null!=this.options.false_value?this.options.false_value:0,Checkbox.__super__.postinitialize.apply(this,arguments),this.attr("tabindex",0),null==this.__selected__&&(this.__selected__=!1),(this.options.selected||this.hasClass("is-selected")||this.value()==this._true_val)&&this.select(),this.on("click",(_this=this,function(e){return e.cancel(),_this.toggle_select()}));var _this},Checkbox.prototype.select=function(silent){if(null==silent&&(silent=!1),!this.__selected__&&(this.addClass("is-selected"),this.__selected__=!0,this.input.value(this._true_val),!silent))return this.trigger(pi.InputEvent.Change,!0)},Checkbox.prototype.deselect=function(silent){if(null==silent&&(silent=!1),this.__selected__&&(this.removeClass("is-selected"),this.__selected__=!1,this.input.value(this._false_val),!silent))return this.trigger(pi.InputEvent.Change,!1)},Checkbox.prototype.toggle_select=function(silent){return this.__selected__?this.deselect(silent):this.select(silent)},Checkbox.prototype.value=function(val){return null!=val?(Checkbox.__super__.value.apply(this,arguments),this.__selected__=val!=this._true_val,this.toggle_select(!0)):Checkbox.__super__.value.apply(this,arguments)},Checkbox.prototype.clear=function(silent){if(null==silent&&(silent=!1),this.value(this.options.default_value==this._true_val),!silent)return this.trigger(pi.InputEvent.Clear)},Checkbox}(pi.BaseInput),pi.Guesser.rules_for("checkbox",["pi-checkbox-wrap"],null)},{"../core":46,"./base/base_input":3,"./events/input_events":12}],10:[function(require){"use strict";var pi,utils,_call_rxp,_condition_rxp,_fun_rxp,_method_rxp,_null,_op_rxp,_operators,_str_rxp,_true,__slice=[].slice;pi=require("../core"),utils=pi.utils,_method_rxp=/([\w\.]+)\.(\w+)/,_str_rxp=/^['"].+['"]$/,_condition_rxp=/^(.*\S)\s*\?\s*(@?[\w\.]+(?:\(.*\S\))?)\s*(?:\:\s*(@?[\w\.]+(?:\(.*\S\))?)\s*)$/,_fun_rxp=/^(@?\w+)(?:\.([\w\.]+)(?:\((.+)\))?)?$/,_op_rxp=/(>|<|=)/,_true=function(){return!0},_null=function(){},_operators={">":function(left,right){return function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],(("function"==typeof left.apply?left.apply(this,args):void 0)||left)>(("function"==typeof right.apply?right.apply(this,args):void 0)||right)}},"<":function(left,right){return function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],(("function"==typeof left.apply?left.apply(this,args):void 0)||left)<(("function"==typeof right.apply?right.apply(this,args):void 0)||right)}},"=":function(left,right){return function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],(("function"==typeof left.apply?left.apply(this,args):void 0)||left)===(("function"==typeof right.apply?right.apply(this,args):void 0)||right)}}},_call_rxp=/\(\)/,pi.Compiler=function(){function Compiler(){}return Compiler.modifiers=[],Compiler.process_modifiers=function(str){var _i,_len,_ref;for(_i=0,_len=(_ref=this.modifiers).length;_i<_len;_i++)str=_ref[_i].call(null,str);return str},Compiler.call=function(owner,target,method_chain,fixed_args){var arg,error,method,method_,target_,target_chain,_ref,_ref1;try{return utils.debug("pi call: target - "+target+"; method chain - "+method_chain),target=function(){switch(!1){case"object"!=typeof target:return target;case"@"!==target[0]:return pi.find(target.slice(1),owner);default:return this[target]}}.call(this),method_chain?(method=(_ref=function(){var _fn,_i,_len,_ref,_ref1;if(method_chain.indexOf(".")<0)return[method_chain,target];for(_ref=method_chain.match(_method_rxp),_ref[0],target_chain=_ref[1],method_=_ref[2],target_=target,_fn=function(key_){return target_="function"==typeof target_[key_]?target_[key_].call(target_):target_[key_]},_i=0,_len=(_ref1=target_chain.split(".")).length;_i<_len;_i++)_fn(_ref1[_i]);return[method_,target_]}())[0],null!=(null!=(_ref1=(target=_ref[1])[method])?_ref1.call:void 0)?target[method].apply(target,function(){var _i,_len,_results;for(_results=[],_i=0,_len=fixed_args.length;_i<_len;_i++)arg=fixed_args[_i],_results.push("function"==typeof arg?arg.apply(this):arg);return _results}.call(this)):target[method]):target}catch(_error){return error=_error,utils.error(error,{backtrace:error.stack,target:target,method:method_chain,args:fixed_args})}},Compiler.is_simple_arg=function(arg){return!(_method_rxp.test(arg)||"@"===arg[0])},Compiler.prepare_arg=function(arg,host){return this.is_simple_arg(arg)?_str_rxp.test(arg)?arg.slice(1,-1):utils.serialize(arg):this.str_to_fun(arg,host)},Compiler._conditional=function(condition,resolve,reject){return function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],condition.apply(this,args)?resolve.apply(this,args):reject.apply(this,args)}},Compiler.str_to_fun=function(callstr,host){var condition,matches,reject,resolve;return(matches=(callstr=this.process_modifiers(callstr)).match(_condition_rxp))?(condition=this.compile_condition(matches[1],host),resolve=this.compile_fun(matches[2],host),reject=matches[3]?this.compile_fun(matches[3],host):_true,this._conditional(condition,resolve,reject)):this.compile_fun(callstr,host)},Compiler.compile_condition=function(callstr,host){var matches,parts;return(matches=callstr.match(_op_rxp))?(parts=callstr.split(_op_rxp),_operators[matches[1]](this.prepare_arg(parts[0]),this.prepare_arg(parts[2]))):this.compile_fun(callstr,host)},Compiler.parse_str=function(callstr){var matches;return!!(matches=callstr.match(_fun_rxp))&&{target:matches[1],method_chain:matches[2],args:matches[3]?matches[3].split(","):[]}},Compiler.compile_fun=function(callstr,target){var arg,data;return(data=this.parse_str(callstr))?(data.target=function(){switch(!1){case"@this"!==data.target:return target;case"@app"!==data.target:return pi.app;case"@host"!==data.target:return target.host;case"@view"!==data.target:return"function"==typeof target.view?target.view():void 0;default:return data.target}}(),data.method_chain?utils.curry(pi.call,[target,data.target,data.method_chain,data.args?function(){var _i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=data.args).length;_i<_len;_i++)arg=_ref[_i],_results.push(this.prepare_arg(arg,target));return _results}.call(this):[]]):utils.curry(pi.call,[target,data.target,void 0,void 0])):(utils.error("cannot compile function: "+callstr),_null)},Compiler.str_to_event_handler=function(callstr,host){var _f;return callstr=callstr.replace(/\be\b/,"e"),_f=this.str_to_fun(callstr,host),function(e){return _f.call({e:e})}},Compiler}(),pi.call=pi.Compiler.call,pi.Compiler.modifiers.push(function(str){return str.replace(_call_rxp,"")})},{"../core":46}],11:[function(require){require("./input_events")},{"./input_events":12}],12:[function(require){"use strict";var pi;(pi=require("../../core")).InputEvent={Change:"changed",Clear:"cleared",Editable:"editable"},pi.FormEvent={Update:"updated",Submit:"submited",Invalid:"invalid"}},{"../../core":46}],13:[function(require){"use strict";var pi,_name_reg,_true,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/base_input"),require("./events/input_events"),pi.utils,_name_reg=/([^\/\\]+$)/,_true=function(){return!0},pi.FileInput=function(_super){function FileInput(){return FileInput.__super__.constructor.apply(this,arguments)}return __extends(FileInput,_super),FileInput.prototype.initialize=function(){return FileInput.__super__.initialize.apply(this,arguments),this._files=[]},FileInput.prototype.postinitialize=function(){var _rxp,_this;return FileInput.__super__.postinitialize.apply(this,arguments),this.multiple(!!this.options.multiple),this.accept(this.options.accept),null!=this.options.rxp?(_rxp=new RegExp(this.options.rxp,"i"),this._filter=function(file){return _rxp.test(file.name)}):this._filter=_true,this.input.attr("tabindex","-1"),
this.input.on("change",(_this=this,function(e){var f,file,_i,_len,_ref;if(e.cancel(),_this._files.length=0,null!=_this.input.node.files){if(!_this.input.node.files.length)return _this.clear();for(_i=0,_len=(_ref=_this.input.node.files).length;_i<_len;_i++)file=_ref[_i],_this._filter(file)&&_this._files.push(file);return _this._files.length?_this.trigger(pi.InputEvent.Change,_this.value()):void 0}_this.input.node.value&&(f={name:_this.input.node.value.split(_name_reg)[1]},!0===_this._filter(f)&&(_this._files.push(f),_this.trigger(pi.InputEvent.Change,_this.value())))}))},FileInput.prototype.multiple=function(value){return this._multiple=value,value?this.input.attr("multiple",""):this.input.attr("multiple",null)},FileInput.prototype.accept=function(value){return this._accept=value,value?this.input.attr("accept",value):this.input.attr("accept",null)},FileInput.prototype.clear=function(){return this._files.length=0,FileInput.__super__.clear.apply(this,arguments)},FileInput.prototype.value=function(){return this._multiple?this._files:this._files[0]},FileInput}(pi.BaseInput),pi.Guesser.rules_for("file_input",["pi-file-input-wrap"],["input[file]"],function(nod){return 1===nod.children("input[type=file]").length})},{"../core":46,"./base/base_input":3,"./events/input_events":12}],14:[function(require){"use strict";var Validator,pi,utils,_array_name,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./events/input_events"),require("./base/validator"),utils=pi.utils,Validator=pi.BaseInput.Validator,_array_name=function(name){return name.indexOf("[]")>-1},pi.Form=function(_super){function Form(){return Form.__super__.constructor.apply(this,arguments)}return __extends(Form,_super),Form.prototype.postinitialize=function(){var _this;if(Form.__super__.postinitialize.apply(this,arguments),this._cache={},this._value={},this._invalids=[],this.former=new pi.Former(this.node,this.options),this.read_values(),this.on(pi.InputEvent.Change,(_this=this,function(e){if(e.cancel(),_this.validate_nod(e.target))return _this.update_value(e.target.name(),e.data)})),this.on("change",function(_this){return function(e){if(utils.is_input(e.target.node))return _this.validate_nod(e.target)?_this.update_value(e.target.node.name,_this.former._parse_nod_value(e.target.node)):void 0}}(this)),this.form="FORM"===this.node.nodeName?this:this.find("form"),null!=this.form)return this.form.on("submit",function(_this){return function(e){return e.cancel(),_this.submit()}}(this))},Form.prototype.submit=function(){if(this.read_values(),!0===this.validate())return this.trigger(pi.FormEvent.Submit,this._value)},Form.prototype.value=function(val){return null!=val?(this._value={},this.former.traverse_nodes(this.node,(_this=this,function(node){return _this.fill_value(node,val)})),this.read_values(),this):this._value;var _this},Form.prototype.clear=function(silent){var _this;if(null==silent&&(silent=!1),this._value={},this.former.traverse_nodes(this.node,(_this=this,function(node){return _this.clear_value(node)})),!1===this.former.options.clear_hidden&&this.read_values(),!silent)return this.trigger(pi.InputEvent.Clear)},Form.prototype.read_values=function(){var _name_values,_this;return _name_values=[],this.former.traverse_nodes(this.node,(_this=this,function(node){var nod;return(nod=node._nod)instanceof pi.BaseInput&&nod.name()?(_array_name(name)||(_this._cache[nod.name()]=nod),_name_values.push({name:nod.name(),value:nod.value()})):utils.is_input(node)&&node.name?(_array_name(node.name)||(_this._cache[node.name]=pi.Nod.create(node)),_name_values.push({name:node.name,value:_this.former._parse_nod_value(node)})):void 0})),this._value=this.former.process_name_values(_name_values)},Form.prototype.find_by_name=function(name){var nod;return null!=this._cache[name]?this._cache[name]:null!=(nod=this.find("[name="+name+"]"))?this._cache[name]=nod:void 0},Form.prototype.fill_value=function(node,val){var nod;if((nod=node._nod)instanceof pi.BaseInput&&nod.name()){if(null==(val=this.former._nod_data_value(nod.name(),val)))return;return nod.value(val)}if(utils.is_input(node))return this.former._fill_nod(node,val)},Form.prototype.validate=function(){var _this;return this.former.traverse_nodes(this.node,(_this=this,function(node){return _this.validate_value(node)})),!this._invalids.length||(this.trigger(pi.FormEvent.Invalid,this._invalids),!1)},Form.prototype.validate_value=function(node){var nod;if((nod=node._nod)instanceof pi.BaseInput)return this.validate_nod(nod)},Form.prototype.validate_nod=function(nod){var flag,type,types,_i,_len,_ref;if(types=nod.data("validates")){for(flag=!0,_i=0,_len=(_ref=types.split(" ")).length;_i<_len;_i++)if(type=_ref[_i],!Validator.validate(type,nod,this)){nod.addClass("is-invalid"),flag=!1;break}return flag?(nod.removeClass("is-invalid"),nod.__invalid__&&(this._invalids.splice(this._invalids.indexOf(nod.name()),1),delete nod.__invalid__),!0):(null==nod.__invalid__&&this._invalids.push(nod.name()),nod.__invalid__=!0,!1)}return!0},Form.prototype.clear_value=function(node){var nod;return(nod=node._nod)instanceof pi.BaseInput?nod.clear():utils.is_input(node)?this.former._clear_nod(node):void 0},Form.prototype.update_value=function(name,val,silent){if(null==silent&&(silent=!1),name&&(name=this.former.transform_name(name),val=this.former.transform_value(val),!0!==_array_name(name)))return utils.set_path(this._value,name,val),silent?void 0:this.trigger(pi.FormEvent.Update,this._value)},Form}(pi.Base),pi.Guesser.rules_for("form",["pi-form"],["form"])},{"../core":46,"./base/validator":8,"./events/input_events":12}],15:[function(require){"use strict";var pi,utils,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty;pi=require("../../core"),utils=pi.utils,pi.Guesser=function(){function Guesser(){}return Guesser.klasses=[],Guesser.klass_reg=null,Guesser.klass_to_component={},Guesser.tag_to_component={},Guesser.specials={},Guesser.compile_klass_reg=function(){return this.klasses.length?this.klass_reg=new RegExp("("+this.klasses.map(function(klass){return"(\\b"+utils.escapeRegexp(klass)+"\\b)"}).join("|")+")","g"):this.klass_reg=null},Guesser.rules_for=function(component_name,klasses,tags,fun){var klass,tag,_base,_i,_j,_len,_len1;if(null==klasses&&(klasses=[]),null==tags&&(tags=[]),klasses.length){for(_i=0,_len=klasses.length;_i<_len;_i++)klass=klasses[_i],this.klass_to_component[klass]=component_name,this.klasses.push(klass);this.compile_klass_reg()}if(tags.length)for(_j=0,_len1=tags.length;_j<_len1;_j++)tag=tags[_j],((_base=this.tag_to_component)[tag]||(_base[tag]=[])).push(component_name);if("function"==typeof fun)return this.specials[component_name]=fun},Guesser.find=function(nod){var el,m,match,matches,tag,tmatches,_i,_j,_len,_len1,_match,_ref,_ref1,_this;if(matches=[],this.klass_reg&&(_match=nod.node.className.match(this.klass_reg))&&1===(matches=utils.uniq(_match)).length)return this.klass_to_component[matches[0]];if(matches=matches.map((_this=this,function(klass){return _this.klass_to_component[klass]})),"input"===(tag=nod.node.nodeName.toLowerCase())&&(tag+="["+nod.node.type+"]"),null!=this.tag_to_component[tag]){if(tmatches=[],matches.length)for(_i=0,_len=(_ref=this.tag_to_component[tag]).length;_i<_len;_i++)el=_ref[_i],__indexOf.call(matches,el)>=0&&tmatches.push(el);else tmatches=this.tag_to_component[tag];if(1===(tmatches=utils.uniq(tmatches)).length)return tmatches[0];matches=tmatches}if(matches.length){for(_j=0,_len1=matches.length;_j<_len1;_j++)if(m=matches[_j],null!=this.specials[m]&&this.specials[m].call(null,nod))return m;return matches[matches.length-1]}for(match in _ref1=this.specials)if(__hasProp.call(_ref1,match)&&_ref1[match].call(null,nod))return match;return"base"},Guesser}()},{"../../core":46}],16:[function(require){"use strict";require("./pieces"),require("./app"),require("./guess/guesser"),require("./events"),require("./base/index"),require("../plugins/index"),require("./renderers"),require("./action_list"),require("./checkbox"),require("./file_input"),require("./progress_bar"),require("./search_input"),require("./select_input"),require("./swf_player"),require("./textarea"),require("./toggle_button"),require("./sorters"),require("./popup_container"),require("./form"),require("./radio_group"),require("./stepper")},{"../plugins/index":64,"./action_list":1,"./app":2,"./base/index":5,"./checkbox":9,"./events":11,"./file_input":13,"./form":14,"./guess/guesser":15,"./pieces":17,"./popup_container":18,"./progress_bar":19,"./radio_group":20,"./renderers":22,"./search_input":25,"./select_input":26,"./sorters":27,"./stepper":28,"./swf_player":29,"./textarea":30,"./toggle_button":31}],17:[function(require){"use strict";var Nod,event_re,pi,utils,_array_rxp,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;pi=require("../core"),require("./compiler"),utils=pi.utils,Nod=pi.Nod,utils.extend(pi.Nod.prototype,{find_cut:function(selector){var acc,el,rest;for(rest=[],acc=[],el=this.node.firstChild;el;)1===el.nodeType?(el.matches(selector)?acc.push(el):el.firstChild&&rest.unshift(el.firstChild),el=el.nextSibling||rest.shift()):el=el.nextSibling||rest.shift();return acc}}),_array_rxp=/\[\]$/,pi.Base=function(_super){function Base(node,host,options){this.node=node,this.host=host,this.options=null!=options?options:{},Base.__super__.constructor.apply(this,arguments),this.preinitialize(),this.initialize(),this.init_plugins(),this.init_children(),this.setup_events(),this.postinitialize()}return __extends(Base,_super),Base.include_plugins=function(){var plugin,plugins,_i,_len,_results;for(_results=[],_i=0,_len=(plugins=1<=arguments.length?__slice.call(arguments,0):[]).length;_i<_len;_i++)plugin=plugins[_i],_results.push(plugin.included(this));return _results},Base.requires=function(){var components;return components=1<=arguments.length?__slice.call(arguments,0):[],this.before_create(function(){var cmp,_results;for(_results=[];components.length;){if(void 0===this[cmp=components.pop()])throw Error("Missing required component "+cmp);_results.push(void 0)}return _results})},Base.prototype.piecify=function(){var c,_i,_len,_ref,_results;for(this.__components__.length=0,this.init_children(),_results=[],_i=0,_len=(_ref=this.__components__).length;_i<_len;_i++)c=_ref[_i],_results.push(c.piecify());return _results},Base.prototype.trigger=function(event,data,bubbles){if(this.enabled||"enabled"===event)return Base.__super__.trigger.call(this,event,data,bubbles)},Base.prototype.bubble_event=function(event){if(null!=this.host)return this.host.trigger(event)},Base.prototype.show=function(){return this.visible||(this.removeClass("is-hidden"),this.visible=!0,this.trigger("hidden",!1)),this},Base.prototype.hide=function(){return this.visible&&(this.addClass("is-hidden"),this.visible=!1,this.trigger("hidden",!0)),this},Base.prototype.enable=function(){return this.enabled||(this.removeClass("is-disabled"),this.enabled=!0,this.trigger("enabled",!0)),this},Base.prototype.disable=function(){return this.enabled&&(this.addClass("is-disabled"),this.enabled=!1,this.trigger("enabled",!1)),this},Base.prototype.activate=function(){return this.active||(this.addClass("is-active"),this.active=!0,this.trigger("active",!0)),this},Base.prototype.deactivate=function(){return this.active&&(this.removeClass("is-active"),this.active=!1,this.trigger("active",!1)),this},Base.prototype.preinitialize=function(){return this.node._nod=this,this.__components__=[],this.__plugins__=[],this.pid=this.data("pid")||this.attr("pid")||this.node.id,this.visible=this.enabled=!0,this.active=!1},Base.prototype.initialize=function(){return(this.options.disabled||this.hasClass("is-disabled"))&&this.disable(),(this.options.hidden||this.hasClass("is-hidden"))&&this.hide(),(this.options.active||this.hasClass("is-active"))&&this.activate(),this._initialized=!0,this.trigger("initialized",!0,!1)},Base.register_callback("initialize"),Base.prototype.init_plugins=function(){var name,_i,_len,_ref;if(null!=this.options.plugins){for(_i=0,_len=(_ref=this.options.plugins).length;_i<_len;_i++)name=_ref[_i],this.attach_plugin(this.find_plugin(name));delete this.options.plugins}},Base.prototype.attach_plugin=function(plugin){if(null!=plugin)return utils.debug("plugin attached "+plugin.prototype.id),this.__plugins__.push(plugin.attached(this))},Base.prototype.find_plugin=function(name){var klass,_ref;for(name=utils.camelCase(name),klass=this.constructor;null!=klass;){if(null!=klass[name])return klass[name];klass=null!=(_ref=klass.__super__)?_ref.constructor:void 0}return utils.warning("plugin not found: "+name),null},Base.prototype.init_children=function(){var _fn,_i,_len,_ref,_this;for(_ref=this.find_cut(".pi"),_this=this,_fn=function(node){var arr,child,_name;if(null!=(child=pi.init_component(node,_this))?child.pid:void 0)return _array_rxp.test(child.pid)?(arr=_this[_name=child.pid.slice(0,-2)]||(_this[_name]=[])).indexOf(child)>-1||arr.push(child):_this[child.pid]=child,_this.__components__.push(child)},_i=0,_len=_ref.length;_i<_len;_i++)_fn(_ref[_i])},Base.prototype.setup_events=function(){var event,handler,_i,_len,_ref,_ref1;for(event in _ref=this.options.events)for(_i=0,_len=(_ref1=_ref[event].split(/;\s*/)).length;_i<_len;_i++)handler=_ref1[_i],this.on(event,pi.Compiler.str_to_event_handler(handler,this));delete this.options.events},Base.prototype.postinitialize=function(){return this.trigger("creation_complete",!0,!1)},Base.register_callback("postinitialize",{as:"create"}),Base.prototype.dispose=function(){var _i,_len,_ref;if(!this._disposed){for(null!=this.host&&this.host.remove_component(this),_i=0,_len=(_ref=this.__plugins__).length;_i<_len;_i++)_ref[_i].dispose();this.__plugins__.length=0,Base.__super__.dispose.apply(this,arguments),this.trigger("destroyed",!0,!1)}},Base.prototype.remove_component=function(child){if(child.pid)return _array_rxp.test(child.pid)?this[""+child.pid.slice(0,-2)]&&delete this[""+child.pid.slice(0,-2)]:delete this[child.pid],this.__components__.splice(this.__components__.indexOf(child),1)},Base.prototype.remove_children=function(){var child,list,_i,_len;for(_i=0,_len=(list=this.__components__.slice()).length;_i<_len;_i++)child=list[_i],this.remove_component(child),child.remove();return Base.__super__.remove_children.apply(this,arguments)},Base}(pi.Nod),event_re=/^on_(.+)/i,pi._guess_component=function(nod){var component,component_name;return component_name=nod.data("component")||pi.Guesser.find(nod),null==(component=utils.get_class_path(pi,component_name))?utils.error("unknown or initialized component "+component_name):(utils.debug("component created: "+component_name),component)},pi._gather_options=function(el){var key,matches,opts,val;for(key in(opts=utils.clone(el.data())).plugins=null!=opts.plugins?opts.plugins.split(/\s+/):null,opts.events={},opts)val=opts[key],(matches=key.match(event_re))&&(opts.events[matches[1]]=val);return opts},pi.init_component=function(nod,host){var component;if(nod=nod instanceof Nod?nod:Nod.create(nod),null!=(component=pi._guess_component(nod)))return nod instanceof component?nod:new component(nod.node,host,pi._gather_options(nod))},pi.piecify=function(nod,host){return pi.init_component(nod,host||nod.parent(".pi"))},pi.event=new pi.EventDispatcher,pi.find=function(pid_path){return utils.get_path(pi.app.view,pid_path)},utils.extend(Nod.prototype,{piecify:function(host){return pi.piecify(this,host)},pi_call:function(target,action){return this._pi_call&&this._pi_action===action||(this._pi_action=action,this._pi_call=pi.Compiler.str_to_fun(action,target)),this._pi_call.call(null)}}),Nod.root.ready(function(){return Nod.root.listen("a","click",function(e){var _ref;"@"===(null!=(_ref=e.target.attr("href"))?_ref[0]:void 0)&&(e.cancel(),utils.debug("handle pi click: "+e.target.attr("href")),e.target.pi_call(e.target,e.target.attr("href")))})}),pi.$=function(q){return"@"===q[0]?pi.find(q.slice(1)):utils.is_html(q)?Nod.create(q):Nod.root.find(q)},pi["export"](pi.$,"$")},{"../core":46,"./compiler":10}],18:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./pieces"),utils=pi.utils,pi.PopupContainer=function(_super){function PopupContainer(){return PopupContainer.__super__.constructor.apply(this,arguments)}return __extends(PopupContainer,_super),PopupContainer.prototype.postinitialize=function(){return PopupContainer.__super__.postinitialize.apply(this,arguments),this._popup_id="p_"+utils.uid(),this.__overlays__=[],this.__containers__=[],this.__popups__=[],this._base_layer=this.options.base_layer?this.options.base_layer.split(/\,\s*/).map(function(selector){return pi.Nod.root.find(selector)}).filter(function(nod){return!!nod}):[pi.app.view],this.z=this.options.z||300,this.show_delay=null!=this.options.show_delay?this.options.show_delay:200,this.hide_delay=null!=this.options.hide_delay?this.options.hide_delay:500,this.listen(".pi-overlay","click",(_this=this,function(){return _this.handle_close()}));var _this},PopupContainer.prototype.add_overlay=function(){return this.overlay=pi.Nod.create("div").piecify(),this.overlay.addClass("pi-overlay"),this.overlay.hide(),this.overlay.style("z-index",++this.z),this.__overlays__.push(this.overlay),this.append(this.overlay),this.overlay},PopupContainer.prototype.add_container=function(){return this.cont=pi.Nod.create("div").piecify(),this.cont.addClass("pi-popup-container"),this.overlay.style("z-index",++this.z),this.__containers__.push(this.cont),this.append(this.cont),this.cont},PopupContainer.prototype.open=function(target,options){var _target_parent,_this;return this.target=target,null==options&&(options={}),this._freeze_layer(),null!=this.overlay&&this.overlay.disable(),null!=this.cont&&this.cont.disable(),this.add_overlay(),this.add_container(),_target_parent=this.target.parent(),this.target.__parent__=_target_parent,this.target.__popup_options__=options,this.target.style("z-index",++this.z),this.target.addClass("is-popup"),this.target.hide(),this.cont.append(this.target),this.setup_target(this.target),this._with_raf("popup_show",(_this=this,function(){return _this.show()})),utils.after(this.show_delay,function(_this){return function(){if(_this.overlay.show(),_this.target.show(),!_this.opened)return _this.opened=!0,_this.trigger("opened",!0)}}(this)),this.__popups__.push(this.target)},PopupContainer.prototype.setup_target=function(target){return!1===target.__popup_options__.close?this.addClass("no-close"):this.removeClass("no-close")},PopupContainer.prototype.handle_close=function(){var options,_ref;(options=null!=(_ref=this.target)?_ref.__popup_options__:void 0)&&!1!==options.close&&("function"==typeof options.close&&!1===options.close.call(null)||this.close())},PopupContainer.prototype.close=function(){return!this._closing&&(this._closing=!0,this.target.hide(),this.overlay.hide(),pi.Nod.win.scrollY(0),1===this.__overlays__.length&&(this.opened=!1,this.trigger("opened",!1)),new Promise((_this=this,function(resolve){return utils.after(_this.hide_delay,function(){return _this.target.removeClass("is-popup"),null!=_this.target.__parent__?(_this.target.__parent__.append(_this.target),delete _this.target.__parent__,delete _this.target.__popup_options__):_this.target.remove(),_this.__popups__.pop(),_this.__containers__.pop().remove(),_this.__overlays__.pop().remove(),_this.z-=3,_this.__overlays__.length?(_this.cont=_this.__containers__[_this.__containers__.length-1].enable(),_this.overlay=_this.__overlays__[_this.__overlays__.length-1].enable(),_this.target=_this.__popups__[_this.__popups__.length-1],_this.setup_target(_this.target)):_this.hide(),_this._unfreeze_layer(),_this._closing=!1,resolve()})})));var _this},PopupContainer.prototype.has_content=function(){return this.__overlays__.length>0},PopupContainer.prototype._freeze_layer=function(){var el,_elements,_i,_len,_results,_st;for(_st=pi.Nod.win.scrollTop(),_results=[],_i=0,_len=(_elements=this.has_content()?[this.overlay,this.cont]:this._base_layer).length;_i<_len;_i++)(el=_elements[_i]).__freezed__?_results.push(void 0):(el.__freezed__=!0,el.__freezer__=this._popup_id,el.__freeze_st__=_st,_results.push(el.style({overflow:"hidden",top:el.y()-_st+"px"})));return _results},PopupContainer.prototype._unfreeze_layer=function(){var _elements,_fn,_i,_len,_st,_this;for(_st=null,_elements=this.has_content()?[this.overlay,this.cont]:this._base_layer,_this=this,_fn=function(el){if(el.__freezed__&&el.__freezer__===_this._popup_id)return delete el.__freezed__,_st=el.__freeze_st__,el._with_raf("reset_popup_styles",function(){return el.style({overflow:null,top:null})})},_i=0,_len=_elements.length;_i<_len;_i++)_fn(_elements[_i]);if(null!=_st)return pi.Nod.win.scrollY(_st)},PopupContainer}(pi.Base),pi.Guesser.rules_for("popup_container",["pi-popup"])},{"../core":46,"./pieces":17}],19:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./pieces"),utils=pi.utils,pi.ProgressBar=function(_super){function ProgressBar(){return ProgressBar.__super__.constructor.apply(this,arguments)}return __extends(ProgressBar,_super),ProgressBar.prototype.start=function(){return this.value=0,this.show()},ProgressBar.prototype.set=function(value){return this.value=value,this.style({width:value+"%"})},ProgressBar.prototype.simulate=function(speed){return null==speed&&(speed=200),this._sid=utils.after(speed,(_this=this,function(){return _this.set(_this.value+(100-_this.value)/2),_this.simulate(speed)}));var _this},ProgressBar.prototype.reset=function(){return this._sid&&clearTimeout(this._sid),this.style({width:0}),this.hide()},ProgressBar.prototype.stop=function(){return this._sid&&clearTimeout(this._sid),this.style({width:"101%"}),this._sid=utils.after(200,(_this=this,function(){return _this.style({width:0}),_this.hide()}));var _this},ProgressBar.prototype.dispose=function(){return this._sid&&clearTimeout(this._sid),ProgressBar.__super__.dispose.apply(this,arguments)},ProgressBar}(pi.Base),pi.Guesser.rules_for("progress_bar",["pi-progressbar"])},{"../core":46,"./pieces":17}],20:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/base_input"),require("./events/input_events"),require("./base/list"),utils=pi.utils,pi.RadioGroup=function(_super){function RadioGroup(){return RadioGroup.__super__.constructor.apply(this,arguments)}return __extends(RadioGroup,_super),RadioGroup.include(pi.List),RadioGroup.include_plugins(pi.List.Selectable),RadioGroup.prototype.postinitialize=function(){return pi.List.prototype.postinitialize.call(this),this.selectable.type("radio"),this.clear_selection(!0),this.input=this.find("input"),this.value(this.input.value()),this.on("selected",(_this=this,function(e){return e.cancel(),_this.input.value(e.data[0].record.value),_this.trigger(pi.InputEvent.Change,_this.value())}));var _this},RadioGroup.prototype.value=function(val){var ref;return null==val?this.input.value():(val=utils.serialize(val),(ref=this.where({record:{value:val}})).length?(this.input.value(val),this.select_item(ref[0])):void 0)},RadioGroup.prototype.clear=function(silent){if(null==silent&&(silent=!1),this.clear_selection(!0),this.input.value(""),!silent)return this.trigger(pi.InputEvent.Clear)},RadioGroup}(pi.BaseInput),pi.Guesser.rules_for("radio_group",["pi-radio-group"])},{"../core":46,"./base/base_input":3,"./base/list":6,"./events/input_events":12}],21:[function(require){"use strict";var pi;(pi=require("../../core")).utils,pi.Renderers={},pi.Renderers.Base=function(){function Base(){}return Base.prototype.render=function(nod,piecified,host){if(nod instanceof pi.Nod)return this._render(nod,nod.data(),piecified,host)},Base.prototype._render=function(nod,data,piecified,host){return null==piecified&&(piecified=!0),nod instanceof pi.Base||piecified&&(nod=nod.piecify(host)),nod.record=data,nod},Base}()},{"../../core":46}],22:[function(require){"use strict";require("./base"),require("./jst"),require("./mustache")},{"./base":21,"./jst":23,"./mustache":24}],23:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("./base"),pi.utils,pi.Renderers.Jst=function(_super){function Jst(template){this.templater=JST[template]}return __extends(Jst,_super),Jst.prototype.render=function(data,piecified,host){var nod;return data instanceof pi.Nod?Jst.__super__.render.apply(this,arguments):(nod=pi.Nod.create(this.templater(data)),this._render(nod,data,piecified,host))},Jst}(pi.Renderers.Base)},{"../../core":46,"./base":21}],24:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("./base"),utils=pi.utils,pi.Renderers.Mustache=function(_super){function Mustache(template){var tpl_nod;if(null==window.Mustache)throw Error("Mustache not found");if(null==(tpl_nod=$("#"+template)))throw Error("Template #"+template+" not found!");this.template=utils.trim(tpl_nod.html()),window.Mustache.parse(this.template)}return __extends(Mustache,_super),Mustache.prototype.render=function(data,piecified,host){var nod;return data instanceof pi.Nod?Mustache.__super__.render.apply(this,arguments):(nod=pi.Nod.create(window.Mustache.render(this.template,data)),this._render(nod,data,piecified,host))},Mustache}(pi.Renderers.Base)},{"../../core":46,"./base":21}],25:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/textinput"),utils=pi.utils,pi.SearchInput=function(_super){function SearchInput(){return SearchInput.__super__.constructor.apply(this,arguments)}return __extends(SearchInput,_super),SearchInput.prototype.postinitialize=function(){return SearchInput.__super__.postinitialize.apply(this,arguments),this.input.on("keyup",utils.debounce(this.options.debounce||300,this._query,this))},SearchInput.prototype._query=function(){var val;if(this.active||this.activate(),val=this.value(),utils.debug("query: "+val),this.trigger("query",val),!val)return this.deactivate()},SearchInput.prototype.reset=function(){return this.value(""),this.deactivate(),this.trigger("query","")},SearchInput}(pi.TextInput),pi.Guesser.rules_for("search_input",["pi-search-field"])},{"../core":46,"./base/textinput":7}],26:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/base_input"),require("./events/input_events"),utils=pi.utils,pi.SelectInput=function(_super){function SelectInput(){return SelectInput.__super__.constructor.apply(this,arguments)}return __extends(SelectInput,_super),SelectInput.requires("dropdown","placeholder"),SelectInput.prototype.postinitialize=function(){var _this;return SelectInput.__super__.postinitialize.apply(this,arguments),this.attr("tabindex","0"),this.dropdown.has_selectable||this.dropdown.attach_plugin(pi.List.Selectable),this.dropdown.selectable.type("radio"),this.dropdown.on("selected",(_this=this,function(e){return _this.value(e.data[0].record.value),_this.placeholder.text(e.data[0].text()),_this.trigger(pi.InputEvent.Change,e.data[0].record.value),_this.blur()})),this.on("focus",function(_this){return function(){return _this.dropdown.show()}}(this)),this.on("blur",function(_this){return function(){return _this._hide_tid=after(100,function(){return _this.dropdown.hide()})}}(this)),this.input.value()?this.value(utils.serialize(this.input.value())):""===this.placeholder.text()?this.placeholder.text(this.placeholder.options.placeholder):void 0},SelectInput.prototype.value=function(val){var item,ref;return null!=val?(SelectInput.__super__.value.apply(this,arguments),this.dropdown.clear_selection(!0),(ref=this.dropdown.where({record:{value:val}})).length&&(item=ref[0],this.dropdown.select_item(item),this.placeholder.text(item.text())),val):SelectInput.__super__.value.apply(this,arguments)},SelectInput.prototype.dispose=function(){return null!=this._hide_tid&&clearTimeout(this._hide_tid),SelectInput.__super__.dispose.apply(this,arguments)},SelectInput.prototype.clear=function(){if(this.placeholder.text(""),SelectInput.__super__.clear.apply(this,arguments),""===this.placeholder.text())return this.placeholder.text(this.placeholder.options.placeholder)},SelectInput}(pi.BaseInput),pi.Guesser.rules_for("select_input",["pi-select-field"],null)},{"../core":46,"./base/base_input":3,"./events/input_events":12}],27:[function(require){"use strict";var pi,_sort_param,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./pieces"),pi.utils,_sort_param=function(name,order){var ref;return(ref={})[name]=order,ref},pi.Sorters=function(_super){function Sorters(){return Sorters.__super__.constructor.apply(this,arguments)}return __extends(Sorters,_super),Sorters.requires("sorters"),Sorters.prototype.postinitialize=function(){var sorter,_i,_len,_ref,_this;for(Sorters.__super__.postinitialize.apply(this,arguments),this.sorters_by_name={},this._value=[],_i=0,_len=(_ref=this.sorters).length;_i<_len;_i++)sorter=_ref[_i],this.sorters_by_name[sorter.options.name]=sorter,sorter.hasClass("is-desc")?this.update_sorter(sorter,"desc"):sorter.hasClass("is-asc")&&this.update_sorter(sorter,"asc");return this.on("click",this.sorter_click(),this,(_this=this,function(e){return e.target.host===_this}))},Sorters.prototype.sorter_click=function(){return this._sorter_click||(this._sorter_click=(_this=this,function(e){var _old;return _old=e.target.__state__,_this.options.multiple||_this.clear(),_this.toggle_state(e.target,_old),_this.trigger("update",_this.value())}));var _this},Sorters.prototype.toggle_state=function(sorter,prev_state){switch(!1){case"asc"!==prev_state:this.update_sorter(sorter,"desc");break;case!("desc"===prev_state&&this.options.multiple):this.remove_sorter(sorter);break;default:this.update_sorter(sorter,"asc")}},Sorters.prototype.update_sorter=function(sorter,new_state){var key,val;if(sorter.__state__=new_state,sorter.removeClass("is-desc","is-asc"),sorter.addClass("is-"+new_state),val=this._find_param(sorter.options.name))for(key in val)__hasProp.call(val,key)&&(val[key],val[key]=sorter.__state__);else this._value.push(_sort_param(sorter.options.name,sorter.__state__))},Sorters.prototype.remove_sorter=function(sorter){var val
;(val=this._find_param(sorter.options.name))&&(this._value.splice(this._value.indexOf(val),1),sorter.__state__="",sorter.removeClass("is-desc","is-asc"))},Sorters.prototype._find_param=function(name){var key,val,_i,_len,_ref;for(_i=0,_len=(_ref=this._value).length;_i<_len;_i++)for(key in val=_ref[_i])if(__hasProp.call(val,key)&&(val[key],key===name))return val},Sorters.prototype.value=function(){return this._value},Sorters.prototype.set=function(sort_params){var name,param,val,_i,_len;for(this.clear(),_i=0,_len=sort_params.length;_i<_len;_i++)for(name in param=sort_params[_i])__hasProp.call(param,name)&&(val=param[name],this.update_sorter(this.sorters_by_name[name],val))},Sorters.prototype.clear=function(){var sorter,_i,_len,_ref;for(this._value.length=0,_i=0,_len=(_ref=this.sorters).length;_i<_len;_i++)(sorter=_ref[_i]).__state__="",sorter.removeClass("is-desc","is-asc");return this},Sorters}(pi.Base),pi.Guesser.rules_for("sorters",["pi-sorters"],null)},{"../core":46,"./pieces":17}],28:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/textinput"),require("./events/input_events"),pi.utils,pi.Stepper=function(_super){function Stepper(){return Stepper.__super__.constructor.apply(this,arguments)}return __extends(Stepper,_super),Stepper.prototype.postinitialize=function(){return Stepper.__super__.postinitialize.apply(this,arguments),this._prefix=null!=this.options.prefix?this.options.prefix:"",this._suffix=null!=this.options.suffix?this.options.suffix:"",this._step=parseFloat(this.options.step||1),null!=this.options.min&&(this._min=parseFloat(this.options.min)),null!=this.options.max&&(this._max=parseFloat(this.options.max)),this.value(this.input.value()),this.listen(".step","click",(_this=this,function(e){return e.target.hasClass("step-up")?_this.incr():_this.decr(),_this.trigger(pi.InputEvent.Change,_this.value()),e.cancel()}));var _this},Stepper.prototype.value=function(val){return null!=val?(null!=this._max&&(0|val)>this._max?val=this._max:null!=this._min&&(0|val)<this._min&&(val=this._min),Stepper.__super__.value.call(this,this._prepare_value(val))):this._read_value()},Stepper.prototype.incr=function(){return this.value((0|this._read_value())+this._step)},Stepper.prototype.decr=function(){return this.value((0|this._read_value())-this._step)},Stepper.prototype._prepare_value=function(val){return null===val?null:""+this._prefix+val+this._suffix},Stepper.prototype._read_value=function(){return this.input.node.value.replace(this._prefix,"").replace(this._suffix,"")},Stepper}(pi.TextInput),pi.Guesser.rules_for("stepper",["pi-stepper"])},{"../core":46,"./base/textinput":7,"./events/input_events":12}],29:[function(require){"use strict";var pi,utils,_swf_count,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;pi=require("../core"),require("./pieces"),utils=pi.utils,_swf_count=0,pi.SwfPlayer=function(_super){function SwfPlayer(){return SwfPlayer.__super__.constructor.apply(this,arguments)}return __extends(SwfPlayer,_super),SwfPlayer.prototype.initialize=function(){var cont,_base;return cont=document.createElement("div"),this.player_id="swf_player_"+ ++_swf_count,cont.id=this.player_id,this.append(cont),(_base=this.options).version||(_base.version="11.0.0"),null!=this.options.url&&this.enabled&&this.load(this.options.url),SwfPlayer.__super__.initialize.apply(this,arguments)},SwfPlayer.prototype.load=function(url,params){var key,val,_ref;for(key in null==params&&(params={}),url||(url=this.options.url),_ref=this.options)val=_ref[key],params[key]||(params[key]=val);return swfobject.embedSWF(url,this.player_id,"100%","100%",this.options.version,"",params,{allowScriptAccess:!0,wmode:"transparent"})},SwfPlayer.prototype.clear=function(){return this.empty()},SwfPlayer.prototype.as3_call=function(){var args,method,obj,_ref;if(method=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],obj=swfobject.getObjectById(this.player_id))return null!=(_ref=obj[method])?_ref.apply(obj,args):void 0},SwfPlayer.prototype.as3_event=function(e){return utils.debug(e),this.trigger("as3_event",e)},SwfPlayer}(pi.Base)},{"../core":46,"./pieces":17}],30:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/textinput"),pi.utils,pi.TextArea=function(_super){function TextArea(){return TextArea.__super__.constructor.apply(this,arguments)}return __extends(TextArea,_super),TextArea.prototype.postinitialize=function(){return this.input="TEXTAREA"===this.node.nodeName?this:this.find("textarea"),TextArea.__super__.postinitialize.apply(this,arguments)},TextArea}(pi.TextInput),pi.Guesser.rules_for("text_area",["pi-textarea"],["textarea"])},{"../core":46,"./base/textinput":7}],31:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base/button"),require("../plugins/base/selectable"),pi.utils,pi.ToggleButton=function(_super){function ToggleButton(){return ToggleButton.__super__.constructor.apply(this,arguments)}return __extends(ToggleButton,_super),ToggleButton.include_plugins(pi.Base.Selectable),ToggleButton}(pi.Button),pi.Guesser.rules_for("toggle_button",["pi-toggle-button"])},{"../core":46,"../plugins/base/selectable":63,"./base/button":4}],32:[function(require){"use strict";var History,pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),utils=pi.utils,History=require("../core/utils/history"),pi.controllers={},pi.controllers.Base=function(_super){function Base(view,host_context){this.view=view,this.host_context=host_context,this._initialized=!1,this._contexts={},this.context_id=null,this._history=new History}return __extends(Base,_super),Base.has_resource=function(resource){if(null!=resource.resources_name)return this.prototype[resource.resources_name]=resource},Base.prototype.id="base",Base.prototype.add_context=function(controller,main){if(this._contexts[controller.id]=controller,controller.host_context=this,main)return this._main_context_id=controller.id},Base.prototype.initialize=function(){return this._initialized=!0,this._main_context_id?this.switch_context(null,this._main_context_id):utils.resolved_promise()},Base.prototype.switch_context=function(from,to,data,exit,switch_hard){var new_context,_this;return null==data&&(data={}),null==exit&&(exit=!1),null==switch_hard&&(switch_hard=!1),switch_hard||(switch_hard=this.always_switch_hard),from&&from!==this.context_id?(utils.warning("trying to switch from non-active context"),utils.rejected_promise()):to&&this.context_id!==to?this._contexts[to]?(utils.info("context switch: "+from+" -> "+to),new_context=this._contexts[to],(null!=this.context&&(exit||switch_hard)&&"function"==typeof this.context.preunload?this.context.preunload():utils.resolved_promise()).then(function(){return exit&&!switch_hard||null==new_context.preload||"function"!=typeof new_context.preload?utils.resolved_promise():new_context.preload()}).then((_this=this,function(){return null!=_this.context&&(exit||switch_hard?_this.context.unload():_this.context.switched()),data=_this.wrap_context_data(_this.context,data),null==from||exit||_this._history.push(from),_this.context=_this._contexts[to],_this.context_id=to,exit&&!switch_hard?_this.context.reload(data):_this.context.load(data)}))):(utils.warning("undefined context: "+to),utils.rejected_promise()):utils.rejected_promise()},Base.prototype.switch_to=function(to,data){return this.switch_context(this.context_id,to,data)},Base.prototype.switch_back=function(data){return null!=this.context?this.switch_context(this.context_id,this._history.pop(),data,!0):utils.resolved_promise()},Base.prototype.wrap_context_data=function(context,data){var res;return res={},null!=context&&(res.context=context.id),null!=(null!=context?context.data_wrap:void 0)?(res.data={},res.data[context.data_wrap]=data):res.data=data,res},Base.prototype.load=function(context_data){this._initialized||this.initialize(),this.view.loaded(context_data.data)},Base.prototype.reload=function(context_data){this.view.reloaded(context_data.data)},Base.prototype.switched=function(){this.view.switched()},Base.prototype.unload=function(){this.view.unloaded()},Base.prototype.exit=function(data){return this.host_context.switch_back(data)},Base.prototype["switch"]=function(to,data){return this.host_context.switch_context(this.id,to,data)},Base.prototype.dispose=function(){var _ref;return this.host_context=void 0,this.context=void 0,this.context_id=void 0,null!=(_ref=this.view)&&_ref.dispose(),this._contexts={},this._history.clear()},Base}(pi.Core)},{"../core":46,"../core/utils/history":51}],33:[function(require){"use strict";require("./base"),require("./page"),require("./modules"),require("./list.controller")},{"./base":32,"./list.controller":34,"./modules":35,"./page":38}],34:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base"),require("./page"),require("./modules/scoped"),utils=pi.utils,pi.app.page,pi.controllers.ListController=function(_super){function ListController(){return ListController.__super__.constructor.apply(this,arguments)}return __extends(ListController,_super),ListController.include(pi.controllers.Scoped),ListController.list_resource=function(resource){return this.prototype.resources=resource,this.prototype._parse_response=function(data){return data[resource.resources_name]},this.has_resource(resource)},ListController.prototype.id="list_base",ListController.prototype.default_scope={},ListController.prototype.initialize=function(){return this.scope().set(this.default_scope),this._promise=utils.resolved_promise(),ListController.__super__.initialize.apply(this,arguments)},ListController.prototype.query=function(params,scope_params){return null==params&&(params={}),null==scope_params&&(scope_params={}),null==this._promise&&(this._promise=utils.resolved_promise()),this._promise=this._promise.then((_this=this,function(){return _this.scope().set(scope_params),_this.scope().is_full?utils.resolved_promise():(params=utils.merge(_this.scope().params,params),_this._resource_query(params))}));var _this},ListController.prototype._resource_query=function(params){return this.view.loading(!0),this.resources.query(params).then((_this=this,function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),response}),function(_this){return function(error){throw _this.view.loading(!1),_this.view.error(error.message),error}}(this));var _this},ListController.prototype.index=function(params){return this.query({},params).then((_this=this,function(data){return _this.view.load(_this._parse_response(data)),data}));var _this},ListController.prototype.search=function(q){return this.query({},{q:q}).then((_this=this,function(data){return null!=data?(_this.view.reload(_this._parse_response(data)),_this.view.searched(q)):_this.view.search(q),data}));var _this},ListController.prototype.sort=function(params){var sort_params,_this;return null==params&&(params=null),sort_params={sort:params},this.query({},sort_params).then((_this=this,function(data){return null!=data?(_this.view.clear_sort(),_this.view.reload(_this._parse_response(data)),_this.view.sorted(params)):_this.view.sort(params),data}))},ListController.prototype.filter=function(params){var filter_params,_this;return null==params&&(params=null),filter_params={filter:params},this.query({},filter_params).then((_this=this,function(data){return null!=data?(_this.view.reload(_this._parse_response(data)),_this.view.filtered(params)):_this.view.filter(params),data}))},ListController}(pi.controllers.Base)},{"../core":46,"./base":32,"./modules/scoped":37,"./page":38}],35:[function(require){"use strict";require("./scoped"),require("./paginated")},{"./paginated":36,"./scoped":37}],36:[function(require){"use strict";var pi,utils;pi=require("../../core"),require("../base"),utils=pi.utils,pi.controllers.Paginated=function(){function Paginated(){}return Paginated.included=function(base){base.prototype.query=function(_params,scope_params,next_page){return null==_params&&(_params={}),null==scope_params&&(scope_params={}),null==next_page&&(next_page=!1),null==_params.page&&(_params.page=this._page=1),_params.per_page=this.per_page,null==this._promise&&(this._promise=utils.resolved_promise()),this._promise=this._promise.then((_this=this,function(){var params;return _this.scope().set(scope_params),_this.scope().is_full?utils.resolved_promise():(params=utils.merge(_this.scope().params,_params),_this._resource_query(params).then(function(data){return _this.page_resolver(data),data}))}));var _this},base.prototype.scope_blacklist.push("page","per_page")},Paginated.prototype.page_resolver=function(data){var list;if(null!=(list=this._parse_response(data))&&list.length<this.per_page)return this.scope().all_loaded()},Paginated.prototype.per_page=40,Paginated.prototype.next_page=function(){var _this;if(!this.scope().is_full)return this._page=(this._page||0)+1,this.query({page:this._page},{},!0).then((_this=this,function(data){return null!=data&&_this.view.load(_this._parse_response(data)),data}))},Paginated}()},{"../../core":46,"../base":32}],37:[function(require){"use strict";var Scope,pi,utils,__hasProp={}.hasOwnProperty;pi=require("../../core"),require("../base"),utils=pi.utils,Scope=function(){function Scope(whitelist,blacklist,rules){this.whitelist=null!=whitelist?whitelist:[],this.blacklist=null!=blacklist?blacklist:[],this.rules=null!=rules?rules:{},this.is_full=!1,this._scope={},this.params={}}return Scope.prototype._filter_key=function(key){return this.whitelist.length?this.whitelist.indexOf(key)>-1:!this.blacklist.length||this.blacklist.indexOf(key)<0},Scope.prototype._merge=function(key,val){if(null===val&&null!=this._scope[key])return delete this._scope[key],void(this.is_full=!1);this.is_full?this._scope[key]=this._resolve(key,this._scope[key],val):this._scope[key]=val},Scope.prototype._resolve=function(key,old_val,val){var _base,_val;return null==this.rules[key]?(this.is_full=!1,val):!1===(_val="function"==typeof(_base=this.rules)[key]?_base[key](old_val,val):void 0)?(this.is_full=!1,val):_val},Scope.prototype.set=function(params){var key,val,_ref,_results;for(key in null==params&&(params={}),params)__hasProp.call(params,key)&&(val=params[key],this._filter_key(key)&&(this.params[key]=val));for(key in _results=[],_ref=this.params)val=_ref[key],_results.push(function(_this){return function(){if(_this._scope[key]!==val)return _this._merge(key,val)}}(this)());return _results},Scope.prototype.clear=function(){return this.params={},this._scope={}},Scope.prototype.to_s=function(){var key,val,_ref,_ref1;for(key in _ref=[],_ref1=this._scope)val=_ref1[key],_ref.push(key+"="+val);return _ref.join("&")},Scope.prototype.all_loaded=function(){return utils.debug("Scope is full: "+this.to_s()),this.is_full=!0},Scope.prototype.reload=function(){return utils.debug("Scope should be reloaded: "+this.to_s()),this.is_full=!1},Scope}(),pi.controllers.Scoped=function(){function Scoped(){}return Scoped.rules={},Scoped.whitelist=[],Scoped.blacklist=[],Scoped.included=function(klass){return klass.prototype.scope_whitelist=[],klass.prototype.scope_blacklist=[],klass.prototype.scope_rules={},!0},Scoped.prototype.scope=function(){return this._scope||(this._scope=new Scope(utils.uniq(pi.controllers.Scoped.whitelist.concat(this.scope_whitelist)),utils.uniq(pi.controllers.Scoped.whitelist.concat(this.scope_blacklist)),utils.merge(pi.controllers.Scoped.rules,this.scope_rules)))},Scoped}()},{"../../core":46,"../base":32}],38:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base"),pi.utils,pi.controllers.Page=function(_super){function Page(){return Page.__super__.constructor.apply(this,arguments)}return __extends(Page,_super),Page}(pi.controllers.Base),pi.app.page=new pi.controllers.Page,pi.Compiler.modifiers.push(function(str){return"@@"===str.slice(0,2)&&(str="@app.page.context."+str.slice(2)),str})},{"../core":46,"./base":32}],39:[function(require){"use strict";var pi,utils,__slice=[].slice;pi=require("./pi"),require("./utils"),utils=pi.utils,pi.Core=function(){function Core(){var _fn,_i,_len,_ref,_this;for(_ref=this.constructor.callbacked||[],_this=this,_fn=function(method){return _this[method]=_this["__"+method]},_i=0,_len=_ref.length;_i<_len;_i++)_fn(_ref[_i])}return Core.include=function(){var mixin,mixins,_i,_len,_results;for(_results=[],_i=0,_len=(mixins=1<=arguments.length?__slice.call(arguments,0):[]).length;_i<_len;_i++)mixin=mixins[_i],utils.extend(this.prototype,mixin.prototype,!0,["constructor"]),_results.push(mixin.included(this));return _results},Core.extend=function(){var mixin,mixins,_i,_len,_results;for(_results=[],_i=0,_len=(mixins=1<=arguments.length?__slice.call(arguments,0):[]).length;_i<_len;_i++)mixin=mixins[_i],utils.extend(this,mixin,!0),_results.push(mixin.extended(this));return _results},Core.alias=function(from,to){this.prototype[from]=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],this[to].apply(this,args)}},Core.class_alias=function(from,to){this[from]=this[to]},Core.included=function(){return!0},Core.extended=function(){return!0},Core.register_callback=function(method,options){var callback_name,_fn,_i,_len,_ref,_this;for(null==options&&(options={}),callback_name=options.as||method,_this=this,_fn=function(_when){return _this[_when+"_"+callback_name]=function(callback){var _base,_name;return this.prototype["_"+_when+"_"+callback_name]&&!this.prototype.hasOwnProperty("_"+_when+"_"+callback_name)&&(this.prototype["_"+_when+"_"+callback_name]=this.prototype["_"+_when+"_"+callback_name].slice()),((_base=this.prototype)[_name="_"+_when+"_"+callback_name]||(_base[_name]=[])).push(callback)}},_i=0,_len=(_ref=["before","after"]).length;_i<_len;_i++)_fn(_ref[_i]);return this.prototype["__"+method]=function(){var args,res;return args=1<=arguments.length?__slice.call(arguments,0):[],this.run_callbacks("before_"+callback_name,args),res=this.constructor.prototype[method].apply(this,args),this.run_callbacks("after_"+callback_name,args),res},(this.callbacked||(this.callbacked=[])).push(method)},Core.prototype.run_callbacks=function(type,args){var callback,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=this["_"+type]||[]).length;_i<_len;_i++)callback=_ref[_i],_results.push(callback.apply(this,args));return _results},Core.prototype.delegate_to=function(){var methods,to,_fn,_i,_len,_this;for(to=arguments[0],methods=2<=arguments.length?__slice.call(arguments,1):[],to="string"==typeof to?this[to]:to,_this=this,_fn=function(method){return _this[method]=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],to[method].apply(to,args)}},_i=0,_len=methods.length;_i<_len;_i++)_fn(methods[_i])},Core}()},{"./pi":48,"./utils":52}],40:[function(require){"use strict";var pi;pi=require("../pi"),require("./nod_events"),pi.NodEvent.register_alias("mousewheel","DOMMouseScroll")},{"../pi":48,"./nod_events":43}],41:[function(require){"use strict";var pi,utils,_true,_types,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../pi"),require("../utils/index"),require("../core"),utils=pi.utils,pi.Event=function(_super){function Event(event,target,bubbles){this.target=target,null==bubbles&&(bubbles=!0),null!=event&&"object"==typeof event?utils.extend(this,event):this.type=event,this.bubbles=bubbles,this.canceled=!1,this.captured=!1}return __extends(Event,_super),Event.prototype.cancel=function(){return this.canceled=!0},Event}(pi.Core),_true=function(){return!0},pi.EventListener=function(_super){function EventListener(type,handler,context,disposable,conditions){this.type=type,this.handler=handler,this.context=null!=context?context:null,this.disposable=null!=disposable&&disposable,this.conditions=conditions,EventListener.__super__.constructor.apply(this,arguments),null==this.handler._uid&&(this.handler._uid="fun"+utils.uid()),this.uid=this.type+":"+this.handler._uid,"function"!=typeof this.conditions&&(this.conditions=_true),null!=this.context&&(null==this.context._uid&&(this.context._uid="obj"+utils.uid()),this.uid+=":"+this.context._uid)}return __extends(EventListener,_super),EventListener.prototype.dispatch=function(event){if(!this.disposed&&this.conditions(event))return!1!==this.handler.call(this.context,event)&&(event.captured=!0),this.disposable?this.dispose():void 0},EventListener.prototype.dispose=function(){return this.handler=this.context=this.conditions=null,this.disposed=!0},EventListener}(pi.Core),_types=function(types){return"string"==typeof types?types.split(","):Array.isArray(types)?types:[null]},pi.EventDispatcher=function(_super){function EventDispatcher(){EventDispatcher.__super__.constructor.apply(this,arguments),this.listeners={},this.listeners_by_key={}}return __extends(EventDispatcher,_super),EventDispatcher.prototype.listeners="",EventDispatcher.prototype.listeners_by_key="",EventDispatcher.prototype.on=function(types,callback,context,conditions){var type,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=_types(types)).length;_i<_len;_i++)type=_ref[_i],_results.push(this.add_listener(new pi.EventListener(type,callback,context,!1,conditions)));return _results},EventDispatcher.prototype.one=function(type,callback,context,conditions){return this.add_listener(new pi.EventListener(type,callback,context,!0,conditions))},EventDispatcher.prototype.off=function(types,callback,context,conditions){var type,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=_types(types)).length;_i<_len;_i++)type=_ref[_i],_results.push(this.remove_listener(type,callback,context,conditions));return _results},EventDispatcher.prototype.trigger=function(event,data,bubbles){var _i,_len,_ref;if(null==bubbles&&(bubbles=!0),event instanceof pi.Event||(event=new pi.Event(event,this,bubbles)),null!=data&&(event.data=data),event.currentTarget=this,null!=this.listeners[event.type]){for(utils.debug("Event: "+event.type,event),_i=0,_len=(_ref=this.listeners[event.type]).length;_i<_len&&(_ref[_i].dispatch(event),!0!==event.canceled);_i++);this.remove_disposed_listeners()}!0!==event.captured&&event.bubbles&&this.bubble_event(event)},EventDispatcher.prototype.bubble_event=function(){},EventDispatcher.prototype.add_listener=function(listener){var _base,_name;return(_base=this.listeners)[_name=listener.type]||(_base[_name]=[]),this.listeners[listener.type].push(listener),this.listeners_by_key[listener.uid]=listener},EventDispatcher.prototype.remove_listener=function(type,callback,context,conditions){var listener,uid,_i,_len,_ref;if(null==context&&(context=null),null==conditions&&(conditions=null),null==type)return this.remove_all();if(null!=this.listeners[type]){if(null==callback){for(_i=0,_len=(_ref=this.listeners[type]).length;_i<_len;_i++)(listener=_ref[_i]).dispose();return this.remove_type(type),void this.remove_disposed_listeners()}uid=type+":"+callback._uid,null!=context&&(uid+=":"+context._uid),null!=(listener=this.listeners_by_key[uid])&&(delete this.listeners_by_key[uid],this.remove_listener_from_list(type,listener))}},EventDispatcher.prototype.remove_listener_from_list=function(type,listener){if(null!=this.listeners[type]&&this.listeners[type].indexOf(listener)>-1&&(this.listeners[type]=this.listeners[type].filter(function(item){return item!==listener}),!this.listeners[type].length))return this.remove_type(type)},EventDispatcher.prototype.remove_disposed_listeners=function(){var key,listener,_ref,_results;for(key in _results=[],_ref=this.listeners_by_key)(listener=_ref[key]).disposed?(this.remove_listener_from_list(listener.type,listener),_results.push(delete this.listeners_by_key[key])):_results.push(void 0);return _results},EventDispatcher.prototype.remove_type=function(type){return delete this.listeners[type]},EventDispatcher.prototype.remove_all=function(){return this.listeners={},this.listeners_by_key={}},EventDispatcher}(pi.Core)},{"../core":39,"../pi":48,"../utils/index":52}],42:[function(require){"use strict";require("./events"),require("./nod_events"),require("./aliases"),require("./resize_delegate")},{"./aliases":40,"./events":41,"./nod_events":43,"./resize_delegate":44}],43:[function(require){"use strict";var NodEvent,pi,utils,_key_regexp,_mouse_regexp,_prepare_event,_selector,_selector_regexp,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../pi"),require("../utils"),require("./events"),utils=pi.utils,pi.Events,pi.NodEvent=function(_super){function NodEvent(event){this.event=event||window.event,this.origTarget=this.event.target||this.event.srcElement,this.target=pi.Nod.create(this.origTarget),this.type=this.constructor.is_aliased(event.type)?this.constructor.reversed_aliases[event.type]:event.type,this.ctrlKey=this.event.ctrlKey,this.shiftKey=this.event.shiftKey,this.altKey=this.event.altKey,this.metaKey=this.event.metaKey,this.detail=this.event.detail,this.bubbles=this.event.bubbles}return __extends(NodEvent,_super),NodEvent.aliases={},NodEvent.reversed_aliases={},NodEvent.delegates={},NodEvent.add="undefined"==typeof Element.prototype.addEventListener?function(nod,event,handler){return nod.attachEvent("on"+event,handler)}:function(nod,event,handler){return nod.addEventListener(event,handler)},NodEvent.remove="undefined"==typeof Element.prototype.removeEventListener?function(nod,event,handler){return nod.detachEvent("on"+event,handler)}:function(nod,event,handler){return nod.removeEventListener(event,handler)},NodEvent.register_delegate=function(type,delegate){return this.delegates[type]=delegate},NodEvent.has_delegate=function(type){return!!this.delegates[type]},NodEvent.register_alias=function(from,to){return this.aliases[from]=to,this.reversed_aliases[to]=from},NodEvent.has_alias=function(type){return!!this.aliases[type]},NodEvent.is_aliased=function(type){return!!this.reversed_aliases[type]},NodEvent.prototype.stopPropagation=function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0},NodEvent.prototype.stopImmediatePropagation=function(){return this.event.stopImmediatePropagation?this.event.stopImmediatePropagation():(this.event.cancelBubble=!0,this.event.cancel=!0)},NodEvent.prototype.preventDefault=function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1},NodEvent.prototype.cancel=function(){return this.stopImmediatePropagation(),this.preventDefault(),NodEvent.__super__.cancel.apply(this,arguments)},NodEvent}(pi.Event),NodEvent=pi.NodEvent,_mouse_regexp=/(click|mouse|contextmenu)/i,_key_regexp=/(keyup|keydown|keypress)/i,pi.MouseEvent=function(){function MouseEvent(){MouseEvent.__super__.constructor.apply(this,arguments),this.button=this.event.button,null==this.pageX&&(this.pageX=this.event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.pageY=this.event.clientY+document.body.scrollTop+document.documentElement.scrollTop),null==this.offsetX&&(this.offsetX=this.event.layerX-this.origTarget.offsetLeft,this.offsetY=this.event.layerY-this.origTarget.offsetTop),this.wheelDelta=this.event.wheelDelta,null==this.wheelDelta&&(this.wheelDelta=40*-this.event.detail)}return __extends(MouseEvent,NodEvent),MouseEvent}(),pi.KeyEvent=function(){function KeyEvent(){KeyEvent.__super__.constructor.apply(this,arguments),utils.debug("I am a KEEEY!"),this.keyCode=this.event.keyCode||this.event.which,this.charCode=this.event.charCode}return __extends(KeyEvent,NodEvent),KeyEvent}(),_prepare_event=function(e){return _mouse_regexp.test(e.type)?new pi.MouseEvent(e):_key_regexp.test(e.type)?new pi.KeyEvent(e):new NodEvent(e)},_selector_regexp=/[\.#]/,_selector=function(s,parent){return _selector_regexp.test(s)?function(e){var node;if(parent||(parent=document),(node=e.target.node).matches(s))return!0;if(node===parent)return!1;for(;(node=node.parentNode)&&node!==parent;)if(node.matches(s))return e.target=pi.Nod.create(node)}:function(e){return e.target.node.matches(s)}},pi.NodEventDispatcher=function(_super){function NodEventDispatcher(){var _this;NodEventDispatcher.__super__.constructor.apply(this,arguments),this.native_event_listener=(_this=this,function(event){return _this.trigger(_prepare_event(event))})}return __extends(NodEventDispatcher,_super),NodEventDispatcher.prototype.listen=function(selector,event,callback,context){return this.on(event,callback,context,_selector(selector,this.node))},NodEventDispatcher.prototype.add_native_listener=function(type){return NodEvent.has_delegate(type)?NodEvent.delegates[type].add(this,this.native_event_listener):NodEvent.add(this.node,type,this.native_event_listener)},NodEventDispatcher.prototype.remove_native_listener=function(type){return NodEvent.has_delegate(type)?NodEvent.delegates[type].remove(this):NodEvent.remove(this.node,type,this.native_event_listener)},NodEventDispatcher.prototype.add_listener=function(listener){return this.listeners[listener.type]||(this.add_native_listener(listener.type),NodEvent.has_alias(listener.type)&&this.add_native_listener(NodEvent.aliases[listener.type])),NodEventDispatcher.__super__.add_listener.apply(this,arguments)},NodEventDispatcher.prototype.remove_type=function(type){return this.remove_native_listener(type),NodEvent.has_alias(type)&&this.remove_native_listener(NodEvent.aliases[type]),NodEventDispatcher.__super__.remove_type.apply(this,arguments)},NodEventDispatcher.prototype.remove_all=function(){var type,_fn,_ref,_this;for(type in _ref=this.listeners,_this=this,_fn=function(){if(_this.remove_native_listener(type),NodEvent.has_alias(type))return _this.remove_native_listener(NodEvent.aliases[type])},_ref)__hasProp.call(_ref,type)&&(_ref[type],_fn());return NodEventDispatcher.__super__.remove_all.apply(this,arguments)},NodEventDispatcher}(pi.EventDispatcher)},{"../pi":48,"../utils":52,"./events":41}],44:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../pi"),require("../utils"),require("./nod_events"),utils=pi.utils,pi.NodEvent.ResizeListener=function(_super){function ResizeListener(nod,handler){var _filter,_this;this.nod=nod,this.handler=handler,this._w=this.nod.width(),this._h=this.nod.height(),_this=this,_filter=function(e){return(_this._w!==e.width||_this._h!==e.height)&&(_this._w=e.width,_this._h=e.height,!0)},
ResizeListener.__super__.constructor.call(this,"resize",this.handler,this.nod,!1,_filter)}return __extends(ResizeListener,_super),ResizeListener}(pi.EventListener),pi.NodEvent.ResizeDelegate=function(){function ResizeDelegate(){this.listeners=[]}return ResizeDelegate.prototype.add=function(nod,callback){if(this.listeners.push(new pi.NodEvent.ResizeListener(nod,callback)),1===this.listeners.length)return this.listen()},ResizeDelegate.prototype.remove=function(nod){var flag,i,_i,_len,_ref;for(flag=!1,i=_i=0,_len=(_ref=this.listeners).length;_i<_len;i=++_i)if(_ref[i].nod===nod){flag=!0;break}if(!0===flag)return this.listeners.splice(i,1)},ResizeDelegate.prototype.listen=function(){return pi.NodEvent.add(pi.Nod.win.node,"resize",this.resize_listener())},ResizeDelegate.prototype.off=function(){return pi.NodEvent.remove(pi.Nod.win.node,"resize",this.resize_listener())},ResizeDelegate.prototype.resize_listener=function(){return this._resize_listener||(this._resize_listener=utils.debounce(300,(_this=this,function(){var listener,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=_this.listeners).length;_i<_len;_i++)listener=_ref[_i],_results.push(listener.dispatch(_this._create_event(listener)));return _results})));var _this},ResizeDelegate.prototype._create_event=function(listener){var nod;return{type:"resize",target:nod=listener.nod,width:nod.width(),height:nod.height()}},ResizeDelegate}(),pi.NodEvent.register_delegate("resize",new pi.NodEvent.ResizeDelegate)},{"../pi":48,"../utils":52,"./nod_events":43}],45:[function(require){"use strict";var pi,utils,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};pi=require("../pi"),utils=pi.utils,pi.Former=function(){function Former(nod,options){this.nod=nod,this.options=null!=options?options:{},!0===this.options.rails&&(this.options.name_transform=this._rails_name_transform),!0===this.options.serialize&&(this.options.parse_value=utils.serialize)}return Former.parse=function(nod,options){return new pi.Former(nod,options).parse()},Former.fill=function(nod,options){return new pi.Former(nod,options).fill()},Former.clear=function(nod,options){return new pi.Former(nod,options).clear()},Former.prototype.parse=function(){return this.process_name_values(this.collect_name_values())},Former.prototype.fill=function(data){return this.traverse_nodes(this.nod,(_this=this,function(nod){return _this._fill_nod(nod,data)}));var _this},Former.prototype.clear=function(){return this.traverse_nodes(this.nod,(_this=this,function(nod){return _this._clear_nod(nod)}));var _this},Former.prototype.process_name_values=function(name_values){var _arrays,_fn,_i,_len,_result,_this;for(_result={},_arrays={},_this=this,_fn=function(item){var i,len,name,name_part,value,_arr_fullname,_current,_j,_len1,_name_parts,_results;if(name=item.name,value=item.value,!_this.options.skip_empty||""!==value&&null!==value){for(_arr_fullname="",_current=_result,name=_this.transform_name(name,!1),value=_this.transform_value(value),_name_parts=name.split("."),len=_name_parts.length,_results=[],i=_j=0,_len1=_name_parts.length;_j<_len1;i=++_j)name_part=_name_parts[i],_results.push(function(name_part){var _arr_len,_arr_name,_array_item,_next_field;return name_part.indexOf("[]")>-1?(_arr_name=name_part.substr(0,name_part.indexOf("[")),_arr_fullname+=_arr_name,_current[_arr_name]||(_current[_arr_name]=[]),i===len-1?_current[_arr_name].push(value):(_next_field=_name_parts[i+1],_arrays[_arr_fullname]||(_arrays[_arr_fullname]=[]),_arr_len=_arrays[_arr_fullname].length,_current[_arr_name].length>0&&(_array_item=_current[_arr_name][_current[_arr_name].length-1]),(!_arr_len||__indexOf.call(_arrays[_arr_fullname],_next_field)>=0&&!(_next_field.indexOf("[]")>-1||null==_array_item[_next_field]||i+1!==len-1))&&(_array_item={},_current[_arr_name].push(_array_item),_arrays[_arr_fullname]=[]),_arrays[_arr_fullname].push(_next_field),_current=_array_item)):(_arr_fullname+=name_part,i<len-1?(_current[name_part]||(_current[name_part]={}),_current=_current[name_part]):_current[name_part]=value)}(name_part));return _results}},_i=0,_len=name_values.length;_i<_len;_i++)_fn(name_values[_i]);return _result},Former.prototype.collect_name_values=function(){return this.traverse_nodes(this.nod,(_this=this,function(nod){return _this._parse_nod(nod)}));var _this},Former.prototype.traverse_nodes=function(nod,callback){var current,result;for(result=this._to_array(callback(nod)),current=nod.firstChild;null!=current;)1===current.nodeType&&(result=result.concat(this.traverse_nodes(current,callback))),current=current.nextSibling;return result},Former.prototype.transform_name=function(name,prefix){return null==prefix&&(prefix=!0),this.options.fill_prefix&&prefix&&(name=name.replace(this.options.fill_prefix,"")),null!=this.options.name_transform&&(name=this.options.name_transform(name)),name},Former.prototype.transform_value=function(val){return null!=this.options.parse_value?this.options.parse_value(val):val},Former.prototype._to_array=function(val){return null==val?[]:utils.to_a(val)},Former.prototype._parse_nod=function(nod){var val;if((!1!==this.options.disabled||!nod.disabled)&&/(input|select|textarea)/i.test(nod.nodeName)&&nod.name&&null!=(val=this._parse_nod_value(nod)))return{name:nod.name,value:val}},Former.prototype._fill_nod=function(nod,data){var type,value;if(/(input|select|textarea)/i.test(nod.nodeName)&&null!=(value=this._nod_data_value(nod.name,data)))if("select"===nod.nodeName.toLowerCase())this._fill_select(nod,value);else{if("object"==typeof value)return;switch(type=nod.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(type)&&value):nod.checked=!0;break;case!(/(radio|checkbox)/.test(type)&&!value):nod.checked=!1;break;default:nod.value=value}}},Former.prototype._fill_select=function(nod,value){var option,_i,_len,_ref,_results;for(value=value instanceof Array?value:[value],_results=[],_i=0,_len=(_ref=nod.getElementsByTagName("option")).length;_i<_len;_i++)option=_ref[_i],_results.push(function(option){var _ref1;return option.selected=(_ref1=option.value,__indexOf.call(value,_ref1)>=0)}(option));return _results},Former.prototype._clear_nod=function(nod){var type;if(/(input|select|textarea)/i.test(nod.nodeName))if("select"===nod.nodeName.toLowerCase())this._fill_select(nod,[]);else switch(type=nod.type.toLowerCase(),!1){case!/(radio|checkbox)/.test(type):nod.checked=!1;break;case!("hidden"===type&&!this.options.clear_hidden):break;default:nod.value=""}},Former.prototype._nod_data_value=function(name,data){var _i,_len,_ref;if(name&&!((name=this.transform_name(name)).indexOf("[]")>-1)){for(_i=0,_len=(_ref=name.split(".")).length;_i<_len&&null!=(data=data[_ref[_i]]);_i++);return data}},Former.prototype._parse_nod_value=function(nod){var type;if("select"===nod.nodeName.toLowerCase())return this._parse_select_value(nod);switch(type=nod.type.toLowerCase(),!1){case!(/(radio|checkbox)/.test(type)&&nod.checked):return nod.value;case!(/(radio|checkbox)/.test(type)&&!nod.checked):case!/(button|reset|submit|image)/.test(type):return null;case!/(file)/.test(type):return this._parse_file_value(nod);default:return nod.value}},Former.prototype._parse_file_value=function(nod){var _ref;if(null!=(_ref=nod.files)?_ref.length:void 0)return nod.multiple?nod.files:nod.files[0]},Former.prototype._parse_select_value=function(nod){var option,_i,_len,_ref,_results;if(!nod.multiple)return nod.value;for(_results=[],_i=0,_len=(_ref=nod.getElementsByTagName("option")).length;_i<_len;_i++)(option=_ref[_i]).selected&&_results.push(option.value);return _results},Former.prototype._rails_name_transform=function(name){return name.replace(/\[([^\]])/gi,".$1").replace(/([^\[])([\]]+)/gi,"$1")},Former}()},{"../pi":48}],46:[function(require,module){"use strict";var pi;pi=require("./pi"),require("./nod"),require("./former/former"),module.exports=pi},{"./former/former":45,"./nod":47,"./pi":48}],47:[function(require){"use strict";var d,info,klasses,pi,utils,version,versions,_caf,_data_reg,_dataset,_fn,_fn1,_fragment,_from_dataCase,_geometry_styles,_i,_j,_len,_len1,_node,_prop_hash,_raf,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;for(pi=require("./pi"),require("./utils"),require("./events"),utils=pi.utils,_prop_hash=function(method,callback){return pi.Nod.prototype[method]=function(prop,val){var k,p;if("object"!=typeof prop)return callback.call(this,prop,val);for(k in prop)__hasProp.call(prop,k)&&(p=prop[k],callback.call(this,k,p))}},_geometry_styles=function(sty){var s,_fn,_i,_len;for(_fn=function(){var name;name=s,pi.Nod.prototype[name]=function(val){return void 0===val?this.node["offset"+utils.capitalize(name)]:(this._with_raf(name,(_this=this,function(){if(_this.node.style[name]=val+"px","width"===name||"height"===name)return _this.trigger("resize")})),this);var _this}},_i=0,_len=sty.length;_i<_len;_i++)s=sty[_i],_fn()},_node=function(n){return n instanceof pi.Nod?n.node:"string"==typeof n?_fragment(n):n},_data_reg=/^data-\w[\w\-]*$/,_from_dataCase=function(str){return str.split("-").join("_")},_dataset="undefined"==typeof DOMStringMap?function(node){var attr,dataset,_i,_len,_ref;if(dataset={},null!=node.attributes)for(_i=0,_len=(_ref=node.attributes).length;_i<_len;_i++)attr=_ref[_i],_data_reg.test(attr.name)&&(dataset[_from_dataCase(attr.name.slice(5))]=utils.serialize(attr.value));return dataset}:function(node){var dataset,key,val,_ref;for(key in dataset={},_ref=node.dataset)__hasProp.call(_ref,key)&&(val=_ref[key],dataset[utils.snake_case(key)]=utils.serialize(val));return dataset},_fragment=function(html){var f,temp;for((temp=document.createElement("div")).innerHTML=html,f=document.createDocumentFragment();temp.firstChild;)f.appendChild(temp.firstChild);return f},_raf=null!=window.requestAnimationFrame?window.requestAnimationFrame:function(callback){return utils.after(0,callback)},_caf=null!=window.cancelAnimationFrame?window.cancelAnimationFrame:function(id){return clearTimeout(id)},pi.Nod=function(_super){function Nod(node){if(this.node=node,Nod.__super__.constructor.apply(this,arguments),null==this.node)throw Error("Node is undefined!");this._disposed=!1,this._data=_dataset(node),null==this.node._nod&&(this.node._nod=this)}return __extends(Nod,_super),Nod.create=function(node){switch(!1){case!!node:return null;case!(node instanceof this):return node;case!("undefined"!=typeof node._nod):return node._nod;case!utils.is_html(node):return this._create_html(node);case"string"!=typeof node:return new this(document.createElement(node));default:return new this(node)}},Nod._create_html=function(html){var node,temp;return node=(temp=_fragment(html)).firstChild,temp.removeChild(node),new this(node)},Nod.prototype.find=function(selector){return pi.Nod.create(this.node.querySelector(selector))},Nod.prototype.all=function(selector){return this.node.querySelectorAll(selector)},Nod.prototype.each=function(selector,callback){var i,node,_i,_len,_ref,_results;for(i=0,_results=[],_i=0,_len=(_ref=this.node.querySelectorAll(selector)).length;_i<_len&&(node=_ref[_i],!0!==callback.call(null,node,i));_i++)_results.push(i++);return _results},Nod.prototype.first=function(selector){return this.find(selector)},Nod.prototype.last=function(selector){return this.find(selector+":last-child")},Nod.prototype.nth=function(selector,n){return this.find(selector+":nth-child("+n+")")},Nod.prototype.find_bf=function(selector){var acc,el,nod,rest;for(rest=[],acc=[],el=this.node.firstChild;el;)if(1===el.nodeType){if(el.matches(selector))acc.push(el),null!=(nod=el.querySelector(selector))&&rest.push(nod);else if(nod=el.querySelector(selector)){el.nextSibling&&rest.unshift(el.nextSibling),el=nod;continue}el=el.nextSibling||rest.shift()}else el=el.nextSibling||rest.shift();return acc},Nod.prototype.attrs=function(data){var name,val;for(name in data)__hasProp.call(data,name)&&(val=data[name],this.attr(name,val));return this},Nod.prototype.styles=function(data){var name,val;for(name in data)__hasProp.call(data,name)&&(val=data[name],this.style(name,val));return this},Nod.prototype.parent=function(selector){var p;if(null==selector)return null!=this.node.parentNode?pi.Nod.create(this.node.parentNode):null;for(p=this.node;(p=p.parentNode)&&p!==document;)if(p.matches(selector))return pi.Nod.create(p);return null},Nod.prototype.children=function(selector){var n,_i,_len,_ref,_results;if(null!=selector){for(_results=[],_i=0,_len=(_ref=this.node.children).length;_i<_len;_i++)(n=_ref[_i]).matches(selector)&&_results.push(n);return _results}return this.node.children},Nod.prototype.wrap=function(){var klasses,wrapper;return klasses=1<=arguments.length?__slice.call(arguments,0):[],(wrapper=pi.Nod.create("div")).addClass.apply(wrapper,klasses),this.node.parentNode.insertBefore(wrapper.node,this.node),wrapper.append(this.node)},Nod.prototype.prepend=function(node){return node=_node(node),this.node.insertBefore(node,this.node.firstChild),this},Nod.prototype.append=function(node){return node=_node(node),this.node.appendChild(node),this},Nod.prototype.insertBefore=function(node){return node=_node(node),this.node.parentNode.insertBefore(node,this.node),this},Nod.prototype.insertAfter=function(node){return node=_node(node),this.node.parentNode.insertBefore(node,this.node.nextSibling),this},Nod.prototype.detach=function(){var _ref;return null!=(_ref=this.node.parentNode)&&_ref.removeChild(this.node),this},Nod.prototype.detach_children=function(){for(;this.node.children.length;)this.node.removeChild(this.node.children[0]);return this},Nod.prototype.remove_children=function(){for(;this.node.firstChild;)this.node.firstChild._nod?this.node.firstChild._nod.remove():this.node.removeChild(this.node.firstChild);return this},Nod.prototype.remove=function(){return this.detach(),this.remove_children(),this.dispose(),null},Nod.prototype.empty=function(){return this.html(""),this},Nod.prototype.clone=function(){var c,nod;return(c=document.createElement(this.node.nameNode)).innerHTML=this.node.outerHTML,nod=new pi.Nod(c.firstChild),utils.extend(nod,this,!0,["listeners","listeners_by_type","__components__","native_event_listener","node"])},Nod.prototype.dispose=function(){var key;if(!this._disposed){for(key in this.off(),delete this.node._nod,this)__hasProp.call(this,key)&&(this[key],delete this[key]);this._disposed=!0}},Nod.prototype.html=function(val){return null!=val?(this.node.innerHTML=val,this):this.node.innerHTML},Nod.prototype.outerHTML=function(val){return null!=val?(this.node.outerHTML=val,this):this.node.outerHTML},Nod.prototype.text=function(val){return null!=val?(this.node.textContent=val,this):this.node.textContent},Nod.prototype.name=function(){return this.node.name||this.data("name")},Nod.prototype.value=function(val){return null!=val?(this.node.value=val,this):this.node.value},Nod.prototype.addClass=function(){var c,_i,_len;for(_i=0,_len=arguments.length;_i<_len;_i++)c=arguments[_i],this.node.classList.add(c);return this},Nod.prototype.removeClass=function(){var c,_i,_len;for(_i=0,_len=arguments.length;_i<_len;_i++)c=arguments[_i],this.node.classList.remove(c);return this},Nod.prototype.toggleClass=function(c){return this.node.classList.toggle(c),this},Nod.prototype.hasClass=function(c){return this.node.classList.contains(c)},Nod.prototype.mergeClasses=function(nod){var klass,_i,_len,_ref;for(_i=0,_len=(_ref=nod.node.className.split(/\s+/)).length;_i<_len;_i++)(klass=_ref[_i])&&this.addClass(klass);return this},Nod.prototype.x=function(){var node,offset;for(offset=this.node.offsetLeft,node=this.node;node=node.offsetParent;)offset+=node.offsetLeft;return offset},Nod.prototype.y=function(){var node,offset;for(offset=this.node.offsetTop,node=this.node;node=node.offsetParent;)offset+=node.offsetTop;return offset},Nod.prototype._with_raf=function(name,fun){return this["__"+name+"_rid"]&&(_caf(this["__"+name+"_rid"]),delete this["__"+name+"_rid"]),this["__"+name+"_rid"]=_raf(fun)},Nod.prototype.move=function(x,y){return this._with_raf("move",(_this=this,function(){return _this.style({left:x+"px",top:y+"px"})}));var _this},Nod.prototype.moveX=function(x){return this.left(x)},Nod.prototype.moveY=function(y){return this.top(y)},Nod.prototype.scrollX=function(x){return this._with_raf("scrollX",(_this=this,function(){return _this.node.scrollLeft=x}));var _this},Nod.prototype.scrollY=function(y){return this._with_raf("scrollY",(_this=this,function(){return _this.node.scrollTop=y}));var _this},Nod.prototype.position=function(){return{x:this.x(),y:this.y()}},Nod.prototype.offset=function(){return{x:this.node.offsetLeft,y:this.node.offsetTop}},Nod.prototype.size=function(width,height){if(null==width&&(width=null),null==height&&(height=null),null==width||null==height)return{width:this.width(),height:this.height()};var _this;null==width&&(width=this.width()),null==height&&(height=this.height()),this._with_raf("size",(_this=this,function(){return _this.node.style.width=width+"px",_this.node.style.height=height+"px",_this.trigger("resize")}))},Nod.prototype.show=function(){return this.node.style.display="block"},Nod.prototype.hide=function(){return this.node.style.display="none"},Nod.prototype.focus=function(){return this.node.focus(),this},Nod.prototype.blur=function(){return this.node.blur(),this},Nod}(pi.NodEventDispatcher),_prop_hash("data",function(prop,val){return void 0===prop?this._data:(prop=prop.replace("-","_"),null===val?(val=this._data[prop],delete this._data[prop],val):void 0===val?this._data[prop]:(this._data[prop]=val,this))}),_prop_hash("style",function(prop,val){if(null===val)this.node.style.removeProperty(prop);else if(void 0===val)return this.node.style[prop];return this.node.style[prop]=val}),_prop_hash("attr",function(prop,val){return null===val?this.node.removeAttribute(prop):void 0===val?this.node.getAttribute(prop):this.node.setAttribute(prop,val)}),_geometry_styles(["top","left","width","height"]),_fn=function(){var prop;return prop="client"+utils.capitalize(d),pi.Nod.prototype[prop]=function(){return this.node[prop]}},_i=0,_len=(_ref=["width","height"]).length;_i<_len;_i++)d=_ref[_i],_fn();for(_fn1=function(){var prop;return prop="scroll"+utils.capitalize(d),pi.Nod.prototype[prop]=function(){return this.node[prop]}},_j=0,_len1=(_ref1=["top","left","width","height"]).length;_j<_len1;_j++)d=_ref1[_j],_fn1();pi.NodRoot=function(_super){function NodRoot(){if(pi.NodRoot.instance)throw"NodRoot is already defined!";pi.NodRoot.instance=this,NodRoot.__super__.constructor.call(this,document.documentElement)}return __extends(NodRoot,_super),NodRoot.instance=null,NodRoot.prototype.initialize=function(){var load_handler,ready_handler,_ready_state,_this;if(_ready_state=document.attachEvent?"complete":"interactive",this._loaded="complete"===document.readyState,this._loaded||(this._loaded_callbacks=[],_this=this,load_handler=function(){return utils.debug("DOM loaded"),_this._loaded=!0,_this.fire_all(),pi.NodEvent.remove(window,"load",load_handler)},pi.NodEvent.add(window,"load",load_handler)),!this._ready){if(document.addEventListener){if(this._ready=document.readyState===_ready_state,this._ready)return;return this._ready_callbacks=[],ready_handler=function(_this){return function(){return utils.debug("DOM ready"),_this._ready=!0,_this.fire_ready(),document.removeEventListener("DOMContentLoaded",ready_handler)}}(this),document.addEventListener("DOMContentLoaded",ready_handler)}if(this._ready=document.readyState===_ready_state,this._ready)return;return this._ready_callbacks=[],ready_handler=function(_this){return function(){if(document.readyState===_ready_state)return utils.debug("DOM ready"),_this._ready=!0,_this.fire_ready(),document.detachEvent("onreadystatechange",ready_handler)}}(this),document.attachEvent("onreadystatechange",ready_handler)}},NodRoot.prototype.ready=function(callback){return this._ready?callback.call(null):this._ready_callbacks.push(callback)},NodRoot.prototype.loaded=function(callback){return this._loaded?callback.call(null):this._loaded_callbacks.push(callback)},NodRoot.prototype.fire_all=function(){var callback;for(this._ready_callbacks&&this.fire_ready();callback=this._loaded_callbacks.shift();)callback.call(null);return this._loaded_callbacks=null},NodRoot.prototype.fire_ready=function(){for(var callback;callback=this._ready_callbacks.shift();)callback.call(null);return this._ready_callbacks=null},NodRoot.prototype.scrollTop=function(){return this.node.scrollTop||document.body.scrollTop},NodRoot.prototype.scrollLeft=function(){return this.node.scrollLeft||document.body.scrollLeft},NodRoot.prototype.scrollHeight=function(){return this.node.scrollHeight},NodRoot.prototype.scrollWidth=function(){return this.node.scrollWidth},NodRoot.prototype.height=function(){return window.innerHeight||this.node.clientHeight},NodRoot.prototype.width=function(){return window.innerWidth||this.node.clientWidth},NodRoot}(pi.Nod),pi.Nod.root=new pi.NodRoot,pi.NodWin=function(_super){function NodWin(){if(pi.NodWin.instance)throw"NodWin is already defined!";pi.NodWin.instance=this,this.delegate_to(pi.Nod.root,"scrollLeft","scrollTop","scrollWidth","scrollHeight"),NodWin.__super__.constructor.call(this,window)}return __extends(NodWin,_super),NodWin.instance=null,NodWin.prototype.scrollY=function(y){var x,_this;return x=this.scrollLeft(),this._with_raf("scrollY",(_this=this,function(){return _this.node.scrollTo(x,y)}))},NodWin.prototype.scrollX=function(x){var y,_this;return y=this.scrollTop(),this._with_raf("scrollX",(_this=this,function(){return _this.node.scrollTo(x,y)}))},NodWin.prototype.width=function(){return this.node.innerWidth},NodWin.prototype.height=function(){return this.node.innerHeight},NodWin.prototype.x=function(){return 0},NodWin.prototype.y=function(){return 0},NodWin}(pi.Nod),pi.Nod.win=new pi.NodWin,pi.Nod.body=new pi.Nod(document.body),pi.$=function(q){return utils.is_html(q)?pi.Nod.create(q):pi.Nod.root.find(q)},pi["export"](pi.$,"$"),klasses=[],!0===(info=utils.browser.info()).msie&&(klasses.push("ie"),version=(versions=info.version.split(".")).length?versions[0]:version,klasses.push("ie"+version)),!0===info.mobile&&klasses.push("mobile"),!0===info.tablet&&klasses.push("tablet"),klasses.length&&pi.Nod.root.addClass.apply(pi.Nod.root,klasses),pi.Nod.root.initialize()},{"./events":42,"./pi":48,"./utils":52}],48:[function(require,module){"use strict";module.exports={}},{}],49:[function(require){"use strict";var pi,_conflicts,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;pi=require("../pi"),_conflicts={},pi["export"]=function(fun,as){return null!=window[as]&&null==_conflicts[as]&&(_conflicts[as]=window[as]),window[as]=fun},pi.noconflict=function(){var fun,name,_results;for(name in _results=[],_conflicts)__hasProp.call(_conflicts,name)&&(fun=_conflicts[name],_results.push(window[name]=fun));return _results},pi.utils=function(){function utils(){}return utils.uniq_id=100,utils.email_rxp=/\b[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}\b/i,utils.digital_rxp=/^[\d\s-\(\)]+$/,utils.html_rxp=/^\s*<[\s\S]+>\s*$/m,utils.esc_rxp=/[-[\]{}()*+?.,\\^$|#]/g,utils.clickable_rxp=/^(a|button|input|textarea)$/i,utils.input_rxp=/^(input|select|textarea)$/i,utils.trim_rxp=/^\s*([\s\S]*[^\s])\s*$/m,utils.notsnake_rxp=/((?:^[^A-Z]|[A-Z])[^A-Z]*)/g,utils.str_rxp=/(^'|'$)/g,utils.uid=function(){return""+ ++this.uniq_id},utils.escapeRegexp=function(str){return str.replace(this.esc_rxp,"\\$&")},utils.trim=function(str){return str.replace(this.trim_rxp,"$1")},utils.is_digital=function(str){return this.digital_rxp.test(str)},utils.is_email=function(str){return this.email_rxp.test(str)},utils.is_html=function(str){return this.html_rxp.test(str)},utils.clickable=function(node){return this.clickable_rxp.test(node.nodeName)},utils.is_input=function(node){return this.input_rxp.test(node.nodeName)},utils.camelCase=function(string){var word;return(string+="").length?function(){var _i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=string.split("_")).length;_i<_len;_i++)word=_ref[_i],_results.push(this.capitalize(word));return _results}.call(this).join(""):string},utils.snake_case=function(string){var matches,word;return(string+="").length?(matches=string.match(this.notsnake_rxp),function(){var _i,_len,_results;for(_results=[],_i=0,_len=matches.length;_i<_len;_i++)word=matches[_i],_results.push(word.toLowerCase());return _results}().join("_")):string},utils.capitalize=function(word){return word[0].toUpperCase()+word.slice(1)},utils.serialize=function(val){return val=function(){switch(!1){case!(null==val):case"null"!==val:return null;case"undefined"!==val:return;case"true"!==val:return!0;case"false"!==val:return!1;case""!==val:return"";case!(isNaN(Number(val))&&"string"==typeof val):return(val+"").replace(this.str_rxp,"");case!isNaN(Number(val)):return val;default:return Number(val)}}.call(this)},utils.key_compare=function(a,b,key,order){var reverse;return reverse="asc"===order,(a=this.serialize(a[key]))===(b=this.serialize(b[key]))?0:!a||a<b?1+-2*reverse:-(1+-2*reverse)},utils.keys_compare=function(a,b,params){var key,param,r,_fn,_i,_len;for(r=0,_i=0,_len=params.length;_i<_len;_i++)for(key in param=params[_i],_fn=function(_this){return function(key,order){var r_;if(r_=_this.key_compare(a,b,key,order),0===r)return r=r_}}(this),param)__hasProp.call(param,key)&&_fn(key,param[key]);return r},utils.sort=function(arr,sort_params){return arr.sort(this.curry(this.keys_compare,[sort_params],this,!0))},utils.sort_by=function(arr,key,order){return null==order&&(order="asc"),arr.sort(this.curry(this.key_compare,[key,order],this,!0))},utils.get_path=function(obj,path){var key,parts,res;for(parts=path.split("."),res=obj;parts.length;){if(null==res[key=parts.shift()])return null;res=res[key]}return res},utils.set_path=function(obj,path,val){var key,parts,res;for(parts=path.split("."),res=obj;parts.length>1;)null==res[key=parts.shift()]&&(res[key]={}),res=res[key];return res[parts[0]]=val},utils.get_class_path=function(pckg,path){var _this;return path=path.split(".").map((_this=this,function(p){return _this.camelCase(p)})).join("."),this.get_path(pckg,path)},utils.wrap=function(key,obj){var data;return(data={})[key]=obj,data},utils.clone=function(obj,except){var flags,key,newInstance;if(null==except&&(except=[]),null==obj||"object"!=typeof obj)return obj;if(obj instanceof Date)return new Date(obj.getTime());if(obj instanceof RegExp)return flags="",null!=obj.global&&(flags+="g"),null!=obj.ignoreCase&&(flags+="i"),null!=obj.multiline&&(flags+="m"),null!=obj.sticky&&(flags+="y"),new RegExp(obj.source,flags);if(obj instanceof Element)return obj.cloneNode(!0);if("function"==typeof obj.clone)return obj.clone();for(key in newInstance=new obj.constructor,obj)__indexOf.call(except,key)<0&&(newInstance[key]=this.clone(obj[key]));return newInstance},utils.merge=function(to,from){var key,obj,prop;for(key in obj=this.clone(to),from)__hasProp.call(from,key)&&(prop=from[key],obj[key]=prop);return obj},utils.extend=function(target,data,overwrite,except){var key,prop;for(key in null==overwrite&&(overwrite=!1),null==except&&(except=[]),data)__hasProp.call(data,key)&&(prop=data[key],null!=target[key]&&!overwrite||__indexOf.call(except,key)>=0||(target[key]=prop));return target},utils.extract=function(data,source,param){var key,p,vals,_fn,_i,_j,_len,_len1;if(null!=source){if(Array.isArray(source))for(_this=this,_fn=function(el){var el_data;return el_data={},_this.extract(el_data,el,param),data.push(el_data)},_i=0,_len=source.length;_i<_len;_i++)_fn(source[_i]);else if("string"==typeof param)null!=source[param]&&(data[param]=source[param]);else if(Array.isArray(param))for(_j=0,_len1=param.length;_j<_len1;_j++)p=param[_j],this.extract(data,source,p);else for(key in param)if(__hasProp.call(param,key)){if(vals=param[key],null==source[key])return;Array.isArray(source[key])?data[key]=[]:data[key]={},this.extract(data[key],source[key],vals)}var _this;return data}},utils.uniq=function(arr){var el,res,_i,_len;for(res=[],_i=0,_len=arr.length;_i<_len;_i++)el=arr[_i],__indexOf.call(res,el)<0&&res.push(el);return res},utils.to_a=function(obj){return Array.isArray(obj)?obj:[obj]},utils.as_promise=function(fun,resolved){return null==resolved&&(resolved=!0),new Promise(function(resolve,reject){return resolved?resolve(fun.call(null)):reject(fun.call(null))})},utils.resolved_promise=function(data){return new Promise(function(resolve){return resolve(data)})},utils.rejected_promise=function(error){return new Promise(function(_,reject){return reject(error)})},utils.debounce=function(period,fun,ths){var _buf,_wait;return _wait=!1,_buf=null,function(){var args;if(args=1<=arguments.length?__slice.call(arguments,0):[],!_wait)return(ths||{}).__debounce_id__=pi.utils.after(period,function(){if(_wait=!1,null!=_buf)return fun.apply(ths,_buf),_buf=null}),_wait=!0,null==_buf?fun.apply(ths,args):void 0;_buf=args}},utils.curry=function(fun,args,ths,last){return null==args&&(args=[]),null==last&&(last=!1),fun="function"==typeof fun?fun:ths[fun],args=pi.utils.to_a(args),function(){var rest;return rest=1<=arguments.length?__slice.call(arguments,0):[],fun.apply(ths||this,last?rest.concat(args):args.concat(rest))}},utils.delayed=function(delay,fun,args,ths){return null==args&&(args=[]),function(){return setTimeout(pi.utils.curry(fun,args,ths),delay)}},utils.after=function(delay,fun,ths){return pi.utils.delayed(delay,fun,[],ths)()},utils}(),pi["export"](pi.utils.curry,"curry"),pi["export"](pi.utils.delayed,"delayed"),pi["export"](pi.utils.after,"after"),pi["export"](pi.utils.debounce,"debounce")},{"../pi":48}],50:[function(require){"use strict";var pi,_android_version_rxp,_ios_rxp,_ios_version_rxp,_mac_os_version_rxp,_win_version,_win_version_rxp;pi=require("../pi"),require("./base"),pi.utils,_mac_os_version_rxp=/\bMac OS X ([\d\._]+)\b/,_win_version_rxp=/\bWindows NT ([\d\.]+)\b/,_ios_rxp=/(iphone|ipod|ipad)/i,_ios_version_rxp=/\bcpu\s*(?:iphone\s+)?os ([\d\.\-_]+)\b/i,_android_version_rxp=/\bandroid[\s\-]([\d\-\._]+)\b/i,_win_version={6.3:"8.1",6.2:"8",6.1:"7","6.0":"Vista",5.2:"XP",5.1:"XP"},pi.utils.browser=function(){function browser(){}return browser.scrollbar_width=function(){return this._scrollbar_width||(this._scrollbar_width=((outerStyle=(outer=document.createElement("div")).style).position="absolute",outerStyle.width="100px",outerStyle.height="100px",outerStyle.overflow="scroll",outerStyle.top="-9999px",document.body.appendChild(outer),w=outer.offsetWidth-outer.clientWidth,document.body.removeChild(outer),w));var outer,outerStyle,w},browser.info=function(){return this._info||(this._info=null!=window.bowser?this._extend_info(window.bowser):this._extend_info()),this._info},browser._extend_info=function(data){return null==data&&(data={}),data.os=this.os(),data},browser.os=function(){return this._os||(this._os=(res={},(ua=window.navigator.userAgent).indexOf("Windows")>-1?(res.windows=!0,(matches=_win_version_rxp.exec(ua))&&(res.version=_win_version[matches[1]])):ua.indexOf("Macintosh")>-1?(res.macos=!0,(matches=_mac_os_version_rxp.exec(ua))&&(res.version=matches[1])):ua.indexOf("X11")>-1?res.unix=!0:(matches=_ios_rxp.exec(ua))?(res[matches[1]]=!0,(matches=_ios_version_rxp.exec(ua))&&(res.version=matches[1])):ua.indexOf("Android")>-1?(res.android=!0,(matches=_android_version_rxp.exec(ua))&&(res.version=matches[1])):ua.indexOf("Tizen")>-1?res.tizen=!0:ua.indexOf("Blackberry")>-1&&(res.blackberry=!0),res.version&&(res.version=res.version.replace(/(_|\-)/g,".")),res));var matches,res,ua},browser}()},{"../pi":48,"./base":49}],51:[function(require,module){"use strict";var History;History=function(){function History(){this._storage=[],this._position=0}return History.prototype.push=function(item){return this._position<0&&(this._storage.splice(this._storage.length+this._position,-this._position),this._position=0),this._storage.push(item)},History.prototype.pop=function(){return this._position-=1,this._storage[this._storage.length+this._position]},History.prototype.size=function(){return this._storage.length},History.prototype.clear=function(){return this._storage.length=0,this._position=0},History}(),module.exports=History},{}],52:[function(require){"use strict";require("./base"),require("./time"),require("./logger"),require("./matchers"),require("./browser")},{"./base":49,"./browser":50,"./logger":53,"./matchers":54,"./time":55}],53:[function(require){"use strict";var level,pi,utils,_log_levels,_show_log,__slice=[].slice
;for(level in pi=require("../pi"),require("./base"),require("./time"),utils=pi.utils,window.console&&window.console.log||(window.console={log:function(){return!0}}),pi.log_level||(pi.log_level="info"),_log_levels={error:{color:"#dd0011",sort:4},debug:{color:"#009922",sort:0},info:{color:"#1122ff",sort:1},warning:{color:"#ffaa33",sort:2}},_show_log=function(level){return _log_levels[pi.log_level].sort<=_log_levels[level].sort},utils.log=function(){var level,messages;return level=arguments[0],messages=2<=arguments.length?__slice.call(arguments,1):[],_show_log(level)&&console.log("%c "+utils.time.now("%H:%M:%S:%L")+" ["+level+"]","color: "+_log_levels[level].color,messages)},_log_levels)_log_levels[level],utils[level]=utils.curry(utils.log,level)},{"../pi":48,"./base":49,"./time":55}],54:[function(require){"use strict";var pi,utils,_key_operand,_operands,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty;pi=require("../pi"),require("./base"),utils=pi.utils,_operands={"?":function(values){return function(value){return __indexOf.call(values,value)>=0}},"?&":function(values){return function(value){var v,_i,_len;for(_i=0,_len=values.length;_i<_len;_i++)if(v=values[_i],!(__indexOf.call(value,v)>=0))return!1;return!0}},">":function(val){return function(value){return value>=val}},"<":function(val){return function(value){return value<=val}},"~":function(val){return"string"==typeof val&&(val=new RegExp(utils.escapeRegexp(val))),function(value){return val.test(value)}}},_key_operand=/^([\w\d_]+)(\?&|>|<|~|\?)$/,pi.utils.matchers=function(){function matchers(){}return matchers.object=function(obj,all){var key,val,_fn,_this;for(key in null==all&&(all=!0),_this=this,_fn=function(key,val){return null==val?obj[key]=function(value){return!value}:"object"==typeof val?obj[key]=_this.object(val,all):"function"!=typeof val?obj[key]=function(value){return val===value}:void 0},obj)val=obj[key],_fn(key,val);return function(item){var _any;if(null==item)return!1;for(key in _any=!1,obj)if((0,obj[key])(item[key])){if(_any=!0,!all)return _any}else if(all)return!1;return _any}},matchers.nod=function(string){var query,regexp,selectors,_ref;return string.indexOf(":")>0?(_ref=string.split(":"),selectors=_ref[0],query=_ref[1],regexp=new RegExp(query,"i"),selectors=selectors.split(","),function(item){var selector,_i,_len,_ref1;for(_i=0,_len=selectors.length;_i<_len;_i++)if(selector=selectors[_i],null!=(_ref1=item.find(selector))?_ref1.text().match(regexp):void 0)return!0;return!1}):(regexp=new RegExp(string,"i"),function(item){return!!item.text().match(regexp)})},matchers.object_ext=function(obj,all){var key,matchers,matches,val;for(key in null==all&&(all=!0),matchers={},obj)__hasProp.call(obj,key)&&(null==(val=obj[key])||"object"!=typeof val||Array.isArray(val)?(matches=key.match(_key_operand))?matchers[matches[1]]=_operands[matches[2]](val):matchers[key]=val:matchers[key]=this.object_ext(val,all));return this.object(matchers,all)},matchers}()},{"../pi":48,"./base":49}],55:[function(require){"use strict";var pi,utils,_formatter,_pad,_reg,_splitter;pi=require("../pi"),require("./base"),utils=pi.utils,_reg=/%([a-zA-Z])/g,_splitter=0==="%a".split(_reg).length?function(str){var flag,len,matches,parts,res;for(matches=str.match(_reg),parts=str.split(_reg),res=[],"%"===str[0]&&res.push("",matches.shift()[1]),len=matches.length+parts.length,flag=!1;len>0;)res.push(flag?matches.shift()[1]:parts.shift()),flag=!flag,len--;return res}:function(str){return str.split(_reg)},_pad=function(val,offset){var n;for(null==offset&&(offset=1),n=10;offset;)val<n&&(val="0"+val),n*=10,offset--;return val},_formatter={H:function(d){return _pad(d.getHours())},k:function(d){return d.getHours()},I:function(d){return _pad(_formatter.l(d))},l:function(d){var h;return(h=d.getHours())>12?h-12:h},M:function(d){return _pad(d.getMinutes())},S:function(d){return _pad(d.getSeconds())},L:function(d){return _pad(d.getMilliseconds(),2)},z:function(d){var offset,sign;return sign=(offset=d.getTimezoneOffset())>0?"-":"+",offset=Math.abs(offset),sign+_pad(Math.floor(offset/60))+":"+_pad(offset%60)},Y:function(d){return d.getFullYear()},y:function(d){return(d.getFullYear()+"").slice(2)},m:function(d){return _pad(d.getMonth()+1)},d:function(d){return _pad(d.getDate())},P:function(d){return d.getHours()>11?"PM":"AM"},p:function(d){return _formatter.P(d).toLowerCase()}},utils.time={now:function(fmt){return this.format(new Date,fmt)},format:function(t,fmt){var flag,fmt_arr,i,res,_i,_len;if(null==fmt)return t;for(flag=!1,res="",_i=0,_len=(fmt_arr=_splitter(fmt)).length;_i<_len;_i++)i=fmt_arr[_i],res+=flag?_formatter[i].call(null,t):i,flag=!flag;return res}}},{"../pi":48,"./base":49}],56:[function(require){"use strict";var pi,utils;pi=require("../core"),require("./net"),utils=pi.utils,pi.net.IframeUpload=function(){function IframeUpload(){}return IframeUpload._build_iframe=function(id){var iframe;return(iframe=pi.Nod.create("iframe")).attrs({id:id,name:id,width:0,height:0,border:0}),iframe.styles({width:0,height:0,border:"none"}),iframe},IframeUpload._build_input=function(name,value){var input;return(input=pi.Nod.create("input")).node.type="hidden",input.node.name=name,input.node.value=value,input},IframeUpload._build_form=function(form,iframe,params,url,method){var param,_i,_len;for(form.attrs({target:iframe,action:url,method:method,enctype:"multipart/form-data",encoding:"multipart/form-data"}),_i=0,_len=params.length;_i<_len;_i++)param=params[_i],form.append(this._build_input(param.name,param.value));return form.append(this._build_input("__iframe__",iframe)),form},IframeUpload.upload=function(form,url,params,method){return new Promise((_this=this,function(resolve){var iframe,iframe_id;return iframe_id="iframe_"+utils.uid(),iframe=_this._build_iframe(iframe_id),form=_this._build_form(form,iframe_id,params,url,method),pi.Nod.body.append(iframe),iframe.on("load",function(){var response;if("complete"===iframe.node.contentDocument.readyState)return response=iframe.node.contentDocument.getElementsByTagName("body")[0],utils.after(500,function(){return iframe.remove()}),iframe.off(),resolve(response)}),form.node.submit()}));var _this},IframeUpload}()},{"../core":46,"./net":58}],57:[function(require){"use strict";require("./net"),require("./iframe.upload")},{"./iframe.upload":56,"./net":58}],58:[function(require){"use strict";var method,pi,utils,_i,_len,_ref,__hasProp={}.hasOwnProperty;for(pi=require("../core"),utils=pi.utils,pi.Net=function(){function Net(){}return Net._prepare_response=function(xhr){var response,type;return type=xhr.getResponseHeader("Content-Type"),response=/json/.test(type)?JSON.parse(xhr.responseText):xhr.responseText,utils.debug("XHR response",xhr.responseText),response},Net._prepare_error=function(xhr){var type;return type=xhr.getResponseHeader("Content-Type"),/json/.test(type)?JSON.parse(xhr.responseText||'{"status":'+xhr.statusText+"}"):xhr.responseText||xhr.statusText},Net._is_app_error=function(status){return status>=400&&status<500},Net._is_success=function(status){return status>=200&&status<300||304===status},Net._with_prefix=function(prefix,key){return prefix?prefix+"["+key+"]":key},Net._to_params=function(data,prefix){var item,key,params,val,_i,_len;if(null==prefix&&(prefix=""),params=[],null==data)return params;if("object"!=typeof data)params.push({name:prefix,value:data});else if(data instanceof Date)params.push({name:prefix,value:data.getTime()});else if(data instanceof Array)for(prefix+="[]",_i=0,_len=data.length;_i<_len;_i++)item=data[_i],params=params.concat(this._to_params(item,prefix));else if(window.File&&(data instanceof File||data instanceof Blob))params.push({name:prefix,value:data});else for(key in data)__hasProp.call(data,key)&&(val=data[key],params=params.concat(this._to_params(val,this._with_prefix(prefix,key))));return params},Net._data_to_query=function(data){var param,q,_i,_len,_ref;for(q=[],_i=0,_len=(_ref=this._to_params(data)).length;_i<_len;_i++)param=_ref[_i],q.push(param.name+"="+encodeURIComponent(param.value));return q.join("&")},Net._data_to_form=window.FormData?function(data){var form,param,_i,_len,_ref;for(form=new FormData,_i=0,_len=(_ref=Net._to_params(data)).length;_i<_len;_i++)param=_ref[_i],form.append(param.name,param.value);return form}:function(data){return Net._data_to_query(data)},Net.use_json=!0,Net.method_override=!1,Net.headers=[],Net.request=function(method,url,data,options,xhr){return null==options&&(options={}),new Promise((_this=this,function(resolve,reject){var key,q,req,use_json,value,_headers;for(key in req=xhr||new XMLHttpRequest,use_json=null!=options.json?options.json:_this.use_json,_headers=utils.merge(pi.net.headers,options.headers||{}),"GET"===method?((q=_this._data_to_query(data))&&(url.indexOf("?")<0?url+="?":url+="&",url+=""+q),data=null):(!0===_this.method_override&&(data._method=method,_headers["X-HTTP-Method-Override"]=method,method="POST"),use_json?(_headers["Content-Type"]="application/json",null!=data&&(data=JSON.stringify(data))):data=_this._data_to_form(data)),req.open(method,url,!0),req.withCredentials=!!options.withCredentials,_headers)__hasProp.call(_headers,key)&&(value=_headers[key],req.setRequestHeader(key,value));return _headers=null,"function"==typeof options.progress&&(req.upload.onprogress=function(event){return value=event.lengthComputable?100*event.loaded/event.total:0,options.progress(Math.round(value))}),req.onreadystatechange=function(){if(4===req.readyState)return _this._is_success(req.status)?resolve(_this._prepare_response(req)):_this._is_app_error(req.status)?reject(Error(_this._prepare_error(req))):reject(Error("500 Internal Server Error"))},req.onerror=function(){reject(Error("Network Error"))},req.send(data)}));var _this},Net.upload=function(url,data,options,xhr){var method;if(null==data&&(data={}),null==options&&(options={}),!this.XHR_UPLOAD)throw Error("File upload not supported");return method=options.method||"POST",options.json=!1,this.request(method,url,data,options,xhr)},Net.iframe_upload=function(form,url,data,options){var as_json,method,_this;if(null==data&&(data={}),null==options&&(options={}),as_json=null!=options.as_json?options.as_json:this.use_json,form instanceof pi.Nod||(form=pi.Nod.create(form)),null==form)throw Error("Form is undefined");return method=options.method||"POST",new Promise((_this=this,function(resolve,reject){return pi.net.IframeUpload.upload(form,url,_this._to_params(data),method).then(function(response){return null==response&&reject(Error("Response is empty")),as_json||resolve(response.innerHtml),response=function(){try{return JSON.parse(response.innerHTML)}catch(_error){return JSON.parse(response.innerText)}}(),resolve(response)})["catch"](function(e){return reject(e)})}))},Net}(),pi.Net.XHR_UPLOAD=!!window.FormData,pi.net=pi.Net,_i=0,_len=(_ref=["get","post","patch","delete"]).length;_i<_len;_i++)method=_ref[_i],pi.net[method]=utils.curry(pi.net.request,[method.toUpperCase()],pi.net)},{"../core":46}],59:[function(require,module){"use strict";window.pi=require("./core"),require("./components"),require("./net"),require("./resources"),require("./controllers"),require("./views"),module.exports=window.pi},{"./components":16,"./controllers":33,"./core":46,"./net":57,"./resources":76,"./views":84}],60:[function(require){"use strict";require("./selectable"),require("./scrollable"),require("./renderable")},{"./renderable":61,"./scrollable":62,"./selectable":63}],61:[function(require){"use strict";var pi,utils,_renderer_reg,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/pieces"),require("../plugin"),utils=pi.utils,_renderer_reg=/(\w+)(?:\(([\w\-\/]+)\))?/,pi.Base.Renderable=function(_super){function Renderable(){return Renderable.__super__.constructor.apply(this,arguments)}return __extends(Renderable,_super),Renderable.prototype.id="renderable",Renderable.included=function(klass){var self;return self=this,klass.before_initialize(function(){return this.attach_plugin(self)})},Renderable.prototype.initialize=function(target){return this.target=target,Renderable.__super__.initialize.apply(this,arguments),this.target._renderer=this.find_renderer(),this.target.delegate_to(this,"render"),this},Renderable.prototype.render=function(data){var nod;return this.target.remove_children(),null!=data&&(null!=(nod=this.target._renderer.render(data,!1))?(this.target.append(nod),this.target.piecify(this.target)):utils.error("failed to render data for: "+this.target.pid+"}",data)),this.target},Renderable.prototype.find_renderer=function(){var klass,name,param,_ref;return null!=this.target.options.renderer&&_renderer_reg.test(this.target.options.renderer)&&((_ref=this.target.options.renderer.match(_renderer_reg))[0],name=_ref[1],param=_ref[2],null!=(klass=pi.Renderers[utils.camelCase(name)]))?new klass(param):new pi.Renderers.Base},Renderable}(pi.Plugin)},{"../../components/pieces":17,"../../core":46,"../plugin":73}],62:[function(require){"use strict";var Nod,binfo,pi,utils,_style_type,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/pieces"),require("../plugin"),utils=pi.utils,Nod=pi.Nod,_style_type={},binfo=utils.browser.info(),0===utils.browser.scrollbar_width()&&!binfo.webkit||binfo.msie&&(0|binfo.version)>9?(_style_type.padding=17,_style_type.position=17):utils.browser.scrollbar_width()>0?_style_type.position=17:binfo.chrome&&(_style_type.padding=7,_style_type.position=17),utils.info("scroller type",_style_type),pi.Base.Scrollable=function(_super){function Scrollable(){return Scrollable.__super__.constructor.apply(this,arguments)}return __extends(Scrollable,_super),Scrollable.prototype.id="scollable",Scrollable.prototype.initialize=function(pane){return this.pane=pane,this.content=this.pane.find(".pi-scroll-content"),this.content||(this.content=pi.Nod.create(this.pane.node.children[0]).addClass("pi-scroll-content")),this.create_scroller(),this.hide_native_scroller(),this.always_show=this.pane.hasClass("has-scroller"),this.setup_events(),this.update_thumb(),this},Scrollable.prototype.create_scroller=function(){return this.track=Nod.create("div").addClass("pi-scroll-track"),this.thumb=Nod.create("div").addClass("pi-scroll-thumb"),this.track.append(this.thumb),this.pane.append(this.track),this.pane.addClass("pi-scroll-pane")},Scrollable.prototype.hide_native_scroller=function(){var cssRule,currentPadding;return cssRule={},_style_type.padding&&(currentPadding=window.getComputedStyle(this.content.node,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),cssRule.paddingRight=+currentPadding+(utils.browser.scrollbar_width()||_style_type.padding)+"px"),_style_type.position&&(cssRule.right="-"+(utils.browser.scrollbar_width()||_style_type.position)+"px"),this.content.style(cssRule)},Scrollable.prototype.setup_events=function(){return this.content.on("mousewheel",this.scroll_listener()),this.pane.on("resize",this.resize_handler()),this.thumb.on("mousedown",this.thumb_mouse_down()),this.track.on("click",this.track_click())},Scrollable.prototype.scroll_listener=function(){return this._sl||(this._sl=(_this=this,function(e){return _this.update_thumb(e)}));var _this},Scrollable.prototype.resize_handler=function(){return this._resize_handler||(this._resize_handler=(_this=this,function(){return _this.update_thumb()}));var _this},Scrollable.prototype.thumb_mouse_down=function(){return this.__tmd||(this.__tmd=(_this=this,function(e){return e.cancel(),_this._wait_drag=utils.after(300,function(){return _this._startY=e.pageY,_this.track.addClass("is-active"),_this._start_point=_this.thumb.offset().y,utils.debug("start_move"),_this.update_scroll(),pi.Nod.root.on("mousemove",_this.track_mouse_move()),_this.track.off("click",_this.track_click()),_this.content.off("mousewheel",_this.scroll_listener()),_this._dragging=!0}),pi.Nod.root.on("mouseup",_this.mouse_up_listener())}));var _this},Scrollable.prototype.track_mouse_move=function(){return this.__tmm||(this.__tmm=(_this=this,function(e){return _this.update_scroll(e)}));var _this},Scrollable.prototype.track_click=function(){return this._tc||(this._tc=(_this=this,function(e){var ch,h,track_y,y;return h=_this.thumb.clientHeight(),ch=_this.content.clientHeight(),track_y=_this.track.y(),(y=e.pageY-track_y)>ch-h&&(y=ch-h),y<0&&(y=0),_this.thumb.moveY(y),_this.update_scroll()}));var _this},Scrollable.prototype.mouse_up_listener=function(){return this.__mul||(this.__mul=(_this=this,function(){return _this.track.removeClass("is-active"),clearTimeout(_this._wait_drag),utils.debug("stop_move"),pi.Nod.root.off("mousemove",_this.track_mouse_move()),pi.Nod.root.off("mouseup",_this.mouse_up_listener()),after(500,function(){return _this.track.on("click",_this.track_click())}),_this.content.on("mousewheel",_this.scroll_listener())}));var _this},Scrollable.prototype.update_scroll=function(e){var ch,h,sh,y;return h=this.thumb.clientHeight(),sh=this.content.scrollHeight(),ch=this.content.clientHeight(),this.content.scrollTop(),null!=e?((y=e.pageY-this._startY+this._start_point)>ch-h&&(y=ch-h),y<0&&(y=0),this.thumb.moveY(y)):y=this.thumb.offset().y,this._last_scroll=y/(ch-h)*(sh-ch),this.content.scrollY(this._last_scroll)},Scrollable.prototype.update_thumb=function(e){var ch,h,sh,st,y;return sh=this.content.scrollHeight(),ch=this.content.clientHeight(),st=this.content.scrollTop(),this._last_scroll=st,ch===sh?(this.thumb.hide(),void(this.always_show||this.track.hide())):(this.thumb.visible||(this.thumb.show(),this.always_show||this.track.show()),(y=st/(sh-ch)*(ch-(h=Math.max(20,ch*(ch/sh)))))<0||y>ch-h?void(null!=e&&e.cancel()):(null!=e&&0===y&&e.wheelDelta>0&&e.cancel(),this.thumb.moveY(y),this.thumb.height(h)))},Scrollable}(pi.Plugin)},{"../../components/pieces":17,"../../core":46,"../plugin":73}],63:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/pieces"),require("../plugin"),pi.utils,pi.Base.Selectable=function(_super){function Selectable(){return Selectable.__super__.constructor.apply(this,arguments)}return __extends(Selectable,_super),Selectable.prototype.id="selectable",Selectable.prototype.initialize=function(target){return this.target=target,Selectable.__super__.initialize.apply(this,arguments),this.__selected__=this.target.hasClass("is-selected"),this.target.on("click",this.click_handler()),this},Selectable.prototype.click_handler=function(){return this._click_handler||(this._click_handler=(_this=this,function(){if(_this.target.enabled)return _this.toggle_select(),!1}));var _this},Selectable.prototype.toggle_select=function(){return this.__selected__?this.deselect():this.select()},Selectable.prototype.select=function(){return this.__selected__||(this.__selected__=!0,this.target.addClass("is-selected"),this.target.trigger("selected",!0)),this},Selectable.prototype.deselect=function(){return this.__selected__&&(this.__selected__=!1,this.target.removeClass("is-selected"),this.target.trigger("selected",!1)),this},Selectable}(pi.Plugin)},{"../../components/pieces":17,"../../core":46,"../plugin":73}],64:[function(require){"use strict";require("./plugin"),require("./base"),require("./list")},{"./base":60,"./list":66,"./plugin":73}],65:[function(require){"use strict";var pi,utils,_is_continuation,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),utils=pi.utils,_is_continuation=function(prev,params){var key,val;for(key in prev)if(__hasProp.call(prev,key)&&(val=prev[key],params[key]!==val))return!1;return!0},pi.List.Filterable=function(_super){function Filterable(){return Filterable.__super__.constructor.apply(this,arguments)}return __extends(Filterable,_super),Filterable.prototype.id="filterable",Filterable.prototype.initialize=function(list){var _this;return this.list=list,Filterable.__super__.initialize.apply(this,arguments),this.list.delegate_to(this,"filter"),this.list.on("update",(_this=this,function(e){return _this.item_updated(e.data.item)}),this,function(_this){return function(e){return("item_added"===e.data.type||"item_updated"===e.data.type)&&e.data.item.host===_this.list}}(this)),this},Filterable.prototype.item_updated=function(item){return!!this.matcher&&(this._all_items.indexOf(item)<0&&this._all_items.unshift(item),this.matcher(item)?void 0:(this.filtered&&this.list.remove_item(item,!0,!1),!1))},Filterable.prototype.all_items=function(){return this._all_items.filter(function(item){return!item._disposed})},Filterable.prototype.start_filter=function(){if(!this.filtered)return this.filtered=!0,this.list.addClass("is-filtered"),this._all_items=this.list.items.slice(),this._prevf={},this.list.trigger("filter_start")},Filterable.prototype.stop_filter=function(rollback){if(null==rollback&&(rollback=!0),this.filtered)return this.filtered=!1,this.list.removeClass("is-filtered"),rollback&&this.list.data_provider(this.all_items(),!1,!1),this._all_items=null,this.matcher=null,this.list.trigger("filter_stop")},Filterable.prototype.filter=function(params){var item,scope,_buffer;return null==params?this.stop_filter():(this.filtered||this.start_filter(),scope=_is_continuation(this._prevf,params)?this.list.items.slice():this.all_items(),this._prevf=params,this.matcher=utils.matchers.object_ext({record:params}),_buffer=function(){var _i,_len,_results;for(_results=[],_i=0,_len=scope.length;_i<_len;_i++)item=scope[_i],this.matcher(item)&&_results.push(item);return _results}.call(this),this.list.data_provider(_buffer,!1,!1),this.list.trigger("filter_update"))},Filterable}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73}],66:[function(require){"use strict";require("./selectable"),require("./sortable"),require("./searchable"),require("./filterable"),require("./scrollend"),require("./move_select"),require("./nested_select")},{"./filterable":65,"./move_select":67,"./nested_select":68,"./scrollend":69,"./searchable":70,"./selectable":71,"./sortable":72}],67:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),require("./selectable"),utils=pi.utils,pi.List.MoveSelect=function(_super){function MoveSelect(){return MoveSelect.__super__.constructor.apply(this,arguments)}return __extends(MoveSelect,_super),MoveSelect.prototype.id="move_select",MoveSelect.prototype.initialize=function(list){return this.list=list,MoveSelect.__super__.initialize.apply(this,arguments),this.list.has_selectable||this.list.attach_plugin(pi.List.Selectable),this._direction=this.list.options.direction||"y",this.list.on("mousedown",this.mouse_down_listener()),this},MoveSelect.prototype._item_under_point=function(point){return this._item_bisearch(0,point[this._direction],point)},MoveSelect.prototype._item_bisearch=function(start,delta,point){var index,index_shift,item,match;return 0===(index_shift=delta/this._height*this._len|0)&&(index_shift=delta>0?1:-1),(index=start+index_shift)<0?0:index>this._len-1?this._len-1:(item=this.list.items[index],0===(match=this._item_match_point(item,point))?index:this._item_bisearch(index,match,point))},MoveSelect.prototype._item_match_point=function(item,point){var item_x,item_y,param,pos,_ref;return item_x=(_ref=item.position()).x,item_y=_ref.y,pos={x:item_x-this._offset.x,y:item_y-this._offset.y},param="y"===this._direction?item.height():item.width(),point[this._direction]>=pos[this._direction]&&pos[this._direction]+param>point[this._direction]?0:point[this._direction]-pos[this._direction]},MoveSelect.prototype._update_range=function(index){var below,downward;if(index!==this._last_index){switch((this._last_index-this._start_index)*(index-this._start_index)<0&&this._update_range(this._start_index),utils.debug("next index: "+index+"; last index: "+this._last_index+"; start: "+this._start_index),downward=index-this._last_index>0,below=this._last_index!==this._start_index?this._last_index-this._start_index>0:downward,utils.debug("below: "+below+"; downward: "+downward),!1){case!(downward&&below):this._select_range(this._last_index+1,index);break;case!(!downward&&!below):this._select_range(index,this._last_index-1);break;case!(downward&&!below):this._clear_range(this._last_index,index-1);break;default:this._clear_range(index+1,this._last_index)}return this._last_index=index}},MoveSelect.prototype._clear_range=function(from,to){var item,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=this.list.items.slice(from,+to+1||9e9)).length;_i<_len;_i++)item=_ref[_i],_results.push(this.list.deselect_item(item));return _results},MoveSelect.prototype._select_range=function(from,to){var item,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=this.list.items.slice(from,+to+1||9e9)).length;_i<_len;_i++)item=_ref[_i],_results.push(this.list.select_item(item));return _results},MoveSelect.prototype.mouse_down_listener=function(){return this._mouse_down_listener||(this._mouse_down_listener=(_this=this,function(e){var _ref,_x,_y;return _x=(_ref=_this.list.items_cont.position()).x,_y=_ref.y,_this._offset={x:_x,y:_y},_this._start_point={x:e.pageX-_x,y:e.pageY-_y},_this._wait_drag=utils.after(300,function(){return _this._height=_this.list.height(),_this._len=_this.list.items.length,_this._start_index=_this._item_under_point(_this._start_point),_this._last_index=_this._start_index,_this.list.clear_selection(!0),_this.list.select_item(_this.list.items[_this._start_index]),_this.list.trigger("selected"),_this.list.on("mousemove",_this.mouse_move_listener()),_this._moving=!0}),pi.Nod.root.on("mouseup",_this.mouse_up_listener())}));var _this},MoveSelect.prototype.mouse_up_listener=function(){return this._mouse_up_listener||(this._mouse_up_listener=(_this=this,function(e){return pi.Nod.root.off("mouseup",_this.mouse_up_listener()),_this._moving?(_this.list.off("mousemove",_this.mouse_move_listener()),_this._moving=!1,e.stopImmediatePropagation(),e.preventDefault()):clearTimeout(_this._wait_drag)}));var _this},MoveSelect.prototype.mouse_move_listener=function(){return this._mouse_move_listener||(this._mouse_move_listener=debounce(300,(_this=this,function(e){var point;return point={x:e.pageX-_this._offset.x,y:e.pageY-_this._offset.y},_this._update_range(_this._item_under_point(point))})));var _this},MoveSelect.prototype.dispose=function(){return pi.Nod.root.off("mouseup",this.mouse_up_listener())},MoveSelect}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73,"./selectable":71}],68:[function(require){"use strict";var pi,_null,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),require("./selectable"),pi.utils,_null=function(){},pi.List.NestedSelect=function(_super){function NestedSelect(){return NestedSelect.__super__.constructor.apply(this,arguments)}return __extends(NestedSelect,_super),NestedSelect.prototype.id="nested_select",NestedSelect.prototype.initialize=function(list){var _this;return this.list=list,pi.Plugin.prototype.initialize.apply(this,arguments),this.selectable=this.list.selectable||{select_all:_null,clear_selection:_null,type:_null,_selected_item:null,enable:_null,disable:_null},this.list.delegate_to(this,"clear_selection","select_all","selected","where","select_item","deselect_item"),!0!==this.list.has_selectable&&this.list.delegate_to(this,"selected_records","selected_record","selected_item","selected_size"),this.enabled=!0,null!=this.list.options.no_select&&this.disable(),this.type(this.list.options.nested_select_type||""),this.list.on("selection_cleared,selected",(_this=this,function(e){var item;return _this._watching_radio&&"selected"===e.type&&(item=e.target===_this.list?_this.selectable._selected_item:e.data[0].host.selectable._selected_item,_this.update_radio_selection(item)),e.target!==_this.list&&(e.cancel(),_this._check_selected())})),this},NestedSelect.prototype.enable=function(){var item,_i,_len,_ref,_ref1,_results;if(!this.enabled){for(this.enabled=!0,this.selectable.enable(),_results=[],_i=0,_len=(_ref=this.list.find_cut(".pi-list")).length;_i<_len;_i++)item=_ref[_i],_results.push(null!=(_ref1=item._nod.selectable)?_ref1.enable():void 0);return _results}},NestedSelect.prototype.disable=function(){var item,_i,_len,_ref,_ref1,_results;if(this.enabled){for(this.enabled=!1,this.selectable.disable(),_results=[],_i=0,_len=(_ref=this.list.find_cut(".pi-list")).length;_i<_len;_i++)item=_ref[_i],_results.push(null!=(_ref1=item._nod.selectable)?_ref1.disable():void 0);return _results}},NestedSelect.prototype.select_item=function(item,force){var _ref;if(null==force&&(force=!1),!item.__selected__)return this._watching_radio&&this.clear_selection(!0),null!=(_ref=item.host.selectable)&&"function"==typeof _ref.select_item&&_ref.select_item(item,force),this._check_selected(),item},NestedSelect.prototype.deselect_item=function(item,force){var _ref;if(null==force&&(force=!1),item.__selected__)return null!=(_ref=item.host.selectable)&&"function"==typeof _ref.deselect_item&&_ref.deselect_item(item,force),this._check_selected(),item},NestedSelect.prototype.where=function(query){var item,ref,_i,_len,_ref;for(ref=pi.List.prototype.where.call(this.list,query),_i=0,_len=(_ref=this.list.find_cut(".pi-list")).length;_i<_len;_i++)item=_ref[_i],ref=ref.concat(item._nod.where(query));return ref},NestedSelect.prototype.type=function(value){return this.is_radio=!!value.match("radio"),this.is_radio?this.enable_radio_watch():this.disable_radio_watch()},NestedSelect.prototype.enable_radio_watch=function(){return this._watching_radio=!0},NestedSelect.prototype.disable_radio_watch=function(){return this._watching_radio=!1},NestedSelect.prototype.update_radio_selection=function(item){item&&this._prev_selected_list!==item.host&&(this._prev_selected_list=item.host,this.list.selected().length>1&&(this.list.clear_selection(!0),item.host.select_item(item)))},NestedSelect.prototype.clear_selection=function(silent,force){var _base,_i,_len,_ref;for(null==silent&&(silent=!1),null==force&&(force=!1),this.selectable.clear_selection(silent,force),_i=0,_len=(_ref=this.list.find_cut(".pi-list")).length;_i<_len;_i++)"function"==typeof(_base=_ref[_i]._nod).clear_selection&&_base.clear_selection(silent,force);if(!silent)return this.list.trigger("selection_cleared")},NestedSelect.prototype.select_all=function(silent,force){var _base,_i,_len,_ref,_selected;for(null==silent&&(silent=!1),null==force&&(force=!1),this.selectable.select_all(!0,force),_i=0,_len=(_ref=this.list.find_cut(".pi-list")).length;_i<_len;_i++)"function"==typeof(_base=_ref[_i]._nod).select_all&&_base.select_all(!0,force);if(!silent&&(_selected=this.selected()).length)return this.list.trigger("selected",_selected)},NestedSelect.prototype.selected=function(){var item,sublist,sublists,_i,_j,_len,_len1,_ref,_ref1,_selected;for(_selected=[],_i=0,_len=(_ref=this.list.items).length;_i<_len;_i++)if((item=_ref[_i]).__selected__&&_selected.push(item),item instanceof pi.List)_selected=_selected.concat(("function"==typeof item.selected?item.selected():void 0)||[]);else if(sublists=item.find_cut(".pi-list"))for(_j=0,_len1=sublists.length;_j<_len1;_j++)sublist=sublists[_j],
_selected=_selected.concat((null!=(_ref1=sublist._nod)&&"function"==typeof _ref1.selected?_ref1.selected():void 0)||[]);return _selected},NestedSelect}(pi.List.Selectable)},{"../../components/base/list":6,"../../core":46,"../plugin":73,"./selectable":71}],69:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),utils=pi.utils,pi.List.ScrollEnd=function(_super){function ScrollEnd(){return ScrollEnd.__super__.constructor.apply(this,arguments)}return __extends(ScrollEnd,_super),ScrollEnd.prototype.id="scroll_end",ScrollEnd.prototype.initialize=function(list){var _this;return this.list=list,ScrollEnd.__super__.initialize.apply(this,arguments),this.scroll_object="window"===this.list.options.scroll_object?pi.Nod.win:this.list.options.scroll_object?pi.$(this.list.options.scroll_object):this.list.items_cont,this._prev_top=this.scroll_object.scrollTop(),!1!==this.list.options.scroll_end&&this.enable(),this.list.on("update",this.scroll_listener(),this,(_this=this,function(e){return _this.enabled&&("item_removed"===e.data.type||"load"===e.data.type)})),this},ScrollEnd.prototype.enable=function(){if(!this.enabled)return this.scroll_object.on("scroll",this.scroll_listener()),this.enabled=!0},ScrollEnd.prototype.disable=function(){if(this.enabled)return this.__debounce_id__&&clearTimeout(this.__debounce_id__),!0!==this.scroll_object._disposed&&this.scroll_object.off("scroll",this.scroll_listener()),this._scroll_listener=null,this.enabled=!1},ScrollEnd.prototype.scroll_listener=function(){return this._scroll_listener||(this._scroll_listener=utils.debounce(500,(_this=this,function(){return!_this.list._disposed&&(_this._prev_top<=_this.scroll_object.scrollTop()&&_this.list.height()-_this.scroll_object.scrollTop()-_this.scroll_object.height()<50&&_this.list.trigger("scroll_end"),_this._prev_top=_this.scroll_object.scrollTop(),!1)}),this));var _this},ScrollEnd.prototype.dispose=function(){return this.disable()},ScrollEnd}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73}],70:[function(require){"use strict";var pi,utils,_clear_mark_regexp,_is_continuation,_selector_regexp,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),utils=pi.utils,_clear_mark_regexp=/<mark>([^<>]*)<\/mark>/gim,_selector_regexp=/[\.#a-z\s\[\]=\"-_,]/i,_is_continuation=function(prev,query){var _ref;return 0===(null!=(_ref=utils.escapeRegexp(query).match(utils.escapeRegexp(prev)))?_ref.index:void 0)},pi.List.Searchable=function(_super){function Searchable(){return Searchable.__super__.constructor.apply(this,arguments)}return __extends(Searchable,_super),Searchable.prototype.id="searchable",Searchable.prototype.initialize=function(list){var _this;return this.list=list,Searchable.__super__.initialize.apply(this,arguments),this.update_scope(this.list.options.search_scope),this.list.delegate_to(this,"search","highlight"),this.searching=!1,this.list.on("update",(_this=this,function(e){return _this.item_updated(e.data.item)}),this,function(_this){return function(e){return("item_added"===e.data.type||"item_updated"===e.data.type)&&e.data.item.host===_this.list}}(this)),this},Searchable.prototype.item_updated=function(item){return!!this.matcher&&(this._all_items.indexOf(item)<0&&this._all_items.unshift(item),this.matcher(item)?void this.highlight_item(this._prevq,item):(this.searching&&this.list.remove_item(item,!0,!1),!1))},Searchable.prototype.update_scope=function(scope){return this.matcher_factory=this._matcher_from_scope(scope),scope&&_selector_regexp.test(scope)?this._highlight_elements=function(item){var selector,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=scope.split(",")).length;_i<_len;_i++)selector=_ref[_i],_results.push(item.find(selector));return _results}:this._highlight_elements=function(item){return[item]}},Searchable.prototype._matcher_from_scope=function(scope){return this.matcher_factory=null==scope?function(value){return utils.matchers.nod(value)}:function(value){return utils.matchers.nod(scope+":"+value)}},Searchable.prototype.all_items=function(){return this._all_items.filter(function(item){return!item._disposed})},Searchable.prototype.start_search=function(){if(!this.searching)return this.searching=!0,this.list.addClass("is-searching"),this._all_items=this.list.items.slice(),this._prevq="",this.list.trigger("search_start")},Searchable.prototype.stop_search=function(rollback){var items;if(null==rollback&&(rollback=!0),this.searching)return this.searching=!1,this.list.removeClass("is-searching"),items=this.all_items(),this.__highlighted__&&this.clear_highlight(items),this.__highlighted__=!1,rollback&&this.list.data_provider(items,!1,!1),this._all_items=null,this.matcher=null,this.list.trigger("search_stop")},Searchable.prototype.clear_highlight=function(nodes){var nod,_i,_len,_raw_html,_results;for(_results=[],_i=0,_len=nodes.length;_i<_len;_i++)_raw_html=(_raw_html=(nod=nodes[_i]).html()).replace(_clear_mark_regexp,"$1"),_results.push(nod.html(_raw_html));return _results},Searchable.prototype.highlight_item=function(query,item){var nod,nodes,_i,_len,_raw_html,_regexp,_results;for(_results=[],_i=0,_len=(nodes=this._highlight_elements(item)).length;_i<_len;_i++)null!=(nod=nodes[_i])&&(_raw_html=nod.html(),_regexp=new RegExp("((?:^|>)[^<>]*?)("+query+")","gim"),_raw_html=_raw_html.replace(_clear_mark_regexp,"$1"),""!==query&&(_raw_html=_raw_html.replace(_regexp,"$1<mark>$2</mark>")),_results.push(nod.html(_raw_html)));return _results},Searchable.prototype.highlight=function(q){var item,_i,_len,_ref;for(this._prevq=q,this.__highlighted__=!0,_i=0,_len=(_ref=this.list.items).length;_i<_len;_i++)item=_ref[_i],this.highlight_item(q,item)},Searchable.prototype.search=function(q,highlight){var item,scope,_buffer;return null==q&&(q=""),""===q?this.stop_search():(null==highlight&&(highlight=this.list.options.highlight),this.searching||this.start_search(),scope=_is_continuation(this._prevq,q)?this.list.items.slice():this.all_items(),this._prevq=q,this.matcher=this.matcher_factory(utils.escapeRegexp(q)),_buffer=function(){var _i,_len,_results;for(_results=[],_i=0,_len=scope.length;_i<_len;_i++)item=scope[_i],this.matcher(item)&&_results.push(item);return _results}.call(this),this.list.data_provider(_buffer,!1,!1),highlight&&this.highlight(q),this.list.trigger("search_update"))},Searchable}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73}],71:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),pi.utils,pi.List.Selectable=function(_super){function Selectable(){return Selectable.__super__.constructor.apply(this,arguments)}return __extends(Selectable,_super),Selectable.prototype.id="selectable",Selectable.prototype.initialize=function(list){var item,_i,_len,_ref,_this;for(this.list=list,Selectable.__super__.initialize.apply(this,arguments),this.list.merge_classes.push("is-selected"),this.type(this.list.options.select_type||"radio"),null==this.list.options.no_select&&this.enable(),_i=0,_len=(_ref=this.list.items).length;_i<_len;_i++)(item=_ref[_i]).hasClass("is-selected")&&(item.__selected__=!0);return this.list.delegate_to(this,"clear_selection","selected","selected_item","select_all","select_item","selected_records","selected_record","deselect_item","toggle_select","selected_size"),this.list.on("update",(_this=this,function(){return _this._selected=null,_this._check_selected(),!1}),this,function(e){return"item_added"!==e.data.type}),this},Selectable.prototype.enable=function(){if(!this.enabled)return this.enabled=!0,this.list.on("item_click",this.item_click_handler())},Selectable.prototype.disable=function(){if(this.enabled)return this.enabled=!1,this.list.off("item_click",this.item_click_handler())},Selectable.prototype.type=function(value){return this.is_radio=!!value.match("radio"),this.is_check=!!value.match("check")},Selectable.prototype.item_click_handler=function(){return this._item_click_handler||(this._item_click_handler=(_this=this,function(e){_this.list.toggle_select(e.data.item,!0),e.data.item.enabled&&_this._check_selected()}));var _this},Selectable.prototype._check_selected=function(){return this.list.selected().length?this.list.trigger("selected",this.list.selected()):this.list.trigger("selection_cleared")},Selectable.prototype.select_item=function(item,force){if(null==force&&(force=!1),!item.__selected__&&(item.enabled||!force))return this.is_radio&&force&&this.clear_selection(!0),item.__selected__=!0,this._selected_item=item,this._selected=null,item.addClass("is-selected")},Selectable.prototype.deselect_item=function(item,force){if(null==force&&(force=!1),item.__selected__&&(item.enabled&&this.is_check||!force))return item.__selected__=!1,this._selected=null,this._selected_item===item&&(this._selected_item=null),item.removeClass("is-selected")},Selectable.prototype.toggle_select=function(item,force){return item.__selected__?this.deselect_item(item,force):this.select_item(item,force)},Selectable.prototype.clear_selection=function(silent,force){var item,_i,_len,_ref;for(null==silent&&(silent=!1),null==force&&(force=!1),_i=0,_len=(_ref=this.list.items).length;_i<_len;_i++)((item=_ref[_i]).enabled||force)&&this.deselect_item(item);if(!silent)return this.list.trigger("selection_cleared")},Selectable.prototype.select_all=function(silent,force){var item,_i,_len,_ref;for(null==silent&&(silent=!1),null==force&&(force=!1),_i=0,_len=(_ref=this.list.items).length;_i<_len;_i++)((item=_ref[_i]).enabled||force)&&this.select_item(item);if(this.selected().length&&!silent)return this.list.trigger("selected",this.selected())},Selectable.prototype.selected=function(){return null==this._selected&&(this._selected=this.list.where({__selected__:!0})),this._selected},Selectable.prototype.selected_item=function(){var _ref;return(_ref=this.list.selected()).length?_ref[0]:null},Selectable.prototype.selected_records=function(){return this.list.selected().map(function(item){return item.record})},Selectable.prototype.selected_record=function(){var _ref;return(_ref=this.list.selected_records()).length?_ref[0]:null},Selectable.prototype.selected_size=function(){return this.list.selected().length},Selectable}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73}],72:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../components/base/list"),require("../plugin"),utils=pi.utils,pi.List.Sortable=function(_super){function Sortable(){return Sortable.__super__.constructor.apply(this,arguments)}return __extends(Sortable,_super),Sortable.prototype.id="sortable",Sortable.prototype.initialize=function(list){var _fn,_i,_len,_ref,_this;if(this.list=list,Sortable.__super__.initialize.apply(this,arguments),null!=this.list.options.sort){for(this._prevs=[],_ref=this.list.options.sort.split(","),_this=this,_fn=function(param){var data,key,order,_ref1;return data={},key=(_ref1=param.split(":"))[0],order=_ref1[1],data[key]=order,_this._prevs.push(data)},_i=0,_len=_ref.length;_i<_len;_i++)_fn(_ref[_i]);this._compare_fun=function(_this){return function(a,b){return utils.keys_compare(a.record,b.record,_this._prevs)}}(this)}return this.list.delegate_to(this,"sort"),this.list.on("update",function(_this){return function(e){return _this.item_updated(e.data.item)}}(this),this,function(_this){return function(e){return("item_added"===e.data.type||"item_updated"===e.data.type)&&e.data.item.host===_this.list}}(this)),this.list.on("update",function(_this){return function(){return _this.resort()}}(this),this,function(_this){return function(e){return"load"===e.data.type&&e.target===_this.list}}(this)),this},Sortable.prototype.item_updated=function(item){return!!this._compare_fun&&(this._bisect_sort(item,0,this.list.size()-1),!1)},Sortable.prototype._bisect_sort=function(item,left,right){var a,i;if(!(right-left<2))return i=left+(right-left)/2|0,a=this.list.items[i],this._compare_fun(item,a)>0?left=i:right=i,this._bisect_sort(item,left,right);this._compare_fun(item,this.list.items[left])>0?this.list.move_item(item,right):this.list.move_item(item,left)},Sortable.prototype.clear=function(){return this._compare_fun=null},Sortable.prototype.resort=function(){return!!this._compare_fun&&(this.list.items.sort(this._compare_fun),this.list.data_provider(this.list.items.slice(),!0,!1))},Sortable.prototype.sort=function(sort_params){if(null!=sort_params)return sort_params=utils.to_a(sort_params),this._prevs=sort_params,this._compare_fun=function(a,b){return utils.keys_compare(a.record,b.record,sort_params)},this.list.items.sort(this._compare_fun),this.list.data_provider(this.list.items.slice(),!0,!1),this.list.trigger("sort_update",sort_params)},Sortable.prototype.sorted=function(sort_params){if(null!=sort_params)return sort_params=utils.to_a(sort_params),this._prevs=sort_params,this._compare_fun=function(a,b){return utils.keys_compare(a.record,b.record,sort_params)},this.list.trigger("sort_update",sort_params)},Sortable}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../plugin":73}],73:[function(require){"use strict";var pi,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};(pi=require("../core")).utils,pi.Plugin=function(_super){function Plugin(){return Plugin.__super__.constructor.apply(this,arguments)}return __extends(Plugin,_super),Plugin.prototype.id="",Plugin.included=function(klass){var self;return self=this,klass.after_initialize(function(){return this.attach_plugin(self)})},Plugin.attached=function(instance){return(new this).initialize(instance)},Plugin.prototype.initialize=function(instance){return instance[this.id]=this,instance["has_"+this.id]=!0,this},Plugin.prototype.dispose=function(){return!0},Plugin}(pi.Core)},{"../core":46}],74:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base"),require("./view"),utils=pi.utils,pi.resources.Association=function(_super){function Association(resources,scope,options){var _this;this.resources=resources,this.options=null!=options?options:{},Association.__super__.constructor.apply(this,arguments),this._only_update=!1,this.owner=this.options.owner,!0===options.belongs_to?options.owner._persisted?this.owner_name_id=this.options.key:(this._only_update=!0,this.options.owner.one("create",(_this=this,function(){var _i,_len,_ref,_ref1;for(_this._only_update=!1,_this.owner=_this.options.owner,_this.owner_name_id=_this.options.key,_i=0,_len=(_ref=_this.__all__).length;_i<_len;_i++)_ref[_i].set(utils.wrap(_this.owner_name_id,_this.owner.id),!0);if(!1!==_this.options._scope)return null!=(null!=(_ref1=_this.options._scope)?_ref1[_this.options.key]:void 0)?_this.options.scope=utils.merge(_this.options._scope,utils.wrap(_this.options.key,_this.owner.id)):_this.options.scope=utils.wrap(_this.options.key,_this.owner.id),_this.reload()}))):this.options.scope||(this._only_update=!0)}return __extends(Association,_super),Association.prototype.clear_all=function(){return this.options.route&&(this.owner[this.options.name+"_loaded"]=!1),Association.__super__.clear_all.apply(this,arguments)},Association.prototype.reload=function(){if(this.clear_all(),this.options.scope)return this._filter=utils.matchers.object_ext(this.options.scope),this.load(this.options.source.where(this.options.scope))},Association.prototype.build=function(data,silent,params){return null==data&&(data={}),null==silent&&(silent=!1),null==params&&(params={}),!0===this.options.belongs_to&&(null==data[this.owner_name_id]&&(data[this.owner_name_id]=this.owner.id),data instanceof pi.resources.Base||(data=this.resources.build(data,!1))),Association.__super__.build.call(this,data,silent,params)},Association.prototype.on_update=function(el){return this.get(el.id)?!1===this.options.copy?this.trigger("update",this._wrap(el)):Association.__super__.on_update.apply(this,arguments):!1===this._only_update?this.build(el):void 0},Association.prototype.on_destroy=function(el){return!1===this.options.copy?(this.trigger("destroy",this._wrap(el)),this.remove(el,!0,!1)):Association.__super__.on_destroy.apply(this,arguments)},Association.prototype.on_create=function(el){var view_item;return(view_item=this.get(el.id)||this.get(el.__tid__))?(this.created(view_item,el.__tid__),!1===this.options.copy?this.trigger("create",this._wrap(el)):view_item.set(el.attributes())):this._only_update?void 0:this.build(el)},Association.prototype.on_load=function(){if(!this._only_update)return this.options.scope?(this.load(this.resources.where(this.options.scope)),this.trigger("load",{})):void 0},Association}(pi.resources.View)},{"../core":46,"./base":75,"./view":82}],75:[function(require){"use strict";var pi,utils,_singular,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};pi=require("../core"),utils=pi.utils,pi.resources={},pi["export"](pi.resources,"$r"),_singular=function(str){return str.replace(/s$/,"")},pi.resources.Base=function(_super){function Base(data){null==data&&(data={}),Base.__super__.constructor.apply(this,arguments),this._changes={},null==data.id||data.__temp__||(this._persisted=!0),this.initialize(data)}return __extends(Base,_super),Base.set_resource=function(plural,singular){return this.__all_by_id__={},this.__all_by_tid__={},this.__all__=[],this.resources_name=plural,this.resource_name=singular||_singular(plural)},Base.register_association=function(name){return null!=this.prototype.__associations__?this.prototype.__associations__=this.prototype.__associations__.slice():this.prototype.__associations__=[],this.prototype.__associations__.push(name)},Base.load=function(data,silent){var el,elements;if(null==silent&&(silent=!1),null!=data)return elements=function(){var _i,_len,_results;for(_results=[],_i=0,_len=data.length;_i<_len;_i++)el=data[_i],_results.push(this.build(el,!0));return _results}.call(this),silent||this.trigger("load",{}),elements},Base.from_data=function(data){if(null!=data[this.resource_name]&&(data[this.resource_name]=this.build(data[this.resource_name])),null!=data[this.resources_name])return data[this.resources_name]=this.load(data[this.resources_name])},Base.clear_all=function(){var _i,_len,_ref;for(_i=0,_len=(_ref=this.__all__).length;_i<_len;_i++)_ref[_i].dispose();return this.__all_by_id__={},this.__all_by_tid__={},this.__all__.length=0},Base.get=function(id){return this.__all_by_id__[id]||this.__all_by_tid__[id]},Base.get_by=function(params){var ref;if(null!=params)return(ref=this.where(params)).length?ref[0]:null},Base.add=function(el){if(!this.get(el.id))return!0===el.__temp__?this.__all_by_tid__[el.id]=el:this.__all_by_id__[el.id]=el,this.__all__.push(el)},Base.build=function(data,silent,add){var el;return null==data&&(data={}),null==silent&&(silent=!1),null==add&&(add=!0),data.id&&(el=this.get(data.id))?el.set(data,silent):(data.id||(data.id="tid_"+utils.uid(),data.__temp__=!0),el=new this(data),add&&(this.add(el),silent||el.__temp__||this.trigger("create",this._wrap(el))),el)},Base.created=function(el,temp_id){if(this.__all_by_tid__[temp_id])return delete this.__all_by_tid__[temp_id],this.__all_by_id__[el.id]=el},Base.clear_temp=function(silent){var el,_,_ref;for(_ in null==silent&&(silent=!1),_ref=this.__all_by_tid__)__hasProp.call(_ref,_)&&(el=_ref[_],this.remove(el,silent));return this.__all_by_tid__={}},Base.remove_by_id=function(id){var el;return null!=(el=this.get(id))&&this.remove(el),!1},Base.remove=function(el,silent,disposed){return null==disposed&&(disposed=!0),null!=this.__all_by_id__[el.id]?delete this.__all_by_id__[el.id]:delete this.__all_by_tid__[el.id],this.__all__.splice(this.__all__.indexOf(el),1),silent||this.trigger("destroy",this._wrap(el)),disposed&&el.dispose(),!0},Base.listen=function(callback,filter){return pi.event.on(this.resources_name+"_update",callback,null,filter)},Base.trigger=function(event,data){return data.type=event,pi.event.trigger(this.resources_name+"_update",data,!1)},Base.off=function(callback){return null!=callback?pi.event.off(this.resources_name+"_update",callback):pi.event.off(this.resources_name+"_update")},Base.all=function(){return this.__all__.slice()},Base.where=function(params){var el,_i,_len,_ref,_results;for(_results=[],_i=0,_len=(_ref=this.__all__).length;_i<_len;_i++)el=_ref[_i],utils.matchers.object_ext(params)(el)&&_results.push(el);return _results},Base._wrap=function(el){return el instanceof pi.resources.Base?utils.wrap(el.constructor.resource_name,el):el},Base.prototype.initialize=function(data){if(!this._initialized)return this.set(data,!0),this._initialized=!0},Base.register_callback("initialize"),Base.prototype.created=function(temp_id){return this.constructor.created(this,temp_id)},Base.prototype.dispose=function(){var key;if(!this.disposed){for(key in this)__hasProp.call(this,key)&&(this[key],delete this[key]);return this.disposed=!0,this}},Base.register_callback("dispose",{as:"destroy"}),Base.prototype.remove=function(silent){return null==silent&&(silent=!1),this.constructor.remove(this,silent)},Base.prototype.attributes=function(){var change,key,res,_ref;for(key in res={},_ref=this._changes)change=_ref[key],res[key]=change.val;return res},Base.prototype.association=function(name){var _ref;return(null!=(_ref=this.__associations__)?_ref.indexOf(name):void 0)>-1},Base.prototype.set=function(params,silent){var key,type,val,_changed,_old_id,_was_id;for(key in _changed=!1,_was_id=!(!this.id||!0===this.__temp__),_old_id=this.id,params)__hasProp.call(params,key)&&(val=params[key],this[key]===val||"function"==typeof this[key]||null!=this.__associations__&&__indexOf.call(this.__associations__,key)>=0||(_changed=!0,this._changes[key]={old_val:this[key],val:val},this[key]=val));return 0|this.id&&!_was_id?(delete this.__temp__,this._persisted=!0,this.__tid__=_old_id,type="create",this.created(_old_id)):type="update",_changed&&!silent&&this.trigger(type,"create"===type?this:this._changes),this},Base.register_callback("set",{as:"update"}),Base.prototype.trigger=function(e,data,bubbles){return null==bubbles&&(bubbles=!1),Base.__super__.trigger.apply(this,arguments),this.constructor.trigger(e,this.constructor._wrap(this))},Base.prototype.trigger_assoc_event=function(name,type,data){return"function"==typeof this["on_"+name+"_update"]&&this["on_"+name+"_update"].call(this,type,data),this.trigger("update",utils.wrap(name,!0))},Base}(pi.EventDispatcher)},{"../core":46}],76:[function(require){"use strict";require("./base"),require("./view"),require("./association"),require("./rest"),require("./modules")},{"./association":74,"./base":75,"./modules":79,"./rest":81,"./view":82}],77:[function(require){"use strict";var pi,utils,_true;pi=require("../../core"),require("../rest"),utils=pi.utils,_true=function(){return!0},pi.resources.HasMany=function(){function HasMany(){}return HasMany.extended=function(){return!0},HasMany.has_many=function(name,params){var _old,_update_filter;if(null==params)throw Error("Has many require at least 'source' param");if(utils.extend(params,{path:":resources/:id/"+name,method:"get"}),this.register_association(name),"function"==typeof params.update_if?_update_filter=params.update_if:!0===params.update_if&&(_update_filter=_true),this.prototype[name]=function(){var default_scope,options,_this;return null==this["__"+name+"__"]&&(options={name:name,owner:this},!0===params.belongs_to&&(options.key=params.key||this.constructor.resource_name+"_id",null==params.copy&&(options.copy=!1),options._scope=params.scope,default_scope=utils.wrap(options.key,this.id),null==params.scope?options.scope=!!this._persisted&&default_scope:options.scope=params.scope,null!=params.params&&params.params.push(this.constructor.resource_name+"_id")),utils.extend(options,params),this["__"+name+"__"]=new pi.resources.Association(params.source,options.scope,options),!1!==options.scope&&this["__"+name+"__"].load(params.source.where(options.scope)),params.update_if&&this["__"+name+"__"].listen((_this=this,function(e){var data;if(data=e.data[params.source.resources_name]||e.data[params.source.resource_name],_update_filter(e.data.type,data))return _this.trigger_assoc_event(name,e.data.type,data)}))),this["__"+name+"__"]},!0===params.route&&(this.routes({member:[{action:"load_"+name,path:params.path,method:params.method}]}),this.prototype["on_load_"+name]=function(data){if(this[name+"_loaded"]=!0,null!=data[name])return this[name]().load(data[name])}),this.after_update(function(data){if(!(data instanceof pi.resources.Base))return data[name]?(this[name+"_loaded"]=!0,this[name]().load(data[name])):void 0}),this.after_initialize(function(){return this[name]()}),!0===params.destroy&&this.before_destroy(function(){return this[name]().clear_all(!0)}),!0===params.attribute)return _old=this.prototype.attributes,this.prototype.attributes=function(){var data;return(data=_old.call(this))[name]=this[name]().serialize(),data}},HasMany}()},{"../../core":46,"../rest":81}],78:[function(require){"use strict";var pi,utils,_false,_true;pi=require("../../core"),require("../rest"),utils=pi.utils,_true=function(){return!0},_false=function(){return!1},pi.resources.HasOne=function(){function HasOne(){}return HasOne.extended=function(){return!0},HasOne.has_one=function(name,params){var bind_fun,resource_name,_old,_update_filter,_this;if(null==params)throw Error("Has one require at least 'source' param");if(params.foreign_key||(params.foreign_key=this.resource_name+"_id"),resource_name=params.source.resource_name,bind_fun="bind_"+name,this.register_association(name),_update_filter="function"==typeof params.update_if?params.update_if:!0===params.update_if?_true:_false,params.source.listen((_this=this,function(e){var el,target,_i,_len,_ref,_results;if(_this.all().length){if("load"===(e=e.data).type){for(_results=[],_i=0,_len=(_ref=params.source.all()).length;_i<_len;_i++)(el=_ref[_i])[params.foreign_key]&&(target=_this.get(el[params.foreign_key]))&&target.association(name)?_results.push(target[bind_fun](el)):_results.push(void 0);return _results}return(el=e[resource_name])[params.foreign_key]&&(target=_this.get(el[params.foreign_key]))&&target.association(name)&&("destroy"===e.type?delete _this[name]:"create"===e.type&&target[bind_fun](el,!0),_update_filter(e,el))?target.trigger_assoc_event(name,e.type,utils.wrap(name,_this[name])):void 0}})),this.prototype[bind_fun]=function(el,silent){if(null==silent&&(silent=!1),null!=el)return this[name]=el,this._persisted&&!this[name][params.foreign_key]&&(this[name][params.foreign_key]=this.id),!silent&&_update_filter(null,el)?this.trigger_assoc_event(name,"create",utils.wrap(name,this[name])):void 0},this.after_initialize(function(){var el;if(this._persisted&&(el=params.source.get_by(utils.wrap(params.foreign_key,this.id))))return this[bind_fun](el,!0)}),this.after_update(function(data){var el;if(!(data instanceof pi.resources.Base))return this._persisted&&!this[name]&&(el=params.source.get_by(utils.wrap(params.foreign_key,this.id)))&&this[bind_fun](el,!0),data[name]?this[name]instanceof pi.resources.Base?this[name].set(data[name]):this[bind_fun](params.source.build(data[name])):void 0}),!0===params.destroy&&this.before_destroy(function(){var _ref;return null!=(_ref=this[name])?_ref.remove():void 0}),!0===params.attribute)return _old=this.prototype.attributes,this.prototype.attributes=function(){var data;return(data=_old.call(this))[name]=this[name].attributes(),data}},HasOne}()},{"../../core":46,"../rest":81}],79:[function(require){"use strict";require("./query"),require("./has_many"),require("./has_one")},{"./has_many":77,"./has_one":78,"./query":80}],80:[function(require){"use strict";var pi;pi=require("../../core"),require("../rest"),pi.utils,pi.resources.Query=function(){function Query(){}return Query.extended=function(klass){return klass.query_path=klass.fetch_path},Query.query=function(params){return this._request(this.query_path,"get",params).then((_this=this,function(response){return _this.on_all(response)}));var _this},Query}()},{"../../core":46,"../rest":81}],81:[function(require){"use strict";var pi,utils,_double_slashes_reg,_path_reg,_tailing_slash_reg,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;pi=require("../core"),require("./base"),utils=pi.utils,_path_reg=/:(\w+)\b/g,_double_slashes_reg=/\/\//,_tailing_slash_reg=/\/$/,pi.resources.REST=function(_super){function REST(data){REST.__super__.constructor.apply(this,arguments),this._snapshot=data}return __extends(REST,_super),REST._rscope="/:path",REST.prototype.wrap_attributes=!1,REST.can_create=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],this.__deps__=(this.__deps__||(this.__deps__=[])).concat(args)},REST.prototype.__filter_params__=!1,REST.params=function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],this.prototype.hasOwnProperty("__filter_params__")||(this.prototype.__filter_params__=[],this.prototype.__filter_params__.push("id")),this.prototype.__filter_params__=this.prototype.__filter_params__.concat(args)},REST.set_resource=function(){return REST.__super__.constructor.set_resource.apply(this,arguments),this.routes({collection:[{action:"show",path:":resources/:id",method:"get"},{action:"fetch",path:":resources",method:"get"}],member:[{action:"update",path:":resources/:id",method:"patch"},{action:"__destroy",path:":resources/:id",method:"delete"},{action:"create",path:":resources",method:"post"}]}),this.prototype.destroy_path=":resources/:id"},REST.routes=function(data){var spec,_fn,_i,_j,_len,_len1,_ref,_ref1,_results,_this;if(null!=data.collection)for(_ref=data.collection,_this=this,_fn=function(spec){return _this[spec.action]=function(params){return null==params&&(params={}),this._request(spec.path,spec.method,params).then((_this=this,function(response){var _j,_len1,_ref1;if(null!=_this.__deps__)for(_j=0,_len1=(_ref1=_this.__deps__).length;_j<_len1;_j++)_ref1[_j].from_data(response);return null!=_this["on_"+spec.action]?_this["on_"+spec.action](response):_this.on_all(response)}));var _this},_this[spec.action+"_path"]=spec.path},_i=0,_len=_ref.length;_i<_len;_i++)_fn(spec=_ref[_i]);if(null!=data.member){for(_results=[],_j=0,_len1=(_ref1=data.member).length;_j<_len1;_j++)spec=_ref1[_j],_results.push(function(_this){return function(spec){return _this.prototype[spec.action]=function(params){return null==params&&(params={}),this.constructor._request(spec.path,spec.method,utils.merge(params,{id:this.id}),this).then((_this=this,function(response){var _k,_len2,_ref2;if(null!=_this.constructor.__deps__)for(_k=0,
_len2=(_ref2=_this.constructor.__deps__).length;_k<_len2;_k++)_ref2[_k].from_data(response);return null!=_this["on_"+spec.action]?_this["on_"+spec.action](response):_this.on_all(response)}));var _this},_this.prototype[spec.action+"_path"]=spec.path}}(this)(spec));return _results}},REST.routes_scope=function(scope){return this._rscope=scope},REST._interpolate_path=function(path,params,target){var flag,part,path_parts,val,vars,_i,_len;for(path_parts=(path=this._rscope.replace(":path",path).replace(_double_slashes_reg,"/").replace(_tailing_slash_reg,"")).split(_path_reg),vars=this.prototype.wrap_attributes&&null!=params[this.resource_name]&&"object"==typeof params[this.resource_name]?utils.extend(params[this.resource_name],params,!1,[this.resource_name]):params,path="",flag=!1,_i=0,_len=path_parts.length;_i<_len;_i++){if(part=path_parts[_i],flag){if(null==(val=null!=vars[part]?vars[part]:null!=target?target[part]:void 0))throw Error("undefined param: "+part);path+=val}else path+=part;flag=!flag}return path},REST.error=function(action,message){return pi.event.trigger("net_error",{resource:this.resources_name,action:action,message:message})},REST._request=function(path,method,params,target){return path=this._interpolate_path(path,utils.merge(params,{resources:this.resources_name,resource:this.resource_name}),target),pi.net[method].call(null,path,params)["catch"]((_this=this,function(error){throw _this.error(error.message),error}));var _this},REST.on_all=function(data){return null!=data[this.resources_name]&&(data[this.resources_name]=this.load(data[this.resources_name])),data},REST.on_show=function(data){var el;if(null!=data[this.resource_name])return(el=this.build(data[this.resource_name])).commit(),el},REST.build=function(){return REST.__super__.constructor.build.apply(this,arguments)},REST.find=function(id){var el;return null!=(el=this.get(id))?utils.resolved_promise(el):this.show({id:id})},REST.find_by=function(params){var el;return null!=(el=this.get_by(params))?utils.resolved_promise(el):this.show(params)},REST.create=function(data){return this.build(data).save()},REST.prototype.destroy=function(){return this._persisted?this.__destroy():utils.as_promise((_this=this,function(){return _this.remove()}));var _this},REST.prototype.on_destroy=function(data){return this.constructor.remove(this),data},REST.alias("on___destroy","on_destroy"),REST.prototype.on_all=function(data){var params;if(null!=(params=data[this.constructor.resource_name])&&params.id===this.id)return this.set(params),this.commit(),this},REST.prototype.on_create=function(data){var params;if(null!=(params=data[this.constructor.resource_name]))return this.set(params,!0),this.commit(),this.trigger("create"),this},REST.prototype.attributes=function(){return this.__attributes__changed__&&(this.__filter_params__?this.__attributes__=utils.extract({},this,this.__filter_params__):this.__attributes__=REST.__super__.attributes.apply(this,arguments)),this.__attributes__},REST.prototype.set=function(){return this.__attributes__changed__=!0,REST.__super__.set.apply(this,arguments)},REST.prototype.save=function(params){var attrs;return null==params&&(params={}),attrs=this.attributes(),utils.extend(attrs,params,!0),attrs=this.wrap_attributes?this._wrap(attrs):attrs,this._persisted?this.update(attrs):this.create(attrs)},REST.prototype.commit=function(){var key,param,_i,_len,_ref;for(param=_i=0,_len=(_ref=this._changes).length;_i<_len;param=++_i)key=_ref[param],this._snapshot[key]=param.val;return this._changes={},this._snapshot},REST.prototype.rollback=function(){var key,param,_i,_len,_ref;for(param=_i=0,_len=(_ref=this._changes).length;_i<_len;param=++_i)this[key=_ref[param]]=this._snapshot[key]},REST.register_callback("save"),REST.prototype._wrap=function(attributes){var data;return(data={})[this.constructor.resource_name]=attributes,data},REST}(pi.resources.Base)},{"../core":46,"./base":75}],82:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base"),utils=pi.utils,pi.resources.ViewItem=function(_super){function ViewItem(view,data,options){this.view=view,this.options=null!=options?options:{},ViewItem.__super__.constructor.apply(this,arguments),null!=this.options.params&&this.options.params.indexOf("id")<0&&this.options.params.push("id"),this._changes={},this.set(data,!0)}return __extends(ViewItem,_super),utils.extend(ViewItem.prototype,pi.resources.Base.prototype,!1),ViewItem.prototype.created=function(tid){return this.view.created(this,tid)},ViewItem.prototype.trigger=function(e,data,bubbles){return null==bubbles&&(bubbles=!0),ViewItem.__super__.trigger.apply(this,arguments),this.view.trigger(e,this.view._wrap(this))},ViewItem.prototype.attributes=function(){var data;return null!=this.options.params?(data=utils.extract({},this,this.options.params),null!=this.options.id_alias&&(this.options.id_alias&&(data[this.options.id_alias]=data.id),delete data.id),data):pi.resources.Base.prototype.attributes.call(this)},ViewItem}(pi.EventDispatcher),pi.resources.View=function(_super){function View(resources,scope,options){var _this;this.resources=resources,this.options=null!=options?options:{},View.__super__.constructor.apply(this,arguments),this.__all_by_id__={},this.__all_by_tid__={},this.__all__=[],this.resources_name=this.resources.resources_name,this.resource_name=this.resources.resource_name,this._filter=null!=scope&&!1!==scope?utils.matchers.object_ext(scope):function(){return!0},this.resources.listen((_this=this,function(e){var el,_name;if(null==(el=e.data[_this.resource_name])||_this._filter(el))return"function"==typeof _this[_name="on_"+e.data.type]?_this[_name](el):void 0}))}return __extends(View,_super),utils.extend(View.prototype,pi.resources.Base),View.prototype.on_update=function(el){var view_item;if(view_item=this.get(el.id))return view_item.set(el.attributes())},View.prototype.on_destroy=function(el){var view_item;if(view_item=this.get(el.id))return this.remove(view_item)},View.prototype.clear_all=function(force){var _i,_j,_len,_len1,_ref,_ref1;if(null==force&&(force=!1),!1!==this.options.copy||!1!==force)if(force&&!this.options.copy)for(this.__all_by_id__={},this.__all_by_tid__={},_i=0,_len=(_ref=this.__all__).length;_i<_len;_i++)_ref[_i].remove();else for(_j=0,_len1=(_ref1=this.__all__).length;_j<_len1;_j++)_ref1[_j].dispose();return this.__all_by_id__={},this.__all_by_tid__={},this.__all__.length=0},View.prototype.build=function(data,silent,params){var el;return null==data&&(data={}),null==silent&&(silent=!1),null==params&&(params={}),(el=this.get(data.id))?el.set(data,silent):(data instanceof pi.resources.Base&&!1===this.options.copy?el=data:(data instanceof pi.resources.Base&&(data=data.attributes()),utils.extend(data,params,!0),el=new pi.resources.ViewItem(this,data,this.options)),el.id&&(this.add(el),silent||this.trigger("create",this._wrap(el))),el)},View.prototype._wrap=function(el){return el instanceof pi.resources.ViewItem?utils.wrap(el.view.resource_name,el):el instanceof pi.resources.Base?utils.wrap(el.constructor.resource_name,el):el},View.prototype.serialize=function(){var el,res,_i,_len,_ref;for(res=[],_i=0,_len=(_ref=this.all()).length;_i<_len;_i++)el=_ref[_i],res.push(el.attributes());return res},View.prototype.listen=function(callback){return this.on("update",callback)},View.prototype.trigger=function(event,data){return data.type=event,View.__super__.trigger.call(this,"update",data)},View.prototype.off=function(callback){return View.__super__.off.call(this,"update",callback)},View}(pi.EventDispatcher)},{"../core":46,"./base":75}],83:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("../components/pieces"),(utils=pi.utils).extend(pi.Base.prototype,{view:function(){return this.__view__||(this.__view__=this._find_view())},_find_view:function(){var comp;for(comp=this.host;comp;){if(!0===comp.is_view)return comp;comp=comp.host}}}),pi.BaseView=function(_super){function BaseView(){return BaseView.__super__.constructor.apply(this,arguments)}return __extends(BaseView,_super),BaseView.prototype.is_view=!0,BaseView.prototype.initialize=function(){var controller_klass;return controller_klass=null,this.options.controller&&(controller_klass=utils.get_class_path(pi.controllers,this.options.controller)),controller_klass||(controller_klass=this.default_controller),null!=controller_klass?this.controller=new controller_klass(this):utils.warning("controller not found",controller_klass),BaseView.__super__.initialize.apply(this,arguments)},BaseView.prototype.postinitialize=function(){var _view;if(BaseView.__super__.postinitialize.apply(this,arguments),null!=this.controller)return((_view=this.view())?_view.controller:pi.app.page).add_context(this.controller,this.options.main)},BaseView.prototype.loaded=function(){},BaseView.prototype.reloaded=function(){},BaseView.prototype.switched=function(){},BaseView.prototype.unloaded=function(){},BaseView}(pi.Base)},{"../components/pieces":17,"../core":46}],84:[function(require){"use strict";require("./base"),require("./plugins"),require("./modules"),require("./list.view")},{"./base":83,"./list.view":85,"./modules":86,"./plugins":90}],85:[function(require){"use strict";var pi,utils,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../core"),require("./base"),utils=pi.utils,pi.ListView=function(_super){function ListView(){return ListView.__super__.constructor.apply(this,arguments)}return __extends(ListView,_super),ListView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ListView.prototype.error=function(message){return utils.error(message)},ListView.prototype.success=function(message){return utils.info(message)},ListView}(pi.BaseView)},{"../core":46,"./base":83}],86:[function(require){"use strict";require("./listable"),require("./loadable")},{"./listable":87,"./loadable":88}],87:[function(require){"use strict";var pi,utils;pi=require("../../core"),require("./../base"),utils=pi.utils,pi.BaseView.Listable=function(){function Listable(){}return Listable.included=function(klass){return klass.requires("list")},Listable.prototype.sort=function(params){return this.list.sort(params)},Listable.prototype.clear_sort=function(){return this.list.sortable.clear()},Listable.prototype.sorted=function(params){if(null!=params)return this.list.sortable.sorted(params)},Listable.prototype.search=function(query){return this._query=query,this.list.search(query,!0)},Listable.prototype.searched=function(query){if(utils.debug("loaded search "+query),this.list.searchable.start_search(),this.list.highlight(query),!query)return this.list.searchable.stop_search(!1)},Listable.prototype.filter=function(data){return this.list.filter(data)},Listable.prototype.filtered=function(data){return utils.debug("loaded filter",data),this.list.filterable.start_filter(),null!=data?this.list.trigger("filter_update"):this.list.filterable.stop_filter(!1)},Listable.prototype.clear=function(){var _ref;return utils.debug("clear list"),this.list.clear(),this.list.clear_selection(),null!=(_ref=this.list.scroll_end)?_ref.disable():void 0},Listable.prototype.load=function(data){var item,_i,_len;for(_i=0,_len=data.length;_i<_len;_i++)item=data[_i],this.list.add_item(item,!0);return this.list.update()},Listable.prototype.reload=function(data){if(this.list.data_provider(data),this._query)return this.searched(this._query)},Listable}()},{"../../core":46,"./../base":83}],88:[function(require){"use strict";var pi;pi=require("../../core"),require("./../base"),pi.utils,pi.BaseView.Loadable=function(){function Loadable(){}return Loadable.included=function(klass){return klass.requires("loader")},Loadable.prototype.loading=function(value){return!0===value?(this.loader.reset(),this.loader.start(),this.loader.simulate()):!1===value?this.loader.stop():void 0},Loadable}()},{"../../core":46,"./../base":83}],89:[function(require){"use strict";var pi,utils,_app_rxp,_finder_rxp,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../plugins/plugin"),require("../../components/pieces"),utils=pi.utils,_finder_rxp=/^(\w+)\.find\(([tid\_\d]+)\)$/,_app_rxp=/^app\.([\.\w]+)$/,pi.Base.Restful=function(_super){function Restful(){return Restful.__super__.constructor.apply(this,arguments)}return __extends(Restful,_super),Restful.prototype.id="restful",Restful.prototype.initialize=function(target){var matches,resources,rest,_this;return this.target=target,Restful.__super__.initialize.apply(this,arguments),this.target.has_renderable||this.target.attach_plugin(pi.Base.Renderable),null!=(rest=this.target.options.rest)&&((matches=rest.match(_app_rxp))?new Promise(function(resolve,reject){var res;return(res=utils.get_path(pi.app,matches[1]))?resolve(res):reject(res)}):(matches=rest.match(_finder_rxp))?null!=(resources=utils.get_path($r,matches[1]))?resources.find(matches[2]):utils.rejected_promise():void 0).then((_this=this,function(resource){return _this.bind(resource,!_this.target.firstChild)}),function(_this){return function(){return utils.error("resource not found: "+rest,_this.target.options.rest)}}(this)),this},Restful.prototype.bind=function(resource,render){if(null==render&&(render=!1),this.resource&&(this.resource.off("update",this.resource_update()),this.resource.off("create",this.resource_update())),this.resource=resource,this.resource)return this.resource.on("update,create",this.resource_update()),render?this.redraw(resource):void 0;this.redraw(null)},Restful.prototype.redraw=function(data){return this.target.render(data)},Restful.prototype.resource_update=function(){return this._resource_update||(this._resource_update=(_this=this,function(e){return utils.debug("Restful component event"),_this.on_update(e.currentTarget)}));var _this},Restful.prototype.on_update=function(data){return this.redraw(data)},Restful.prototype.dispose=function(){return this.bind(null)},Restful}(pi.Plugin)},{"../../components/pieces":17,"../../core":46,"../../plugins/plugin":73}],90:[function(require){"use strict";require("./base.restful"),require("./list.restful")},{"./base.restful":89,"./list.restful":91}],91:[function(require){"use strict";var pi,utils,_app_rxp,_where_rxp,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};pi=require("../../core"),require("../../plugins/plugin"),require("../../components/base/list"),utils=pi.utils,_where_rxp=/^(\w+)\.(where|find)\(([\w\s\,\:]+)\)(?:\.([\w]+))?$/i,_app_rxp=/^app\.([\.\w]+)\.(\w+)$/,pi.List.Restful=function(_super){function Restful(){return Restful.__super__.constructor.apply(this,arguments)}return __extends(Restful,_super),Restful.prototype.id="restful",Restful.prototype.initialize=function(list){var el,key,matches,ref,resources,rest,val,_i,_len,_name,_ref,_ref1,_this;if(this.list=list,Restful.__super__.initialize.apply(this,arguments),this.items_by_id={},this.listen_load=!0===this.list.options.listen_load,this.listen_create=null!=this.list.options.listen_create?this.list.options.listen_create:this.listen_load,null!=(rest=this.list.options.rest))if(matches=rest.match(_app_rxp))null!=(ref=utils.get_path(pi.app,matches[1]))&&(resources="function"==typeof ref[_name=matches[2]]?ref[_name]():void 0);else if(matches=rest.match(_where_rxp)){if(rest=matches[1],null!=(ref=$r[utils.camelCase(rest)]))if("where"===matches[2])for(resources=ref,this.scope={},_i=0,_len=(_ref=matches[3].split(/\s*\,\s*/)).length;_i<_len;_i++)key=(_ref1=_ref[_i].split(/\s*\:\s*/))[0],val=_ref1[1],this.scope[key]=utils.serialize(val);else"find"===matches[2]&&null!=(el=ref.get(matches[3]))&&"function"==typeof el[matches[4]]&&(resources=el[matches[4]]())}else resources=$r[utils.camelCase(rest)];return null!=resources&&this.bind(resources,this.list.options.load_rest,this.scope),this.list.delegate_to(this,"find_by_id"),this.list.on("destroyed",(_this=this,function(){return _this.bind(null),!1})),this},Restful.prototype.bind=function(resources,load,params){var filter,matcher,_this;return null==load&&(load=!1),this.resources&&this.resources.off(this.resource_update()),this.resources=resources,null==this.resources?(this.items_by_id={},void(this.list._disposed||this.list.clear())):(null!=params&&(matcher=utils.matchers.object(params),_this=this,filter=function(e){return"load"===e.data.type||matcher(e.data[_this.resources.resource_name])}),this.resources.listen(this.resource_update(),filter),load?null!=params?this.load(resources.where(params)):this.load(resources.all()):void 0)},Restful.prototype.find_by_id=function(id){var items;return this.listen_load&&null!=this.items_by_id[id]?this.items_by_id[id]:(items=this.list.where({record:{id:0|id}})).length?this.items_by_id[id]=items[0]:void 0},Restful.prototype.load=function(data){var item,_i,_len;for(_i=0,_len=data.length;_i<_len;_i++)item=data[_i],this.items_by_id[item.id]&&this.listen_load||(this.items_by_id[item.id]=this.list.add_item(item,!0));return this.list.update("load")},Restful.prototype.resource_update=function(){return this._resource_update||(this._resource_update=(_this=this,function(e){var _ref;return utils.debug("Restful list event",e.data.type),null!=(_ref=_this["on_"+e.data.type])?_ref.call(_this,e.data[_this.resources.resource_name]):void 0}));var _this},Restful.prototype.on_load=function(){if(this.listen_load)return null!=this.scope?this.load(this.resources.where(this.scope)):this.load(this.resources.all())},Restful.prototype.on_create=function(data){var item;if(this.listen_create)return this.find_by_id(data.id)?data.__tid__&&(item=this.find_by_id(data.__tid__))?(delete this.items_by_id[data.__tid__],this.items_by_id[data.id]=item,this.list.update_item(item,data)):void 0:this.items_by_id[data.id]=this.list.add_item(data)},Restful.prototype.on_destroy=function(data){var item;(item=this.find_by_id(data.id))&&(this.list.remove_item(item),delete this.items_by_id[data.id])},Restful.prototype.on_update=function(data){var item;if(item=this.find_by_id(data.id))return this.list.update_item(item,data)},Restful.prototype.dispose=function(){if(this.items_by_id={},null!=this.resources)return this.resources.off(this.resource_update())},Restful}(pi.Plugin)},{"../../components/base/list":6,"../../core":46,"../../plugins/plugin":73}]},{},[59]),function(){!function(context){"use strict";var orig_clear,orig_disable,orig_enable,pi;(pi=context.pi).utils,orig_disable=pi.BaseInput.prototype.disable,orig_enable=pi.BaseInput.prototype.enable,pi.BaseInput.prototype.disable=function(){return this.attr("disabled","disabled"),orig_disable.call(this)},pi.BaseInput.prototype.enable=function(){return this.attr("disabled",null),orig_enable.call(this)},orig_clear=pi.FileInput.prototype.clear,pi.FileInput.prototype.clear=function(){return this.input.value(""),orig_clear.call(this)}}(this)}.call(this),function(){!function(context){"use strict";var _old_query,pi;(pi=context.pi).utils.extend(pi.controllers.Base.prototype,{location:function(url,target){return null==url&&(url=window.location.href),null==target&&(target="_self"),window.open(url,target)},start_tour:function(force){return null==force&&(force=!1),pi.app.tour.run_for(this.id,force)},qs_params:function(){return null!=this._qs_params?this._qs_params:(this._qs_params={},window.location.search.replace(/(^\?)/,"").split("&").map((_this=this,function(n){return n=n.split("="),_this._qs_params[n[0]]=n[1]})),this._qs_params);var _this}}),_old_query=pi.controllers.ListController.prototype.query,pi.controllers.ListController.query=function(){return _old_query.apply(this,arguments)["catch"]((_this=this,function(e){throw _this._promise=null,e}));var _this}}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils.extend(pi.KeyEvent.prototype,{printable:function(){return this.keyCode>47&&this.keyCode<58||32===this.keyCode||13===this.keyCode||this.keyCode>64&&this.keyCode<91||this.keyCode>95&&this.keyCode<112||this.keyCode>185&&this.keyCode<193||this.keyCode>218&&this.keyCode<223}})}(this)}.call(this),function(){!function(context){"use strict";var orig_clear_nod,pi;(pi=context.pi).utils,orig_clear_nod=pi.Former.prototype._clear_nod,pi.Former.prototype._clear_nod=function(nod){if(/(input|select|textarea)/i.test(nod.nodeName)&&"submit"!==nod.type.toLowerCase())return orig_clear_nod.call(this,nod)}}(this)}.call(this),function(){!function(context){"use strict";var _bad_rxp,app,pi,status_handlers,utils;pi=context.pi,utils=pi.utils,app=pi.app,_bad_rxp=/(translation missing|internal server|<!doctype)/i,status_handlers={error:function(message){return utils.local_error("Error: "+message),_bad_rxp.test(message)?app.view.error.show(I18n.t("http_error.app_error")):app.view.error.show(message)},success:function(message){if(utils.info(message),!_bad_rxp.test(message))return app.view.success.show(message)}},utils.extend(pi.BaseView.prototype,status_handlers,!0),utils.extend(pi.ListView.prototype,status_handlers,!0)}(this)}.call(this),function(){var global,CODE,HTTP_DOMAIN,HTTP_INIT,HTTP_PREF,HTTP_PROTOCOL,HTTP_QUERY,MATH,TABLE_FOR_REESCAPE_HTML,URL_SUFFIX,_extract_domain,_extract_suffix,_normalize_url,_reescape_html;(global=window).JST||(global.JST={}),HTTP_PREF="(?:https?:\\/\\/|www\\.)",HTTP_PROTOCOL="(https?:\\/\\/)",HTTP_DOMAIN=(HTTP_INIT="\\d\\w\\u0100-\\u0171\\u0410-\\u044f\\=\\%")+"\\.\\-",HTTP_QUERY="\\&\\?\\=\\[\\]\\#\\;\\+\\:",URL_SUFFIX=new RegExp("([^\\/"+HTTP_INIT+"])$"),MATH=/(?:\$\$|\$|\()[\s\S]+(?:\$\$|\$|\()/gim,CODE=/<pre>.+<\/pre>/gim,TABLE_FOR_REESCAPE_HTML={"&amp;":"&","&quot;":'"',"&lt;":"<","&gt;":">","&nbsp;":" "},_normalize_url=function(url){return(url=_reescape_html(url).trim()).match(new RegExp("^"+HTTP_PROTOCOL))||(url="http://"+url),url},_extract_domain=function(url){return url.match(new RegExp("^"+HTTP_PREF+"([^\\/]*)"))[1]},_extract_suffix=function(url){var matches;return(matches=url.match(URL_SUFFIX))?[matches[1],url.replace(URL_SUFFIX,"")]:["",url]},_reescape_html=function(str){var key;for(key in TABLE_FOR_REESCAPE_HTML)str=str.replace(new RegExp(key,"g"),TABLE_FOR_REESCAPE_HTML[key]);return str},global.JST.parse_code=function(str){return str.indexOf("<code>")>-1?((""+str).replace(new RegExp("(^|</code>)([^<]*|<(?!code>))*(<code>|$)","igm"),function(match,pref,url){return global.JST.parseLinks(_reescape_html(url))}),str):global.JST.parseLinks(_reescape_html(str))},global.JST.html_encode=function(str){return str.indexOf("&lt;")>-1?str:str.replace(/[&<>"']/g,function($0){return"&"+{"&":"amp","<":"lt",">":"gt",'"':"quot","'":"#39"}[$0]+";"})},global.JST.strip_html=function(str){return global.JST.strip_math(pi.Nod.create("<div>"+global.JST.strip_code(str)+"</div>").text().replace(/\s\s+/gm," ").trim())},global.JST.strip_math=function(str){return(""+str).replace(MATH,"")},global.JST.strip_code=function(str){return(""+str).replace(CODE,"")},global.JST.sanitize=function(str){return(""+str).replace(/<\s*script[^>]*>/gim,"").replace(/<\s*\/\s*script\s*>/gim,"")},global.JST.tough_sanitize=function(str){return(""+str).replace(/<\s*script[^>]*>/gim,'<p style="color:red;">[For security reasons, using scripts is not allowed]</p>').replace(/<\s*\/\s*script\s*>/gim,"").replace(/<iframe(?!(.*?)youtube(.*?)<\/iframe>)(.*)/gim,'<p style="color:red;">[For security reasons, using iframe is not allowed]</p>')},global.JST.parseLinks=function(str){return(""+str).replace(new RegExp('(=\\"|\\b)('+HTTP_PREF+"["+HTTP_INIT+"]["+HTTP_DOMAIN+"]*\\.["+HTTP_INIT+"]{2,}(?:\\:\\d+)?["+HTTP_DOMAIN+"\\/"+HTTP_QUERY+"]*)","igm"),function(match,pref,url){var ref,suffix;return'="'===pref?pref+url:(url=_normalize_url(url),suffix=(ref=_extract_suffix(url))[0],"<a href='"+(url=ref[1])+"' target='_blank'>"+_extract_domain(url)+"</a>"+suffix)})},global.JST.currency=function(num){var frac,i,ref,triple,triples;for((num=""+num).indexOf(".")>-1?((ref=num.split("."))[0],frac=ref[1]):frac="00",triples=[],i=num.length;triple=num.substring(i-3,i);)triples.unshift(triple),i-=3;return triples.join(" ")+","+frac},global.JST.ava_name=function(fullname){var last_name,name,ref;return name=(ref=fullname.split(/\s+/))[0],last_name=ref[1],(name[0]||"").toUpperCase()+((null!=last_name?last_name[0]:void 0)||"").toUpperCase()}}.call(this),function(){!function(context){"use strict";var _extension,fn,i,len,pi,ref,utils;for(utils=(pi=context.pi).utils,_extension={},fn=function(method){return _extension[method+"_items"]=function(){var item,j,len1,ref1,results;for(results=[],j=0,len1=(ref1=this.items).length;j<len1;j++)item=ref1[j],results.push(item[""+method].call(item));return results}},i=0,len=(ref=["activate","deactivate"]).length;i<len;i++)fn(ref[i]);utils.extend(pi.List.prototype,_extension)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.NestedList=function(superClass){function NestedList(){return NestedList.__super__.constructor.apply(this,arguments)}return extend(NestedList,superClass),NestedList.prototype.initialize=function(){return utils.warning("NestedList is deprecated!"),NestedList.__super__.initialize.apply(this,arguments),this._group_key=this.options.group_key,this._groups={}},NestedList.prototype.add_item=function(data,silent){var group,item;if(data[this._group_key]=0|data[this._group_key],data[this._group_key]){if(!(group=this._groups[data[this._group_key]]))return void utils.warning("cannot add item: group not found",data);item=group.add_item(data,silent)}else item=NestedList.__super__.add_item.apply(this,arguments),this._groups[item.record.id]=item;return item},NestedList.prototype.add_item_at=function(data,index,silent){var group,item;if(data[this._group_key]=0|data[this._group_key],data[this._group_key]){if(!(group=this._groups[data[this._group_key]]))return void utils.warning("cannot add item: group not found",data);item=group.add_item_at(data,index,silent)}else item=NestedList.__super__.add_item_at.apply(this,arguments),this._groups[item.record.id]=item;return item},NestedList.prototype.remove_item=function(item,silent){var group;return item.record[this._group_key]?(group=this._groups[item.record[this._group_key]])?group.remove_item(item,silent):void utils.warning("cannot remove item: group not found",item):(delete this._groups[item.record.id],NestedList.__super__.remove_item.apply(this,arguments))},NestedList.prototype.update_item=function(item,data,silent){var group;return item.record[this._group_key]?(group=this._groups[item.record[this._group_key]])?group.update_item(item,data,silent):void utils.warning("cannot update item: group not found",item):((item=NestedList.__super__.update_item.apply(this,arguments)).piecify(),item)},NestedList.prototype.move_item=function(item,index){var group;return item.record[this._group_key]?(group=this._groups[item.record[this._group_key]])?group.move_item(item,index):void utils.warning("cannot update item: group not found",item):NestedList.__super__.move_item.apply(this,arguments)},NestedList}(pi.List)}(this)}.call(this),function(){var slice=[].slice;!function(context){"use strict";var _normalize_path,_orig_upload,_perf_wrap,i,len,method,net,pi,ref1,utils;for(pi=context.pi,utils=pi.utils,(net=pi.net)._active_req=0,_normalize_path=function(method,path){return method+path.replace(/\/\d+\/?/g,"/id/").replace(/(\?.*$|^https?\:\/\/[^\/]+|\.json)/g,"").replace(/\//g,"__")},_perf_wrap=function(target,method,path_index){var _orig;return _orig=target[method],target[method]=function(){var _skip,_start,args;return args=1<=arguments.length?slice.call(arguments,0):[],_start=+new Date,net._active_req+=1,_skip=pi.net.__skip_perf__,_orig.apply(this,args).then(function(data){var delta,page_id,ref1;return delta=+new Date-_start,page_id=_normalize_path(method,args[path_index]),utils.debug("Net Request: "+delta,page_id),!0!==_skip&&null!=(ref1=pi.app.perf)&&ref1.ajax_loaded(page_id,delta),data}).then(function(data){return net._active_req-=1,data})["catch"](function(e){throw net._active_req-=1,e})}},i=0,len=(ref1=["post","get","delete","patch"]).length;i<len;i++)method=ref1[i],_perf_wrap(pi.net,method,0);_perf_wrap(pi.net,"request",1),_orig_upload=pi.net.upload,pi.net.upload=function(){var args,ref;return args=1<=arguments.length?slice.call(arguments,0):[],pi.net.__skip_perf__=!0,ref=_orig_upload.apply(this,args),pi.net.__skip_perf__=!1,ref}}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils.extend(pi.NodWin.prototype,{scrollToNod:function(nod,params){var align,animated,dest_y,h,wh,y;return null==params&&(params={}),align=params.align||"middle",animated=null==params.animated||params.animated,h=nod.height(),pi.Nod.body.scrollHeight(),wh=this.height(),dest_y=(y=nod.position().y)+h-wh,"middle"===align?dest_y+=(wh-h)/2:"top"===align&&(dest_y+=wh-h),dest_y=Math.max(0,dest_y),animated?this.scrollYAnimated(y,dest_y):this.scrollY(dest_y)},scrollYAnimated:function(from,to){return Tweener.addTween(this,{_animated_y:to,time:Math.abs(from-to)/500})}}),Object.defineProperties(pi.NodWin.prototype,{_animated_y:{get:function(){return this.scrollTop()},set:function(val){return this.node.scrollTo(this.scrollLeft(),val)}}})}(this)}.call(this),function(){var slice=[].slice;!function(context){"use strict";var _included,_origf,_origs,_update_handler,pi,utils;(utils=(pi=context.pi).utils).extend(pi.controllers.Paginated.prototype,{pagination_field:"pagination",page_resolver:function(data){var ref;if(this.view.handle_pagination(null!=data?data[this.pagination_field]:void 0),!(null!=data&&null!=(ref=data[this.pagination_field])?ref.next_page:void 0))return this.scope().all_loaded()}},!0),utils.extend(pi.BaseView.prototype,{handle_pagination:function(data){var ref,ref1;if(null!=data)return data.next_page?null!=(ref=this.list)&&ref.addClass("has-pages"):null!=(ref1=this.list)&&ref1.removeClass("has-pages"),this.total_entries(data.total_entries)},total_entries:function(num){var ref;if(null!=num)return null!=(ref=this._entries_counter())?ref.text(num):void 0},_entries_counter:function(){return this._ec||(this._ec=this.find(".pi-entries-counter"))}}),_origs=pi.BaseView.Listable.prototype.search,_origf=pi.BaseView.Listable.prototype.filter,_included=pi.BaseView.Listable.included,_update_handler=function(){var _this;if(null!=this._entries_counter())return this.list.on("update",(_this=this,function(e){var _new_counter,_was;return _was=0|_this._entries_counter().text(),_new_counter="load"===e.data.type&&0===_was?_this.list.size():"item_added"===e.data.type?_was+1:"item_removed"===e.data.type?_was-1:void 0,_this.total_entries(_new_counter)}),this,function(e){var ref;return null!=(null!=(ref=e.data)?ref.type:void 0)&&"item_updated"!==e.data.type&&"clear"!==e.data.type})},pi.BaseView.Listable.included=function(klass){return _included.call(this,klass),klass.after_create(_update_handler)},pi.ListView.prototype.postinitialize=function(){return pi.BaseView.prototype.postinitialize.call(this),_update_handler.call(this)},pi.BaseView.Listable.prototype.search=pi.ListView.prototype.search=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],_origs.apply(this,args),this.total_entries(this.list.size())},pi.BaseView.Listable.prototype.filter=pi.ListView.prototype.filter=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],_origf.apply(this,args),this.total_entries(this.list.size())}}(this)}.call(this),function(){!function(context){"use strict";var pi
;(pi=context.pi).utils.extend(pi.PopupContainer.prototype,{_freeze_layer:function(){var _elements,_st,el,i,len,results;for(_st=pi.Nod.win.scrollTop(),results=[],i=0,len=(_elements=this.has_content()?[this.overlay,this.cont]:this._base_layer).length;i<len;i++)(el=_elements[i]).__freezed__?results.push(void 0):(el.__freezed__=!0,el.__freezer__=this._popup_id,el.__freeze_st__=_st,this.options.freeze_klass&&el.addClass(this.options.freeze_klass),results.push(el.style({overflow:"hidden",top:el.y()-_st+"px"})));return results},_unfreeze_layer:function(){var _elements,_st,fn,i,len,_this;for(_st=null,_elements=this.has_content()?[this.overlay,this.cont]:this._base_layer,_this=this,fn=function(el){var _klass;if(el.__freezed__&&el.__freezer__===_this._popup_id)return delete el.__freezed__,_st=el.__freeze_st__,_klass=_this.options.freeze_klass,el._with_raf("reset_popup_styles",function(){if(el.style({overflow:null,top:null}),_klass)return el._with_raf("reset_freeze_klass",function(){return el.removeClass(_klass)})})},i=0,len=_elements.length;i<len;i++)fn(_elements[i]);if(null!=_st)return pi.Nod.win.scrollY(_st)}},!0)}(this)}.call(this),function(){!function(context){"use strict";var TAGGED_RXP,_search_scope,pi;(pi=context.pi).utils,TAGGED_RXP=/^((?:(?:\w+:\w+)\s+)*(?:\w+:\w+))([^:]*)$/,_search_scope=function(prev,query){var ref;return!query.match(TAGGED_RXP)&&(0===(null!=(ref=query.match(prev))?ref.index:void 0)&&(prev||""))},pi.controllers.Scoped.rules.q=_search_scope}(this)}.call(this),function(){!function(context){"use strict";var _old_setup_events,pi;pi=context.pi,_old_setup_events=pi.Base.Scrollable.prototype.setup_events,pi.Base.Scrollable.prototype.setup_events=function(){return _old_setup_events.call(this),this.pane.on("hidden",this.scroll_listener(),this,function(e){return!e.data})}}(this)}.call(this),function(){var slice=[].slice;!function(context){"use strict";var pi,utils;pi=context.pi,(utils=pi.utils).local_error=utils.error,utils.error=function(){var args;return args=1<=arguments.length?slice.call(arguments,0):[],utils.local_error.apply(this,args)}}(this)}.call(this),function(){!function(context){"use strict";context.pi.utils.selectElementText=function(el,win){var doc,range,sel;return doc=(win=win||window).document,win.getSelection&&doc.createRange?(sel=win.getSelection(),(range=doc.createRange()).selectNodeContents(el),sel.removeAllRanges(),sel.addRange(range)):doc.body.createTextRange?((range=doc.body.createTextRange()).moveToElementText(el),range.select()):void 0}}(this)}.call(this),function(){!function(context){"use strict";var _date_rxp,_jira_time_rxp,_numeric_rxp,_phone_rxp,_time_rxp,pi;(pi=context.pi).utils,_time_rxp=/^\s*(\d?\d):(\d\d)\s*((a|p)m)?\s*$/i,_phone_rxp=/^\s*(\+|8)?\s*(\d{1,4})?\s*([\d\s\-]|\(\d{3,6}\))?\s*([\d\-\s]{7,15})\s*$/,_date_rxp=/^\s*\d{2,4}\s*[\-\.\/]\s*\d{2,4}\s*[\-\.\/]\s*\d{2,4}\s*$/,_numeric_rxp=/^\s*\d+(\.\d+)?\s*$/,_jira_time_rxp=/^([0-9]+d((((\s1[0-9]h$)|(\s2[0-3]h$)|((\s[0-9]h$)))|(((\s[0-5][0-9]m$))|((\s[0-9]m$))))|$|(\s((1[0-9]h\s)|(2[0-3]h\s)|([0-9]h\s))(([0-5][0-9]m$)|([0-9]m$)))))|((^1[0-9]h)|(^2[0-3]h)|(^[0-9]h))(((\s[0-5][0-9]m))|((\s[0-9]m))|$)|((^[0-5][0-9]m$)|(^[0-9]m$))/gm,pi.BaseInput.Validator.add("time",function(value){var matches;return!value||!!(matches=value.match(_time_rxp))&&((0|matches[1])<24&&(0|matches[2])<=59)}),pi.BaseInput.Validator.add("temp_file",function(value){return null===value||(0|value)>0}),pi.BaseInput.Validator.add("file_attach",function(value){return null===value||0!==parseInt(value)}),pi.BaseInput.Validator.add("phone",function(value){return!value||!!value.match(_phone_rxp)}),pi.BaseInput.Validator.add("date",function(value){return!value||!!value.match(_date_rxp)}),pi.BaseInput.Validator.add("numeric",function(value){return!value||!!(value+"").match(_numeric_rxp)}),pi.BaseInput.Validator.add("max",function(value,_nod,_form,data){return!value||(0|value)<=data}),pi.BaseInput.Validator.add("min",function(value,_nod,_form,data){return!value||(0|value)>=data}),pi.BaseInput.Validator.add("jira_time_format",function(value){return!value||!!(value+"").match(_jira_time_rxp)})}(this)}.call(this),function(){!function(context){"use strict";var orig_clear_all,pi;(pi=context.pi).utils,orig_clear_all=pi.resources.View.prototype.clear_all,pi.resources.View.prototype.clear_all=function(force){var i,ref;if(null===force&&(force=!1),!this.options.copy||!force){if(force&&!this.options.copy){for(this.__all_by_id__={},this.__all_by_tid__={},i=(ref=this.__all__).length-1;i>=0;)ref[i].remove(),i--;return this.__all_by_id__={},this.__all_by_tid__={},this.__all__.length=0}return orig_clear_all.call(this,force)}}}(this)}.call(this),function(){!function(context){"use strict";var ConfirmHandler,_cancel,pi,utils;utils=(pi=context.pi).utils,_cancel=function(){return pi.app.view.popup.close(pi.app.view.confirm_modal)},ConfirmHandler=function(){function ConfirmHandler(success,reject){null==reject&&(reject=null),this.success=function(){return _cancel().then(success)},this.reject=reject?function(){return _cancel().then(reject)}:_cancel}return ConfirmHandler.prototype["with"]=function(target,template){var template_name;if(template_name="templates/"+template,JST[template_name]&&pi.app.view.confirm_modal)return pi.app.view.confirm_modal.init(JST[template_name](target),this.success,this.reject),pi.app.view.popup.open(pi.app.view.confirm_modal)},ConfirmHandler}(),utils.extend(pi.controllers.Base.prototype,{confirm:function(resolve,reject){return new ConfirmHandler(resolve,reject)}})}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils.extend(pi.controllers.Base.prototype,{with_loader:function(promise){return this._xhr_loading=!0,this.view.loading(!0),promise["catch"]((_this=this,function(e){throw _this._xhr_loading=!1,_this.view.loading(!1),_this.view.error(e.message),delete _this._promise,e})).then(function(_this){return function(response){return _this._xhr_loading=!1,_this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),null!=(null!=response?response.redirect:void 0)&&_this.location(response.redirect),response}}(this));var _this}})}(this)}.call(this),function(){!function(context){"use strict";var _next_year,_now,pi,utils;utils=(pi=context.pi).utils,pi.configs||(pi.configs={}),_now=new Date,(_next_year=new Date).setFullYear(_now.getFullYear()+1),pi.configs.pikaday={"default":{bound:!0,position:"bottom",format:"YYYY-MM-DD",defaultDate:new Date,setDefaultDate:!0,firstDay:0,minDate:_now,maxDate:_next_year,yearRange:1,showWeekNumber:!1,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"previous month",nextMonth:"next month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}}},pi.configs.pikaday.en=pi.configs.pikaday["default"],pi.configs.pikaday.ru=utils.merge(pi.configs.pikaday["default"],{firstDay:1,i18n:{previousMonth:"\u043f\u0440\u0435\u0434. \u043c\u0435\u0441\u044f\u0446",nextMonth:"\u0441\u043b\u0435\u0434. \u043c\u0435\u0441\u044f\u0446",months:["\u044f\u043d\u0432\u0430\u0440\u044c","\u0444\u0435\u0432\u0440\u0430\u043b\u044c","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440\u0435\u043b\u044c","\u043c\u0430\u0439","\u0438\u044e\u043d\u044c","\u0438\u044e\u043b\u044c","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044c","\u043e\u043a\u0442\u044f\u0431\u0440\u044c","\u043d\u043e\u044f\u0431\u0440\u044c","\u0434\u0435\u043a\u0430\u0431\u0440\u044c"],weekdays:["\u0432\u043e\u0441\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"],weekdaysShort:["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"]}})}(this)}.call(this),function(){var hasProp={}.hasOwnProperty;!function(context){"use strict";var I18nSimple,deep_merge,load_path;load_path=function(path){return new Promise(function(resolve,reject){var req;return(req=new XMLHttpRequest).open("GET",path,!0),req.onreadystatechange=function(){4===req.readyState&&(200===req.status?resolve(JSON.parse(req.responseText)):reject(Error(req.statusText)))},req.onerror=function(){reject(Error("Network Error"))},req.send(null)})},deep_merge=function(target,data){var key;for(key in data)hasProp.call(data,key)&&(data[key],"object"==typeof target[key]&&"object"==typeof data[key]?target[key]=deep_merge(target[key],data[key]):target[key]=data[key]);return target},I18nSimple=function(){function I18nSimple(locale,paths){var i,len,loaders,path;if(this.locale=locale,this.store={},null!=paths){for(loaders=[],i=0,len=(paths=paths instanceof Array?paths:[paths]).length;i<len;i++)path=paths[i],loaders.push(new load_path(path));var _this;Promise.all(loaders).then((_this=this,function(values){var j,len1,results,val;for(results=[],j=0,len1=values.length;j<len1;j++)val=values[j],results.push(_this.add_translation(val));return results}))}}return I18nSimple.prototype.add_translation=function(data){return this.store=deep_merge(this.store,data)},I18nSimple.prototype.t=function(term){var data,i,key,len,ref;for(data=this.store,i=0,len=(ref=term.split(".")).length;i<len;i++){if(!data[key=ref[i]])return"";data=data[key]}return"string"==typeof data?data:""},I18nSimple}(),"function"==typeof define&&null!=define.amd?define(I18nSimple):"function"==typeof module?module.exports=I18nSimple:context.I18nSimple=I18nSimple}(this)}.call(this),function(global){"use strict";function CsvToJson(_input,_config){var config=IS_WORKER?_config:copyAndValidateConfig(_config);if(config.worker&&Papa.WORKERS_SUPPORTED&&SCRIPT_PATH){var w=newWorker();w.userStep=config.step,w.userChunk=config.chunk,w.userComplete=config.complete,w.userError=config.error,config.step=isFunction(config.step),config.chunk=isFunction(config.chunk),config.complete=isFunction(config.complete),config.error=isFunction(config.error),delete config.worker,w.postMessage({input:_input,config:config,workerId:w.id})}else if("string"==typeof _input){if(!config.download){var results=(ph=new ParserHandle(config)).parse(_input);return isFunction(config.complete)&&config.complete(results),results}new NetworkStreamer(config).stream(_input)}else if(_input instanceof File)if(config.step||config.chunk){new FileStreamer(config).stream(_input)}else{var ph=new ParserHandle(config);if(IS_WORKER){var reader=new FileReaderSync,input=reader.readAsText(_input,config.encoding);return ph.parse(input)}(reader=new FileReader).onload=function(event){var results=new ParserHandle(config).parse(event.target.result);isFunction(config.complete)&&config.complete(results)},reader.readAsText(_input,config.encoding)}}function JsonToCsv(_input,_config){function unpackConfig(){"object"==typeof _config&&("string"==typeof _config.delimiter&&1==_config.delimiter.length&&-1==global.Papa.BAD_DELIMITERS.indexOf(_config.delimiter)&&(_delimiter=_config.delimiter),("boolean"==typeof _config.quotes||_config.quotes instanceof Array)&&(_quotes=_config.quotes),"string"==typeof _config.newline&&(_newline=_config.newline))}function objectKeys(obj){if("object"!=typeof obj)return[];var keys=[];for(var key in obj)keys.push(key);return keys}function serialize(fields,data){var csv="";"string"==typeof fields&&(fields=JSON.parse(fields)),"string"==typeof data&&(data=JSON.parse(data));var hasHeader=fields instanceof Array&&fields.length>0,dataKeyedByField=!(data[0]instanceof Array);if(hasHeader){for(var i=0;i<fields.length;i++)i>0&&(csv+=_delimiter),csv+=safe(fields[i],i);data.length>0&&(csv+=_newline)}for(var row=0;row<data.length;row++){for(var maxCol=hasHeader?fields.length:data[row].length,col=0;col<maxCol;col++){col>0&&(csv+=_delimiter);var colIdx=hasHeader&&dataKeyedByField?fields[col]:col;csv+=safe(data[row][colIdx],col)}row<data.length-1&&(csv+=_newline)}return csv}function safe(str,col){return void 0===str?"":(str=str.toString().replace(/"/g,'""'),"boolean"==typeof _quotes&&_quotes||_quotes instanceof Array&&_quotes[col]||hasAny(str,global.Papa.BAD_DELIMITERS)||str.indexOf(_delimiter)>-1||" "==str.charAt(0)||" "==str.charAt(str.length-1)?'"'+str+'"':str)}function hasAny(str,substrings){for(var i=0;i<substrings.length;i++)if(str.indexOf(substrings[i])>-1)return!0;return!1}var _quotes=!1,_delimiter=",",_newline="\r\n";if(unpackConfig(),"string"==typeof _input&&(_input=JSON.parse(_input)),_input instanceof Array){if(!_input.length||_input[0]instanceof Array)return serialize(null,_input);if("object"==typeof _input[0])return serialize(objectKeys(_input[0]),_input)}else if("object"==typeof _input)return"string"==typeof _input.data&&(_input.data=JSON.parse(_input.data)),_input.data instanceof Array&&(_input.fields||(_input.fields=_input.data[0]instanceof Array?_input.fields:objectKeys(_input.data[0])),_input.data[0]instanceof Array||"object"==typeof _input.data[0]||(_input.data=[_input.data])),serialize(_input.fields||[],_input.data||[]);throw"exception: Unable to serialize unrecognized input"}function NetworkStreamer(config){(config=config||{}).chunkSize||(config.chunkSize=Papa.RemoteChunkSize);var xhr,nextChunk,start=0,fileSize=0,aggregate="",partialLine="",handle=new ParserHandle(copy(config));this.stream=function(url){function readChunk(){if(xhr=new XMLHttpRequest,IS_WORKER||(xhr.onload=chunkLoaded,xhr.onerror=chunkError),xhr.open("GET",url,!IS_WORKER),config.step){var end=start+config.chunkSize-1;fileSize&&end>fileSize&&(end=fileSize),xhr.setRequestHeader("Range","bytes="+start+"-"+end)}xhr.send(),IS_WORKER&&0==xhr.status?chunkError():start+=config.chunkSize}function chunkLoaded(){if(4==xhr.readyState)if(xhr.status<200||xhr.status>=400)chunkError();else{aggregate+=partialLine+xhr.responseText,partialLine="";var finishedWithEntireFile=!config.step||start>getFileSize(xhr);if(!finishedWithEntireFile){var lastLineEnd=aggregate.lastIndexOf("\n");if(lastLineEnd<0&&(lastLineEnd=aggregate.lastIndexOf("\r")),!(lastLineEnd>-1))return void nextChunk();partialLine=aggregate.substring(lastLineEnd+1),aggregate=aggregate.substring(0,lastLineEnd)}var results=handle.parse(aggregate);aggregate="",IS_WORKER?global.postMessage({results:results,workerId:Papa.WORKER_ID,finished:finishedWithEntireFile}):isFunction(config.chunk)&&(config.chunk(results),results=undefined),finishedWithEntireFile&&isFunction(config.complete)?config.complete(results):results&&results.meta.aborted&&isFunction(config.complete)?config.complete(results):finishedWithEntireFile||nextChunk()}}function chunkError(){isFunction(config.error)?config.error(xhr.statusText):IS_WORKER&&config.error&&global.postMessage({workerId:Papa.WORKER_ID,error:xhr.statusText,finished:!1})}function getFileSize(xhr){var contentRange=xhr.getResponseHeader("Content-Range");return parseInt(contentRange.substr(contentRange.lastIndexOf("/")+1))}(nextChunk=IS_WORKER?function(){readChunk(),chunkLoaded()}:function(){readChunk()})()}}function FileStreamer(config){(config=config||{}).chunkSize||(config.chunkSize=Papa.LocalChunkSize);var reader,start=0,aggregate="",partialLine="",handle=new ParserHandle(copy(config));this.stream=function(file){function nextChunk(){start<file.size&&readChunk()}function readChunk(){var end=Math.min(start+config.chunkSize,file.size),txt=reader.readAsText(slice.call(file,start,end),config.encoding);return start+=config.chunkSize,txt}function chunkLoaded(event){aggregate+=partialLine+event.target.result,partialLine="";var finishedWithEntireFile=start>=file.size;if(!finishedWithEntireFile){var lastLineEnd=aggregate.lastIndexOf("\n");if(lastLineEnd<0&&(lastLineEnd=aggregate.lastIndexOf("\r")),!(lastLineEnd>-1))return void nextChunk();partialLine=aggregate.substring(lastLineEnd+1),aggregate=aggregate.substring(0,lastLineEnd)}var results=handle.parse(aggregate);aggregate="",IS_WORKER?global.postMessage({results:results,workerId:Papa.WORKER_ID,finished:finishedWithEntireFile}):isFunction(config.chunk)&&(config.chunk(results,file),results=undefined),finishedWithEntireFile&&isFunction(config.complete)?config.complete(undefined,file):results&&results.meta.aborted&&isFunction(config.complete)?config.complete(results,file):finishedWithEntireFile||nextChunk()}function chunkError(){isFunction(config.error)?config.error(reader.error,file):IS_WORKER&&config.error&&global.postMessage({workerId:Papa.WORKER_ID,error:reader.error,file:file,finished:!1})}var slice=file.slice||file.webkitSlice||file.mozSlice;(reader=new FileReader).onload=chunkLoaded,reader.onerror=chunkError,nextChunk()}}function ParserHandle(_config){function processResults(){return _results&&_delimiterError&&(addError("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to comma"),_delimiterError=!1),needsHeaderRow()&&fillHeaderFields(),applyHeaderAndDynamicTyping()}function needsHeaderRow(){return _config.header&&0==_fields.length}function fillHeaderFields(){if(_results){for(var i=0;needsHeaderRow()&&i<_results.data.length;i++)for(var j=0;j<_results.data[i].length;j++)_fields.push(_results.data[i][j]);_results.data.splice(0,1)}}function applyHeaderAndDynamicTyping(){if(!_results||!_config.header&&!_config.dynamicTyping)return _results;for(var i=0;i<_results.data.length;i++){for(var row={},j=0;j<_results.data[i].length;j++){if(_config.dynamicTyping){var value=_results.data[i][j];_results.data[i][j]="true"==value||"false"!=value&&tryParseFloat(value)}_config.header&&(j>=_fields.length&&(row.__parsed_extra||(row.__parsed_extra=[]),row.__parsed_extra.push(_results.data[i][j])),row[_fields[j]]=_results.data[i][j])}_config.header&&(_results.data[i]=row,j>_fields.length?addError("FieldMismatch","TooManyFields","Too many fields: expected "+_fields.length+" fields but parsed "+j,i):j<_fields.length&&addError("FieldMismatch","TooFewFields","Too few fields: expected "+_fields.length+" fields but parsed "+j,i))}return _config.header&&_results.meta,_results.meta.fields=_fields,_results}function guessDelimiter(input){for(var bestDelim,bestDelta,fieldCountPrevRow,delimChoices=[",","\t","|",";",Papa.RECORD_SEP,Papa.UNIT_SEP],i=0;i<delimChoices.length;i++){var delim=delimChoices[i],delta=0,avgFieldCount=0;fieldCountPrevRow=undefined;for(var preview=new Parser({delimiter:delim,preview:10}).parse(input),j=0;j<preview.data.length;j++){var fieldCount=preview.data[j].length;avgFieldCount+=fieldCount,void 0!==fieldCountPrevRow?fieldCount>1&&(delta+=Math.abs(fieldCount-fieldCountPrevRow),fieldCountPrevRow=fieldCount):fieldCountPrevRow=fieldCount}avgFieldCount/=preview.data.length,(void 0===bestDelta||delta<bestDelta)&&avgFieldCount>1.99&&(bestDelta=delta,bestDelim=delim)}return _config.delimiter=bestDelim,{successful:!!bestDelim,bestDelimiter:bestDelim}}function tryParseFloat(val){return FLOAT.test(val)?parseFloat(val):val}function addError(type,code,msg,row){_results.errors.push({type:type,code:code,message:msg,row:row})}var _delimiterError,FLOAT=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,_fields=[],_results={data:[],errors:[],meta:{}};_config=copy(_config),this.parse=function(input){if(_delimiterError=!1,!_config.delimiter){var delimGuess=guessDelimiter(input);delimGuess.successful?_config.delimiter=delimGuess.bestDelimiter:(_delimiterError=!0,_config.delimiter=","),_results.meta.delimiter=_config.delimiter}if(isFunction(_config.step)){var userStep=_config.step;_config.step=function(results,parser){_results=results,needsHeaderRow()?processResults():userStep(processResults(),parser)}}return _results=new Parser(_config).parse(input),processResults()}}function Parser(config){function parserLoop(){for(;_i<_input.length&&!_aborted&&!(_preview>0&&_rowIdx>=_preview);){if(_paused)return finishParsing();'"'==_ch?parseQuotes():_inQuotes?parseInQuotes():parseNotInQuotes(),nextChar()}return finishParsing()}function nextChar(){_ch=_input[++_i]}function finishParsing(){if(_aborted&&addError("Abort","ParseAbort","Parsing was aborted by the user's step function"),_inQuotes&&addError("Quotes","MissingQuotes","Unescaped or mismatched quotes"),endRow(),!isFunction(_step))return returnable()}function parseQuotes(){quotesOnBoundary()&&!quotesEscaped()?_inQuotes=!_inQuotes:(saveChar(),_inQuotes&&quotesEscaped()?_i++:addError("Quotes","UnexpectedQuotes","Unexpected quotes"))}function parseInQuotes(){saveChar()}function parseNotInQuotes(){_ch==_delimiter?newField():twoCharLineBreak()?(newRow(),nextChar()):oneCharLineBreak()?newRow():isCommentStart()?skipLine():saveChar()}function isCommentStart(){return!!_comments&&((0==_i||oneCharLineBreak(_i-1)||twoCharLineBreak(_i-2))&&_input[_i]===_comments)}function skipLine(){for(;!twoCharLineBreak()&&!oneCharLineBreak()&&_i<_input.length;)nextChar()}function saveChar(){_data[_rowIdx][_colIdx]+=_ch}function newField(){_data[_rowIdx].push(""),_colIdx=_data[_rowIdx].length-1}function newRow(){endRow(),_lineNum++,_data.push([]),_rowIdx=_data.length-1,newField()}function endRow(){trimEmptyLastRow(),isFunction(_step)&&(_data[_rowIdx]&&_step(returnable(),self),clearErrorsAndData())}function trimEmptyLastRow(){1==_data[_rowIdx].length&&EMPTY.test(_data[_rowIdx][0])&&(config.keepEmptyRows?_data[_rowIdx].splice(0,1):_data.splice(_rowIdx,1),_rowIdx=_data.length-1)}function twoCharLineBreak(i){return"number"!=typeof i&&(i=_i),i<_input.length-1&&("\r"==_input[i]&&"\n"==_input[i+1]||"\n"==_input[i]&&"\r"==_input[i+1])}function oneCharLineBreak(i){return"number"!=typeof i&&(i=_i),"\r"==_input[i]||"\n"==_input[i]}function quotesEscaped(){return!quotesOnBoundary()&&_i<_input.length-1&&'"'==_input[_i+1]}function quotesOnBoundary(){return!_inQuotes&&isBoundary(_i-1)||isBoundary(_i+1)}function isBoundary(i){"number"!=typeof i&&(i=_i);var ch=_input[i];return i<=-1||i>=_input.length||ch==_delimiter||"\r"==ch||"\n"==ch}function addError(type,code,msg){_errors.push({type:type,code:code,message:msg,line:_lineNum,row:_rowIdx,index:_i})}function reset(input){_input=input,_inQuotes=!1,_lineNum=1,_i=0,clearErrorsAndData(),_data=[[""]],_ch=_input[_i]}function clearErrorsAndData(){_data=[],_errors=[],_rowIdx=0,_colIdx=0}function returnable(){return{data:_data,errors:_errors,meta:{lines:_lineNum,delimiter:_delimiter,aborted:_aborted}}}var _input,_delimiter,_comments,_step,_preview,_ch,_i,_inQuotes,_lineNum,_data,_errors,_rowIdx,_colIdx,self=this,EMPTY=/^\s*$/,_aborted=!1,_paused=!1;_delimiter=(config=config||{}).delimiter,_comments=config.comments,_step=config.step,_preview=config.preview,("string"!=typeof _delimiter||1!=_delimiter.length||Papa.BAD_DELIMITERS.indexOf(_delimiter)>-1)&&(_delimiter=","),!0===_comments?_comments="#":("string"!=typeof _comments||1!=_comments.length||Papa.BAD_DELIMITERS.indexOf(_comments)>-1||_comments==_delimiter)&&(_comments=!1),this.parse=function(input){if("string"!=typeof input)throw"Input must be a string";return reset(input),parserLoop()},this.abort=function(){_aborted=!0}}function getScriptPath(){var id="worker"+String(Math.random()).substr(2);return document.write('<script id="'+id+'"></script>'),document.getElementById(id).previousSibling.src}function newWorker(){if(!Papa.WORKERS_SUPPORTED)return!1;var w=new global.Worker(SCRIPT_PATH);return w.onmessage=mainThreadReceivedMessage,w.id=workerIdCounter++,workers[w.id]=w,w}function mainThreadReceivedMessage(e){var msg=e.data,worker=workers[msg.workerId];if(msg.error)worker.userError(msg.error,msg.file);else if(msg.results&&msg.results.data){if(isFunction(worker.userStep))for(var i=0;i<msg.results.data.length;i++)worker.userStep({data:[msg.results.data[i]],errors:msg.results.errors,meta:msg.results.meta});else isFunction(worker.userChunk)&&worker.userChunk(msg.results,msg.file);delete msg.results}msg.finished&&(isFunction(workers[msg.workerId].userComplete)&&workers[msg.workerId].userComplete(msg.results),workers[msg.workerId].terminate(),delete workers[msg.workerId])}function workerThreadReceivedMessage(e){var msg=e.data;if("undefined"==typeof Papa.WORKER_ID&&msg&&(Papa.WORKER_ID=msg.workerId),"string"==typeof msg.input)global.postMessage({workerId:Papa.WORKER_ID,results:Papa.parse(msg.input,msg.config),finished:!0});else if(msg.input instanceof File){var results=Papa.parse(msg.input,msg.config);results&&global.postMessage({workerId:Papa.WORKER_ID,results:results,finished:!0})}}function copyAndValidateConfig(origConfig){"object"!=typeof origConfig&&(origConfig={});var config=copy(origConfig);return("string"!=typeof config.delimiter||1!=config.delimiter.length||Papa.BAD_DELIMITERS.indexOf(config.delimiter)>-1)&&(config.delimiter=DEFAULTS.delimiter),"boolean"!=typeof config.header&&(config.header=DEFAULTS.header),"boolean"!=typeof config.dynamicTyping&&(config.dynamicTyping=DEFAULTS.dynamicTyping),"number"!=typeof config.preview&&(config.preview=DEFAULTS.preview),"function"!=typeof config.step&&(config.step=DEFAULTS.step),"function"!=typeof config.complete&&(config.complete=DEFAULTS.complete),"string"!=typeof config.encoding&&(config.encoding=DEFAULTS.encoding),"boolean"!=typeof config.worker&&(config.worker=DEFAULTS.worker),"boolean"!=typeof config.download&&(config.download=DEFAULTS.download),"boolean"!=typeof config.keepEmptyRows&&(config.keepEmptyRows=DEFAULTS.keepEmptyRows),config}function copy(obj){if("object"!=typeof obj)return obj;var cpy=obj instanceof Array?[]:{};for(var key in obj)cpy[key]=copy(obj[key]);return cpy}function isFunction(func){return"function"==typeof func}var SCRIPT_PATH,IS_WORKER=!global.document,workers={},workerIdCounter=0,DEFAULTS={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:undefined,encoding:"",worker:!1,comments:!1,complete:undefined,download:!1,keepEmptyRows:!1};if(global.Papa={},global.Papa.parse=CsvToJson,global.Papa.unparse=JsonToCsv,global.Papa.RECORD_SEP=String.fromCharCode(30),global.Papa.UNIT_SEP=String.fromCharCode(31),global.Papa.BYTE_ORDER_MARK="\ufeff",global.Papa.BAD_DELIMITERS=["\r","\n",'"',global.Papa.BYTE_ORDER_MARK],global.Papa.WORKERS_SUPPORTED=!!global.Worker,global.Papa.LocalChunkSize=10485760,global.Papa.RemoteChunkSize=5242880,global.Papa.Parser=Parser,global.Papa.ParserHandle=ParserHandle,global.Papa.NetworkStreamer=NetworkStreamer,global.Papa.FileStreamer=FileStreamer,global.jQuery){var $=global.jQuery;$.fn.parse=function(options){function parseNextFile(){if(0!=queue.length){var f=queue[0];if(isFunction(options.before)){var returned=options.before(f.file,f.inputElem);if("object"==typeof returned){if("abort"==returned.action)return void error("AbortError",f.file,f.inputElem,returned.reason);if("skip"==returned.action)return void fileComplete();"object"==typeof returned.config&&(f.instanceConfig=$.extend(f.instanceConfig,returned.config))}else if("skip"==returned)return void fileComplete()}var userCompleteFunc=f.instanceConfig.complete;f.instanceConfig.complete=function(results){isFunction(userCompleteFunc)&&userCompleteFunc(results,f.file,f.inputElem),fileComplete()},Papa.parse(f.file,f.instanceConfig)}else isFunction(options.complete)&&options.complete()}function error(name,file,elem,reason){isFunction(options.error)&&options.error({name:name},file,elem,reason)}function fileComplete(){queue.splice(0,1),parseNextFile()}var config=options.config||{},queue=[];return this.each(function(){if(!("INPUT"==$(this).prop("tagName").toUpperCase()&&"file"==$(this).attr("type").toLowerCase()&&global.FileReader)||!this.files||0==this.files.length)return!0;for(var i=0;i<this.files.length;i++)queue.push({file:this.files[i],inputElem:this,instanceConfig:$.extend({},config)})}),parseNextFile(),this}}IS_WORKER?global.onmessage=workerThreadReceivedMessage:Papa.WORKERS_SUPPORTED&&(SCRIPT_PATH=getScriptPath())}(this),
/*! shepherd 0.5.1 */
/*! tether 0.6.5 */
function(root,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory(require,exports,module):root.Tether=factory()}(this,function(){return function(){var Evented,addClass,defer,deferred,extend,flush,getBounds,getOffsetParent,getOrigin,getScrollBarSize,getScrollParent,hasClass,removeClass,uniqueId,updateClasses,zeroPosCache,id,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__slice=[].slice;null==this.Tether&&(this.Tether={modules:[]}),getScrollParent=function(el){var parent,position,style,_ref;if("fixed"===(position=getComputedStyle(el).position))return el;for(void 0,parent=el;parent=parent.parentNode;){try{style=getComputedStyle(parent)}catch(_error){}if(null==style)return parent;if(/(auto|scroll)/.test(style.overflow+style["overflow-y"]+style["overflow-x"])&&("absolute"!==position||"relative"===(_ref=style.position)||"absolute"===_ref||"fixed"===_ref))return parent}return document.body},id=0,uniqueId=function(){return id++},zeroPosCache={},getOrigin=function(doc){var id,k,node,v,_ref;if(null==(node=doc._tetherZeroElement)&&((node=doc.createElement("div")).setAttribute("data-tether-id",uniqueId()),extend(node.style,{top:0,left:0,position:"absolute"}),doc.body.appendChild(node),doc._tetherZeroElement=node),id=node.getAttribute("data-tether-id"),null==zeroPosCache[id]){for(k in zeroPosCache[id]={},_ref=node.getBoundingClientRect())v=_ref[k],zeroPosCache[id][k]=v;defer(function(){return zeroPosCache[id]=void 0})}return zeroPosCache[id]},getBounds=function(el){var box,doc,docEl,k,origin,v,_ref;for(k in el===document?(doc=document,el=document.documentElement):doc=el.ownerDocument,docEl=doc.documentElement,box={},_ref=el.getBoundingClientRect())v=_ref[k],box[k]=v;return origin=getOrigin(doc),box.top-=origin.top,box.left-=origin.left,null==box.width&&(box.width=document.body.scrollWidth-box.left-box.right),null==box.height&&(box.height=document.body.scrollHeight-box.top-box.bottom),box.top=box.top-docEl.clientTop,box.left=box.left-docEl.clientLeft,box.right=doc.body.clientWidth-box.width-box.left,box.bottom=doc.body.clientHeight-box.height-box.top,box},getOffsetParent=function(el){return el.offsetParent||document.documentElement},getScrollBarSize=function(){var inner,outer,width,widthContained,widthScroll;return(inner=document.createElement("div")).style.width="100%",inner.style.height="200px",outer=document.createElement("div"),extend(outer.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),outer.appendChild(inner),document.body.appendChild(outer),widthContained=inner.offsetWidth,outer.style.overflow="scroll",widthContained===(widthScroll=inner.offsetWidth)&&(widthScroll=outer.clientWidth),document.body.removeChild(outer),{width:width=widthContained-widthScroll,height:width}},extend=function(out){var args,key,obj,val,_i,_len,_ref;for(null==out&&(out={}),args=[],Array.prototype.push.apply(args,arguments),_i=0,_len=(_ref=args.slice(1)).length;_i<_len;_i++)if(obj=_ref[_i])for(key in obj)__hasProp.call(obj,key)&&(val=obj[key],out[key]=val);return out},removeClass=function(el,name){var cls,_i,_len,_ref,_results;if(null!=el.classList){for(_results=[],_i=0,_len=(_ref=name.split(" ")).length;_i<_len;_i++)(cls=_ref[_i]).trim()&&_results.push(el.classList.remove(cls));return _results}return el.className=el.className.replace(new RegExp("(^| )"+name.split(" ").join("|")+"( |$)","gi")," ")},addClass=function(el,name){var cls,_i,_len,_ref,_results;if(null!=el.classList){for(_results=[],_i=0,_len=(_ref=name.split(" ")).length;_i<_len;_i++)(cls=_ref[_i]).trim()&&_results.push(el.classList.add(cls));return _results}return removeClass(el,name),el.className+=" "+name},hasClass=function(el,name){return null!=el.classList?el.classList.contains(name):new RegExp("(^| )"+name+"( |$)","gi").test(el.className)},updateClasses=function(el,add,all){var cls,_i,_j,_len,_len1,_results;for(_i=0,_len=all.length;_i<_len;_i++)cls=all[_i],__indexOf.call(add,cls)<0&&hasClass(el,cls)&&removeClass(el,cls);for(_results=[],_j=0,_len1=add.length;_j<_len1;_j++)cls=add[_j],hasClass(el,cls)?_results.push(void 0):_results.push(addClass(el,cls));return _results},deferred=[],defer=function(fn){return deferred.push(fn)},flush=function(){var fn,_results;for(_results=[];fn=deferred.pop();)_results.push(fn());return _results},Evented=function(){function Evented(){}return Evented.prototype.on=function(event,handler,ctx,once){var _base;return null==once&&(once=!1),null==this.bindings&&(this.bindings={}),null==(_base=this.bindings)[event]&&(_base[event]=[]),this.bindings[event].push({handler:handler,ctx:ctx,once:once})},Evented.prototype.once=function(event,handler,ctx){return this.on(event,handler,ctx,!0)},Evented.prototype.off=function(event,handler){var i,_ref,_results;if(null!=(null!=(_ref=this.bindings)?_ref[event]:void 0)){if(null==handler)return delete this.bindings[event];for(i=0,_results=[];i<this.bindings[event].length;)this.bindings[event][i].handler===handler?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented.prototype.trigger=function(){var args,ctx,event,handler,i,once,_ref,_ref1,_results;if(event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],null!=(_ref=this.bindings)?_ref[event]:void 0){for(i=0,_results=[];i<this.bindings[event].length;)handler=(_ref1=this.bindings[event][i]).handler,ctx=_ref1.ctx,once=_ref1.once,handler.apply(null!=ctx?ctx:this,args),once?_results.push(this.bindings[event].splice(i,1)):_results.push(i++);return _results}},Evented}(),this.Tether.Utils={getScrollParent:getScrollParent,getBounds:getBounds,getOffsetParent:getOffsetParent,extend:extend,addClass:addClass,removeClass:removeClass,hasClass:hasClass,updateClasses:updateClasses,defer:defer,flush:flush,uniqueId:uniqueId,Evented:Evented,getScrollBarSize:getScrollBarSize}}.call(this),function(){var MIRROR_LR,MIRROR_TB,OFFSET_MAP,Tether,addClass,addOffset,attachmentToOffset,autoToFixedAttachment,defer,extend,flush,getBounds,getOffsetParent,getScrollBarSize,getScrollParent,now,offsetToPx,parseAttachment,parseOffset,position,removeClass,tethers,transformKey,updateClasses,within,_Tether,_ref,__slice=[].slice,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");_ref=(Tether=this.Tether).Utils,getScrollParent=_ref.getScrollParent,_ref.getSize,_ref.getOuterSize,getBounds=_ref.getBounds,getOffsetParent=_ref.getOffsetParent,extend=_ref.extend,addClass=_ref.addClass,removeClass=_ref.removeClass,updateClasses=_ref.updateClasses,defer=_ref.defer,flush=_ref.flush,getScrollBarSize=_ref.getScrollBarSize,within=function(a,b,diff){return null==diff&&(diff=1),a+diff>=b&&b>=a-diff},transformKey=function(){var el,key,_i,_len,_ref1;for(el=document.createElement("div"),_i=0,_len=(_ref1=["transform","webkitTransform","OTransform","MozTransform","msTransform"]).length;_i<_len;_i++)if(key=_ref1[_i],void 0!==el.style[key])return key}(),tethers=[],position=function(){var _i,_len;for(_i=0,_len=tethers.length;_i<_len;_i++)tethers[_i].position(!1);return flush()},now=function(){var _ref1;return null!=(_ref1="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?_ref1:+new Date},function(){var event,lastCall,lastDuration,pendingTimeout,tick,_i,_len,_ref1,_results;for(lastCall=null,lastDuration=null,pendingTimeout=null,tick=function(){return null!=lastDuration&&lastDuration>16?(lastDuration=Math.min(lastDuration-16,250),void(pendingTimeout=setTimeout(tick,250))):null!=lastCall&&now()-lastCall<10?void 0:(null!=pendingTimeout&&(clearTimeout(pendingTimeout),pendingTimeout=null),lastCall=now(),position(),lastDuration=now()-lastCall)},_results=[],_i=0,_len=(_ref1=["resize","scroll","touchmove"]).length;_i<_len;_i++)event=_ref1[_i],_results.push(window.addEventListener(event,tick))}(),MIRROR_LR={center:"center",left:"right",right:"left"},MIRROR_TB={middle:"middle",top:"bottom",bottom:"top"},OFFSET_MAP={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},autoToFixedAttachment=function(attachment,relativeToAttachment){var left,top;return left=attachment.left,top=attachment.top,"auto"===left&&(left=MIRROR_LR[relativeToAttachment.left]),"auto"===top&&(top=MIRROR_TB[relativeToAttachment.top]),{left:left,top:top}},attachmentToOffset=function(attachment){var _ref1,_ref2;return{left:null!=(_ref1=OFFSET_MAP[attachment.left])?_ref1:attachment.left,top:null!=(_ref2=OFFSET_MAP[attachment.top])?_ref2:attachment.top}},addOffset=function(){var left,offsets,out,top,_i,_len,_ref1;for(out={top:0,left:0},_i=0,_len=(offsets=1<=arguments.length?__slice.call(arguments,0):[]).length;_i<_len;_i++)top=(_ref1=offsets[_i]).top,left=_ref1.left,"string"==typeof top&&(top=parseFloat(top,10)),"string"==typeof left&&(left=parseFloat(left,10)),out.top+=top,out.left+=left;return out},offsetToPx=function(offset,size){return"string"==typeof offset.left&&-1!==offset.left.indexOf("%")&&(offset.left=parseFloat(offset.left,10)/100*size.width),"string"==typeof offset.top&&-1!==offset.top.indexOf("%")&&(offset.top=parseFloat(offset.top,10)/100*size.height),offset},parseAttachment=parseOffset=function(value){var _ref1;return{top:(_ref1=value.split(" "))[0],left:_ref1[1]}},_Tether=function(){function _Tether(options){var _i,_len,_ref1,_ref2;for(this.position=__bind(this.position,this),tethers.push(this),this.history=[],this.setOptions(options,!1),_i=0,_len=(_ref1=Tether.modules).length;_i<_len;_i++)null!=(_ref2=_ref1[_i].initialize)&&_ref2.call(this);this.position()}return _Tether.modules=[],_Tether.prototype.getClass=function(key){var _ref1,_ref2;return(null!=(_ref1=this.options.classes)?_ref1[key]:void 0)?this.options.classes[key]:!1!==(null!=(_ref2=this.options.classes)?_ref2[key]:void 0)?this.options.classPrefix?this.options.classPrefix+"-"+key:key:""},_Tether.prototype.setOptions=function(options,position){var defaults,key,_i,_len,_ref1,_ref2;for(this.options=options,null==position&&(position=!0),defaults={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=extend(defaults,this.options),_ref1=this.options,this.element=_ref1.element,this.target=_ref1.target,this.targetModifier=_ref1.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),_i=0,_len=(_ref2=["element","target"]).length;_i<_len;_i++){if(null==this[key=_ref2[_i]])throw new Error("Tether Error: Both element and target must be defined");null!=this[key].jquery?this[key]=this[key][0]:"string"==typeof this[key]&&(this[key]=document.querySelector(this[key]))}if(addClass(this.element,this.getClass("element")),addClass(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");if(this.targetAttachment=parseAttachment(this.options.targetAttachment),this.attachment=parseAttachment(this.options.attachment),this.offset=parseOffset(this.options.offset),this.targetOffset=parseOffset(this.options.targetOffset),null!=this.scrollParent&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParent=this.target:this.scrollParent=getScrollParent(this.target),!1!==this.options.enabled)return this.enable(position)},_Tether.prototype.getTargetBounds=function(){var bounds,fitAdj,height,out,scrollBottom,scrollPercentage,style,target;if(null==this.targetModifier)return getBounds(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:((out={height:(bounds=getBounds(this.target)).height,width:bounds.width,top:bounds.top,left:bounds.left}).height=Math.min(out.height,bounds.height-(pageYOffset-bounds.top)),out.height=Math.min(out.height,bounds.height-(bounds.top+bounds.height-(pageYOffset+innerHeight))),out.height=Math.min(innerHeight,out.height),out.height-=2,out.width=Math.min(out.width,bounds.width-(pageXOffset-bounds.left)),out.width=Math.min(out.width,bounds.width-(bounds.left+bounds.width-(pageXOffset+innerWidth))),out.width=Math.min(innerWidth,out.width),out.width-=2,out.top<pageYOffset&&(out.top=pageYOffset),out.left<pageXOffset&&(out.left=pageXOffset),out);case"scroll-handle":return(target=this.target)===document.body?(target=document.documentElement,bounds={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):bounds=getBounds(target),style=getComputedStyle(target),scrollBottom=0,(target.scrollWidth>target.clientWidth||"scroll"===[style.overflow,style.overflowX]||this.target!==document.body)&&(scrollBottom=15),out={width:15,height:.975*(height=bounds.height-parseFloat(style.borderTopWidth)-parseFloat(style.borderBottomWidth)-scrollBottom)*(height/target.scrollHeight),left:bounds.left+bounds.width-parseFloat(style.borderLeftWidth)-15},fitAdj=0,height<408&&this.target===document.body&&(fitAdj=-11e-5*Math.pow(height,2)-.00727*height+22.58),this.target!==document.body&&(out.height=Math.max(out.height,24)),scrollPercentage=this.target.scrollTop/(target.scrollHeight-height),out.top=scrollPercentage*(height-out.height-fitAdj)+bounds.top+parseFloat(style.borderTopWidth),this.target===document.body&&(out.height=Math.max(out.height,24)),out}},_Tether.prototype.clearCache=function(){return this._cache={}},_Tether.prototype.cache=function(k,getter){return null==this._cache&&(this._cache={}),null==this._cache[k]&&(this._cache[k]=getter.call(this)),this._cache[k]},_Tether.prototype.enable=function(position){if(null==position&&(position=!0),addClass(this.target,this.getClass("enabled")),addClass(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),position)return this.position()},_Tether.prototype.disable=function(){if(removeClass(this.target,this.getClass("enabled")),removeClass(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent)return this.scrollParent.removeEventListener("scroll",this.position)},_Tether.prototype.destroy=function(){var i,_i,_len,_results;for(this.disable(),_results=[],i=_i=0,_len=tethers.length;_i<_len;i=++_i){if(tethers[i]===this){tethers.splice(i,1);break}_results.push(void 0)}return _results},_Tether.prototype.updateAttachClasses=function(elementAttach,targetAttach){var add,all,side,sides,_i,_j,_len,_len1,_ref1,_this=this;for(null==elementAttach&&(elementAttach=this.attachment),null==targetAttach&&(targetAttach=this.targetAttachment),sides=["left","top","bottom","right","middle","center"],(null!=(_ref1=this._addAttachClasses)?_ref1.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),add=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],elementAttach.top&&add.push(this.getClass("element-attached")+"-"+elementAttach.top),elementAttach.left&&add.push(this.getClass("element-attached")+"-"+elementAttach.left),targetAttach.top&&add.push(this.getClass("target-attached")+"-"+targetAttach.top),targetAttach.left&&add.push(this.getClass("target-attached")+"-"+targetAttach.left),all=[],_i=0,_len=sides.length;_i<_len;_i++)side=sides[_i],all.push(this.getClass("element-attached")+"-"+side);for(_j=0,_len1=sides.length;_j<_len1;_j++)side=sides[_j],all.push(this.getClass("target-attached")+"-"+side);return defer(function(){if(null!=_this._addAttachClasses)return updateClasses(_this.element,_this._addAttachClasses,all),updateClasses(_this.target,_this._addAttachClasses,all),_this._addAttachClasses=void 0})},_Tether.prototype.position=function(flushChanges){var elementPos,height,left,manualOffset,manualTargetOffset,next,offset,offsetBorder,offsetParent,offsetParentSize,offsetParentStyle,offsetPosition,ret,scrollLeft,scrollTop,scrollbarSize,side,targetAttachment,targetOffset,targetPos,targetSize,top,width,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_this=this;if(null==flushChanges&&(flushChanges=!0),this.enabled){for(this.clearCache(),targetAttachment=autoToFixedAttachment(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,targetAttachment),width=(elementPos=this.cache("element-bounds",function(){return getBounds(_this.element)})).width,height=elementPos.height,0===width&&0===height&&null!=this.lastSize?(width=(_ref1=this.lastSize).width,height=_ref1.height):this.lastSize={width:width,height:height},targetSize=targetPos=this.cache("target-bounds",function(){return _this.getTargetBounds()}),offset=offsetToPx(attachmentToOffset(this.attachment),{width:width,height:height}),targetOffset=offsetToPx(attachmentToOffset(targetAttachment),targetSize),manualOffset=offsetToPx(this.offset,{width:width,height:height}),manualTargetOffset=offsetToPx(this.targetOffset,targetSize),offset=addOffset(offset,manualOffset),targetOffset=addOffset(targetOffset,manualTargetOffset),left=targetPos.left+targetOffset.left-offset.left,top=targetPos.top+targetOffset.top-offset.top,_i=0,_len=(_ref2=Tether.modules).length;_i<_len;_i++)if(null!=(ret=_ref2[_i].position.call(this,{left:left,top:top,targetAttachment:targetAttachment,targetPos:targetPos,attachment:this.attachment,elementPos:elementPos,offset:offset,targetOffset:targetOffset,manualOffset:manualOffset,manualTargetOffset:manualTargetOffset,scrollbarSize:scrollbarSize}))&&"object"==typeof ret){if(!1===ret)return!1;top=ret.top,left=ret.left}if(next={page:{top:top,left:left},viewport:{top:top-pageYOffset,bottom:pageYOffset-top-height+innerHeight,left:left-pageXOffset,right:pageXOffset-left-width+innerWidth}},document.body.scrollWidth>window.innerWidth&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.bottom-=scrollbarSize.height),document.body.scrollHeight>window.innerHeight&&(scrollbarSize=this.cache("scrollbar-size",getScrollBarSize),next.viewport.right-=scrollbarSize.width),(""!==(_ref3=document.body.style.position)&&"static"!==_ref3||""!==(_ref4=document.body.parentElement.style.position)&&"static"!==_ref4)&&(next.page.bottom=document.body.scrollHeight-top-height,next.page.right=document.body.scrollWidth-left-width),!1!==(null!=(_ref5=this.options.optimizations)?_ref5.moveElement:void 0)&&null==this.targetModifier){for(offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),offsetPosition=this.cache("target-offsetparent-bounds",function(){return getBounds(offsetParent)}),offsetParentStyle=getComputedStyle(offsetParent),getComputedStyle(this.element),offsetParentSize=offsetPosition,offsetBorder={},_j=0,_len1=(_ref6=["Top","Left","Bottom","Right"]).length;_j<_len1;_j++)offsetBorder[(side=_ref6[_j]).toLowerCase()]=parseFloat(offsetParentStyle["border"+side+"Width"]);offsetPosition.right=document.body.scrollWidth-offsetPosition.left-offsetParentSize.width+offsetBorder.right,offsetPosition.bottom=document.body.scrollHeight-offsetPosition.top-offsetParentSize.height+offsetBorder.bottom,next.page.top>=offsetPosition.top+offsetBorder.top&&next.page.bottom>=offsetPosition.bottom&&next.page.left>=offsetPosition.left+offsetBorder.left&&next.page.right>=offsetPosition.right&&(scrollTop=offsetParent.scrollTop,scrollLeft=offsetParent.scrollLeft,next.offset={top:next.page.top-offsetPosition.top+scrollTop-offsetBorder.top,left:next.page.left-offsetPosition.left+scrollLeft-offsetBorder.left})}return this.move(next),this.history.unshift(next),this.history.length>3&&this.history.pop(),flushChanges&&flush(),!0}},_Tether.prototype.move=function(position){var css,elVal,found,key,moved,offsetParent,point,same,transcribe,type,val,write,writeCSS,_i,_len,_ref1,_ref2,_this=this;if(null!=this.element.parentNode){for(type in same={},position)for(key in same[type]={},position[type]){for(found=!1,_i=0,_len=(_ref1=this.history).length;_i<_len;_i++)if(point=_ref1[_i],!within(null!=(_ref2=point[type])?_ref2[key]:void 0,position[type][key])){found=!0;break}found||(same[type][key]=!0)}for(key in css={top:"",left:"",right:"",bottom:""},transcribe=function(same,pos){var xPos,yPos,_ref3;return!1===(null!=(_ref3=_this.options.optimizations)?_ref3.gpu:void 0)?(same.top?css.top=pos.top+"px":css.bottom=pos.bottom+"px",same.left?css.left=pos.left+"px":css.right=pos.right+"px"):(same.top?(css.top=0,yPos=pos.top):(css.bottom=0,yPos=-pos.bottom),same.left?(css.left=0,xPos=pos.left):(css.right=0,xPos=-pos.right),css[transformKey]="translateX("+Math.round(xPos)+"px) translateY("+Math.round(yPos)+"px)","msTransform"!==transformKey?css[transformKey]+=" translateZ(0)":void 0)},moved=!1,(same.page.top||same.page.bottom)&&(same.page.left||same.page.right)?(css.position="absolute",transcribe(same.page,position.page)):(same.viewport.top||same.viewport.bottom)&&(same.viewport.left||same.viewport.right)?(css.position="fixed",transcribe(same.viewport,position.viewport)):null!=same.offset&&same.offset.top&&same.offset.left?(css.position="absolute",offsetParent=this.cache("target-offsetparent",function(){return getOffsetParent(_this.target)}),getOffsetParent(this.element)!==offsetParent&&defer(function(){return _this.element.parentNode.removeChild(_this.element),offsetParent.appendChild(_this.element)}),transcribe(same.offset,position.offset),moved=!0):(css.position="absolute",transcribe({top:!0,left:!0},position.page)),moved||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),writeCSS={},write=!1,css)val=css[key],""===(elVal=this.element.style[key])||""===val||"top"!==key&&"left"!==key&&"bottom"!==key&&"right"!==key||(elVal=parseFloat(elVal),val=parseFloat(val)),elVal!==val&&(write=!0,writeCSS[key]=css[key]);return write?defer(function(){return extend(_this.element.style,writeCSS)}):void 0}},_Tether}(),Tether.position=position,this.Tether=extend(_Tether,Tether)}.call(this),function(){var BOUNDS_FORMAT,defer,extend,getBoundingRect,getBounds,updateClasses,_ref,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};(_ref=this.Tether.Utils).getOuterSize,getBounds=_ref.getBounds,_ref.getSize,extend=_ref.extend,updateClasses=_ref.updateClasses,defer=_ref.defer,BOUNDS_FORMAT=["left","top","right","bottom"],getBoundingRect=function(tether,to){var i,pos,side,size,style,_i,_len;if("scrollParent"===to?to=tether.scrollParent:"window"===to&&(to=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),to===document&&(to=to.documentElement),null!=to.nodeType)for(pos=size=getBounds(to),style=getComputedStyle(to),to=[pos.left,pos.top,size.width+pos.left,size.height+pos.top],i=_i=0,_len=BOUNDS_FORMAT.length;_i<_len;i=++_i)"Top"===(side=(side=BOUNDS_FORMAT[i])[0].toUpperCase()+side.substr(1))||"Left"===side?to[i]+=parseFloat(style["border"+side+"Width"]):to[i]-=parseFloat(style["border"+side+"Width"]);return to},this.Tether.modules.push({position:function(_arg){var addClasses,allClasses,attachment,bounds,changeAttachX,changeAttachY,cls,constraint,eAttachment,height,left,oob,oobClass,p,pin,pinned,pinnedClass,side,tAttachment,targetAttachment,targetHeight,targetSize,targetWidth,to,top,width,_i,_j,_k,_l,_len,_len1,_len2,_len3,_len4,_len5,_m,_n,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_this=this;if(top=_arg.top,left=_arg.left,targetAttachment=_arg.targetAttachment,!this.options.constraints)return!0;for(function(prefix){var side,_i,_len,_results;for(_this.removeClass(prefix),_results=[],_i=0,_len=BOUNDS_FORMAT.length;_i<_len;_i++)side=BOUNDS_FORMAT[_i],_results.push(_this.removeClass(prefix+"-"+side));return _results},height=(_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)})).height,0===(width=_ref1.width)&&0===height&&null!=this.lastSize&&(width=(_ref2=this.lastSize).width,height=_ref2.height),targetHeight=(targetSize=this.cache("target-bounds",function(){return _this.getTargetBounds()})).height,targetWidth=targetSize.width,tAttachment={},eAttachment={},allClasses=[this.getClass("pinned"),this.getClass("out-of-bounds")],_i=0,_len=(_ref3=this.options.constraints).length;_i<_len;_i++)(constraint=_ref3[_i]).outOfBoundsClass&&allClasses.push(constraint.outOfBoundsClass),constraint.pinnedClass&&allClasses.push(constraint.pinnedClass);for(_j=0,_len1=allClasses.length;_j<_len1;_j++)for(cls=allClasses[_j],_k=0,_len2=(_ref4=["left","top","right","bottom"]).length;_k<_len2;_k++)side=_ref4[_k],allClasses.push(cls+"-"+side);for(addClasses=[],tAttachment=extend({},targetAttachment),eAttachment=extend({},this.attachment),_l=0,_len3=(_ref5=this.options.constraints).length;_l<_len3;_l++){if(to=(constraint=_ref5[_l]).to,attachment=constraint.attachment,pin=constraint.pin,null==attachment&&(attachment=""),__indexOf.call(attachment," ")>=0?(changeAttachY=(_ref6=attachment.split(" "))[0],changeAttachX=_ref6[1]):changeAttachX=changeAttachY=attachment,bounds=getBoundingRect(this,to),"target"!==changeAttachY&&"both"!==changeAttachY||(top<bounds[1]&&"top"===tAttachment.top&&(top+=targetHeight,tAttachment.top="bottom"),top+height>bounds[3]&&"bottom"===tAttachment.top&&(top-=targetHeight,tAttachment.top="top")),"together"===changeAttachY&&(top<bounds[1]&&"top"===tAttachment.top&&("bottom"===eAttachment.top?(top+=targetHeight,tAttachment.top="bottom",top+=height,eAttachment.top="top"):"top"===eAttachment.top&&(top+=targetHeight,tAttachment.top="bottom",top-=height,eAttachment.top="bottom")),top+height>bounds[3]&&"bottom"===tAttachment.top&&("top"===eAttachment.top?(top-=targetHeight,tAttachment.top="top",top-=height,eAttachment.top="bottom"):"bottom"===eAttachment.top&&(top-=targetHeight,tAttachment.top="top",top+=height,eAttachment.top="top")),"middle"===tAttachment.top&&(top+height>bounds[3]&&"top"===eAttachment.top?(top-=height,eAttachment.top="bottom"):top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"))),"target"!==changeAttachX&&"both"!==changeAttachX||(left<bounds[0]&&"left"===tAttachment.left&&(left+=targetWidth,tAttachment.left="right"),left+width>bounds[2]&&"right"===tAttachment.left&&(left-=targetWidth,tAttachment.left="left")),"together"===changeAttachX&&(left<bounds[0]&&"left"===tAttachment.left?"right"===eAttachment.left?(left+=targetWidth,tAttachment.left="right",left+=width,eAttachment.left="left"):"left"===eAttachment.left&&(left+=targetWidth,tAttachment.left="right",left-=width,eAttachment.left="right"):left+width>bounds[2]&&"right"===tAttachment.left?"left"===eAttachment.left?(left-=targetWidth,tAttachment.left="left",left-=width,eAttachment.left="right"):"right"===eAttachment.left&&(left-=targetWidth,tAttachment.left="left",left+=width,eAttachment.left="left"):"center"===tAttachment.left&&(left+width>bounds[2]&&"left"===eAttachment.left?(left-=width,eAttachment.left="right"):left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"))),"element"!==changeAttachY&&"both"!==changeAttachY||(top<bounds[1]&&"bottom"===eAttachment.top&&(top+=height,eAttachment.top="top"),top+height>bounds[3]&&"top"===eAttachment.top&&(top-=height,eAttachment.top="bottom")),"element"!==changeAttachX&&"both"!==changeAttachX||(left<bounds[0]&&"right"===eAttachment.left&&(left+=width,eAttachment.left="left"),left+width>bounds[2]&&"left"===eAttachment.left&&(left-=width,eAttachment.left="right")),"string"==typeof pin?pin=function(){var _len4,_m,_ref7,_results;for(_results=[],_m=0,_len4=(_ref7=pin.split(",")).length;_m<_len4;_m++)p=_ref7[_m],_results.push(p.trim());return _results}():!0===pin&&(pin=["top","left","right","bottom"]),pin||(pin=[]),pinned=[],oob=[],top<bounds[1]&&(__indexOf.call(pin,"top")>=0?(top=bounds[1],pinned.push("top")):oob.push("top")),top+height>bounds[3]&&(__indexOf.call(pin,"bottom")>=0?(top=bounds[3]-height,pinned.push("bottom")):oob.push("bottom")),left<bounds[0]&&(__indexOf.call(pin,"left")>=0?(left=bounds[0],pinned.push("left")):oob.push("left")),left+width>bounds[2]&&(__indexOf.call(pin,"right")>=0?(left=bounds[2]-width,pinned.push("right")):oob.push("right")),pinned.length)for(pinnedClass=null!=(_ref7=this.options.pinnedClass)?_ref7:this.getClass("pinned"),addClasses.push(pinnedClass),_m=0,_len4=pinned.length;_m<_len4;_m++)side=pinned[_m],addClasses.push(pinnedClass+"-"+side);if(oob.length)for(oobClass=null!=(_ref8=this.options.outOfBoundsClass)?_ref8:this.getClass("out-of-bounds"),addClasses.push(oobClass),_n=0,_len5=oob.length;_n<_len5;_n++)side=oob[_n],addClasses.push(oobClass+"-"+side);(__indexOf.call(pinned,"left")>=0||__indexOf.call(pinned,"right")>=0)&&(eAttachment.left=tAttachment.left=!1),(__indexOf.call(pinned,"top")>=0||__indexOf.call(pinned,"bottom")>=0)&&(eAttachment.top=tAttachment.top=!1),tAttachment.top===targetAttachment.top&&tAttachment.left===targetAttachment.left&&eAttachment.top===this.attachment.top&&eAttachment.left===this.attachment.left||this.updateAttachClasses(eAttachment,tAttachment)}return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),{top:top,left:left}}})}.call(this),function(){var defer,getBounds,updateClasses,_ref;_ref=this.Tether.Utils,getBounds=_ref.getBounds,updateClasses=_ref.updateClasses,defer=_ref.defer,this.Tether.modules.push({position:function(_arg){var abutted,addClasses,allClasses,bottom,left,right,side,sides,targetPos,top,_i,_j,_k,_l,_len,_len1,_len2,_len3,_ref1,_ref2,_ref3,_ref4,_ref5,_this=this;if(top=_arg.top,left=_arg.left,bottom=top+(_ref1=this.cache("element-bounds",function(){return getBounds(_this.element)})).height,right=left+_ref1.width,abutted=[],top<=(targetPos=this.getTargetBounds()).bottom&&bottom>=targetPos.top)for(_i=0,_len=(_ref2=["left","right"]).length;_i<_len;_i++)(_ref3=targetPos[side=_ref2[_i]])!==left&&_ref3!==right||abutted.push(side);if(left<=targetPos.right&&right>=targetPos.left)for(_j=0,_len1=(_ref4=["top","bottom"]).length;_j<_len1;_j++)(_ref5=targetPos[side=_ref4[_j]])!==top&&_ref5!==bottom||abutted.push(side);for(addClasses=[],sides=["left","top","right","bottom"],(allClasses=[]).push(this.getClass("abutted")),_k=0,_len2=sides.length;_k<_len2;_k++)side=sides[_k],allClasses.push(this.getClass("abutted")+"-"+side);for(abutted.length&&addClasses.push(this.getClass("abutted")),_l=0,_len3=abutted.length;_l<_len3;_l++)side=abutted[_l],addClasses.push(this.getClass("abutted")+"-"+side);return defer(function(){return updateClasses(_this.target,addClasses,allClasses),updateClasses(_this.element,addClasses,allClasses)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(_arg){var left,shift,shiftLeft,shiftTop,top,_ref;if(top=_arg.top,left=_arg.left,this.options.shift)return"string"==typeof(shift=function(val){return"function"==typeof val?val.call(this,{top:top,left:left}):val}(this.options.shift))?((shift=shift.split(" "))[1]||(shift[1]=shift[0]),shiftTop=shift[0],shiftLeft=shift[1],shiftTop=parseFloat(shiftTop,10),shiftLeft=parseFloat(shiftLeft,10)):(shiftTop=(_ref=[shift.top,shift.left])[0],shiftLeft=_ref[1]),{top:top+=shiftTop,left:left+=shiftLeft}}})}.call(this),this.Tether}),function(){var ATTACHMENT,Evented,Shepherd,Step,Tour,addClass,createFromHTML,extend,hasClass,matchesSelector,parseShorthand,ref,removeClass,uniqueId,bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend1=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;ref=Tether.Utils,extend=ref.extend,removeClass=ref.removeClass,addClass=ref.addClass,hasClass=ref.hasClass,Evented=ref.Evented,ref.getBounds,uniqueId=ref.uniqueId,Shepherd=new Evented,ATTACHMENT={top:"bottom center",left:"middle right",right:"middle left",bottom:"top center",center:"middle center"},createFromHTML=function(html){var el;return(el=document.createElement("div")).innerHTML=html,el.children[0]},matchesSelector=function(el,sel){var ref1,ref2,ref3,ref4,ref5;return(null!=(ref1=null!=(ref2=null!=(ref3=null!=(ref4=null!=(ref5=el.matches)?ref5:el.matchesSelector)?ref4:el.msMatchesSelector)?ref3:el.webkitMatchesSelector)?ref2:el.mozMatchesSelector)?ref1:el.oMatchesSelector).call(el,sel)},parseShorthand=function(obj,props){var i,j,len,out,vals;if(null==obj)return obj;if("object"==typeof obj)return obj;for((vals=obj.split(" ")).length>props.length&&(vals[0]=vals.slice(0,+(vals.length-props.length)+1||9e9).join(" "),vals.splice(1,vals.length-props.length)),out={},i=j=0,len=props.length;j<len;i=++j)out[props[i]]=vals[i]
;return out},Step=function(){function Step(tour,options){this.tour=tour,this.destroy=bind(this.destroy,this),this.scrollTo=bind(this.scrollTo,this),this.complete=bind(this.complete,this),this.cancel=bind(this.cancel,this),this.isOpen=bind(this.isOpen,this),this.hide=bind(this.hide,this),this.show=bind(this.show,this),this.setOptions(options)}return extend1(Step,Evented),Step.prototype.setOptions=function(options1){var base,event,handler,ref1;if(this.options=null!=options1?options1:{},this.destroy(),this.id=this.options.id||this.id||"step-"+uniqueId(),this.options.when)for(event in ref1=this.options.when)handler=ref1[event],this.on(event,handler,this);return null!=(base=this.options).buttons?base.buttons:base.buttons=[{text:"Next",action:this.tour.next}]},Step.prototype.getTour=function(){return this.tour},Step.prototype.bindAdvance=function(){var event,handler,ref1,selector,_this;return ref1=parseShorthand(this.options.advanceOn,["selector","event"]),event=ref1.event,selector=ref1.selector,_this=this,handler=function(e){if(_this.isOpen())if(null!=selector){if(matchesSelector(e.target,selector))return _this.tour.next()}else if(_this.el&&e.target===_this.el)return _this.tour.next()},document.body.addEventListener(event,handler),this.on("destroy",function(){return document.body.removeEventListener(event,handler)})},Step.prototype.getAttachTo=function(){var opts;if(null==(opts=parseShorthand(this.options.attachTo,["element","on"]))&&(opts={}),"string"==typeof opts.element&&(opts.element=document.querySelector(opts.element),null==opts.element))throw new Error("Shepherd step's attachTo was not found in the page");return opts},Step.prototype.setupTether=function(){var attachment,opts,tetherOpts;if("undefined"==typeof Tether||null===Tether)throw new Error("Using the attachment feature of Shepherd requires the Tether library");return opts=this.getAttachTo(),attachment=ATTACHMENT[opts.on||"right"],null==opts.element&&(opts.element="viewport",attachment="middle center"),tetherOpts={classPrefix:"shepherd",element:this.el,constraints:[{to:"window",pin:!0,attachment:"together"}],target:opts.element,offset:opts.offset||"0 0",attachment:attachment},this.tether=new Tether(extend(tetherOpts,this.options.tetherOptions))},Step.prototype.show=function(){var _this;return null==this.el&&this.render(),addClass(this.el,"shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupTether(),this.options.scrollTo&&setTimeout((_this=this,function(){return _this.scrollTo()})),this.trigger("show")},Step.prototype.hide=function(){var ref1;return removeClass(this.el,"shepherd-open"),document.body.removeAttribute("data-shepherd-step"),null!=(ref1=this.tether)&&ref1.destroy(),this.tether=null,this.trigger("hide")},Step.prototype.isOpen=function(){return hasClass(this.el,"shepherd-open")},Step.prototype.cancel=function(){return this.tour.cancel(),this.trigger("cancel")},Step.prototype.complete=function(){return this.tour.complete(),this.trigger("complete")},Step.prototype.scrollTo=function(){var element;return element=this.getAttachTo().element,null!=this.options.scrollToHandler?this.options.scrollToHandler(element):null!=element?element.scrollIntoView():void 0},Step.prototype.destroy=function(){var ref1;return null!=this.el&&(document.body.removeChild(this.el),delete this.el),null!=(ref1=this.tether)&&ref1.destroy(),this.tether=null,this.trigger("destroy")},Step.prototype.render=function(){var button,buttons,cfg,content,footer,header,j,k,len,len1,link,paragraph,paragraphs,ref1,ref2,ref3,text;if(null!=this.el&&this.destroy(),this.el=createFromHTML("<div class='shepherd-step "+(null!=(ref1=this.options.classes)?ref1:"")+"' data-id='"+this.id+"'></div>"),(content=document.createElement("div")).className="shepherd-content",this.el.appendChild(content),header=document.createElement("header"),content.appendChild(header),null!=this.options.title&&(header.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink&&(link=createFromHTML("<a href class='"+(this.options.cancelLinkClasses||"shepherd-cancel-link")+"'></a>"),header.appendChild(link),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(link)),null!=this.options.text){if(text=createFromHTML("<div class='shepherd-text'></div>"),"function"==typeof(paragraphs=this.options.text)&&(paragraphs=this.options.text.call(this,text)),paragraphs instanceof HTMLElement)text.appendChild(paragraphs);else for("string"==typeof paragraphs&&(paragraphs=[paragraphs]),j=0,len=paragraphs.length;j<len;j++)paragraph=paragraphs[j],text.innerHTML+="<p>"+paragraph+"</p>";content.appendChild(text)}if(footer=document.createElement("footer"),this.options.buttons){for(buttons=createFromHTML("<ul class='shepherd-buttons'></ul>"),k=0,len1=(ref2=this.options.buttons).length;k<len1;k++)cfg=ref2[k],button=createFromHTML("<li class='shepherd-button-cont'><a class='"+(null!=(ref3=cfg.classes)?ref3:"shepherd-button")+"'>"+cfg.text+"</a>"),buttons.appendChild(button),this.bindButtonEvents(cfg,button.querySelector("a"));footer.appendChild(buttons)}if(content.appendChild(footer),document.body.appendChild(this.el),this.setupTether(),this.options.advanceOn)return this.bindAdvance()},Step.prototype.bindCancelLink=function(link){return link.addEventListener("click",(_this=this,function(e){return e.preventDefault(),_this.cancel()}));var _this},Step.prototype.bindButtonEvents=function(cfg,el){var event,handler,page,ref1;for(event in null==cfg.events&&(cfg.events={}),null!=cfg.action&&(cfg.events.click=cfg.action),ref1=cfg.events)"string"==typeof(handler=ref1[event])&&(page=handler,handler=function(_this){return function(){return _this.tour.show(page)}}(this)),el.addEventListener(event,handler);return this.on("destroy",function(){var ref2,results;for(event in results=[],ref2=cfg.events)handler=ref2[event],results.push(el.removeEventListener(event,handler));return results})},Step}(),Tour=function(){function Tour(options1){var fn,j,len,ref1,ref2,_this;for(this.options=null!=options1?options1:{},this.hide=bind(this.hide,this),this.complete=bind(this.complete,this),this.cancel=bind(this.cancel,this),this.back=bind(this.back,this),this.next=bind(this.next,this),this.steps=null!=(ref1=this.options.steps)?ref1:[],_this=this,fn=function(event){return _this.on(event,function(opts){return null==opts&&(opts={}),opts.tour=_this,Shepherd.trigger(event,opts)})},j=0,len=(ref2=["complete","cancel","hide","start","show","active","inactive"]).length;j<len;j++)fn(ref2[j])}return extend1(Tour,Evented),Tour.prototype.addStep=function(name,step){var ref1;return null==step&&(step=name),step instanceof Step?step.tour=this:("string"!=(ref1=typeof name)&&"number"!==ref1||(step.id=name.toString()),step=extend({},this.options.defaults,step),step=new Step(this,step)),this.steps.push(step),this},Tour.prototype.getById=function(id){var j,len,ref1,step;for(j=0,len=(ref1=this.steps).length;j<len;j++)if((step=ref1[j]).id===id)return step},Tour.prototype.getCurrentStep=function(){return this.currentStep},Tour.prototype.next=function(){var index;return(index=this.steps.indexOf(this.currentStep))===this.steps.length-1?(this.hide(index),this.trigger("complete"),this.done()):this.show(index+1)},Tour.prototype.back=function(){var index;return index=this.steps.indexOf(this.currentStep),this.show(index-1)},Tour.prototype.cancel=function(){var ref1;return null!=(ref1=this.currentStep)&&ref1.hide(),this.trigger("cancel"),this.done()},Tour.prototype.complete=function(){var ref1;return null!=(ref1=this.currentStep)&&ref1.hide(),this.trigger("complete"),this.done()},Tour.prototype.hide=function(){var ref1;return null!=(ref1=this.currentStep)&&ref1.hide(),this.trigger("hide"),this.done()},Tour.prototype.done=function(){return Shepherd.activeTour=null,removeClass(document.body,"shepherd-active"),this.trigger("inactive",{tour:this})},Tour.prototype.show=function(key){var next;if(null==key&&(key=0),this.currentStep?this.currentStep.hide():(addClass(document.body,"shepherd-active"),this.trigger("active",{tour:this})),Shepherd.activeTour=this,next="string"==typeof key?this.getById(key):this.steps[key])return this.trigger("show",{step:next,previous:this.currentStep}),this.currentStep=next,next.show()},Tour.prototype.start=function(){return this.trigger("start"),this.currentStep=null,this.next()},Tour}(),extend(Shepherd,{Tour:Tour,Step:Step,Evented:Evented}),window.Shepherd=Shepherd}.call(this),window.LocalFileReader=function(){var LocalFileReader=function(){};if(window.File&&window.FileReader&&window.FileList&&window.Blob){LocalFileReader.isSupported=!0,LocalFileReader.readers={},LocalFileReader.matchers={},LocalFileReader.add_reader=function(id,type_reg,constructor){LocalFileReader.readers[id]=constructor,LocalFileReader.matchers[id]=type_reg};var reader_from_type=function(type){for(id in LocalFileReader.matchers){if(LocalFileReader.matchers.hasOwnProperty(id))if(LocalFileReader.matchers[id].test(type))return new LocalFileReader.readers[id]}};LocalFileReader.read=function(file,reader,options){return options||(options={}),(reader=reader||reader_from_type(file.type))?reader.load(file,options):new Promise(function(resolve,reject){reject(new Error("unknown mime-type: '#{file.type}'"))})}}else LocalFileReader.isSupported=!1;return LocalFileReader}(),function(){!function(context){"use strict";context.LocalFileReader.DefaultReader=function(){function DefaultReader(){}return DefaultReader.prototype.load=function(file,options){return this.file=file,this.options=options,this.reader=new FileReader,new Promise((_this=this,function(resolve,reject){return _this.reader.addEventListener("load",function(e){return resolve(_this.parse_data(e.target.result))}),_this.reader.addEventListener("error",function(e){return reject(e.target.error)}),_this.invoke_read()}));var _this},DefaultReader.prototype.invoke_read=function(){return this.reader.readAsBinaryString(this.file)},DefaultReader.prototype.parse_data=function(data){return data},DefaultReader}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var TextReader,_iso_rxp,_utf_rxp;if(_utf_rxp=/[\u0100-\u0171\u0410-\u044f]{2,}/,_iso_rxp=/[\xc0-\xd6]{2,}/,TextReader=function(superClass){function TextReader(){return TextReader.__super__.constructor.apply(this,arguments)}return extend(TextReader,superClass),TextReader.prototype.load=function(file,options){return this.file=file,this.options=null!=options?options:{},this.reader=new FileReader,null!=this.options.encoding?this.do_read():this.do_detect_encoding().then((_this=this,function(){return _this.do_read()}),function(e){throw e});var _this},TextReader.prototype.do_detect_encoding=function(){return new Promise((_this=this,function(resolve,reject){var blob;return _this.reader.addEventListener("load",function(e){if(!_this._detected)return _utf_rxp.test(e.target.result)?_this.options.encoding="":_iso_rxp.test(e.target.result)?_this.options.encoding="ISO-8859-1":_this.options.encoding="CP1251",_this._detected=!0,resolve(e.target.result)}),_this.reader.addEventListener("error",function(e){return reject(e.target.error)}),blob=_this.file.slice(0,2e3),_this.reader.readAsText(blob)}));var _this},TextReader.prototype.do_read=function(){return new Promise((_this=this,function(resolve,reject){return _this.reader.addEventListener("load",function(e){return resolve(_this.parse_data(e.target.result))}),_this.reader.addEventListener("error",function(e){return reject(e.target.error)}),_this.invoke_read()}));var _this},TextReader.prototype.invoke_read=function(){return this.reader.readAsText(this.file,this.options.encoding)},TextReader}(context.LocalFileReader.DefaultReader),context.LocalFileReader&&context.LocalFileReader.isSupported)context.LocalFileReader.add_reader("csv",/text\/.*/,TextReader),context.LocalFileReader.add_reader("csv-ms",/application\/.*(excel|csv).*/,TextReader)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var ImageReader;if(ImageReader=function(superClass){function ImageReader(){return ImageReader.__super__.constructor.apply(this,arguments)}return extend(ImageReader,superClass),ImageReader.prototype.invoke_read=function(){return this.reader.readAsDataURL(this.file)},ImageReader}(context.LocalFileReader.DefaultReader),context.LocalFileReader&&context.LocalFileReader.isSupported)context.LocalFileReader.add_reader("image",/image\/.*/,ImageReader)}(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/accounts/clear_payment_credentials_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("accounts.confirm.clear_payment_credentials")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/accounts/edit_link_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4,_skim_codeattributes5;if(_buf="",_buf+='<div class="item edit-link item ',_buf+=this.escape(this.label?void 0:"is-editing"),_buf+='"><div class="view">',this.label&&this.url){switch(_buf+='<input name="menu[links][][label]" type="hidden"',_skim_codeattributes1=this.label){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><input name="menu[links][][url]" type="hidden"',_skim_codeattributes2=this.url){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}_buf+=" />"}switch(_buf+='<div class="field">',_buf+=this.escape(this.label),_buf+=" <a",_skim_codeattributes3=this.url){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=">",_buf+=this.escape(this.url),_buf+='</a></div><div class="buttons inline-right"><div class="icon-button inline button pi edit-btn" data-on-click="@host.addClass(&#39;is-editing&#39;)"><i class="fa fa-pencil"></i></div><div class="icon-button inline button pi delete-btn" data-on-click="@host.host.remove_item(@host)"><i class="fa fa-trash-o"></i></div></div></div><form class="edit pi pi-form" data-on-submited="@host.host.update_item(@host,e.data)"><div class="field label"><label class="field-label">',_buf+=this.escape(I18n.t("accounts.edit.menu.link_label")),_buf+='</label> <div class="pi-text-input-wrap pi" data-name="label" data-validates="presence"><input class="text-input" type="text"',_skim_codeattributes4=this.label){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}switch(_buf+=' /></div></div> <div class="field url"><label class="field-label">',_buf+=this.escape(I18n.t("accounts.edit.menu.link_url")),_buf+='</label> <div class="pi-text-input-wrap pi" data-name="url" data-validates="presence"><input class="text-input" type="text"',_skim_codeattributes5=this.url){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes5),_buf+='"'}return _buf+=' /></div></div><div class="buttons inline-right"><div class="icon-button inline button pi copy-btn" data-on-click="@host.submit()"><i class="fa fa-check"></i></div></div></form></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/accounts/show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<div class="profile-info"><div class="avatar">',this.logo_large_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.logo_large_url),_buf+='" />'):(_buf+='<div class="no-avatar"><div class="no-avatar-link"><a class="dotted-link" href="@@edit">',_buf+=this.escape(I18n.t("accounts.show.logo_missing")),_buf+="</a></div></div>"),_buf+='</div><div class="info"><div class="field"><div class="title">',_buf+=this.escape(this.name),_buf+='</div><div class="action-btn inline button button-finish pi" data-component="button" data-on-click="@@edit"><i class="button-icon fa fa-pencil"></i><div class="btn-label">',_buf+=this.escape(""+I18n.t("helpers.edit")),_buf+='</div></div></div><div class="clear"></div><div class="line"></div>',this.subdomain||this.hostname){switch(_buf+='<div class="field"><div class="label">',_buf+=this.escape(I18n.t("accounts.show.login_path")+": "),_buf+='</div><a class="data account-login-path"',_skim_codeattributes1=this.login_url){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.login_url),_buf+="</a></div>"}return _buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/account_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.id),_buf+='</div><div class="field name" title="',_buf+=this.escape(this.name),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field registered">',_buf+=this.escape(this.created_at),_buf+="</div>",this.has_details&&("enabled"===this.status?(_buf+='<div class="field status green">',_buf+=this.escape(this.status_name),_buf+="</div>"):(_buf+='<div class="field status red">',_buf+=this.escape(this.status_name),_buf+="</div>"),_buf+='<div class="field started">',_buf+=this.escape(this.started_time),_buf+='</div><div class="field finished">',_buf+=this.escape(this.finished_time),_buf+="</div>",this.agreement_type&&!this.docs_sent&&(_buf+='<div class="field"><i class="fa docs-not-sent fa-exclamation"></i></div>')),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/account_short_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field fullname" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/convert_to_master_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("accounts.convert_to_master_confirm")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("accounts.account_destroy_confirm")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/manager_list_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field fullname" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.fullname),_buf+='</div><div class="field email">',_buf+=this.escape(this.email),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/netology"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field fullname" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/order_list_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field order_name">',_buf+=this.escape(this.name),_buf+='</div><div class="field amount">',_buf+=this.escape(this.amount),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.id),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/show_content"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field name"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.show_title")),_buf+='</span><div class="info-field select-text title">',_buf+=this.escape(this.name),_buf+='</div></div><div class="field button"><a class="button button-save" href="/admin/accounts/',_buf+=this.escape(this.id),_buf+='/login">',_buf+=this.escape(I18n.t("accounts.admin_login_account")),_buf+='</a></div><div class="field button is-hidden pi" data-pid="disable_btn"><a class="button pi-button-red pi toggle-btn" data-pid="toggle_btn" href="@@toggle_status">',_buf+=this.escape(I18n.t("accounts.disable")),_buf+='</a></div><div class="field button is-hidden pi" data-pid="enable_btn"><a class="button pi-button-green pi toggle-btn" data-pid="toggle_btn" href="@@toggle_status">',_buf+=this.escape(I18n.t("accounts.enable")),_buf+='</a></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.current_subscription")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.subscription_name),_buf+='</div></div><div class="clear"></div><div class="delimeter"></div>',this.agreement_type&&(_buf+='<div class="agreement-scope"><div class="field-title">',_buf+=this.escape(I18n.t("activemodel.models.agreement_form")),_buf+="</div>","personal"===this.agreement_type&&(_buf+='<div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.type")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(I18n.t("accounts.agreements.personal")),_buf+='</div></div><div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.birthday")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.birthday),_buf+="</div></div>"),"company"===this.agreement_type&&(_buf+='<div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.type")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(I18n.t("accounts.agreements.company")),_buf+='</div></div><div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.company")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.company_name),_buf+='</div></div><div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.tax_number")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.tax_number),_buf+="</div></div>"),_buf+='<div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.phone")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.owner_phone),_buf+='</div></div><div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.name")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.owner_fullname),_buf+='</div></div><div class="field agreement"><span class="field-label">',_buf+=this.escape(I18n.t("activemodel.attributes.agreement_form.address")),_buf+='</span><div class="info-field agreement">',_buf+=this.escape(this.address),_buf+='</div></div><div class="field agreement"><div class="divided-links"><div class="divided-link inline"><a class="link dotted-link" href="',_buf+=this.escape(this.agreement_admin_link),_buf+='?preview=Y" target="_blank">',_buf+=this.escape(I18n.t("accounts.agreement_link")),_buf+='</a></div><div class="divided-link inline"><a class="link dotted-link grey" href="',_buf+=this.escape(this.agreement_admin_link),_buf+='?force=Y&amp;preview=Y" target="_blank">',_buf+=this.escape(I18n.t("accounts.agreement_renew_link")),_buf+='</a></div></div></div></div><div class="clear"></div><div class="delimeter"></div>'),_buf+='<div class="field starting"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.starting_subscribe")),_buf+='</span><div class="date">',_buf+=this.escape(this.started_time),_buf+='</div></div><div class="field ending"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.ending_subscribe")),_buf+='</span><div class="date">',_buf+=this.escape(this.finished_time),_buf+='</div></div><div class="clear"></div><div class="delimeter"></div><div class="field users-block"><div class="field-label">',_buf+=this.escape(I18n.t("accounts.using_users")),_buf+='</div><span class="number">',_buf+=this.escape(this.users_num+" "+I18n.t("accounts.from")+" "+this.subscription_users),_buf+='</span></div><div class="field memory-block"><div class="field-label">',_buf+=this.escape(I18n.t("accounts.using_memory")),_buf+='</div><span class="number">',_buf+=this.escape(this.memory_total+" "+I18n.t("accounts.from")+" "+this.subscription_memory),_buf+='</span></div><div class="clear"></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/sub_list_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field sub-name">',_buf+=this.escape(this.name),_buf+='</div><div class="field started">',_buf+=this.start_date+" - "+this.finish_date,_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/accounts/system_color_theme_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.user_id),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field name">',_buf+=this.escape(this.login),_buf+='</div><div class="field data-time">',_buf+=this.escape(this.deleted_at),_buf+='</div><div class="field data-time">',_buf+=this.escape(this.course_session_id),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/north_star/subscription_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.account_name),_buf+=" &mdash; ",_buf+=this.escape(this.name),_buf+='</a></div><div class="field date">',_buf+=this.escape(this.start_date),_buf+='</div><div class="field date">',_buf+=this.finish_date,_buf+='</div><div class="field date">',_buf+=this.closed_date||"-",_buf+='</div><div class="field active_users">',_buf+=this.escape(this.active_users),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("orders.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/edit_file_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="files"><div class="file-info"><label class="field-label">',_buf+=this.escape(I18n.t("orders.invoice")),_buf+="</label>",this.has_invoice?(_buf+='<span class="file-name">',_buf+=this.escape(this.invoice_file_name),_buf+='</span><a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;invoice&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+='</a><a class="link dotted-link up-doc red pi" data-on-click="@@delete_document(&#39;invoice&#39;)">',_buf+=this.escape(I18n.t("orders.delete")),_buf+="</a>"):(_buf+='<a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;invoice&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+="</a>"),_buf+='</div><div class="file-info"><label class="field-label">',_buf+=this.escape(I18n.t("orders.doc")),_buf+="</label>",this.has_doc?(_buf+='<span class="file-name">',_buf+=this.escape(this.doc_file_name),_buf+='</span><a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;doc&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+='</a><a class="link dotted-link up-doc red pi" data-on-click="@@delete_document(&#39;doc&#39;)">',_buf+=this.escape(I18n.t("orders.delete")),_buf+="</a>"):(_buf+='<a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;doc&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+="</a>"),_buf+='</div><div class="file-info"><label class="field-label">',_buf+=this.escape(I18n.t("orders.act")),_buf+="</label>",this.has_act?(_buf+='<span class="file-name">',_buf+=this.escape(this.act_file_name),_buf+='</span><a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;act&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+='</a><a class="link dotted-link up-doc red pi" data-on-click="@@delete_document(&#39;act&#39;)">',_buf+=this.escape(I18n.t("orders.delete")),_buf+="</a>"):(_buf+='<a class="link dotted-link up-doc pi" data-on-click="@@upload_document(&#39;act&#39;)">',_buf+=this.escape(I18n.t("orders.upload")),_buf+="</a>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2;if(_buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.account_name),_buf+=" &mdash; ",_buf+=this.escape(this.name),_buf+='</a></div><div class="field date">',_buf+=this.escape(this.created_time),_buf+='</div><div class="field date">',_buf+=this.escape(this.payment_date),_buf+='</div><div class="field date">',_buf+=this.escape(this.payment_till_date),_buf+='</div><div class="field amount">',_buf+=this.escape(this.amount),_buf+='</div><div class="field status ',
_buf+=this.escape(this.text_status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div>",this.docs_sent){switch(_buf+='<div class="field docs-status is-sent"',_skim_codeattributes1=I18n.t("orders.docs_is_sent")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+='><i class="fa fa-file-text"></i></div>'}else{switch(_buf+='<div class="field docs-status"',_skim_codeattributes2=I18n.t("orders.docs_isnt_sent")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}_buf+='><i class="fa fa-file-text"></i></div>'}return _buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/select_account_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</div>","enabled"===this.status?(_buf+='<div class="field status green">',_buf+=this.escape(this.status_name),_buf+="</div>"):"disabled"===this.status&&(_buf+='<div class="field status red">',_buf+=this.escape(this.status_name),_buf+="</div>"),_buf+='<i class="fa fa-check"></i></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/select_tariff_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</div><div class="field amount" title="',_buf+=this.escape(this.amount),_buf+='">',_buf+=this.escape(this.humanize_amount),_buf+='</div><div class="field user_count">',_buf+=this.escape(this.user_count),_buf+='</div><div class="field disk_space">',_buf+=this.escape(this.humanize_memory),_buf+='</div><div class="field visible">',this.visible?_buf+='<i class="fa fa-check green"></i>':_buf+='<i class="fa fa-close red"></i>',_buf+='</div><i class="fa fa-check"></i></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/orders/send_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("orders.confirm.send_docs")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/products/orders/confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("products_orders.confirm")+" ?"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/products/orders/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field date">',_buf+=this.escape(this.created_time),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.product_name),_buf+='</a></div><div class="field name">',_buf+=this.escape(this.account_name),_buf+='</div><div class="field email">',_buf+=this.escape(this.user_email),_buf+='</div><div class="field amount">',_buf+=this.escape(this.amount),_buf+='</div><div class="field status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/products/orders/show_content"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field id"><span class="field-label">',_buf+=this.escape(I18n.t("orders.id")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.id),_buf+='</div></div><div class="field id"><span class="field-label">',_buf+=this.escape(I18n.t("orders.status")),_buf+='</span><div class="info-field select-text ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+='</div></div><div class="field name"><span class="field-label">',_buf+=this.escape(I18n.t("products.name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.product_name),_buf+='</div></div><div class="field name"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.organization")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.account_name),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.fullname")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.user_fullname),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.email")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.user_email),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.created_time")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.created_time),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/products/stores/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("stores.confirm.destroy")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/products/stores/store_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field name">',_buf+=this.escape(this.account_name),_buf+='</div><div class="field date">',_buf+=this.escape(this.created_time),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/promo_codes/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("promo_codes.confirm.destroy")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/promo_codes/promo_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field code" title="',_buf+=this.escape(this.code),_buf+='">',_buf+=this.escape(this.code),_buf+='</div><div class="field user">',_buf+=this.escape(this.user_name),_buf+='</div><div class="field email">',_buf+=this.escape(this.user_email),_buf+='</div><div class="field account">',_buf+=this.escape(this.account),_buf+="</div>","percent"===this.type?(_buf+='<div class="field discount">',_buf+=this.escape(this.value),_buf+=" %</div>"):(_buf+='<div class="field discount">',_buf+=this.escape(this.value),_buf+=" ",_buf+=this.escape(I18n.t("promo_codes.cur")),_buf+="</div>"),_buf+='<div class="field expired_at">',_buf+=this.escape(this.expired_time),_buf+='</div><div class="field count">',_buf+=this.escape(this.count),_buf+="  </div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/reports/page_load_stats"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="admin-reports-stats-table"><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("admins.reports.load_time")),_buf+='</div><div class="value">',_buf+=this.escape((0|this.mean_load_time)+" ms / "+(0|this.perc_load_time)+" ms"),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("admins.reports.req_time")),_buf+='</div><div class="value">',_buf+=this.escape((0|this.mean_req_time)+" ms / "+(0|this.perc_req_time)+" ms"),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("admins.reports.dom_time")),_buf+='</div><div class="value">',_buf+=this.escape((0|this.mean_dom_time)+" ms / "+(0|this.perc_dom_time)+" ms"),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("admins.reports.ajax_time")),_buf+='</div><div class="value">',_buf+=(0|this.mean_ajax_time)+" ms / "+(0|this.perc_ajax_time)+" ms",_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/reports/slow_ajax_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item slow-ajax-item"><div class="field name" title="',_buf+=this.escape(this.page_id),_buf+='">',_buf+=this.escape(this.page_name),_buf+='</div><div class="field method">',_buf+=this.escape(this.method),_buf+='</div><div class="field req-time">',_buf+=this.escape(this.req_time+" ms"),_buf+='</div><div class="field user-id">',_buf+=this.escape(this.user_id),_buf+='</div><div class="field browser">',_buf+=this.escape(this.browser+" "+this.browser_version),_buf+='</div><div class="field os">',_buf+=this.escape(this.os),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/reports/slow_page_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item slow-page-item"><div class="field name" title="',_buf+=this.escape(this.page_name),_buf+='">',_buf+=this.escape(this.page_name),_buf+='</div><div class="field load-time">',_buf+=this.escape(this.load_time+" ms"),_buf+='</div><div class="field req-time">',_buf+=this.escape(this.req_time+" ms"),_buf+='</div><div class="field redirect-time">',_buf+=this.escape(this.redirect_time+" ms"),_buf+='</div><div class="field dom-time">',_buf+=this.escape(this.dom_time+" ms"),_buf+='</div><div class="field user-id">',_buf+=this.escape(this.user_id),_buf+='</div><div class="field browser">',_buf+=this.escape(this.browser+" "+this.browser_version),_buf+='</div><div class="field os">',_buf+=this.escape(this.os),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/restore/course_stat_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.user_id),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field name">',_buf+=this.escape(this.login),_buf+='</div><div class="field data-time">',_buf+=this.escape(this.deleted_at),_buf+='</div><div class="field data-time">',_buf+=this.escape(this.course_session_id),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/subscriptions/freeze_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("subscriptions.confirm.freeze")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/subscriptions/subscription_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.account_name),_buf+=" &mdash; ",_buf+=this.escape(this.name),_buf+='</a></div><div class="field date">',_buf+=this.escape(this.start_date),_buf+='</div><div class="field date">',_buf+=this.finish_date,_buf+='</div><div class="field amount">',_buf+=this.escape(this.payment_cur),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/subscriptions/subscription_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.account_name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.account_name),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.tariff_plan")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.tariff_plan),_buf+='</div></div><div class="field payment"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.payment")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.payment_cur),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.payment_type")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape({creditcard:I18n.t("orders.payment_form.creditcard"),bank_transfer:I18n.t("orders.payment_form.bank_transfer")}[this.payment_type]),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.started_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.start_date),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.finished_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.finish_date),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.closed_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.closed_date),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.memory")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.memory),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.active_users")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.active_users),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.users_limit")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.users_limit),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.months")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.months),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.days")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.days),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("subscriptions.promo_code")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.promo_code),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tariff_plans/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("tariff_plans.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tariff_plans/select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.id),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tariff_plans/tariff_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field price" title="',_buf+=this.escape(this.price),_buf+='">',_buf+=this.escape(this.price),_buf+='</div><div class="field active_users">',_buf+=this.escape(this.humanize_active_users),_buf+='</div><div class="field memory">',_buf+=this.escape(this.humanize_memory),_buf+='</div><div class="field free">',this.free?_buf+='<i class="fa fa-check green"></i>':_buf+='<i class="fa fa-close red"></i>',_buf+='</div><div class="field default">',this["default"]?_buf+='<i class="fa fa-check green"></i>':_buf+='<i class="fa fa-close red"></i>',_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tariffs/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("tariffs.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tariffs/tariff_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field amount" title="',_buf+=this.escape(this.amount),_buf+='">',_buf+=this.escape(this.humanize_amount),_buf+='</div><div class="field user_count">',_buf+=this.escape(this.user_count),_buf+='</div><div class="field disk_space">',_buf+=this.escape(this.humanize_memory),_buf+='</div><div class="field visible">',this.visible?_buf+='<i class="fa fa-check green"></i>':_buf+='<i class="fa fa-close red"></i>',_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tours/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("tours.confirm.destroy")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tours/step_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<form class="step-item item pi-form" data-on-updated="@this.record.set(e.data,true)" data-rails="true"><div class="two-columns"><div class="field"><label class="field-label" for="text">',_buf+=this.escape(I18n.t("tours.step.text")+" [ru]"),_buf+='</label><div class="pi-text-input-wrap pi-textarea pi step-item-text" data-component="text_area" data-name="ru[text]" data-plugins="scrollable"><textarea class="text-input step-item-text-input">',_buf+=this.escape(""+((this.ru||{}).text||"")),_buf+='</textarea></div></div><div class="field"><label class="field-label" for="text">',_buf+=this.escape(I18n.t("tours.step.text")+" [en]"),_buf+='</label><div class="pi-text-input-wrap pi-textarea pi step-item-text" data-component="text_area" data-name="en[text]" data-plugins="scrollable"><textarea class="text-input step-item-text-input">',_buf+=this.escape(""+((this.en||{}).text||"")),_buf+='</textarea></div></div></div><div class="two-columns"><div class="field"><label class="field-label" for="video">',_buf+=this.escape(I18n.t("tours.step.video")+" [ru]"),_buf+='</label><div class="pi-text-input-wrap pi" data-name="ru[video]"><input class="text-input" type="text" value="',_buf+=this.escape((this.ru||{}).video),_buf+='" /></div></div><div class="field"><label class="field-label" for="video">',_buf+=this.escape(I18n.t("tours.step.video")+" [en]"),_buf+='</label><div class="pi-text-input-wrap pi" data-name="en[video]"><input class="text-input" type="text" value="',_buf+=this.escape((this.en||{}).video),_buf+='" /></div></div></div><div class="clean"></div><div class="field"><label class="field-label" for="attachTo[element]">',_buf+=this.escape(""+I18n.t("tours.step.element")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="attachTo[element]"><input class="text-input" type="text" value="',_buf+=this.escape((this.attachTo||{}).element),_buf+='" /></div></div><div class="field"><label class="field-label" for="attachTo[on]">',_buf+=this.escape(""+I18n.t("tours.step.position")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="attachTo[on]"><input class="text-input" type="text" value="',_buf+=this.escape((this.attachTo||{}).on),_buf+='" /></div></div><div class="clear"></div><div class="field"><label class="field-label" for="show">',_buf+=this.escape(""+I18n.t("tours.step.show")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="show"><input class="text-input" type="text" value="',_buf+=this.escape(this.show),_buf+='" /></div></div><div class="field"><label class="field-label" for="hide">',_buf+=this.escape(""+I18n.t("tours.step.hide")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="hide"><input class="text-input" type="text" value="',_buf+=this.escape(this.hide),_buf+='" /></div></div></form>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/tours/tour_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</div><div class="field role grey-text">',_buf+=this.escape(this.role_name),_buf+='</div><div class="field code">',_buf+=this.escape(this.code),_buf+='</div><div class="field controller-id" title="',_buf+=this.escape(this.controller_id),_buf+='">',_buf+=this.escape(this.controller_id),_buf+='</div><div class="field steps-num">',_buf+=this.escape(this.steps_num()),_buf+='</div><div class="field temp grey-text">',this.temporary&&(_buf+=this.escape(I18n.t("tours.temp"))),_buf+='</div><div class="field active red-text">',this.active||(_buf+=this.escape(I18n.t("tours.nonactive"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/users/show_account_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field accounts"><div class="account-id inline">',_buf+=this.escape(this.id),_buf+='</div><div class="account-name inline">',_buf+=this.escape(this.name),_buf+="</div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/users/url_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.admin_authorize_link_popup")),_buf+='<br /><a class="auth_link" href="',_buf+=this.escape(this.url),_buf+='">',_buf+=this.escape(this.url),_buf+="</a></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/users/user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id">',_buf+=this.escape(this.id),_buf+='</div><div class="field name" title="',_buf+=this.escape(this.name),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>",!1===this.active&&(_buf+='<span class="no-active">',_buf+=this.escape(""+I18n.t("users.inactive")),_buf+="</span>"),_buf+='</div><div class="field last_name">',_buf+=this.escape(this.last_name),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),_buf+='</div><div class="field registered">',_buf+=this.escape(this.created_at),_buf+='</div><div class="field activity">',_buf+=this.escape(this.activity_time),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin/users/user_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.fullname),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.email")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.email),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.phone")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.phone),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.notice_email")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.notification_email),_buf+="</div>",this.email_verified?(_buf+='<div class="span tag green">',_buf+=this.escape(""+I18n.t("users.email_confirm")),_buf+="</div>"):(_buf+='<div class="span tag red">',_buf+=this.escape(""+I18n.t("users.email_not_confirm")),_buf+="</div>"),_buf+='</div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.lang")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.lang),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.created")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.created_at),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("users.last_actived")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.activity_time),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/app_answer_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,answ,i,ref;if(_buf="",_buf+='<li class="item multiline"><div class="field descr">',_buf+=this.escape(this.field_name),_buf+='</div><div class="field answer">',"multiple"===this.field_type)for(i in ref=this.name)answ=ref[i],_buf+='<div class="variant">',_buf+=this.escape(answ),_buf+="</div>";else _buf+=this.escape(this.name);return _buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/app_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.user_fullname),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.user_fullname),_buf+='">',_buf+=this.escape(this.user_fullname),_buf+='</a><span class="email" title="',_buf+=this.escape(this.user_email||this.user_phone),_buf+='">',_buf+=this.escape(this.user_email||this.user_phone),_buf+='</span></div><div class="field session-name">',_buf+=this.escape(this.applicable_name),_buf+='</div><div class="field created-at">',_buf+=this.escape(this.created_date),_buf+=' <span class="status-icon">',"pending"===this.status&&(_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),"declined"===this.status&&(_buf+='<i class="fa not-checked-icon fa-times"></i>'),_buf+="</span></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/app_meeting_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.user_fullname),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.user_fullname),_buf+='">',_buf+=this.escape(this.user_fullname),_buf+='</a><span class="email" title="',_buf+=this.escape(this.user_email||this.user_phone),_buf+='">',_buf+=this.escape(this.user_email||this.user_phone),_buf+='</span></div><div class="field created-at">',_buf+=this.escape(this.created_date),_buf+=' <span class="status-icon">',"pending"===this.status&&(_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),"declined"===this.status&&(_buf+='<i class="fa not-checked-icon fa-times"></i>'),_buf+="</span></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/app_product_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.user_fullname),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.user_fullname),_buf+='">',_buf+=this.escape(this.user_fullname),_buf+='</a><span class="email" title="',_buf+=this.escape(this.user_email||this.user_phone),_buf+='">',_buf+=this.escape(this.user_email||this.user_phone),_buf+='</span></div><div class="field created-at">',_buf+=this.escape(this.created_date),_buf+=' <span class="status-icon">',"pending"===this.status&&(_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),"declined"===this.status&&(_buf+='<i class="fa not-checked-icon fa-times"></i>'),_buf+="</span></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/app_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _,_buf,id,label,ref;if(_buf="",_buf+='<div class="list-container info-list"><ul class="list non-selectable"><li class="item"><div class="field descr">',_buf+=this.escape(I18n.t("applications.user_name")),_buf+='</div><div class="field name">',_buf+=this.escape(this.user_name),_buf+='</div></li><li class="item"><div class="field descr">',_buf+=this.escape(I18n.t("applications.user_last_name")),_buf+='</div><div class="field name">',_buf+=this.escape(this.user_last_name),_buf+='</div></li><li class="item"><div class="field descr">',_buf+=this.escape(I18n.t("applications.user_email")),_buf+='</div><div class="field name">',_buf+=this.escape(this.user_email),
_buf+='</div></li><li class="item"><div class="field descr">',_buf+=this.escape(I18n.t("applications.user_phone")),_buf+='</div><div class="field name">',_buf+=this.escape(this.user_phone),_buf+='</div></li><li class="item labeled"><div class="field descr">',_buf+=this.escape(I18n.t("applications.user_labels")),_buf+='</div><div class="field labels">',this.labels)for(_ in ref=this.labels)id=ref[_],(label=$r.Label.get(id))&&(_buf+='<div class="label-item">',_buf+=this.escape(label.name),_buf+="</div>");return _buf+="</div></li></ul></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/applications/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("applications.confirm.destroy")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/apply_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=I18n.t("assignment_rules.confirm.apply_rule"),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/course_session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field course-name">',_buf+=this.escape(this.course_name),_buf+='</div><div class="field started-at">',_buf+=this.escape(this.started_time),_buf+='</div><div class="field finished-at">',_buf+=this.finished_time,_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("assignment_rules.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/label_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/program_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field started-at">',_buf+=this.escape(this.started_time),_buf+='</div><div class="field finished-at">',_buf+=this.finished_time,_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/assignment_rules/rule_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field labels-count">',_buf+=this.escape(this.labels_count),_buf+='</div><div class="field sessions-count">',_buf+=this.escape(this.sessions_count),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/clickmeeting_meetings/clickmeeting_meeting_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item meeting-item cover-item-small"><div class="cover inline">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</div><div class="info inline"><div class="meeting-time"><span class="meeting-datetime">',_buf+=this.escape(this.start_time),_buf+='</span></div><p class="meeting-title ellipses"><span>',_buf+=this.escape(this.name),_buf+="</span></p></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/clickmeeting_meetings/meeting_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<li class="item meeting-item cover-item-small"><div class="cover inline">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</div><div class="info inline"><div class="meeting-time"><span class="meeting-datetime">',this.permanent_room?_buf+=this.escape(I18n.t("clickmeeting_meetings.permanent")):_buf+=this.escape(this.start_time+" - "+this.end_time),_buf+="</span>",this.login_token&&(_buf+='<span class="meeting-datetime">',_buf+=this.escape(" | "+I18n.t("clickmeeting_meetings.login_token")+" "),_buf+='</span><span class="meeting-datetime select-text">',_buf+=this.escape(this.login_token),_buf+="</span>"),("running"===this.status||this.permanent_room)&&(_buf+=' <span class="is-running">',_buf+=this.escape(I18n.t("meetings.is_running")),_buf+="</span>"),this.is_not_created()?(_buf+='<span class="meeting-datetime">',_buf+=this.escape(" | "),_buf+='</span><span class="is-running">',_buf+=this.escape(I18n.t("meetings.not_created")),_buf+="</span>"):this.is_creating()&&(_buf+='<span class="meeting-datetime">',_buf+=this.escape(" | "+I18n.t("meetings.creating")),_buf+="</span>"),_buf+='</div><p class="meeting-title ellipses"><a class="link" href="@@go_to_applications(',_buf+=this.escape(this.id),_buf+=')"',_skim_codeattributes1=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+="</a></p></div>",this.enter_is_available()?(_buf+='<div class="buttons"><a class="button button-enter" href="',_buf+=this.escape(this.login_url),_buf+='" target="_blank">',this.login_hash?_buf+=this.escape(I18n.t("helpers.enter")):_buf+=this.escape(I18n.t("helpers.guest_enter")),_buf+="</a></div>"):this.report_available&&(_buf+='<div class="buttons"><a class="button pi-button-grey" href="@@send_report(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("meetings.get_report")),_buf+="</a></div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/competences/edit_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="filter-group item"><div class="group-dropdown ellipses"><span class="dotted-link group-title pi" data-on-click="@host.active ? @host.deactivate : @host.activate; e.cancel">',_buf+=this.escape(this.name),_buf+='</span></div><div class="label-edit-form pi-form pi" data-on-submited="@@update(',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="form"><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input label-group-name-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="buttons inline-right"><div class="icon-button-green button inline pi" data-on-click="@host.submit"><i class="fa fa-check"></i></div><div class="icon-button button inline pi" data-on-click="@view.list.finish_edit"><i class="fa fa-times"></i></div></div></div><div class="filters-list list-container pi-list pi" data-id="',_buf+=this.escape(this.id),_buf+='" data-listen-create="true" data-load-rest="true" data-plugins="selectable restful" data-renderer="jst(templates/labels/edit_filter_item)" data-rest="Competence.find(',_buf+=this.escape(this.id),_buf+=').competences" data-select-type="check" pid="list"><ul class="filters list"></ul><div class="filter-item add-item pi" data-component="add_item_link" data-on-submit="@@create(e.data)" pid="add_item_btn"><span class="add-item-link pi" pid="link">',_buf+=this.escape(I18n.t("courses.competences.add_subgroup_click")),_buf+='</span><div class="form-content"><div class="form pi-form pi" pid="form"><input name="group_id" type="hidden" value="',_buf+=this.escape(this.id),_buf+='" /><div class="pi-text-input-wrap pi" data-name="name" pid="input_txt"><input class="text-input label-name-input" placeholder="',_buf+=this.escape(I18n.t("users.labels.new_subgroup")),_buf+='" type="text" /></div></div><div class="buttons inline-right"><div class="icon-button-green submit-btn inline pi" pid="submit_btn"><i class="fa fa-check"></i></div><div class="icon-button cancel-btn inline pi" pid="cancel_btn"><i class="fa fa-times"></i></div></div></div></div></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/competences/filter_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2;if(_buf="",_buf+='<li class="users-filter-group"><div class="group-dropdown item pi" data-on-click="@host.active ? @host.deactivate : @host.activate">',this.is_readonly){switch(_buf+='<i class="fa fa-lock"',_skim_codeattributes1=this.readonly_reason){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+="></i>"}switch(_buf+=this.escape(this.name),_buf+='</div><div class="users-filters-list pi-list pi"',_skim_codeattributes2=this.id){case!0:_buf+=' data-id="data-id"';break;case!1:case null:break;default:_buf+=' data-id="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}return _buf+=' data-listen-create="true" data-load-rest="true" data-pid="list" data-plugins="selectable restful" data-renderer="jst(templates/labels/filter_item)" data-rest="Competence.find(',_buf+=this.escape(this.id),_buf+=').competences" data-select-type="check"><ul class="users-filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/competences/filter_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="competences-filter-item item" data-group-id="',_buf+=this.escape(this.group_id),_buf+='" data-id="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.name),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/assigned_course_session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,link_suffix;switch(_buf="",link_suffix=this.application_status&&"accepted"!==this.application_status?"/apply":"",_buf+='<li class="item course-item stats cover-item"><a class="cover inline" href="/course_sessions/',_buf+=this.escape(this.id),_buf+=this.escape(link_suffix),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="/course_sessions/',_buf+=this.escape(this.id),_buf+=this.escape(link_suffix),_buf+='"',_skim_codeattributes1=this.course_name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.course_name),_buf+='</a><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+='</p></p><footer class="inline"><div class="session-date">',this.period?(_buf+='<span class="deadline">',_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),this.course_types&&this.course_types.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/courses/item_course_types"]({types:this.course_types})),_buf+="</div>",this.role_id!==$r.CourseSession.MODERATOR&&this.role_id!==$r.CourseSession.MENTOR||(_buf+='<div class="session-name"><span>',_buf+=this.escape(this.name),_buf+="</span></div>"),_buf+='</footer></div><div class="course-progress-info inline-right top small-grey-text rt-text">',this.role_id===$r.CourseSession.LISTENER&&(_buf+='<div class="course-progress-wrap inline"><div class="course-progress-bg"></div><div class="course-progress" style="width:',_buf+=this.escape(this.progress_percent),_buf+='%"></div></div> <div class="course-progress-val inline">',_buf+=this.escape(this.progress_percent+"%"),_buf+="</div>"),"accepted"===this.application_status&&(_buf+='<div class="status green-text">',_buf+=this.escape(I18n.t("applications.statuses.accepted")),_buf+="</div>"),"declined"===this.application_status&&(_buf+='<div class="status red-text">',_buf+=this.escape(I18n.t("applications.statuses.declined")),_buf+="</div>"),"pending"===this.application_status&&(_buf+='<div class="status yellow-text">',_buf+=this.escape(I18n.t("applications.statuses.pending")),_buf+="</div>"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/course_session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item ',_buf+=this.escape(this.finished?"is-finished":void 0),_buf+='"><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>",this.finished||1!==this.access_type&&3!==this.access_type||(_buf+=' <span class="small-text access-type-',_buf+=this.escape(this.access_type),_buf+='">',_buf+=this.escape(this.access_type_name),_buf+="</span>"),_buf+='</div><div class="field started-at">',_buf+=this.escape(this.started_time),_buf+="</div>",this.period?(_buf+='<div class="field finished-at">',_buf+=this.escape(this.period_days),_buf+="</div>"):(_buf+='<div class="field finished-at">',_buf+=this.finished_time,_buf+="</div>"),_buf+='<div class="field participants ct-text">',_buf+=this.escape(this.assignments_count),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/course_session_register_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item ',_buf+=this.escape(this.users_count>=this.users_limit?"is-disabled":""),_buf+='"><div class="cs-name"><span>',_buf+=this.escape(" "+this.name+" "),_buf+="</span>",this.users_count>=this.users_limit&&(_buf+='<span class="no-seats">',_buf+=this.escape(" ("+I18n.t("course_sessions.users_overhead")+") "),_buf+="</span>"),_buf+='</div><div class="cs-date">',_buf+=this.period_string(),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/course_session_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item">',this.period?_buf+=this.escape(this.name+" ("+this.period_days+")"):(_buf+=this.escape(this.name+" ("+this.started_at_date+" - "),this.infinitely?_buf+="&infin;)":_buf+=this.escape(this.finished_at_date+")")),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=I18n.t("course_sessions.confirm.destroy"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/finish_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=I18n.t("course_sessions.confirm.finish"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/moderated_course_session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,link_suffix;switch(_buf="",link_suffix=this.application_status&&"accepted"!==this.application_status?"/apply":"?moderate=true",_buf+='<li class="item course-item stats cover-item"><a class="cover inline" href="/course_sessions/',_buf+=this.escape(this.id),_buf+=this.escape(link_suffix),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="/course_sessions/',_buf+=this.escape(this.id),_buf+=this.escape(link_suffix),_buf+='"',_skim_codeattributes1=this.course_name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.course_name),_buf+='</a><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+='</p></p><footer class="inline"><div class="session-date">',this.period?(_buf+='<span class="deadline">',_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),this.course_types&&this.course_types.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/courses/item_course_types"]({types:this.course_types})),_buf+='</div><div class="session-name"><span>',_buf+=this.escape(this.name),_buf+='</span></div></footer></div><div class="course-progress-info inline-right top small-grey-text rt-text">',this.role_id===$r.CourseSession.LISTENER&&(_buf+='<div class="course-progress-wrap inline"><div class="course-progress-bg"></div><div class="course-progress" style="width:',_buf+=this.escape(this.progress_percent),_buf+='%"></div></div> <div class="course-progress-val inline">',_buf+=this.escape(this.progress_percent+"%"),_buf+="</div>"),"accepted"===this.application_status&&(_buf+='<div class="status green-text">',_buf+=this.escape(I18n.t("applications.statuses.accepted")),_buf+="</div>"),"declined"===this.application_status&&(_buf+='<div class="status red-text">',_buf+=this.escape(I18n.t("applications.statuses.declined")),_buf+="</div>"),"pending"===this.application_status&&(_buf+='<div class="status yellow-text">',_buf+=this.escape(I18n.t("applications.statuses.pending")),_buf+="</div>"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/open_course_session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<li class="item course-item stats cover-item"><a class="cover inline" href="/course_sessions/',_buf+=this.escape(this.slug||this.id),_buf+='/apply">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="/course_sessions/',_buf+=this.escape(this.id),_buf+='/apply"',_skim_codeattributes1=this.course_name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.course_name),_buf+='</a></p><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+="</p><footer>",this.period?(_buf+='<span class="deadline">',_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),this.course_types&&this.course_types.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/courses/item_course_types"]({types:this.course_types})),_buf+='</footer></div><div class="course-progress-info inline-right top small-grey-text rt-text">',this.survey_id?(_buf+='<a class="button pi-button-grey" href="/surveys/',_buf+=this.escape(this.survey_id),_buf+='">',_buf+=this.escape(""+I18n.t("course_sessions.edit.register_btn")),_buf+="</a>"):(_buf+='<form action="/course_sessions/',_buf+=this.escape(this.slug||this.id),_buf+='/register" method="post"><input name="utf8" type="hidden" value="\u2713" /><input name="authenticity_token" type="hidden" value="',_buf+=this.escape(window.AUTH_TOKEN),_buf+='" /><input class="button pi-button-grey" type="submit" value="',_buf+=this.escape(I18n.t("course_sessions.edit.register_btn")),_buf+='" /></form>'),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',this.is_freezed_learning&&(_buf+='<span class="is-freezed"><i class="fa fa-paused"></i></span>'),_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field role red-text">',2===this.role_id?_buf+=this.escape(I18n.t("course_sessions.roles.moderator")):3===this.role_id&&(_buf+=this.escape(I18n.t("course_sessions.roles.mentor"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/remove_participant_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("course_sessions.confirm.remove_participant")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/session_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field period">',this.period?_buf+=this.escape(this.period_days):(_buf+=this.escape(this.started_at_date+" - "),this.infinitely?_buf+="&infin;":_buf+=this.escape(this.finished_at_date)),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/session_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item course-item stats cover-item-small"><div class="info inline"><p class="course-title ellipses"><span title="',_buf+=this.escape(this.course_name),_buf+='">',_buf+=this.escape(this.course_name),_buf+='</span></p><p class="started ellipses"><span title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</span></p><footer>",this.period?(_buf+='<span class="started">',_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline">',_buf+=this.finished_time,_buf+="</span>"),_buf+="</footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_sessions/show_popup"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("title")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.name),_buf+="</div></div>",this.period?(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("course_sessions.finished_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.period_days,_buf+="</div></div>"):(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("course_sessions.started_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.started_time),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("course_sessions.finished_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.finished_time,_buf+="</div></div>"),_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("listeners.access_type_label")),_buf+='</span><div class="info-field select-text access-type-',_buf+=this.escape(this.access_type),_buf+='">',_buf+=this.escape(this.access_type_name),_buf+="</div></div>",!this.finished&&(1===this.access_type||3===this.access_type)){switch(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("course_sessions.info.apply_url")),_buf+='</span><div class="copy-field url-field pi-text-input-wrap is-readonly"><div class="text-input pi pi-copy-text"',_skim_codeattributes1=I18n.t("link_is_copied")){case!0:_buf+=' data-message="data-message"';break;case!1:case null:break;default:_buf+=' data-message="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.apply_url),_buf+="</div></div></div>"}return _buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_stats/course_stat_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item course-item stats"><div class="cover inline">',this.thumb_url?(_buf+='<img class="cover-img" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover"><i class="icon-logo"></i></div>',_buf+='</div><div class="info inline"><p class="course-title ellipses"><a class="link" href="/course_sessions/',_buf+=this.escape(this.course_session_id),_buf+='" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></p><p class="ownername grey-text">',_buf+=this.escape(this.owner_name),_buf+="</p>",this.course_type_id&&(_buf+='<p class="course-type"><a class="link" href="@@course_type_filter(',_buf+=this.escape(this.course_type_id),_buf+=')">',_buf+=this.escape(this.course_type_name),_buf+="</a></p>"),_buf+='</div><div class="course-stat-info inline-right"><div class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":""),_buf+='">',_buf+=this.deadline_at,_buf+='</div><p>&nbsp;</p><div class="course-progress-info small-grey-text"><div class="course-progress-wrap inline"><div class="course-progress-bg"></div><div class="course-progress" style="width:',_buf+=this.escape(this.progress_percent),_buf+='%"></div></div><div class="course-progress-val inline">',_buf+=this.escape(" "+this.progress_percent+"%"),_buf+="</div></div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_stats/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=I18n.t("course_stats.confirm.destroy"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_stats/quiz_result_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<li class="item quiz-result-item">',"quiz"===this.type)_buf+='<div class="field name">',this.stat?(_buf+='<a class="link" href="@@show_quiz_stat(',_buf+=this.escape(this.quiz.id),_buf+=')">',_buf+=this.escape(this.quiz.name),_buf+="</a>"):(_buf+="<span>",_buf+=this.escape(this.quiz.name),_buf+="</span>"),_buf+='</div><div class="field weight">',_buf+=this.escape(this.quiz.weight+" ("+this.quiz.weight_percent()+"%)"),_buf+="</div>";else if("task"===this.type){if(_buf+='<div class="field name">',this.stat){switch(_buf+='<a class="link"',_skim_codeattributes1=this.stat.result_view_path()){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=' target="_blank">',_buf+=this.escape(this.task.name),_buf+="</a>"}else _buf+="<span>",_buf+=this.escape(this.task.name),_buf+="</span>";_buf+='</div><div class="field weight"></div>'}return this.stat&&(_buf+='<div class="field score-percent">',_buf+=this.escape(this.stat.score+" ("+this.stat.score_percent+"%)"),_buf+='</div><div class="field score">',_buf+=this.escape(""+("quiz"===this.type?this.stat.score*this.quiz.weight:this.stat.score)),_buf+='</div><div class="field max-score">',_buf+=this.escape(""+("quiz"===this.type?this.quiz.total_score*this.quiz.weight:this.task.score)),_buf+='</div><div class="field">',this.complete&&(!1===this.stat.checked?_buf+='<i class="fa not-checked-icon fa-exclamation"></i>':_buf+='<i class="fa complete-icon fa-check"></i>'),_buf+="</div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_stats/stat_result_header"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form"><h1 class="leftbar-title inline" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</h1><div class="buttons inline-right"><a class="button inline pi-button-blue ok-btn" href="@@close()">',_buf+=this.escape("OK"),_buf+='</a></div><div class="user-stat-info"><div class="user-info inline"><p><a class="dotted-link" href="@@select_user()">',_buf+=this.escape(this.username),_buf+='</a></p><p><span class="grey-text">',_buf+=this.escape(this.email||this.phone),_buf+='</span></p></div><div class="divider"></div><div class="stat-info inline"><div class="score-time-info stat-info-item"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("course_stats.score")+": "),_buf+="</span><span>",_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+='</span></div><div class="stat-info-item"><span class="time-spent"><i class="fa fa-clock-o grey-text">',_buf+=" "+this.time_spent,_buf+='</i><div class="period"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("course_stats.beginning")+": "),_buf+="</span><span>",_buf+=this.escape(""+this.started_date),_buf+='</span><div class="divider"></div><span class="info-label grey-text">',_buf+=this.escape(I18n.t("course_stats.ending")+": "),_buf+="</span><span>",_buf+=""+this.finish_date,_buf+="</span></div></span></div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_types/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),
(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("course_types.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_types/index_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<li class="item" data-id="@id">',this.is_readonly){switch(_buf+='<i class="fa fa-lock"',_skim_codeattributes1=this.readonly_reason){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+="></i>"}return _buf+=this.escape(this.name),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/course_types/type_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="edit-item pi-form pi" data-on-submited="@@update(',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="form"><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input label-name-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="buttons inline-right"><div class="icon-button-green button inline pi" data-on-click="@host.submit"><i class="fa fa-check"></i></div><div class="icon-button button inline pi" data-on-click="@view.list.finish_edit"><i class="fa fa-times"></i></div></div></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/about"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="course-profile-content"><div class="avatar inline">',this.cover_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.cover_url),_buf+='" />'):_buf+='<div class="no-avatar"></div>',_buf+='</div><div class="info inline"><div class="field"><div class="fullname">',_buf+=this.escape(this.name),_buf+='</div></div><div class="field">',this.description?(_buf+='<div class="description wysiwyg">',_buf+=""+JST.parseLinks(JST.sanitize(this.description)),_buf+="</div>"):(_buf+='<div class="no-description">',_buf+=this.escape(I18n.t("courses.no_description")),_buf+="</div>"),_buf+='</div><div class="course-moderators"><div class="list-header"><div class="headings"><span class="pi heading field datetime name">',_buf+=this.escape(I18n.t("courses.author_and_moderators")),_buf+='</span><span class="pi heading field status">',_buf+=this.escape(I18n.t("courses.status")),_buf+='</span></div></div><div class="pi list-container users-list pi-action-list" data-highlight="true" data-listen-load="true" data-load-rest="true" data-pid="list" data-plugins="restful" data-renderer="jst(templates/courses/participant_item)" data-rest="app.course.participants" data-select-type="check"><ul class="list"></ul></div></div></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/course_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<li class="item course-item cover-item"><a class="cover inline" href="/courses/',_buf+=this.escape(this.id),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="/courses/',_buf+=this.escape(this.id),_buf+='"',_skim_codeattributes1=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+="</a>",(this.unchangeable||this.is_shared||this.copyright_protected)&&!pi.app.user.admin||(_buf+='<div class="inline-right" style="top: 6px;"><div class="icon-button inline button pi edit-btn" data-on-click="@@edit(@host.record)"><i class="fa fa-pencil"></i></div></div>'),this.is_shared&&!this.copyright_protected&&(_buf+='<div class="inline-right" style="top: 6px;"><div class="icon-button inline button pi edit-btn" data-on-click="@@clone(@host.record)"><i class="fa fa-files-o"></i></div></div>'),_buf+='</p><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+='</p><footer><span class="info-label">',_buf+=this.escape(I18n.t("courses.updated")),_buf+='</span> <span class="updated-at">',_buf+=this.escape(this.updated_time),_buf+="</span>",this.types&&this.types.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/courses/item_course_types"](this)),this.competences&&this.competences.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/courses/item_competences"](this)),_buf+="</footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("courses.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/item_competences"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,competence,competence_id,i,len,ref;if(_buf="",competence=$r.Competence.get(this.competences[0])){if(_buf+='<span class="course-type first-course-type posrel"><a class="course-type-link" href="@@competences_filter(',_buf+=this.escape(competence.id),_buf+=')">',_buf+=this.escape(competence.name),_buf+="</a>",this.competences.length>1){for(_buf+=" <span>",_buf+=this.escape("+"+(this.competences.length-1)),_buf+='</span> <div class="course-types-callout pi-callout">',i=0,len=(ref=this.competences).length;i<len;i++)competence_id=ref[i],(competence=$r.Competence.get(competence_id))&&(_buf+='<p class="course-type"><a class="course-type-link" href="@@competences_filter(',_buf+=this.escape(competence.id),_buf+=')">',_buf+=this.escape(competence.name),_buf+="</a></p> ");_buf+="</div>"}_buf+="</span> "}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/item_course_types"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,len,ref,type,type_id;if(_buf="",type=$r.CourseType.get(this.types[0])){if(_buf+='<span class="course-type first-course-type posrel"><a class="course-type-link" href="@@course_type_filter(',_buf+=this.escape(type.id),_buf+=')">',_buf+=this.escape(type.name),_buf+="</a>",this.types.length>1){for(_buf+=" <span>",_buf+=this.escape("+"+(this.types.length-1)),_buf+='</span> <div class="course-types-callout pi-callout">',i=0,len=(ref=this.types).length;i<len;i++)type_id=ref[i],(type=$r.CourseType.get(type_id))&&(_buf+='<p class="course-type"><a class="course-type-link" href="@@course_type_filter(',_buf+=this.escape(type.id),_buf+=')">',_buf+=this.escape(type.name),_buf+="</a></p> ");_buf+="</div>"}_buf+="</span> "}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/panel"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<div class="info-panel-content"><div class="avatar inline">',this.thumb_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-avatar"><i class="icon-logo"></i></div>',_buf+='</div><div class="info inline">',this.is_netology)_buf+='<h1 class="title ellipses">',_buf+=this.escape(this.name),_buf+="</h1>";else{switch(_buf+='<h1 class="title ellipses"><a class="title-link" href="@@edit_course"',_skim_codeattributes1=I18n.t("helpers.edit")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.name),_buf+="</a></h1>"}return _buf+='<span class="owner-name">',_buf+=this.escape(""+this.owner_name),_buf+='</span></div><div class="actions inline-right"><a class="button pi-button-blue" href="/courses/',_buf+=this.escape(this.id),_buf+='/view">',_buf+=this.escape(""+I18n.t("courses.view_link")),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/courses/participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field role">',2===this.role_id&&(_buf+=this.escape(I18n.t("courses.author"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/chat/comment_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="chat-item chat-discussion-item comment"><div class="discussion-info"><div class="avatar inline">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" title="',_buf+=this.escape(this.user_name),_buf+='" />'):(_buf+='<div class="avatar-letter">',_buf+=this.escape(JST.ava_name(this.user_name)),_buf+="</div>"),_buf+='</div><div class="fullname inline"><div class="username">',_buf+=this.escape(this.user_name),_buf+='</div></div><div class="created-at inline"><div class="grey-text">',_buf+=this.escape(this.created_time),_buf+='</div></div></div><div class="wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.text)),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/chat/discussion"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="chat-discussion-item"><div class="discussion-info"><div class="avatar inline">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" title="',_buf+=this.escape(this.user_name),_buf+='" />'):(_buf+='<div class="avatar-letter">',_buf+=this.escape(JST.ava_name(this.user_name)),_buf+="</div>"),_buf+='</div><div class="fullname inline"><div class="username">',_buf+=this.escape(this.user_name),_buf+='</div></div><div class="created-at inline"><div class="grey-text">',_buf+=this.escape(this.created_time),_buf+='</div></div></div><div class="discussion-title">',_buf+=this.escape(this.title),_buf+='</div><div class="discussion-body wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.text)),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/chat/discussion_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="chat-item chat-discussion-item"><div class="discussion-info"><div class="avatar inline">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" title="',_buf+=this.escape(this.user_name),_buf+='" />'):(_buf+='<div class="avatar-letter">',_buf+=this.escape(JST.ava_name(this.user_name)),_buf+="</div>"),_buf+='</div><div class="fullname inline"><div class="username">',_buf+=this.escape(this.user_name),_buf+='</div></div><div class="created-at inline"><div class="grey-text">',_buf+=this.escape(this.created_time),_buf+='</div><div class="comments-icon inline grey-text">',_buf+=this.escape(this.comments_count),_buf+='</div></div></div><div class="discussion-title ellipses"><a class="title dotted-link" href="@@context.show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.title),_buf+="</a></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/comment_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_this;return _buf="",_buf+='<section class="comment-content comment-item"><header class="comment-header"><div class="comment-user-info"><div class="avatar inline">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" title="',_buf+=this.escape(this.user_name),_buf+='" />'):(_buf+='<div class="avatar-letter">',_buf+=this.escape(JST.ava_name(this.user_name)),_buf+="</div>"),_buf+='</div><div class="fullname inline"><p class="username"><span class="name">',_buf+=this.escape(this.user_name),_buf+='</span></p><p class="created-at">',this.meta.id&&this.meta.user_name&&(_buf+='<span class="reply-to"><span>&#8594;&nbsp;</span><a class="reply-link" href="@@show_comment(',_buf+=this.escape(this.meta.id),_buf+=')">',_buf+=this.escape(this.meta.user_name),_buf+="</a><span>,&nbsp;</span></span>"),_buf+='<span class="grey-text">',_buf+=this.escape(this.created_time),_buf+='</span></p></div></div></header><article class="comment-body wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.text)),_buf+="</article>",this.attachments.length>0&&(_buf+='<div class="attachments">',this.attachments.forEach((_this=this,function(file){var _skim_codeattributes1;switch(_buf+='<i class="task-attachment-icon document-icon ',_buf+=_this.escape(file.category),_buf+=" ",_buf+=_this.escape(file.extension),_buf+='"></i><a class="task-attachment-name"',_skim_codeattributes1=file.file_name){case!0:_buf+=' download="download"';break;case!1:case null:break;default:_buf+=' download="',_buf+=_this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=' href="',_buf+=_this.escape(file.cors_url),_buf+='" rel="noopener noreferrer" target="_blank">',_buf+=_this.escape(file.file_name),_buf+="</a>"})),_buf+="</div>"),_buf+='<footer class="comment-footer"><div class="list-filter"><div class="item"><a class="dotted-link" href="@@reply_to(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("discussions.show.reply")),_buf+="</a></div>",pi.app.user.id===this.user_id&&(_buf+='<div class="item edit-link"><a class="dotted-link grey" href="@@edit_comment(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("discussions.show.edit")),_buf+="</a></div>"),(pi.app.user.id===this.user_id||pi.app.user.role_id>1)&&(_buf+='<div class="item edit-link"><a class="dotted-link red" href="@@destroy_comment(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("discussions.show.destroy")),_buf+="</a></div>"),_buf+="</div></footer></section>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/destroy_comment_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("discussions.confirm.destroy_comment")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("discussions.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.title),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/discussion_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item ',_buf+=this.escape(this.pinned?"is-pinned":void 0),_buf+='"><div class="field name"><span class="material-info">',this.meta.section_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.section"))+" "+this.meta.section_pos+". "),_buf+="</span>"),this.meta.material_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.material"))+" "+this.meta.material_pos+". "),_buf+="</span>"),this.meta.quiz_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.quiz"))+" "+this.meta.quiz_pos+". "),_buf+="</span>"),_buf+='</span><a class="title link" href="',_buf+=this.escape(this.show_url()),_buf+='">',_buf+=this.escape(this.title),_buf+='</a><div class="author">',_buf+=this.escape(this.user_name),_buf+='</div></div><div class="field comments-count">',_buf+=this.escape(this.comments_count),_buf+='</div><div class="field views-num">',_buf+=this.escape(this.views_num),_buf+='</div><div class="field last-activity">',_buf+=this.escape(this.last_activity_time),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/discussion_search_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item search-item"><div class="author">',_buf+=this.escape(this.user_name),_buf+='</div><div class="title"><span class="material-info">',this.meta.section_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.section"))+" "+this.meta.section_pos+". "),_buf+="</span>"),this.meta.material_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.material"))+" "+this.meta.material_pos+". "),_buf+="</span>"),this.meta.quiz_pos&&(_buf+="<span>",_buf+=this.escape(pi.utils.capitalize(I18n.t("discussions.selector.quiz"))+" "+this.meta.quiz_pos+". "),_buf+="</span>"),_buf+='</span><a class="link" href="',_buf+=this.escape(this.show_url()),_buf+='">',_buf+=this.escape(this.title),_buf+='</a></div><div class="text">',_buf+=this.text,_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/material_select"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,meta;return _buf="",meta=this.meta||{},_buf+='<div class="material-selector ',_buf+=this.escape(meta.section_id||meta.quiz_id||meta.material_id?"is-selected":""),_buf+='">',meta.section_id&&(_buf+='<input name="meta[section_id]" type="hidden" value="',_buf+=this.escape(meta.section_id),_buf+='" /><input name="meta[section_pos]" type="hidden" value="',_buf+=this.escape(meta.section_pos),_buf+='" />'),meta.material_id&&(_buf+='<input name="meta[material_id]" type="hidden" value="',_buf+=this.escape(meta.material_id),_buf+='" /><input name="meta[material_pos]" type="hidden" value="',_buf+=this.escape(meta.material_pos),_buf+='" />'),meta.quiz_id&&(_buf+='<input name="meta[quiz_id]" type="hidden" value="',_buf+=this.escape(meta.quiz_id),_buf+='" /><input name="meta[quiz_pos]" type="hidden" value="',_buf+=this.escape(meta.quiz_pos),_buf+='" />'),_buf+='<div class="material-selector-link"><a class="dotted-link" href="@@select_material">',_buf+=this.escape(I18n.t("discussions.select_material_link")),_buf+='</a></div><div class="material-selector-block"><div class="material-selector-info inline">',meta.section_id&&(_buf+='<span class="name">',_buf+=this.escape(I18n.t("discussions.selector.section")+" "+meta.section_pos+" "),_buf+="</span><span>&#8594;&nbsp;</span>"),meta.material_id&&(_buf+='<span class="name">',_buf+=this.escape(I18n.t("discussions.selector.material")+" "+meta.material_pos),_buf+="</span>"),meta.quiz_id&&(_buf+='<span class="name">',_buf+=this.escape(I18n.t("discussions.selector.quiz")+" "+meta.quiz_pos),_buf+="</span>"),_buf+='</div><div class="list-filter inline"><div class="item"><a class="dotted-link" href="@@select_material">',_buf+=this.escape(I18n.t("discussions.change_material")),_buf+='</a></div><div class="item"><a class="dotted-link red" href="@@remove_material">',_buf+=this.escape(I18n.t("discussions.remove_material")),_buf+="</a></div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/paginator"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<a class="load-more-pages-link" href="@@next_page()">',_buf+=this.escape(I18n.t("discussions.show.load_more")+" "+this.per_page+" "+I18n.t("of")+" "+this.total_remained),_buf+="</a>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/select_material_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon icon-file-doc grey"></i><span class="part-item">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><span class="part-item">',_buf+=this.escape(this.name),_buf+="</span></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/select_quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info"><i class="material-icon quiz icon-quiz"></i><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><span class="quiz-title">',_buf+=this.escape(this.name),_buf+="</span></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/discussions/select_section_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="section-item item form-item"><div class="group-dropdown text-info section-info pi"><div><span class="part-item">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</span><span class="group-title pi">',_buf+=this.escape(this.name),_buf+='</span></div></div><div class="filters-list list-container pi-list pi" data-listen-load="true" data-load-rest="true" data-plugins="selectable sortable restful" data-renderer="jst(templates/discussions/select_material_item)" data-rest="Material.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio check" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container pi-list pi" data-listen-load="true" data-load-rest="true" data-plugins="selectable sortable restful" data-renderer="jst(templates/discussions/select_quiz_item)" data-rest="Quiz.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio check" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/abort_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("documents.confirm.upload_abort")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/bottom_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="info-content"><div class="category-icon inline"><i class="fa ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension),_buf+='"></i></div><div class="file-name inline"><i class="fa show fa-1x"></i>',_buf+=this.escape(JST.strip_html(this.name+(this.extension?"."+this.extension:""))),_buf+='</div><div class="buttons inline-right"><a class="icon-button button inline" download="',_buf+=this.escape(this.file_name),_buf+='" href="',_buf+=this.escape(this.download_url),_buf+='" target="_blank"><i class="fa fa-download fa-1x"></i></a></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/breadcrumbs"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="document_parent">',this.id?this.current?(_buf+='<i class="fa fa-folder-open"></i><a class="dotted-link current" href="@@show_folder(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<i class="document-icon folder"></i><a class="dotted-link" href="@@show_folder(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<i class="document-icon folder"></i><a class="dotted-link" href="@@show_folder">',_buf+=this.escape(I18n.t("documents.library")),_buf+="</a>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("documents.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/document_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field category-icon">',this.is_shared||this["public"]?_buf+='<i class="document-icon shared-folder"></i>':(_buf+='<i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension),_buf+='"></i>'),_buf+='</div><div class="field title">',this.is_folder?(_buf+='<a class="link" href="@@show_folder(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),"other"===this.category&&(_buf+=".",_buf+=this.escape(this.extension)),_buf+=' <span class="file-status ',_buf+=this.escape(this.status_code||""),_buf+='">',void 0!==this.status_name?_buf+=this.escape(this.status_name):_buf+=this.escape(I18n.t("documents.status.uploading")),_buf+="</span></a>"),_buf+='</div><div class="field size">',_buf+=this.escape(this.size),_buf+='</div><div class="field owner_name">',_buf+=this.escape(this.owner_name),_buf+='</div><div class="field created_at">',_buf+=this.escape(this.created_at),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/file_upload_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</div><div class="field progress inline-right">',this.loaded?_buf+='<i class="fa fa-check green-text"></i>':this.failed?_buf+='<i class="fa fa-times red-text"></i>':_buf+='<div class="upload-progress"><div class="pi-progressbar upload-progressbar pi" pid="loader"></div></div>',_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/folder_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field category-icon">',this["public"]||this.is_shared?_buf+='<i class="document-icon shared-folder"></i>':_buf+='<i class="document-icon folder"></i>',_buf+='</div><div class="field name"><a class="link" href="@@show_folder(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</a></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/folder_move_breadcrumbs"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="document_parent">',this.id?this.current?(_buf+='<span class="arrow">&#8594;</span><span class="current">',_buf+=this.escape(this.name),_buf+="</span>"):(_buf+='<span class="arrow">&#8594;</span><a class="dotted-link" href="@@show_folder(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<a class="dotted-link" href="@@show_folder">',_buf+=this.escape(I18n.t("documents.library")),_buf+="</a>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div><div class="title">',_buf+=this.escape(I18n.t("documents.info.title")),_buf+='</div><div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("documents.name")),_buf+='</span><div class="info-field selet-text">',_buf+=this.escape(this.name),_buf+=".",_buf+=this.escape(this.extension),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("documents.owner_name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.owner_name),_buf+='</div></div><div class="two-columns"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("documents.created_at")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.created_at),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("documents.size")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.size),_buf+='</div></div></div></div><a class="button pi-button-blue" href="',_buf+=this.escape(this.download_url),_buf+='" target="_blank"><i class="button-icon fa fa-download"></i><span>',_buf+=this.escape(I18n.t("documents.info.download")),_buf+="</span></a></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><input name="participants[][id]" type="hidden" value="',_buf+=this.escape(this.id),_buf+='" /><input name="participants[][changed]" type="hidden" value="',_buf+=this.escape(this.changed),_buf+='" /><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),_buf+='</div><div class="field role">',this.role>1?(_buf+=this.escape(I18n.t("meetings.presenter")),_buf+='<input name="participants[][role]" type="hidden" value="',_buf+=this.escape(this.role),_buf+='" />'):_buf+='<input name="participants[][role]" type="hidden" value="1" />',_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),
this.JST["templates/documents/show_image"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="show-image"><image src="',_buf+=this.escape(this.document.view_url),_buf+='" width="800"></image></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/documents/show_video"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="show-video"><video class="video-js vjs-default-skin vjs-big-play-centered" controls="true" height="400" id="video_js" poster="',_buf+=this.escape(this.document.poster_url),_buf+='" preload="auto" width="640"><source src="',_buf+=this.escape(this.document.view_url),_buf+='" type="video/mp4" /></video></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/choose_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="list-item choose-label-item pi-checkbox-wrap pi" data-name="id-',_buf+=this.escape(this.id),_buf+='" pid="id-',_buf+=this.escape(this.id),_buf+='"><div class="text-content">',_buf+=this.escape(""+this.name),_buf+='</div><input type="hidden" /></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/chosen_label_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="user-label">',_buf+=this.escape(""+this.name),_buf+='<a class="link-button delete-label fa fa-times" href="@@remove_label(',_buf+=this.escape(this.id),_buf+=')"></a></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("labels.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/edit_filter_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item" data-group-id="',_buf+=this.escape(this.group_id),_buf+='" data-id="',_buf+=this.escape(this.id),_buf+='"><div class="user-label">',_buf+=this.escape(this.name),_buf+='</div><div class="label-edit-form pi-form pi" data-on-submited="@@update(',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="form"><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input label-name-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="buttons inline-right"><div class="icon-button-green button inline pi" data-on-click="@host.submit"><i class="fa fa-check"></i></div><div class="icon-button button inline pi" data-on-click="@view.list.finish_edit"><i class="fa fa-times"></i></div></div></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/edit_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="filter-group item"><div class="group-dropdown ellipses"><span class="dotted-link group-title pi" data-on-click="@host.active ? @host.deactivate : @host.activate; e.cancel">',_buf+=this.escape(this.name),_buf+='</span></div><div class="label-edit-form pi-form pi" data-on-submited="@@update(',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="form"><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input label-group-name-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="buttons inline-right"><div class="icon-button-green button inline pi" data-on-click="@host.submit"><i class="fa fa-check"></i></div><div class="icon-button button inline pi" data-on-click="@view.list.finish_edit"><i class="fa fa-times"></i></div></div></div><div class="filters-list list-container pi-list pi" data-id="',_buf+=this.escape(this.id),_buf+='" data-listen-create="true" data-load-rest="true" data-plugins="selectable restful" data-renderer="jst(templates/labels/edit_filter_item)" data-rest="Label.find(',_buf+=this.escape(this.id),_buf+=').labels" data-select-type="radio check" pid="list"><ul class="filters list"></ul><div class="filter-item add-item pi" data-component="add_item_link" data-on-submit="@@create(e.data)" pid="add_item_btn"><span class="add-item-link pi" pid="link">',_buf+=this.escape(I18n.t("users.labels.add_subgroup_click")),_buf+='</span><div class="form-content"><div class="form pi-form pi" pid="form"><input name="group_id" type="hidden" value="',_buf+=this.escape(this.id),_buf+='" /><div class="pi-text-input-wrap pi" data-name="name" pid="input_txt"><input class="text-input label-name-input" placeholder="',_buf+=this.escape(I18n.t("users.labels.new_subgroup")),_buf+='" type="text" /></div></div><div class="buttons inline-right"><div class="icon-button-green submit-btn inline pi" pid="submit_btn"><i class="fa fa-check"></i></div><div class="icon-button cancel-btn inline pi" pid="cancel_btn"><i class="fa fa-times"></i></div></div></div></div></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/filter_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="users-filter-group"><div class="group-dropdown item pi" data-on-click="@host.active ? @host.deactivate : @host.activate">',_buf+=this.escape(this.name),_buf+='</div><div class="users-filters-list pi-list pi" data-id="',_buf+=this.escape(this.id),_buf+='" data-listen-create="true" data-load-rest="true" data-pid="list" data-plugins="selectable searchable restful" data-renderer="jst(templates/labels/filter_item)" data-rest="Label.find(',_buf+=this.escape(this.id),_buf+=').labels" data-select-type="check"><ul class="users-filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/filter_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3;switch(_buf="",_buf+='<div class="users-filter-item item"',_skim_codeattributes1=this.group_id){case!0:_buf+=' data-group-id="data-group-id"';break;case!1:case null:break;default:_buf+=' data-group-id="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_skim_codeattributes2=this.id){case!0:_buf+=' data-id="data-id"';break;case!1:case null:break;default:_buf+=' data-id="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}if(_buf+=">",this.is_readonly){switch(_buf+='<i class="fa fa-lock"',_skim_codeattributes3=this.readonly_reason){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}_buf+="></i>"}return _buf+=this.escape(this.name),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/mentoring_filter_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="mentor-users-filter-item item pi" data-item-id="',_buf+=this.escape(this.id),_buf+='" data-pid="label-',_buf+=this.escape(this.id),_buf+='"><div class="pi-checkbox-wrap pi" data-false-value="false" data-name="label-',_buf+=this.escape(this.id),_buf+='" data-on-changed="e.data ? @view.label_cb_checked(@host.pid) : false" data-pid="cb" data-true-value="true"><input type="hidden" value="false" />',_buf+=this.escape(this.name),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/labels/mentoring_group_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="mentor-users-filter-group pi" data-item-id="',_buf+=this.escape(this.id),_buf+='" data-pid="group-',_buf+=this.escape(this.id),_buf+='"><div class="pi-checkbox-wrap pi" data-false-value="false" data-name="group-',_buf+=this.escape(this.id),_buf+='" data-on-changed="e.data ? @view.group_cb_checked(@host.pid) : false" data-pid="cb" data-true-value="true"><input type="hidden" value="false" /></div><div class="mentor-group-dropdown item pi" data-on-click="@host.active ? @host.deactivate : @host.activate"><span class="dotted-link">',_buf+=this.escape(this.name),_buf+='</span></div><div class="users-filters-list pi-list pi" data-id="',_buf+=this.escape(this.id),_buf+='" data-listen-create="true" data-load-rest="true" data-pid="list" data-plugins="restful" data-renderer="jst(templates/labels/mentoring_filter_item)" data-rest="Label.find(',_buf+=this.escape(this.id),_buf+=').labels" data-select-type="check"><ul class="users-filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/listeners/listener"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+='</a></div><div class="field email" title="',_buf+=this.escape(this.email),_buf+='">',_buf+=this.escape(this.email),_buf+='</div><div class="field activity">',_buf+=this.escape(this.last_activity_at),_buf+='</div><div class="field role">',this.role_id>1&&(_buf+=this.escape(this.role_name)),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/listeners/listener_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.username),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',this.is_freezed&&(_buf+='<span class="is-freezed"><i class="fa fa-pause"></i></span>'),_buf+='<a class="link" href="@@show_results(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.username),_buf+='</a><span class="email is-hidden">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field time-spent">',_buf+=this.time_spent,_buf+='</div><div class="field last-activity">',_buf+=this.last_activity_at,_buf+='</div><div class="field progress ',_buf+=this.escape(this.complete?"is-completed":""),_buf+='">',this.progress>0?(_buf+=this.escape(this.progress_percent),_buf+="%"):_buf+="&mdash;",this.cert_file&&(_buf+='<a class="link link-cert" href="',_buf+=this.escape(this.cert_file),_buf+='" target="_blank"></a>'),this.is_generate_cert&&(_buf+='<a class="link link-generate-cert" href="/courses/',_buf+=this.escape(this.course_id),_buf+="/listeners/",_buf+=this.escape(this.id),_buf+='/cert" target="_blank"></a>'),_buf+="</div>",this.deadline_date&&(_buf+='<div class="field deadline">',_buf+=this.deadline_date,_buf+="</div>"),_buf+='<div class="field completed-tasks ',_buf+=this.escape(0===this.completed_tasks?"no-tasks":""),_buf+='">',_buf+=this.escape(this.completed_tasks+" "+I18n.t("quizzes.view.of")+" "+this.total_tasks),_buf+='</div><div class="field total-score ',_buf+=this.escape(0===this.score?"red-text":""),_buf+='">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/attach_library_breadcrumbs"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="document_parent">',this.id?this.current?(_buf+='<span class="arrow">&#8594;</span><span class="current">',_buf+=this.escape(this.name),_buf+="</span>"):(_buf+='<span class="arrow">&#8594;</span><a class="dotted-link" href="@@context.show_folder(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<a class="dotted-link" href="@@context.show_folder">',_buf+=this.escape(I18n.t("documents.library")),_buf+="</a>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_material_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item material-item ',_buf+=this.escape("ok"===this.status_code?"":"is-disabled"),_buf+='"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</div><div class="item-title">',_buf+=this.escape(this.name),_buf+='<span class="file-status ',_buf+=this.escape(this.status_code||""),_buf+='">',void 0!==this.status_name?_buf+=this.escape(this.status_name):_buf+=this.escape(I18n.t("documents.status.converting")),_buf+="</span></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item quiz-item material-item"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='. </div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_resource_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="resource-item item"><div class="field material-icon blue"></div><a class="field link download-link" download="',_buf+=this.escape(this.name),_buf+='" href="',_buf+=this.escape(this.view_url_cors),_buf+='">',_buf+=this.escape(""+this.name),_buf+="</a></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_scorm_package_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item quiz-item material-item"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("scorm_packages.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_section_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="section-item"><div class="group-dropdown item item-info pi" data-on-click="@host.active ? @host.deactivate : @host.activate"><div class="item-position">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+='</div></div><div class="materials-list list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/contents_material_item)" data-rest="Material.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="scorm-packages-list list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/contents_scorm_package_item)" data-rest="ScormPackage.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="quizzes-list is-empty list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/contents_quiz_item)" data-rest="Quiz.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="task-list is-empty list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/contents_task_item)" data-rest="Task.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_section_resource_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="section-item"><div class="group-dropdown item item-info pi" data-on-click="@host.active ? @host.deactivate : @host.activate"><div class="item-position">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+='</div></div><div class="materials-list list-container pi-list pi" data-load-rest="true" data-plugins="restful" data-renderer="jst(templates/materials/contents_resource_item)" data-rest="Resource.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/contents_task_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item quiz-item material-item"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("tasks.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='. </div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("materials.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/document_attach_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field category-icon">',this["public"]||this.is_shared?_buf+='<i class="document-icon shared-folder"></i>':(_buf+='<i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension),_buf+='"></i>'),_buf+='</div><div class="field name">',this.is_folder?(_buf+='<a class="link" href="@@context.show_folder(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+='<a class="link" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='<span class="file-status ',_buf+=this.escape(this.status_code||""),_buf+='">',void 0!==this.status_name?_buf+=this.escape(this.status_name):_buf+=this.escape(I18n.t("documents.status.uploading")),_buf+="</span></a>"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/dropbox_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field cover">',this.icon?(_buf+='<img class="cover-img" height="26" src="',_buf+=this.escape(this.icon),_buf+='" />'):_buf+='<div class="no-cover"><i class="icon-logo"></i></div>',_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/file_upload"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="material-file-upload ',_buf+=this.escape(this.file_name?"has-file":"no-file"),_buf+='"><input type="hidden" value="',_buf+=this.escape(this.id||this.external||0),_buf+='" />',this.external&&this.external_type&&(_buf+='<input name="external" type="hidden" value="',_buf+=this.escape(this.external),_buf+='" /><input name="external_type" type="hidden" value="',_buf+=this.escape(this.external_type),_buf+='" /><input name="file_name" type="hidden" value="',_buf+=this.escape(this.file_name),_buf+='" /><input name="external_thumb" type="hidden" value="',_buf+=this.escape(this.external_thumb),_buf+='" /><input name="external_class" type="hidden" value="',_buf+=this.escape(this.external_class),_buf+='" /><input name="external_file_type" type="hidden" value="',_buf+=this.escape(this.extension),_buf+='" />'),_buf+='<div class="upload-link"><div class="dotted-link pi" data-on-click="@@upload_file(@host)">',_buf+=this.escape(I18n.t("materials.upload_file")),_buf+='</div></div><div class="file-info"><div class="category-icon inline">',this.category?(_buf+='<i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i>'):_buf+='<i class="document-icon other"></i>',_buf+='</div><span class="file-name ellipses inline">',_buf+=this.escape(this.file_name),_buf+="</span>",this.size&&(_buf+='<span class="file-size">&nbsp;&mdash;',_buf+=this.escape(this.size),_buf+="</span>"),_buf+='<div class="divider inline"></div><div class="dotted-link delete-btn inline pi" data-on-click="@@delete_file(@host)">',_buf+=this.escape(I18n.t("materials.delete_file")),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/google_image_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field cover">',this.thumb?(_buf+='<img class="cover-img" height="26" src="',_buf+=this.escape(this.thumb),_buf+='" />'):_buf+='<div class="no-cover"></div>',_buf+='</div><div class="field name">',_buf+=this.escape(this.title),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/contents_material_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item material-item ',_buf+=this.escape("ok"===this.status_code?"":"is-disabled"),_buf+='"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=". ",this.stat&&!0===this.stat.complete&&(_buf+='<i class="fa complete-icon fa-check"></i>'),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+='<span class="file-status ',_buf+=this.escape(this.status_code||""),_buf+='">',void 0!==this.status_name?_buf+=this.escape(this.status_name):_buf+=this.escape(I18n.t("documents.status.converting")),_buf+="</span></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/contents_quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item quiz-item material-item ',_buf+=this.escape(this.attempts_available()>0?"":"is-disabled"),_buf+='"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".",this.stat()&&!0===this.stat().complete&&(_buf+='<i class="fa complete-icon fa-check"></i>'),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/contents_scorm_package_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,stat;return _buf="",stat=this.stat_for_user(pi.app.user.id),_buf+='<div class="item quiz-item material-item"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("scorm_packages.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".",stat&&stat.success&&(_buf+='<i class="fa complete-icon fa-check"></i>'),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/contents_section_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,interval_nav,next_section_opening_at,prev_section_id,ref,ref1,ref2;return _buf="",interval_nav=2===(null!=(ref=$r.CourseSession.get(pi.app.course_session_id))?ref.navigation:void 0),prev_section_id=null!=(ref1=$r.Section.get_by({position:this.position-1}))?ref1.id:void 0,next_section_opening_at=null!=(ref2=$r.SectionStat.get_by({course_id:this.course_id,section_id:prev_section_id}))?ref2.next_section_opening_at:void 0,_buf+='<li class="section-item"><div class="group-dropdown item item-info pi" data-on-click="@host.active ? @host.deactivate : @host.activate">',!this.available&&interval_nav?next_section_opening_at?(_buf+='<div class="item-position">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "+I18n.t("sections.starts_on")+" "+next_section_opening_at),_buf+="</div>"):(_buf+='<div class="item-position">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "+I18n.t("sections.opened_soon")),_buf+="</div>"):(_buf+='<div class="item-position">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+"."),_buf+="</div>"),_buf+='<div class="item-title">',_buf+=this.escape(this.name),_buf+='</div></div><div class="materials-list list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/listeners/contents_material_item)" data-rest="Material.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="scorm-packages-list is-empty list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/listeners/contents_scorm_package_item)" data-rest="ScormPackage.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="quizzes-list is-empty list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/listeners/contents_quiz_item)" data-rest="Quiz.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="tasks-list is-empty list-container pi-list pi" data-load-rest="true" data-plugins="restful sortable selectable" data-renderer="jst(templates/materials/listeners/contents_task_item)" data-rest="Task.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/contents_task_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,stat;return _buf="",stat=this.stat_for_user(pi.app.user.id),_buf+='<div class="item quiz-item material-item"><div class="item-info"><div class="item-position">',_buf+=this.escape(I18n.t("tasks.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".",stat&&(stat.checked?stat.success?_buf+='<i class="fa complete-icon fa-check"></i>':_buf+='<i class="fa failed-icon fa-times"></i>':_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),_buf+='</div><div class="item-title">',_buf+=this.escape(this.name),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/material_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon icon-material grey"></i><span class="part-item">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=". </span>",pi.app.course_stat.can_take?"ok"===this.status_code?(_buf+='<a class="link" href="',_buf+=this.escape(this.take_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+=this.escape(this.name),_buf+=' <span class="file-status">',_buf+=this.escape(this.status_name),_buf+="</span>"):pi.app.course_stat.can_view_materials?"ok"===this.status_code?(_buf+='<a class="link" href="',_buf+=this.escape(this.view_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+=this.escape(this.name),_buf+=' <span class="file-status">',_buf+=this.escape(this.status_name),_buf+="</span>"):_buf+=this.escape(this.name),this.stat&&!0===this.stat.complete&&(_buf+='<div class="inline-right"><i class="fa complete-icon fa-check"></i></div>'),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,stat;return _buf="",stat=this.stat(),_buf+='<div class="filter-item item form-item quiz-item"><div class="text-info field ',_buf+=this.escape(stat?"short":void 0),_buf+='"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><span class="link quiz-title pi" data-on-click="@view.list.edit_item(@host)">',_buf+=this.escape(this.name),_buf+="</span></div>",stat&&stat.complete&&(_buf+='<div class="field stat-info inline ',_buf+=this.escape(stat.success?"is-success":"is-failed"),_buf+='">',stat.checked?(_buf+='<div class="inline score-percent">',_buf+=this.escape(stat.score+" ("+stat.score_percent+"%)"),_buf+="</div>"):(_buf+='<div class="inline check-info">',_buf+=this.escape(""+I18n.t("quizzes.info.check")),_buf+="</div>"),_buf+='<div class="inline time-spent">',_buf+=""+stat.time_spent,_buf+='</div><div class="inline finished-at ellipses">',_buf+=""+stat.finished_time,_buf+='</div><div class="inline">',stat.checked?stat.success?_buf+='<i class="fa complete-icon fa-check"></i>':_buf+='<i class="fa failed-icon fa-times"></i>':_buf+='<i class="fa not-checked-icon fa-clock-o"></i>',_buf+="</div></div>"),
_buf+='<div class="form-wrapper item-edit-form quiz-listener-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content form"><div class="field"><label class="field-label">',_buf+=this.escape(I18n.t("quizzes.title")+" "+this.position+"."),_buf+='</label><div class="info-field select-text title-field">',_buf+=this.escape(""+this.name),_buf+='</div></div><div class="field"><label class="field-label">',_buf+=this.escape(""+I18n.t("quizzes.info.title")),_buf+='</label><table class="quiz-info-table"><tr class="headings"><th>',_buf+=this.escape(""+I18n.t("quizzes.info.ques_num")),_buf+="</th><th>",_buf+=this.escape(""+I18n.t("quizzes.edit.time_limit")),_buf+="</th><th>",_buf+=this.escape(""+I18n.t("quizzes.edit.passing_grade")),_buf+='</th></tr><tr class="values"><td>',_buf+=this.escape(""+this.effective_questions_count),_buf+="</td>",this.time_limit>0?(_buf+="<td>",_buf+=this.escape(""+this.time_limit_duration),_buf+="</td>"):(_buf+="<td>",_buf+="&mdash;",_buf+="</td>"),this.passing_grade>0?(_buf+="<td>",_buf+=this.escape(this.passing_grade+" "+I18n.t("quizzes.view.of")+" "+this.total_score+" / "+this.passing_percent+"%"),_buf+="</td>"):(_buf+="<td>",_buf+="&mdash;",_buf+="</td>"),_buf+='</tr></table></div><div class="field info-attempts"><span>',_buf+=this.escape(""+I18n.t("quizzes.info.attempts")),_buf+='</span><span class="info-attempts-value">',_buf+=this.escape(this.attempts_available()+" "+I18n.t("quizzes.view.of")+" "+this.attempts),_buf+='</span></div><div class="actions buttons">',this.attempts_available()>0&&(_buf+='<div class="pi-button-green button take-quiz-btn inline pi" data-on-click="@@take_quiz(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(""+I18n.t("quizzes.info.begin")),_buf+="</div>"),this.attempts_made()>0&&1===this.show_results&&(_buf+='<div class="pi-button-grey button inline pi" data-on-click="@@show_results(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(""+I18n.t("quizzes.info.results")),_buf+="</div>"),_buf+="</div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/quiz_take_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content"><p>',this.attempts_made()>0?_buf+=this.escape(I18n.t("quizzes.confirm.take.new")):_buf+=this.escape(I18n.t("quizzes.confirm.take.first")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</p>",this.time_limit&&(_buf+='<br /><p><span class="name">',_buf+=this.escape(I18n.t("quizzes.confirm.take.time_limit")),_buf+="</span><span>",_buf+=this.escape(this.time_limit_duration),_buf+="</span></p>"),_buf+='<br /><p><span class="name">',_buf+=this.escape(I18n.t("quizzes.confirm.take.attempts")),_buf+="</span><span>",_buf+=this.escape(this.attempts_available()+" "+I18n.t("of")+" "+this.attempts),_buf+="</span></p></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/scorm_package_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,stat;return _buf="",stat=this.stat_for_user(pi.app.user.id),_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("scorm_packages.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link" href="',_buf+=this.escape(this.take_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>",stat&&(_buf+='<div class="inline-right">',stat.success&&(_buf+='<i class="fa complete-icon fa-check"></i>'),_buf+="</div>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/section_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,interval_nav,next_section_opening_at,prev_section_id,ref,ref1,ref2;return _buf="",interval_nav=2===(null!=(ref=$r.CourseSession.get(pi.app.course_session_id))?ref.navigation:void 0),prev_section_id=null!=(ref1=$r.Section.get_by({position:this.position-1}))?ref1.id:void 0,next_section_opening_at=null!=(ref2=$r.SectionStat.get_by({course_id:this.course_id,section_id:prev_section_id}))?ref2.next_section_opening_at:void 0,_buf+='<li class="section-item item form-item ',_buf+=this.escape(!0===this.draft?"is-disabled":void 0),_buf+='"><div class="group-dropdown text-info section-info pi"><div><span class="part-item">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</span><span class="group-title pi">',_buf+=this.escape(this.name),_buf+="</span>",this.draft?(_buf+='<span class="draft">',_buf+=this.escape(I18n.t("sections.unpublished")),_buf+="</span>"):this.available||(_buf+='<div class="inline-right">',interval_nav?next_section_opening_at?(_buf+=' <span class="grey-text">',_buf+=this.escape(I18n.t("sections.starts_on")+" "+next_section_opening_at),_buf+='</span><div class="pi inline info-callout-content"><i class="fa fa-lock info-callout-icon pi"></i></div>'):(_buf+=' <span class="grey-text">',_buf+=this.escape(I18n.t("sections.opened_soon")),_buf+='</span><div class="pi inline info-callout-content"><i class="fa fa-lock info-callout-icon pi"></i></div>'):(_buf+=' <span class="grey-text">',_buf+=this.escape(I18n.t("sections.unavailable")),_buf+='</span><div class="pi inline info-callout-content"><i class="fa fa-lock info-callout-icon pi" data-on-click="@host.callout.show; e.cancel"></i><div class="pi-callout pi top left med info-callout is-hidden" data-pid="callout"><div class="close-callout-btn button-close pi" data-on-click="@host.hide"></div>',_buf+=I18n.t("sections.unavailable_text"),_buf+="</div></div>"),_buf+="</div>"),_buf+='</div></div><div class="filters-list list-container pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/listeners/material_item)" data-rest="Material.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container quizzes-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/listeners/scorm_package_item)" data-rest="ScormPackage.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container quizzes-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/listeners/quiz_item)" data-rest="Quiz.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container tasks-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/listeners/task_item)" data-rest="Task.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/listeners/task_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,stat;return _buf="",stat=this.stat_for_user(pi.app.user.id),_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("tasks.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link" href="',_buf+=this.escape(this.take_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>",stat&&(stat.checked||(_buf+='<div class="inline check-info">',_buf+=this.escape(""+I18n.t("quizzes.info.check")),_buf+="</div>"),_buf+='<div class="inline-right">',stat.checked?stat.success?_buf+='<i class="fa complete-icon fa-check"></i>':_buf+='<i class="fa failed-icon fa-times"></i>':(_buf+='<div class="pi inline info-callout-content"><i class="fa not-checked-icon fa-clock-o pi" data-on-click="@host.callout.show; e.cancel"></i><div class="pi-callout pi top left med info-callout is-hidden" data-pid="callout"><div class="close-callout-btn button-close pi" data-on-click="@host.hide"></div>',_buf+=I18n.t("quizzes.message.unavailable_text"),_buf+="</div></div>"),_buf+="</div>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/material_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,view_as_a_listener;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon icon-material grey"></i><span class="part-item">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".</span>","ok"===this.status_code?(view_as_a_listener=pi.app.new_version?this.new_view_path():this.view_path(),_buf+='<a class="link" href="',_buf+=this.escape(view_as_a_listener),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+=this.escape(this.name),_buf+=' <span class="file-status">',_buf+=this.escape(this.status_name),_buf+="</span>"),this.is_editor_js&&(_buf+='<span style="color:red;font-size: 11px;padding: 0;margin: 0;display: block;height: unset;line-height: 20px !important;margin-top: -12px;opacity: 0.7;margin-left: 110px;">',_buf+=this.escape("  "+I18n.t("materials.new_format_message")+"."),_buf+="</span>"),_buf+='</div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form material-edit-form pi-form pi ',_buf+=this.escape(this.has_file?void 0:"is-text"),_buf+='" data-on-submited="@@update_material(',_buf+=this.escape(this.id),_buf+=',e.data)" data-serialize="true"><div class="field"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("materials.name")),_buf+='</label><div class="pi-text-input-wrap pi fw" data-name="name" data-validates="presence"><input class="text-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="two-columns"><div class="field pi-radio-group pi" data-item-klass="pi-radio-button" data-on-changed="e.data=&#39;file&#39; ? @host.removeClass(&#39;is-text&#39;) : @host.addClass(&#39;is-text&#39;)"><input type="hidden" value="',_buf+=this.escape(this.has_file?"file":"text"),_buf+='" /><ul class="list"><li class="pi-radio-button" data-value="file">',_buf+=this.escape(I18n.t("materials.types.file")),_buf+='</li><li class="pi-radio-button" data-value="text">',_buf+=this.escape(I18n.t("materials.types.text")),_buf+='</li></ul></div><div class="field pi pi-uploader" data-name="temp_file_id" data-plugins="renderable" data-renderer="jst(templates/materials/file_upload)"><div class="material-file-upload pi ',_buf+=this.escape(this.has_file?"has-file":""),_buf+='" pid="upload_info">',this.external&&this.external_type&&(_buf+='<input name="external" type="hidden" value="',_buf+=this.escape(this.external),_buf+='" /><input name="external_type" type="hidden" value="',_buf+=this.escape(this.external_type),_buf+='" /><input name="file_name" type="hidden" value="',_buf+=this.escape(this.file_name),_buf+='" />'),_buf+='<div class="upload-link"><div class="dotted-link pi" data-on-click="@@upload_file(@host.host)">',_buf+=this.escape(I18n.t("materials.upload_file")),_buf+='</div></div><div class="file-info"><div class="category-icon inline"><i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i></div><span class="file-name ellipses inline">',_buf+=this.escape(this.file_name),_buf+="</span>",this.size&&(_buf+='<span class="file-size">&nbsp;&mdash;',_buf+=this.escape(this.size),_buf+="</span>"),_buf+='<div class="divider inline"></div><div class="dotted-link delete-btn inline pi" data-on-click="@@delete_file(@host.host)">',_buf+=this.escape(I18n.t("materials.delete_file")),_buf+="</div>",this.download_url&&(_buf+='<a class="dotted-link inline pi" download="',_buf+=this.escape(this.file_name),_buf+='" href="',_buf+=this.escape(this.download_url),_buf+='" target="_blank">',this.is_external?_buf+=this.escape(I18n.t("materials.open_source")):_buf+=this.escape(I18n.t("materials.download_file")),_buf+="</a>"),_buf+='</div></div></div></div></div><div class="field material-edit-description"><label class="field-label" for="description">',_buf+=this.escape(I18n.t("materials.description")),_buf+="</label>",this.markdown?_buf+=JST["templates/shared/markdown_editor"]({name:"description",value:this.description}):_buf+=JST["templates/shared/editor"]({name:"description",value:this.description}),_buf+='<div class="field"></div></div><div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(""+I18n.t("helpers.save")),_buf+="</div></div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/material_view_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,view_as_a_listener;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon icon-material grey"></i><span class="part-item">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".</span>","ok"===this.status_code?(view_as_a_listener=pi.app.new_version?this.new_view_path():this.view_path(),_buf+='<a class="link" href="',_buf+=this.escape(view_as_a_listener),_buf+='">',_buf+=this.escape(this.name),_buf+="</a>"):(_buf+=this.escape(this.name),_buf+=' <span class="file-status">',_buf+=this.escape(this.status_name),_buf+="</span>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/quiz_view_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link" href="',_buf+=this.escape(this.view_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/resource_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="resource-item item"><div class="field material-icon blue"></div><div class="field name">',_buf+=this.escape(""+this.name),_buf+='</div><div class="field delete-btn pi" data-on-click="@@destroy_resource(',_buf+=this.escape(this.id),_buf+=')"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/resource_upload_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</div><div class="field progress inline-right">',this.loaded?_buf+='<i class="fa fa-check green-text"></i>':this.failed?_buf+='<i class="fa fa-times red-text"></i>':_buf+='<div class="upload-progress"><div class="pi-progressbar upload-progressbar pi" pid="loader"></div></div>',_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/scorm_package_view_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("scorm_packages.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link" href="',_buf+=this.escape(this.view_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/section_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3,ref;switch(_buf="",_buf+='<li class="section-item item form-item ',_buf+=this.escape(!0===this.draft?"is-draft":""),_buf+='"><div class="group-dropdown text-info section-info pi"><div><span class="part-item">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</span><span class="group-title pi">',_buf+=this.escape(this.name),_buf+='</span><span class="draft publish-link pi" data-on-click="@@publish_section(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("sections.publish")),_buf+='</span></div></div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form pi-form pi" data-on-submited="@@update_section(',_buf+=this.escape(this.id),_buf+=',e.data)" data-serialize="true"><div class="field"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("sections.name")),_buf+='</label><div class="pi-text-input-wrap pi fw" data-name="name" data-validates="presence"><input class="text-input" type="text"',_skim_codeattributes1=this.name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="field inline"><div class="pi-checkbox-wrap pi ',_buf+=this.escape(!0===this.draft?"is-selected":""),_buf+='" data-false-value="false" data-name="draft" data-on-changed="',_buf+=this.escape(!0===this.draft?"@host.notify_cb.clear; e.data ? @host.notify_cb.hide : @host.notify_cb.show":"e"),_buf+='" data-true-value="true"><input type="hidden"',_skim_codeattributes2=this.draft){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><label class="checkbox-label" for="draft">',_buf+=this.escape(I18n.t("sections.draft")),_buf+="</label></div></div>",this.draft&&(_buf+='<div class="field inline"><div class="pi-checkbox-wrap pi is-hidden" data-false-value="false" data-name="send_notification" data-on-changed="e.data ? @host.notify_txt.show : @host.notify_txt.hide" data-on-cleared="@host.notify_txt.hide" data-pid="notify_cb" data-true-value="true"><input type="hidden" value="false" /><label class="checkbox-label" for="draft">',_buf+=this.escape(I18n.t("sections.send_notification")),_buf+='</label></div></div><div class="clear"></div><div class="field pi is-hidden" data-pid="notify_txt"><label class="field-label" for="notification_txt">',_buf+=this.escape(I18n.t("sections.notification_text")),_buf+='</label><div class="pi-text-input-wrap pi-textarea pi notification-txt fw" data-component="text_area" data-name="notification_txt" data-plugins="scrollable"><textarea class="text-input"></textarea></div></div>'),_buf+='<div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(I18n.t("helpers.save")),_buf+='</div></div></div><div class="list-container resources-list inline pi" data-listen-create="true" data-load-rest="true" data-pid="files_list" data-plugins="restful" data-renderer="jst(templates/materials/resource_item)" data-rest="Resource.where(section_id: ',_buf+=this.escape(this.id),_buf+=')"><ul class="list"></ul></div><div class="upload-resources"><icon class="fa fa-paperclip"></icon><a class="add-files dotted-link button pi" href="@@add_resources(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("materials.add_resources")),_buf+='</a><div class="add-resources-info">',_buf+=this.escape(I18n.t("materials.add_resources_info")),_buf+='</div></div></div><div class="filters-list list-container pi-list pi" data-listen-create="true" data-load-rest="true" data-plugins="selectable sortable restful" data-renderer="jst(templates/section_contents/item)" data-rest="SectionContent.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-select-type="radio check" data-sort="position:asc" pid="list"><ul class="filters list"></ul><div class="filter-item add-item add-content form-item pi" data-pid="add_content_btn"><div class="add-item-icon"><span class="add-item-link pi" data-on-click="@@view.show_add_links(@host)">',_buf+=this.escape(I18n.t("sections.add_content")),_buf+='</span></div></div><div class="filter-item add-material add-item form-item is-hidden pi" data-component="add_material" data-on-submit="@@create_material(e.data)" data-pid="add_btn"><div class="add-item-icon quizzes-add-links"><span class="add-item-link pi" data-pid="link">',_buf+=this.escape(I18n.t("materials.add_material")),_buf+='</span><span class="add-item-link fa fa-chevron-up pi" data-on-click="@@view.hide_add_links(@host)"></span></div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-pid="cancel_btn"></div><div class="form-content"><div class="form material-edit-form pi-form pi" data-serialize="true" pid="form"><input data-name="section_id" name="section_id" type="hidden"',_skim_codeattributes3=this.id){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}return _buf+=' /><div class="field"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("materials.name")),_buf+='</label><div class="pi-text-input-wrap pi fw" data-name="name" data-pid="input_txt" data-validates="presence"><input class="text-input" type="text" /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="two-columns"><div class="field pi-radio-group pi" data-item-klass="pi-radio-button" data-on-changed="e.data=&#39;file&#39; ? @host.removeClass(&#39;is-text&#39;) : @host.addClass(&#39;is-text&#39;)" data-pid="material_default_choose"><input type="hidden" value="file" /><ul class="list"><li class="pi-radio-button" data-value="file">',_buf+=this.escape(I18n.t("materials.types.file")),_buf+='</li><li class="pi-radio-button" data-value="text">',_buf+=this.escape(I18n.t("materials.types.text")),_buf+='</li></ul></div><div class="field pi pi-uploader" data-name="temp_file_id" data-plugins="renderable" data-renderer="jst(templates/materials/file_upload)"><div class="material-file-upload"><input type="hidden" value="0" /><div class="upload-link"><div class="dotted-link pi" data-on-click="@@upload_file(@host)">',_buf+=this.escape(I18n.t("materials.upload_file")),_buf+='</div></div></div></div></div><div class="field material-edit-description"><label class="field-label" for="description">',_buf+=this.escape(I18n.t("materials.description")),_buf+="</label>",_buf+=JST["templates/shared/markdown_editor"]({name:"description",value:this.description}),_buf+='<div class="field"></div></div></div><div class="submit-btn pi-button-green inline pi" pid="submit_btn">',_buf+=this.escape(I18n.t("helpers.save")),_buf+="</div></div></div></div>",(null!=(ref=pi.app.course)?ref.copyright_protected:void 0)||(_buf+='<div class="filter-item add-material add-item form-item is-hidden pi" data-pid="add_scorm_btn"><div class="add-item-icon quizzes-add-links"><span class="add-item-link pi" data-on-click="@@create_scorm(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("scorm_packages.add_scorm")),_buf+="</span></div></div>"),_buf+='<div class="filter-item add-material add-item form-item is-hidden pi" data-pid="add_quiz_btn"><div class="add-item-icon quizzes-add-links"><span class="add-item-link pi" data-on-click="@@create_quiz(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("quizzes.add_quiz")),_buf+='</span><span class="or-field">',_buf+=this.escape(I18n.t("quizzes.or")),_buf+='</span><span class="add-item-link pi" data-on-click="@@copy_quiz(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("quizzes.copy_quiz")),_buf+="</span>",pi.app.user&&pi.app.user.admin&&(_buf+='<span class="or-field">',_buf+=this.escape(I18n.t("quizzes.or")),_buf+='</span><span class="add-item-link pi" data-on-click="@@import_quiz(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("quizzes.import_quiz")),_buf+="</span>"),_buf+='</div></div><div class="filter-item add-material add-item form-item is-hidden pi" data-pid="add_task_btn"><div class="add-item-icon tasks-add-links"><span class="add-item-link pi" data-on-click="@@create_task(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("tasks.add_task")),_buf+="</span></div></div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/section_view_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="section-item item form-item ',_buf+=this.escape(!0===this.draft?"is-draft":""),_buf+='"><div class="group-dropdown text-info section-info pi"><div><span class="part-item">',_buf+=this.escape(I18n.t("materials.section")+" "+this.position+". "),_buf+='</span><span class="group-title pi">',_buf+=this.escape(this.name),_buf+='</span><span class="draft">',_buf+=this.escape(""+I18n.t("sections.draft")),_buf+='</span></div></div><div class="filters-list list-container pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/material_view_item)" data-rest="Material.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container scorm-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/scorm_package_view_item)" data-rest="ScormPackage.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container quizzes-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/quiz_view_item)" data-rest="Quiz.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div><div class="filters-list list-container tasks-list pi-list pi" data-load-rest="true" data-plugins="sortable restful" data-renderer="jst(templates/materials/task_view_item)" data-rest="Task.where(section_id: ',_buf+=this.escape(this.id),_buf+=')" data-sort="position:asc" pid="list"><ul class="filters list"></ul></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/task_view_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item"><div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("tasks.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link" href="',_buf+=this.escape(this.view_path()),_buf+='">',_buf+=this.escape(this.name),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/materials/youtube_video_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field cover">',this.thumb?(_buf+='<img class="cover-img" height="26" src="',_buf+=this.escape(this.thumb),_buf+='" />'):_buf+='<div class="no-cover"></div>',_buf+='</div><div class="field name">',_buf+=this.escape(this.title),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("meetings.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/finish_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("meetings.confirm.finish")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/meeting_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<li class="item meeting-item cover-item-small">',this.is_moderator?(_buf+='<a class="cover inline" href="/meetings/',_buf+=this.escape(this.id),_buf+='" title="',_buf+=this.escape(this.name),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+="</a>"):(_buf+='<div class="cover inline">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+="</div>"),_buf+='<div class="info inline"><div class="meeting-time"><span class="meeting-datetime">',_buf+=this.escape(this.start_time),_buf+="</span>","running"===this.status&&(_buf+=' <span class="is-running">',_buf+=this.escape(I18n.t("meetings.is_running")),_buf+="</span>"),_buf+='</div><p class="meeting-title ellipses">',this.is_moderator){switch(_buf+='<a class="link" href="/meetings/',_buf+=this.escape(this.slug||this.id),_buf+='"',_skim_codeattributes1=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.name),_buf+="</a>"}else _buf+="<span>",_buf+=this.escape(this.name),_buf+="</span>";return _buf+="</p></div>","running"!==this.status&&"soon"!==this.status||(_buf+='<div class="buttons"><a class="button button-enter" href="',_buf+=this.escape(this.enter_path),_buf+='" target="_blank">',_buf+=this.escape(I18n.t("helpers.enter")),_buf+="</a>",4!==pi.app.user.role_id&&pi.app.user.id!==this.owner_id||"running"!==this.status||(_buf+='<a class="button button-finish" href="@@finish(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(I18n.t("helpers.finish")),_buf+="</a>"),_buf+="</div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/meeting_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item meeting-item cover-item-small"><div class="cover inline">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</div><div class="info inline"><div class="meeting-time"><span class="meeting-datetime">',_buf+=this.escape(this.start_time),_buf+='</span></div><p class="meeting-title ellipses"><span>',_buf+=this.escape(this.name),_buf+="</span></p></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),
this.JST["templates/meetings/meeting_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("title")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.name),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("date_and_time")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.start_time),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("meetings.access_type")),_buf+='</span><div class="info-field select-text access-type-',_buf+=this.escape(this.access_type),_buf+='">',_buf+=this.escape(this.access_type_name),_buf+="</div></div>",1===this.access_type||3===this.access_type){switch(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("meetings.info.url")),_buf+='</span><div class="copy-field url-field pi-text-input-wrap is-readonly"><div class="text-input pi pi-copy-text"',_skim_codeattributes1=I18n.t("link_is_copied")){case!0:_buf+=' data-message="data-message"';break;case!1:case null:break;default:_buf+=' data-message="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.url),_buf+="</div></div></div>"}return _buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/participant_detail_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+="</span></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field role">',this.role_id>1&&(_buf+=this.escape(I18n.t("meetings.presenter"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/recording_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field play"><a class="link play-link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='"></a></div><div class="field datetime">',_buf+=this.escape(this.start_time),_buf+='</div><div class="field title"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field duration inline-right">',_buf+=this.escape(this.duration),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/meetings/show_participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email),_buf+=')">',_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email),_buf+='</span></div><div class="field role">',this.role_id>1&&(_buf+=this.escape(I18n.t("meetings.presenter"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/_yandex_payment_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<form action="',_buf+=this.escape(this.yandex_kassa_params.pay_url),_buf+='" method="post"><input name="shopId" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.shop_id),_buf+='" /><input name="scid" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.scid),_buf+='" /><input name="sum" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.sum),_buf+='" /><input name="customerNumber" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.customer_num),_buf+='" /><input name="orderNumber" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.order_num),_buf+='" /><input name="paymentType" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.payment_type),_buf+='" /><input name="cps_phone" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.cps_phone),_buf+='" /><input name="shopSuccessURL" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.success_payment_url),_buf+='" /><input name="shopDefaultURL" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.default_url),_buf+='" /><input name="shopFailURL" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.fail_payment_url),_buf+='" /><input name="ym_merchant_receipt" type="hidden" value="',_buf+=this.escape(this.yandex_kassa_params.ym_merchant_receipt),_buf+='" /><input class="button pi-button-green" type="submit" value="',_buf+=this.escape(I18n.t("orders.pay")),_buf+='" /></form>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/amount_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+="<span>",_buf+=this.escape(I18n.t("orders.sum")),_buf+='</span><span class="sum">',_buf+=this.escape(this.sum),_buf+="</span><span>",_buf+=this.escape(I18n.t("orders.currency")),_buf+='</span><div class="clear"></div><div class="info">',_buf+=this.escape(this.tariff.user_count),_buf+=" ",_buf+=this.escape(I18n.t("orders.users")),_buf+=", ",_buf+=this.escape(this.tariff.disk_space),_buf+=" ",_buf+=this.escape(I18n.t("orders.gb")),_buf+='</div><div class="info">',_buf+=this.escape(I18n.t("orders.additional_memory")),_buf+=": ",_buf+=this.escape(this.memory),_buf+=" ",_buf+=this.escape(I18n.t("orders.gb")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/bottom_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<br /><div class="info">',_buf+=this.escape(this.params.tariff.user_count),_buf+=" ",_buf+=this.escape(I18n.t("orders.users")),_buf+=", ",_buf+=this.escape(this.params.tariff.disk_space),_buf+=" ",_buf+=this.escape(I18n.t("orders.gb")),_buf+='</div><br /><div class="info">',_buf+=this.escape(I18n.t("orders.additional_memory")),_buf+=": ",_buf+=this.escape(this.params.memory),_buf+=" ",_buf+=this.escape(I18n.t("orders.gb")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/memory_period"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="period-range">',_buf+=this.escape(this.month_count),_buf+=" ( ",_buf+=this.escape(this.started),_buf+=" - ",_buf+=this.escape(this.ended),_buf+=" )</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field double-decker date-num"><div class="number">',_buf+=this.escape("\u2116"+this.id),_buf+='</div><div class="datetime">',_buf+=this.escape(this.created_time),_buf+='</div></div><div class="field double-decker"><div class="amount">',_buf+=this.escape(this.amount+" "+I18n.t("rub")),_buf+='</div><div class="dummy"></div></div><div class="field double-decker pay-status"><div class="status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div>","success"===this.status?(_buf+='<div class="payed_at">',_buf+=this.escape(this.payment_date),_buf+="</div>"):(_buf+='<div class="pay-till">',_buf+=this.escape(I18n.t("till")+" "+this.payment_till_date),_buf+="</div>"),_buf+='</div><div class="field doc"></div>',"pending"!==this.status&&"failed"!==this.status||(_buf+='<div class="field actions">',"creditcard"===this.payment_type||"jur_credit"===this.payment_type?3===this.yandex_kassa_api_version?(_buf+='<a class="button pi-button-green inline" href="/payments/',_buf+=this.escape(this.id),_buf+='/make" target="_blank">',_buf+=this.escape(I18n.t("orders.pay")),_buf+="</a>"):_buf+=JST["templates/orders/_yandex_payment_form"](this):(_buf+='<i class="icon-file-pdf icon-med grey-text"></i><a class="doc-link inline" href="/orders/',_buf+=this.escape(this.id),_buf+='/invoice" target="_blank">',_buf+=this.escape(I18n.t("orders.download_invoice")),_buf+="</a>"),_buf+="</div>"),"success"===this.status&&(_buf+='<div class="field doc"><i class="icon-file-pdf icon-med grey-text"></i><a class="dotted-link doc-link inline" href="',_buf+=this.escape(this.act_url),_buf+='" target="_blank">',_buf+=this.escape(I18n.t("orders.act")),_buf+="</a></div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/order_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("accounts.account_name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.account_name),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("title")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.name),_buf+="</div>",this.mandatory&&(_buf+='<div class="info-field select-type mandatory">',_buf+=this.escape(" ( "+I18n.t("orders.mandatory")+" ) "),_buf+="</div>"),_buf+="</div>",this.user_id&&(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.user_info")),_buf+='</span><div class="info-field name">',_buf+=this.escape(this.user_name),_buf+='</div><div class="info-field email">',_buf+=this.escape(this.user_email),_buf+="</div></div>"),_buf+='<div class="left-column"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.status")),_buf+='</span><div class="info-field select-text status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.amount")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.amount),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.created_time")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.created_time),_buf+="</div></div>","success"===this.status?(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.date")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.payment_date),_buf+="</div></div>"):(_buf+='<div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.payment_till")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.payment_till_date),_buf+="</div></div>"),_buf+='</div><div class="right-column"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.comment")),_buf+='</span><div class="hr"></div><div class="info-field select-text">',_buf+=this.escape(this.comment),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.payment_form.title")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape({creditcard:I18n.t("orders.payment_form.creditcard"),bank_transfer:I18n.t("orders.payment_form.bank_transfer")}[this.payment_type]),_buf+='</div></div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("orders.documents")),_buf+='</span><div class="buttons"><a class="button pi-button-blue doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/invoice" target="_blank">',_buf+=this.escape(I18n.t("orders.download_invoice_with_stamp")),_buf+='</a><a class="button pi-button-blue doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/invoice?without_stamp=1" target="_blank">',_buf+=this.escape(I18n.t("orders.download_invoice_without_stamp")),_buf+="</a>","success"===this.status&&(_buf+='<div class="doc-act"><a class="button pi-button-green doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/act" target="_blank">',_buf+=this.escape(I18n.t("orders.download_act_with_stamp")),_buf+='</a><a class="button pi-button-green doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/act?without_stamp=1" target="_blank">',_buf+=this.escape(I18n.t("orders.download_act_without_stamp")),_buf+="</a></div>"),_buf+='</div><br /><div class="buttons"><a class="button pi-button-grey doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/invoice?force=y" target="_blank">',_buf+=this.escape(I18n.t("orders.reload_invoice")),_buf+="</a>","success"===this.status&&(_buf+='<a class="button pi-button-grey doc" href="/admin/orders/',_buf+=this.escape(this.id),_buf+='/act?force=y" target="_blank">',_buf+=this.escape(I18n.t("orders.reload_act")),_buf+="</a>"),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/payment"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+="<div><span>",_buf+=this.escape(I18n.t("orders.sum")),_buf+='</span><span class="order-info-sum">',_buf+=this.escape(this.amount+" "+I18n.t("rub")),_buf+="</span></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/payment_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field number">',_buf+=this.escape(this.id),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field datetime">',_buf+=this.escape(this.payment_date),_buf+='</div><div class="field datetime">',_buf+=this.escape(this.payment_till_date),_buf+='</div><div class="field status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+='</div><div class="field amount ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.amount),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/period_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="payment-item item checkbox-wrap ',_buf+=this.escape(this.selected?"is-selected":void 0),_buf+='" data-started="',_buf+=this.escape(this.started),_buf+='" data-type="period" data-value="',_buf+=this.escape(this.value),_buf+='"><i class="fa fa-check"></i>',_buf+=this.escape(this.value),_buf+=" ",_buf+=this.escape(I18n.t("orders.month")),_buf+=" ( ",_buf+=this.escape(this.started),_buf+=" - ",_buf+=this.escape(this.ended),_buf+=" )</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/orders/tariff_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<span class="tariff_info">',_buf+=this.escape(I18n.t("orders.tariff.checked")),_buf+=": ",_buf+=this.escape(this.name),_buf+=", ",_buf+=this.escape(this.user_count),_buf+=" ",_buf+=this.escape(I18n.t("orders.users")),_buf+=", ",_buf+=this.escape(this.disk_space),_buf+=" ",_buf+=this.escape(I18n.t("orders.gb")),_buf+="</span>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("products.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/event_selector"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3;if(_buf="",_buf+='<div class="event-field">',null!=this.event_id){switch(_buf+='<input name="copy_from_event" type="hidden" value="1" /><input name="event_id" type="hidden"',_skim_codeattributes1=this.event_id){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><input name="event_type" type="hidden"',_skim_codeattributes2=this.event_type){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><input name="type" type="hidden"',_skim_codeattributes3=this.type){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}_buf+=' /><label class="field-label">',_buf+=this.escape(I18n.t("products.edit_form."+pi.utils.snake_case(this.event_type))),_buf+='</label><span class="info-label">',_buf+=this.escape(this.name),_buf+="</span>"}return _buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field user">',_buf+=this.escape(this.user_fullname),_buf+='<span class="email">',_buf+=this.escape(this.user_email||this.user_phone),_buf+='</span></div><div class="field number">',_buf+=this.escape(this.id),_buf+='</div><div class="field date">',_buf+=this.escape(this.created_time),_buf+='</div><div class="field amount ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.amount_int+" &#8381;",_buf+='</div><div class="field status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/orders/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.product_name),_buf+='">',_buf+=this.escape(this.product_name),_buf+='</a></div><div class="field username">',_buf+=this.escape(this.user_fullname),_buf+='</div><div class="field date">',_buf+=this.escape(this.created_time),_buf+='</div><div class="field amount ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.amount_int+" &#8381;",_buf+='</div><div class="field status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/orders/show_content"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field name"><span class="field-label">',_buf+=this.escape(I18n.t("products.name")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.product_name),_buf+='</div></div><div class="field id"><span class="field-label">',_buf+=this.escape(I18n.t("orders.id")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.id),_buf+='</div></div><div class="field status"><span class="field-label">',_buf+=this.escape(I18n.t("orders.status")),_buf+='</span><div class="info-field select-text ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+='</div></div><div class="field amount"><span class="field-label">',_buf+=this.escape(I18n.t("orders.amount")),_buf+='</span><div class="info-field select-text">',_buf+=this.amount_int+" &#8381;",_buf+='</div></div><div class="field amount"><span class="field-label">',_buf+=this.escape(I18n.t("users.fullname")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.user_fullname),_buf+='</div></div><div class="field amount"><span class="field-label">',_buf+=this.escape(I18n.t("users.email")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.user_email),_buf+='</div></div><div class="field amount"><span class="field-label">',_buf+=this.escape(I18n.t("users.phone")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.user_phone),_buf+='</div></div><div class="field created_at"><span class="field-label">',_buf+=this.escape(I18n.t("orders.created_time")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.created_time),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/participant_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')">',_buf+=this.escape(this.fullname),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field role red-text">',1===this.role_id&&(_buf+=this.escape(I18n.t("products.roles.author"))),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/product_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2;switch(_buf="",_buf+='<li class="item product-item cover-item"><a class="cover inline" href="/products/',_buf+=this.escape(this.slug||this.id),_buf+='" title="',_buf+=this.escape(this.name),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="product-title ellipses"><a class="link" href="/products/',_buf+=this.escape(this.slug||this.id),_buf+='"',_skim_codeattributes1=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=">",_buf+=this.escape(this.name),_buf+="</a></p>",this.free?(_buf+='<p><span class="green-text">',_buf+=this.escape(I18n.t("products.free")),_buf+="</span></p>"):(_buf+='<p class="product-price"><label>',_buf+=this.escape(I18n.t("products.index.price")+":"),_buf+="</label> <span>",_buf+=(0|this.amount)+" &#8381;",_buf+="</span></p>"),_buf+='<p><a class="link" href="/products/',_buf+=this.escape(this.slug||this.id),_buf+='/buy"',_skim_codeattributes2=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}return _buf+=">",_buf+=this.escape(I18n.t("products.index.buy_page")),_buf+="</a></p></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/product_store_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<div class="item store-product-item ',_buf+=this.escape(this.product_type),_buf+='"><div class="item-cover">',this.cover_url?(_buf+='<div class="item-cover-img" style="background-image: url(&#39;',_buf+=this.escape(this.cover_url),_buf+='&#39;);"></div>'):_buf+='<div class="no-cover"><i class="icon-logo"></i></div>',_buf+='</div><div class="item-dates">',this.event_dates&&(_buf+=this.event_dates),_buf+='</div><div class="item-title"><a class="link"',_skim_codeattributes1=this.url){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+='</a></div><div class="item-authors">',_buf+=this.escape(this.authors),_buf+='</div><div class="item-footer pos-rel"><div class="icon"></div>',this.free?(_buf+='<div class="price inline-right">',_buf+=this.escape(I18n.t("products.free")),_buf+="</div>"):(_buf+='<div class="price inline-right">',_buf+=this.amount_rubles,_buf+="</div>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/promo_codes/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("promo_codes.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.code),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/products/promo_codes/promo_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field code select-text" title="',_buf+=this.escape(this.code),_buf+='">',_buf+=this.escape(this.code),_buf+="</div>","percent"===this.type?(_buf+='<div class="field discount">',_buf+=this.escape(this.value),_buf+=" %</div>"):(_buf+='<div class="field discount">',_buf+=this.escape(this.value),_buf+=" ",_buf+=this.escape(I18n.t("promo_codes.cur")),_buf+="</div>"),_buf+='<div class="field expired_at">',_buf+=this.escape(this.expired_time),_buf+='</div><div class="field count">',_buf+=this.escape(this.count),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/credentials/app_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item application-item"><div class="info-line"><div class="field info-label">',_buf+=this.escape(I18n.t("accounts.credentials.name")),_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+='</div></div><div class="info-line"><div class="field info-label">',_buf+=this.escape(I18n.t("accounts.credentials.api_key")),_buf+='</div><div class="field select-text">',_buf+=this.escape(this.uid),_buf+='</div></div><div class="info-line"><div class="field info-label">',_buf+=this.escape(I18n.t("accounts.credentials.secret_key")),_buf+='</div><div class="field select-text">',_buf+=this.escape(this.secret),_buf+='</div></div><div class="info-line"><div class="field info-label">',_buf+=this.escape(I18n.t("accounts.credentials.redirect_uri_label")),_buf+='</div><div class="field select-text">',_buf+=this.escape(this.redirect_uri),_buf+='</div></div><div class="info-line"><div class="field info-label">ID</div><div class="field select-text">',_buf+=this.escape(this.id),_buf+="</div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/credentials/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("accounts.credentials.confirm_destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/index"]=function(){var indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,len,provider,ref;for(_buf="",_buf+='<div class="profile-info"><div class="avatar">',this.avatar_large_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_large_url),_buf+='" />'):_buf+='<div class="no-avatar"></div>',_buf+='</div><div class="info"><div class="field"><div class="title">',_buf+=this.escape(this.fullname),_buf+='</div><div class="action-btn inline button button-finish pi" data-component="button" data-on-click="@@edit"><i class="button-icon fa fa-pencil"></i><div class="btn-label">',_buf+=this.escape(""+I18n.t("helpers.edit")),_buf+='</div></div></div><div class="clear"></div><div class="line"></div><div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.email")+": "),_buf+='</div><div class="data">',_buf+=this.escape(this.email),_buf+='</div></div><div class="clear"></div><div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.phone")+": "),_buf+="</div>",this.phone?(_buf+='<div class="data">',_buf+=this.escape(this.phone),_buf+="</div>"):(_buf+='<div class="data">',_buf+="&mdash;",_buf+="</div>"),_buf+='</div><div class="clear"></div>',this.signature&&(_buf+='<div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.signature")+": "),_buf+='</div><div class="data">',_buf+=this.escape(this.signature),_buf+='</div></div><div class="clear"></div>'),this.description&&(_buf+='<div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.description")+": "),_buf+='</div><div class="data">',_buf+=JST.parseLinks(JST.sanitize(this.description)),_buf+='</div></div><div class="clear"></div>'),_buf+='<div class="line"></div><div class="field"><div class="fullname">',_buf+=this.escape(I18n.t("profiles.settings")),_buf+="</div></div>",""!==this.notice_email&&"undefined"!==this.notice_email&&(_buf+='<div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.notice_email")+": "),_buf+='</div><div class="data">',_buf+=this.escape(this.notice_email),_buf+="</div>",this.email_verified?(_buf+='<div class="span tag green">',_buf+=this.escape(""+I18n.t("users.email_confirm")),_buf+="</div>"):(_buf+='<div class="span tag red">',_buf+=this.escape(""+I18n.t("users.email_not_confirm")),_buf+='</div><a class="link reconfirm-link" href="@@reconfirm_email()">',_buf+=this.escape(""+I18n.t("users.reconfirm_email")),_buf+="</a>"),_buf+="</div>"),_buf+='<div class="clear"></div><div class="field"><div class="label">',_buf+=this.escape(I18n.t("profiles.language")+": "),_buf+='</div><div class="data">',_buf+=this.escape(this.lang),_buf+="</div></div>",this.new_manager&&(_buf+='<div class="clear"></div><div class="field">',"0"===this.new_manager?(_buf+='<a class="dotted-link inline" href="/?new_manager=true">',_buf+=this.escape(I18n.t("profiles.go_to_new_manager")),_buf+="</a>"):(_buf+='<a class="dotted-link inline" href="/?new_manager=false">',_buf+=this.escape(I18n.t("profiles.go_to_old_manager")),_buf+="</a>"),_buf+="</div>"),_buf+='<div class="clear"></div><div class="line"></div><div class="field"><div class="fullname">',_buf+=this.escape(I18n.t("profiles.social_networks")),_buf+='</div></div><div class="field"><div class="providers-list">',i=0,
len=(ref=["vk","facebook","yandex","google"]).length;i<len;i++)provider=ref[i],_buf+='<div class="provider-item"><div class="social-icon-image inline ',_buf+=this.escape(provider),_buf+='"></div> ',indexOf.call(this.providers,provider)>=0?(_buf+='<a class="dotted-link inline" href="@@remove_provider(',_buf+=this.escape(provider),_buf+=')">',_buf+=this.escape(I18n.t("profiles.dettach")),_buf+="</a>"):(_buf+='<a class="dotted-link inline" href="/oauth/',_buf+=this.escape(provider),_buf+='">',_buf+=this.escape(I18n.t("profiles.attach")),_buf+="</a>"),_buf+="</div>";return _buf+="</div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/orders/cancel_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("orders.confirm.cancel")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/orders/order_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field id" title="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(this.id),_buf+='</div><div class="field date">',_buf+=this.escape(this.created_time),_buf+='</div><div class="field name">',_buf+=this.escape(this.product_name),_buf+='</div><div class="field amount">',_buf+=this.escape(this.amount),_buf+='</div><div class="field status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.state),_buf+="</div>",this.payment_path&&"pending"===this.status&&(_buf+='<div class="field pay_buttons"><a class="button pi-button-green" href="',_buf+=this.escape(this.payment_path),_buf+='" target="_blank">',_buf+=this.escape(""+I18n.t("orders.pay")),_buf+="</a></div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/panel"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div><div class="avatar inline"><a href="/profiles">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" />'):_buf+='<div class="no-avatar"></div>',_buf+='</a></div><div class="info inline"><h1 class="title">',_buf+=this.escape(this.fullname),_buf+='</h1><span class="owner-name">',_buf+=this.escape(this.email),_buf+="</span></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/profile/remove_provider_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.social.remove_provider_confirm")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/program_sessions/_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,course,link,thumb_url,title,_this;switch(_buf="",link="/course_sessions/"+this.id,pi.app.user.id===this.program_owner_id&&(link="/courses/"+this.course_id),course=pi.app.courses.find((_this=this,function(c){return c.id===_this.course_id})),thumb_url=this.thumb_url||course.thumb_url,title=this.course_name||course.name,_buf+='<li class="item course-item stats cover-item"><a class="cover inline" href="',_buf+=this.escape(link),_buf+='">',thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="',_buf+=this.escape(link),_buf+='"',_skim_codeattributes1=title){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(title),_buf+="</a></p><footer>",this.period?(_buf+="<span>",_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),_buf+="</footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/program_sessions/item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,link;switch(_buf="",link="/course_sessions/"+this.id,pi.app.user.id!==this.program_owner_id&&4!==pi.app.user.role_id||(link="/courses/"+this.course_id),_buf+='<li class="item course-item stats cover-item"><a class="cover inline" href="',_buf+=this.escape(link),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="',_buf+=this.escape(link),_buf+='"',_skim_codeattributes1=this.course_name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.course_name),_buf+="</a></p><footer>",this.period?(_buf+="<span>",_buf+=this.escape(this.period_days),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),_buf+="</footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/add_listeners_attention"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("programs.attention.add_listeners")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/assigned_program_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item program-item stats cover-item"><a class="cover inline" href="/course_sessions/',_buf+=this.escape(this.id),_buf+=this.escape(link_suffix),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="program-title ellipses">',_buf+=this.escape(this.name),_buf+='</p><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+='</p><footer><span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>",this.programs_sessions&&this.program_sessions.length&&(_buf+=' <span class="star"></span> ',_buf+=JST["templates/program_sessions/item"]({types:this.program_sessions})),_buf+='</footer></div><div class="edit-item pi-form pi" data-on-submited="@@update(',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="form"><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input label-name-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="buttons inline-right"><div class="icon-button-green button inline pi" data-on-click="@host.submit"><i class="fa fa-check"></i></div><div class="icon-button button inline pi" data-on-click="@view.list.finish_edit"><i class="fa fa-times"></i></div></div></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/course_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,thumb_url,_this;return _buf="",_buf+='<li class="item"><div class="cover inline">',(thumb_url=this.thumb_url||pi.app.courses.find((_this=this,function(c){return c.id===_this.id})).thumb_url)?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(thumb_url),_buf+='" />'):_buf+='<img class="cover-img no-events" src="/favicon.ico" />',_buf+='</div><div class="field name">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("programs.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/finish_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=I18n.t("programs.confirm.finish"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<li class="item program-item cover-item"><a class="cover inline" href="/programs/',_buf+=this.escape(this.id),_buf+='">',this.thumb_url?(_buf+='<img class="cover-img no-events" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover no-events"><i class="icon-logo"></i></div>',_buf+='</a><div class="info inline"><p class="course-title ellipses"><a class="link" href="/programs/',_buf+=this.escape(this.id),_buf+='"',_skim_codeattributes1=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+='</a></p><p class="ownername">',_buf+=this.escape(this.owner_name),_buf+="</p><footer>",this.period?(_buf+="<span>",_buf+=this.escape(this.human_period),_buf+="</span>"):(_buf+='<span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline ',_buf+=this.escape(this.deadline_soon?"red-text":void 0),_buf+='">',_buf+=this.finished_time,_buf+="</span>"),_buf+="</footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/programs/program_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item course-item stats cover-item-small"><div class="info inline"><p class="course-title ellipses"><span title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</span></p><footer><span class="started">',_buf+=this.escape(this.started_time),_buf+='</span> <span>&mdash;</span> <span class="deadline">',_buf+=this.finished_time,_buf+="</span></footer></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/question_categories/create_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("quizzes.edit.question_categories_confirm")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/question_categories/edit_category_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="text-info q-category-table"><div class="name inline">',this.name&&(_buf+='<span title="',_buf+=this.escape(JST.strip_html(this.name).slice(0,100)),_buf+='">',_buf+=this.escape(JST.strip_html(this.name)),_buf+="</span>"),_buf+='</div><div class="options inline-right">',this.score&&(_buf+='<span class="red-text">',_buf+=this.escape(JST.strip_html(this.score)),_buf+="</span>"),_buf+="</div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/answer_file_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="file-info"><div class="category-icon inline"><i class="fa ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i></div><span class="file-name">',_buf+=this.escape(this.file_name),_buf+="</span>",this.size&&(_buf+='<span class="file-size">&nbsp;&mdash;',_buf+=this.escape(this.size),_buf+="</span>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("questions.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/list_type_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,j,k,len,len1,option,ref,ref1;if(_buf="",_buf+='<div><label class="field-label options-label">',_buf+=this.escape(I18n.t("quizzes.question.options")),_buf+='</label><div class="pi options-list list-container pi-list" data-pid="list" data-plugins="renderable" data-renderer="jst(templates/questions/',_buf+=this.escape(this.type),_buf+='_option)" pid="options_list"><ul class="list">',null!=this.data&&this.data.length)for(i=j=0,len=(ref=this.data).length;j<len;i=++j)(option=ref[i]).__list_index__=i,_buf+=""+JST["templates/questions/"+this.type+"_option"](option);else if("short_answer"!==this.type)for(k=0,len1=(ref1=[0,1]).length;k<len1;k++)option={__list_index__:i=ref1[k]},_buf+=""+JST["templates/questions/"+this.type+"_option"](option);else _buf+=""+JST["templates/questions/"+this.type+"_option"]();return _buf+='</ul><div class="add-item add-option pi" data-on-click="@host.add_item"><span class="add-item-link">',_buf+=this.escape(""+I18n.t("quizzes.question.add_option")),_buf+="</span></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/match_question_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><input name="data[][left_key]" type="hidden" value="',_buf+=this.escape(this.left_key),_buf+='" /><div class="pi-text-input-wrap pi inline" data-name="data[][left]" data-validates="presence"><input class="text-input match-input" type="text" value="',_buf+=this.escape(this.left),_buf+='" /></div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><input name="data[][right_key]" type="hidden" value="',_buf+=this.escape(this.right_key),_buf+='" /><div class="pi-text-input-wrap pi inline" data-name="data[][right]" data-validates="presence"><input class="text-input match-input" type="text" value="',_buf+=this.escape(this.right),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@view.remove_question(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/multiple_choice_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><input name="data[][key]" type="hidden" value="',_buf+=this.escape(this.key),_buf+='" /><div class="pi-checkbox-wrap option-check pi" data-name="data[][correct]"><input type="hidden" value="',_buf+=this.escape(0|this.correct),_buf+='" /></div><div class="pi-text-input-wrap pi" data-name="data[][name]" data-validates="presence"><input class="text-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@view.remove_question(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/numeric_question_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div><label class="field-label">',_buf+=this.escape(I18n.t("quizzes.question.numeric_options")),_buf+='</label><div class="numeric-options field two-columns"><div class="numeric-field inline field"><label class="field-label" for="data[min]">',_buf+=this.escape(I18n.t("quizzes.question.numeric_min")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="data[min]" data-validates="presence numeric"><input class="text-input numeric-input" type="text" value="',_buf+=this.escape(this.data.min),_buf+='" /></div></div><div class="numeric-field inline"><label class="field-label" for="data[max]">',_buf+=this.escape(I18n.t("quizzes.question.numeric_max")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="data[max]" data-validates="presence numeric"><input class="text-input numeric-input" type="text" value="',_buf+=this.escape(this.data.max),_buf+='" /></div></div></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/open_answer_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){return""})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/position_question_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><input name="data[][key]" type="hidden" value="',_buf+=this.escape(this.key),_buf+='" /><div class="option-index inline">',_buf+=this.escape(this.__list_index__+1),_buf+='</div><div class="pi-text-input-wrap pi" data-name="data[][name]" data-validates="presence"><input class="text-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@view.remove_question(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/question_stat_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _answer,_buf,i,j,k,l,len,len1,len2,len3,m,opt,ref,ref1,ref2,ref3;switch(_buf="",this.type){case"short_answer":_buf+='<div class="pi-text-input-wrap is-disabled"><input class="text-input" disabled="true" type="text" value="',_buf+=this.escape(this.stat.answer.data),_buf+='" /></div>';break;case"open_answer":_buf+='<div class="wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.stat.answer.data)),_buf+="</div>";break;case"single_choice":for(_buf+='<div class="pi-radio-group pi list-container"><input type="hidden" value="',_buf+=this.escape(this.stat.answer.data),_buf+='" /><ul class="list">',j=0,len=(ref=this.data).length;j<len;j++)opt=ref[j],_buf+='<li class="item pi-radio-button option-item choice-item is-disabled" data-value="',_buf+=this.escape(opt.key),_buf+='"><div class="text-content">',_buf+=JST.sanitize(opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"true_false_question":_buf+='<div class="pi-radio-group pi list-container" data-name="answer"><input type="hidden" value="',_buf+=this.escape(this.stat.answer.data),_buf+='" /><ul class="list"><li class="item pi-radio-button option-item choice-item is-disabled" data-value="t"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+='</div></li><li class="item pi-radio-button option-item choice-item is-disabled" data-value="f"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li></ul></div>";break;case"numeric_question":_buf+='<div class="pi-text-input-wrap pi is-disabled" data-name="answer" data-validates="presence numeric"><input class="text-input" placeholder="',_buf+=this.escape(I18n.t("quizzes.view.type_answer")),_buf+='" type="text" value="',_buf+=this.escape(this.stat.answer.data),_buf+='" /></div>';break;case"multiple_choice":for(_buf+='<div class="list-container"><ul class="list">',k=0,len1=(ref1=this.data).length;k<len1;k++)opt=ref1[k],_buf+='<li class="pi-checkbox-wrap item option-item choice-item is-disabled ',_buf+=this.escape(this.stat.answer.data.indexOf(opt.key)>-1?"is-selected":""),_buf+='"><div class="text-content">',_buf+=JST.sanitize(opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"match_question":for(_buf+='<div class="list-container inline"><ul class="list is-answered">',l=0,len2=(ref2=this.data.left||this.data).length;l<len2;l++)opt=ref2[l],_answer=this.fetch_match_answer(this.stat,opt.left_key),_buf+='<li class="item option-item match-item is-disabled"><div class="match-text match-input inline">',_buf+=this.escape(""+opt.left),_buf+='</div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop">',_answer&&(_buf+='<div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.right),_buf+="</div>"),_buf+="</div></li>";_buf+='</ul><div class="answer-options"></div></div>';break;case"position_question":for(_buf+='<div class="list-container inline"><ul class="list">',i=m=0,len3=(ref3=this.data).length;m<len3;i=++m)opt=ref3[i],_answer=this.fetch_position_answer(this.stat,i),_buf+='<li class="item option-item position-item is-disabled"><div class="option-index inline">',_buf+=this.escape(""+(i+1)),_buf+='</div><div class="option-drop-area position-drop pi-drop-input inline is-disabled has-drop">',_answer&&(_buf+='<div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.name),_buf+="</div>"),_buf+="</div></li>";_buf+='</ul><div class="answer-options"></div></div>'}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/question_take"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_position,_quiz;return _buf="",_buf+="<div>",_position=(_quiz=$r.Quiz.get(this.quiz_id)).question_ids.indexOf(this.id)+1,_buf+='<div class="ques-header"><div class="question-num"><div class="inline">',_buf+=this.escape(I18n.t("quizzes.question.title")+" "+_position+" "+I18n.t("quizzes.view.of")+" "+_quiz.effective_questions_count),_buf+="</div>",this.category_name&&(_buf+='<div class="ques-category">',_buf+=this.escape(I18n.t("questions.category")+": "+this.category_name),_buf+="</div>"),_buf+='</div><div class="ques-score inline">',_buf+=this.escape(this.score+" "+I18n.t("quizzes.view.score")),_buf+='</div></div><div class="ques-text wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.name)),_buf+="</div>",this.has_attachment||this.is_external?"image"!==this.category&&"video"!==this.category||!this.thumb_url?(_buf+='<div class="attachment-title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.materials")),_buf+='</div><div class="attachment-file"><div class="category-icon inline">',this.category?(_buf+='<i class="fa ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i>'):_buf+='<i class="fa fa-file-text-o"></i>',_buf+='</div><a class="file-name dotted-link pi" href="@@show_media">',_buf+=this.escape(this.file_name),_buf+='</a><i class="fa fa-chevron-right"></i><div class="clear"></div></div><div class="ques-options ',_buf+=this.escape(this.type),_buf+='">',this.stat&&!1!==this.stat.complete?_buf+=""+JST["templates/questions/question_stat_options"](this):_buf+=""+JST["templates/questions/question_view_options"](this),_buf+="</div>"):(_buf+='<div class="ques-with-media ques-options ',_buf+=this.escape(this.type),_buf+='">',this.stat&&!1!==this.stat.complete?_buf+=""+JST["templates/questions/question_stat_options"](this):_buf+=""+JST["templates/questions/question_view_options"](this),_buf+='<div class="ques-media file-info inline"><div class="thumbnail-link pi" data-on-click="@@show_media"><div class="icon-zoom"><i class="fa fa-search-plus"></i></div><img class="thumb" src="',_buf+=this.escape(this.thumb_url),_buf+='" /></div></div></div>'):(_buf+='<div class="ques-options ',_buf+=this.escape(this.type),_buf+='">',this.stat&&!1!==this.stat.complete?_buf+=""+JST["templates/questions/question_stat_options"](this):_buf+=""+JST["templates/questions/question_view_options"](this),_buf+="</div>"),_buf+='<div class="ques-bottom">',this.stat&&!1!==this.stat.complete?_quiz.questions_num>this.position&&0===_quiz.navigation&&(_buf+='<div class="button pi-button-blue ques-submit-btn pi" data-on-click="@@next">',_buf+=this.escape(I18n.t("quizzes.view.next_btn")),_buf+="</div>"):(_buf+='<div class="button pi-button-blue ques-submit-btn pi" data-on-click="@view.form.submit" pid="submit_btn">',_buf+=this.escape(I18n.t("quizzes.view.submit_btn")),_buf+="</div>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/question_view"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_position;return _buf="",_buf+="<div>",_position=$r.Quiz.get(this.quiz_id).question_ids.indexOf(this.id)+1,_buf+='<div class="ques-header"><div class="question-num">',_buf+=this.escape(I18n.t("quizzes.question.title")+" "+_position+" "+I18n.t("quizzes.view.of")+" "+$r.Quiz.get(this.quiz_id).questions_num),_buf+='</div><div class="ques-score inline">',_buf+=this.escape(this.score+" "+I18n.t("quizzes.view.score")),_buf+='</div></div><div class="ques-text wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.name)),_buf+="</div>",this.has_attachment||this.is_external?"image"!==this.category&&"video"!==this.category||!this.thumb_url?(_buf+='<div class="attachment-title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.materials")),_buf+='</div><div class="attachment-file"><div class="category-icon inline">',this.category?(_buf+='<i class="fa ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i>'):_buf+='<i class="fa fa-file-text-o"></i>',_buf+='</div><a class="file-name dotted-link pi" href="@@show_media">',_buf+=this.escape(this.file_name),_buf+='</a><i class="fa fa-chevron-right"></i><div class="clear"></div></div><div class="ques-options ',_buf+=this.escape(this.type),_buf+='">',_buf+=""+JST["templates/questions/question_view_options"](this),_buf+="</div>"):(_buf+='<div class="ques-with-media ques-options ',_buf+=this.escape(this.type),_buf+='">',_buf+=""+JST["templates/questions/question_view_options"](this),_buf+='<div class="ques-media file-info inline"><div class="thumbnail-link pi" data-on-click="@@show_media"><div class="icon-zoom"><i class="fa fa-search-plus"></i></div><img class="thumb" src="',_buf+=this.escape(this.thumb_url),_buf+='" /></div></div></div>'):(_buf+='<div class="ques-options ',_buf+=this.escape(this.type),_buf+='">',_buf+=""+JST["templates/questions/question_view_options"](this),_buf+="</div>"),_buf+='<div class="ques-bottom"></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/question_view_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,j,k,l,len,len1,len2,len3,len4,len5,m,n,o,opt,ref,ref1,ref2,ref3,ref4,ref5;switch(_buf="",this.type){case"short_answer":_buf+='<div class="pi-text-input-wrap pi" data-name="answer" data-validates="presence"><input class="text-input" placeholder="',_buf+=this.escape(I18n.t("quizzes.view.type_answer")),_buf+='" type="text" value="" /></div>';break;case"open_answer":_buf+='<div class="open-answer-wrapper inline"><div class="title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.open_answer_title")),_buf+="</div>",_buf+=JST["templates/shared/editor"]({name:"answer[text]"}),this.allow_attachment&&(_buf+='<div class="answer-file-info"><div class="pi content" data-pid="content" data-plugins="renderable" data-renderer="jst(templates/questions/answer_file_info)"></div></div><input class="pi" data-pid="file_vield" name="answer[temp_file_id]" type="hidden" /><a class="upload-answ-file-link dotted-link link" href="@@upload_answer_file">',_buf+=this.escape(I18n.t("quizzes.view.upload_answer_file")),_buf+="</a>"),_buf+="</div>";break;case"single_choice":for(_buf+='<div class="pi-radio-group pi list-container" data-name="answer"><input type="hidden" /><ul class="list">',j=0,len=(ref=this.data).length;j<len;j++)opt=ref[j],_buf+='<li class="item pi-radio-button option-item choice-item" data-value="&#39;',_buf+=this.escape(opt.key),_buf+='&#39;"><div class="text-content">',_buf+=JST.sanitize(opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"true_false_question":_buf+='<div class="pi-radio-group pi list-container" data-name="answer"><input type="hidden" /><ul class="list"><li class="item pi-radio-button option-item choice-item" data-value="t"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+='</div></li><li class="item pi-radio-button option-item choice-item" data-value="f"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li></ul></div>";break;case"numeric_question":_buf+='<div class="pi-text-input-wrap pi" data-name="answer" data-serialize="true" data-validates="numeric"><input class="text-input" placeholder="',_buf+=this.escape(I18n.t("quizzes.view.type_numeric_answer")),_buf+='" type="text" value="" /></div>';break;case"multiple_choice":for(_buf+='<div class="pi list-container"><ul class="list">',k=0,len1=(ref1=this.data).length;k<len1;k++)opt=ref1[k],_buf+='<li class="pi-checkbox-wrap item option-item choice-item" data-false-value="" data-name="answer[]" data-true-value="&#39;',_buf+=this.escape(opt.key),_buf+='&#39;"><input type="hidden" value="" /><div class="text-content">',_buf+=JST.sanitize(opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"match_question":for(_buf+='<div class="pi list-container inline"><ul class="list inline">',l=0,len2=(ref2=this.data.left||this.data).length;l<len2;l++)opt=ref2[l],_buf+='<li class="item option-item match-item"><input name="answer[][left]" type="hidden" value="',_buf+=this.escape(opt.left_key),_buf+='" /><div class="match-text match-input inline">',_buf+=this.escape(""+opt.left),_buf+='</div><div class="option-drop-area match-drop match-input pi-drop-input inline pi" data-name="answer[][right]" data-plugins="click_droppable"></div></li>';for(_buf+='</ul><div class="answer-options inline"><div class="answer-title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.positioning")),_buf+="</div>",m=0,len3=(ref3=this.data.right||this.data).length;m<len3;m++)opt=ref3[m],_buf+='<div class="answer-option pi" data-plugins="click_draggable"><input type="hidden" value="',_buf+=this.escape(opt.right_key),_buf+='" />',_buf+=JST.sanitize(opt.right),_buf+='<i class="button-close cancel-drop inline-right pi" pid="cancel_btn"></i></div>';_buf+="</div></div>";break;case"position_question":for(_buf+='<div class="pi list-container inline"><ul class="list inline">',i=n=0,len4=(ref4=this.data).length;n<len4;i=++n)opt=ref4[i],_buf+='<li class="item option-item position-item"><div class="option-index inline">',
_buf+=this.escape(""+(i+1)),_buf+='</div><div class="option-drop-area position-drop pi-drop-input inline pi" data-name="answer[]" data-plugins="click_droppable"></div></li>';for(_buf+='</ul><div class="answer-options inline"><div class="answer-title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.positioning")),_buf+="</div>",o=0,len5=(ref5=this.data).length;o<len5;o++)opt=ref5[o],_buf+='<div class="answer-option pi" data-plugins="click_draggable"><input type="hidden" value="',_buf+=this.escape(opt.key),_buf+='" />',_buf+=JST.sanitize(opt.name),_buf+='<i class="button-close cancel-drop inline-right pi" pid="cancel_btn"></i></div>';_buf+="</div></div>"}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/recount_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("questions.confirm.recount")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/short_answer_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><div class="pi-text-input-wrap pi" data-name="data[][name]" data-validates="presence"><input class="text-input short-answer-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@view.remove_question(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/single_choice_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><input name="data[][key]" type="hidden" value="',_buf+=this.escape(this.key),_buf+='" /><div class="pi-checkbox-wrap option-check as-radio pi" data-name="data[][correct]"><input type="hidden" value="',_buf+=this.escape(0|this.correct),_buf+='" /></div><div class="pi-text-input-wrap pi" data-name="data[][name]" data-validates="presence"><input class="text-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@view.remove_question(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/questions/true_false_question_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div><label class="field-label options-label">',_buf+=this.escape(I18n.t("quizzes.question.options")),_buf+='</label><div class="pi options-list list-container pi-list" data-pid="list"><ul class="list"><li class="item option-item tf-item"><div class="pi-checkbox-wrap option-check as-radio pi" data-false-value="f" data-name="data[correct]" data-true-value="t"><input type="hidden" value="',_buf+=this.escape(this.data.correct),_buf+='" /></div><div class="tf-field inline">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+='</div></li><li class="item option-item tf-item"><div class="pi-checkbox-wrap option-check as-radio pi" data-false-value="t" data-name="data[correct]" data-true-value="f"><input type="hidden" value="',_buf+=this.escape(this.data.correct),_buf+='" /></div><div class="tf-field inline">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li></ul></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/listeners/question_result_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item question-result-item"><div class="field group-dropdown pi" data-on-click="@host.active ? @host.deactivate : @host.activate; e.cancel"><i class="fa fa-caret-right icon-right"></i><i class="fa fa-caret-down icon-down"></i><div class="question-text inline"><span class="part-item">',_buf+=this.escape(this.question.position+". "),_buf+='</span><div class="inline question-name wysiwyg">',_buf+=JST.sanitize(this.question.name),_buf+='</div></div><div class="inline time-spent">',_buf+=this.stat.time_spent,_buf+='</div><div class="inline score">',_buf+=this.escape(this.stat.score),_buf+='</div><div class="inline-right correctness">',this.stat.checked?!0===this.stat.success?_buf+='<i class="fa complete-icon fa-check"></i>':!1===this.stat.success&&(_buf+='<i class="fa failed-icon fa-times"></i>'):_buf+='<i class="fa not-checked-icon fa-exclamation"></i>',_buf+='</div></div><div class="answer-content"><div class="stat-info"><div class="score-time-info stat-info-item">',void 0!==this.stat.score&&(_buf+='<span class="info-label grey-text">',_buf+=this.escape(I18n.t("quiz_stats.score")+": "),_buf+="</span><span>",_buf+=this.escape(this.stat.score+" "+I18n.t("quizzes.view.of")+" "+this.question.score),_buf+='</span> <span class="divider"></span> '),_buf+='<span><i class="fa fa-clock-o grey-text"></i>',_buf+=" "+this.stat.time_spent,_buf+='</span></div></div><div class="ques-options ',_buf+=this.escape(this.stat.question_type),_buf+='">',_buf+=""+JST["templates/quiz_stats/listeners/quiz_stat_question_options"](this),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/listeners/quiz_result_header"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,len,ref,stat;for(_buf="",_buf+='<div class="form"><h1 class="leftbar-title inline" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.quiz.name),_buf+='</h1><div class="buttons inline-right"><a class="button inline pi-button-blue ok-btn" href="@@close()">',_buf+=this.escape("OK"),_buf+='</a></div><div class="stat-attempts-info"><div class="select-attempt inline pi-select-field long-text pi" data-on-changed="@@load_stat(e.data)" data-pid="attempts_select"><input type="hidden" value="" /><div class="pi placeholder" pid="placeholder"></div><div class="pi list-container pi-select-list is-hidden" pid="dropdown"><ul class="list">',i=0,len=(ref=this.quiz_stats).length;i<len;i++)stat=ref[i],_buf+='<li class="item" data-value="',_buf+=this.escape(stat.id),_buf+='">',_buf+=I18n.t("quiz_stats.attempt")+" \u2116"+stat.attempt+" ("+stat.finished_time+")",_buf+="</li>";return _buf+='</ul></div></div><div class="user-stat-info inline pi" data-plugins="restful" data-renderer="jst(templates/quiz_stats/quiz_stat_info)" pid="stat_info"></div></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/listeners/quiz_stat_question_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _answer,_buf,_index,_klass,_show_answer,_show_correct_answers_only,_show_results,_success,false_klass,flag,i,j,k,klass,klass2,l,len,len1,len2,len3,len4,m,n,opt,ref,ref1,ref2,ref3,ref4,ref5,ref6,true_klass;switch(_buf="",_success=this.stat.success,_show_results=$r.Quiz.get(this.question.quiz_id).show_results,_show_answer=$r.Quiz.get(this.question.quiz_id).show_answers,_show_correct_answers_only=$r.Quiz.get(this.question.quiz_id).show_correct_answers_only,this.question.type){case"short_answer":if(klass=_show_answer?_success?"is-correct":"is-incorrect":"",(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only)&&(_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected ',_buf+=this.escape(klass),_buf+='"><div class="text-content">',_buf+=this.escape((null!=(ref=this.stat.answer.data)?ref.toString():void 0)||""),_buf+="</div></div>"),_show_answer&&!this.stat.success&&!_show_correct_answers_only)for(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.correct_answer")),_buf+="</span></div>",j=0,len=(ref1=this.question.data).length;j<len;j++)opt=ref1[j],_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected"><div class="text-content">',_buf+=this.escape(opt.name),_buf+="</div></div>";!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>");break;case"open_answer":_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.user_answer")),_buf+='</span></div><div class="open-answer-result select-text wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.stat.answer.data)),_buf+='</div><div class="clear"></div>',this.stat.answer.file_id&&(_buf+='<a class="open-answer-result-file dotted-link" download="',_buf+=this.escape(this.stat.file_name),_buf+='" href="',_buf+=this.escape(this.stat.file_download_url),_buf+='" target="_blank">',_buf+=this.escape(I18n.t("quiz_stats.user_answer_download")),_buf+="</a>"),_buf+='<div class="clear"></div>',this.stat.checked&&this.stat.answer.comment&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.user_answer_comment")),_buf+='</span></div><div class="open-answer-result wysiwyg">',_buf+=JST.parseLinks(this.stat.answer.comment),_buf+="</div>");break;case"single_choice":for(_buf+='<div class="pi-radio-group list-container"><ul class="list">',k=0,len1=(ref2=this.question.data).length;k<len1;k++)klass="",klass2="",(opt=ref2[k]).key===this.stat.answer.data?(klass="is-selected",_show_answer&&(klass2=opt.correct?"is-correct":"is-incorrect")):opt.correct&&_show_answer&&(klass="is-selected"),(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only&&"is-correct"===klass2)&&(_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(klass),_buf+=" ",_buf+=this.escape(klass2),_buf+='"><div class="text-content">',_buf+=this.escape(""+opt.name),_buf+="</div></li>");_buf+="</ul>",!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>"),_buf+="</div>";break;case"true_false_question":_buf+='<div class="pi-radio-group list-container"><ul class="list">',true_klass="",false_klass="",klass="",_show_answer&&(klass=this.stat.success?" is-correct":" is-incorrect"),"t"===this.stat.answer.data?true_klass+="is-selected"+klass:(false_klass+="is-selected"+klass,_show_answer&&!_show_correct_answers_only&&(true_klass+="is-selected")),_show_results&&!_show_correct_answers_only?(_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(true_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+='</div></li><li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(false_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li>"):_show_answer&&_show_correct_answers_only&&this.stat.success&&("t"===this.stat.answer.data?(_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(true_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+="</div></li>"):(_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(false_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li>")),!this.stat.success&&_show_answer&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>"),_buf+="</ul></div>";break;case"numeric_question":klass=_show_answer?_success?"is-correct":"is-incorrect":"",(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only)&&(_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected ',_buf+=this.escape(klass),_buf+='"><div class="text-content">',_buf+=this.escape((null!=(ref3=this.stat.answer.data)?ref3.toString():void 0)||""),_buf+="</div></div>",_show_answer&&!this.stat.success&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.correct_answer")),_buf+='</span></div><div class="pi-checkbox-wrap option-item choice-item is-selected"><div class="text-content">',_buf+=this.question.data.min+" &mdash; "+this.question.data.max,_buf+="</div></div>")),!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>");break;case"multiple_choice":if(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only){for(_buf+='<div class="list-container"><ul class="list">',l=0,len2=(ref4=this.question.data).length;l<len2;l++)opt=ref4[l],klass="",klass2="",flag=!0,this.stat.answer.data.indexOf(opt.key)>-1?(klass="is-selected",flag=!1,_show_answer&&(klass2=opt.correct?"is-correct":"is-incorrect")):opt.correct&&_show_answer&&!_show_correct_answers_only&&(klass="is-selected",flag=!1),_show_correct_answers_only?"is-correct"===klass2?(_buf+='<li class="pi-checkbox-wrap item.option-item choice-item is-disabled ',_buf+=this.escape(klass),_buf+=" ",_buf+=this.escape(klass2),_buf+='"><div class="text-content">',_buf+=this.escape(""+opt.name),_buf+="</div></li>",flag=!0):flag=!1:(_buf+='<li class="pi-checkbox-wrap item option-item choice-item is-disabled ',_buf+=this.escape(klass),_buf+=" ",_buf+=this.escape(klass2),_buf+='"><div class="text-content">',_buf+=this.escape(""+opt.name),_buf+="</div></li>");_buf+="</ul></div>"}!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>"),this.question.incomplete_answer&&_show_correct_answers_only&&!1===flag&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incomplete_answer")),_buf+="</span></div>");break;case"match_question":if(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only){for(_buf+='<div class="list-container"><ul class="list">',m=0,len3=(ref5=this.question.data.left||this.question.data).length;m<len3;m++)opt=ref5[m],_answer=this.question.fetch_match_answer(this.stat,opt.left_key),flag=!0,klass="",_show_answer&&(_answer.right_key===opt.right_key?(klass="is-correct",flag=!0):(klass="is-incorrect",flag=!1)),_show_correct_answers_only?"is-correct"===klass&&(_buf+='<li class="item option-item match-item is-disabled ',_buf+=this.escape(klass),_buf+='"><div class="match-text match-input inline">',_buf+=this.escape(""+opt.left),_buf+='</div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop">',_answer&&(_buf+='<div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.right),_buf+="</div>"),_buf+="</div></li>",!1===flag&&(_buf+='<li class="item option-item match-item is-disabled"><div class="match-text match-input inline"></div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop"><div class="answer-option is-disabled is-dropped">',_buf+=this.escape(opt.right),_buf+="</div></div></li>")):(_buf+='<li class="item option-item match-item is-disabled ',_buf+=this.escape(klass),_buf+='"><div class="match-text match-input inline">',_buf+=this.escape(""+opt.left),_buf+='</div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop">',_answer&&(_buf+='<div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.right),_buf+="</div>"),_buf+="</div></li>",!1===flag&&(_buf+='<li class="item option-item match-item is-disabled"><div class="match-text match-input inline"></div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop"><div class="answer-option is-disabled is-dropped">',_buf+=this.escape(opt.right),_buf+="</div></div></li>"));_buf+='</ul><div class="answer-options"></div></div>'}!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>"),this.question.incomplete_answer&&_show_correct_answers_only&&!1===flag&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incomplete_answer")),_buf+="</span></div>");break;case"position_question":if(_show_results&&!_show_correct_answers_only||this.stat.success&&_show_correct_answers_only){for(_buf+='<div class="list-container"><ul class="list">',i=n=0,len4=(ref6=this.question.data).length;n<len4;i=++n)opt=ref6[i],_index=this.stat.answer.data.indexOf(opt.key),_show_answer?(_answer=opt,_klass=_index===i?"is-correct":"is-incorrect"):(_index=i,_answer=this.question.fetch_position_answer(this.stat,i)),_buf+='<li class="item option-item position-item is-disabled ',_buf+=this.escape(_klass),_buf+='"><div class="option-index inline">',_buf+=this.escape(""+(_index+1)),_buf+='</div><div class="option-drop-area position-drop pi-drop-input inline is-disabled has-drop"><div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.name),_buf+="</div></div></li>";_buf+='</ul><div class="answer-options"></div></div>'}!this.stat.success&&_show_correct_answers_only&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.incorrect_answer")),_buf+="</span></div>")}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/question_result_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="item question-result-item"><div class="field group-dropdown pi" data-on-click="@host.active ? @host.deactivate : @host.activate; e.cancel"><i class="fa fa-caret-right icon-right"></i><i class="fa fa-caret-down icon-down"></i><div class="question-text inline"><span class="part-item">',_buf+=this.escape(this.question.position+". "),_buf+='</span><div class="inline question-name wysiwyg">',_buf+=JST.sanitize(this.question.name),_buf+="</div>",this.question.question_category_name&&(_buf+='<div class="question-name wysiwyg">',_buf+=I18n.t("questions.category")+": "+this.question.question_category_name,_buf+="</div>"),_buf+='</div><div class="inline time-spent">',_buf+=this.stat.time_spent,_buf+='</div><div class="inline score">',_buf+=this.escape(this.stat.score),_buf+='</div><div class="inline-right correctness">',this.stat.checked?this.stat.success?_buf+='<i class="fa complete-icon fa-check"></i>':_buf+='<i class="fa failed-icon fa-times"></i>':_buf+='<i class="fa not-checked-icon fa-exclamation"></i>',_buf+='</div></div><div class="answer-content"><div class="stat-info"><div class="score-time-info stat-info-item"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("quiz_stats.score")+": "),_buf+="</span><span>",_buf+=this.escape(this.stat.score+" "+I18n.t("quizzes.view.of")+" "+this.question.score),_buf+='</span><span class="divider"></span><span class="time-spent"><i class="fa fa-clock-o grey-text"></i>',_buf+=" "+this.stat.time_spent,_buf+='</span></div></div><div class="ques-options ',_buf+=this.escape(this.stat.question_type),_buf+='">',_buf+=""+JST["templates/quiz_stats/quiz_stat_question_options"](this),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/quiz_result_header"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form"><h1 class="leftbar-title inline" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</h1><div class="buttons inline-right"><a class="button inline pi-button-blue ok-btn" href="@@close()">',_buf+=this.escape("OK"),_buf+='</a></div><div class="user-stat-info"><div class="user-info inline"><p><span class="dotted-link">',_buf+=this.escape(this.username),_buf+='</span></p><p><span class="grey-text">',_buf+=this.escape(this.email||this.phone),_buf+='</span></p></div><div class="divider"></div>',_buf+=""+JST["templates/quiz_stats/quiz_stat_info"](this),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/quiz_stat_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="stat-info inline"><div class="score-time-info stat-info-item"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("quiz_stats.score")+": "),_buf+="</span><span>",_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+='</span><span class="divider"></span><span class="time-spent"><i class="fa fa-clock-o grey-text">',_buf+=this.time_spent,_buf+="</i> </span></div>",this.correct_data()&&(_buf+='<div class="correct-incorrect-info stat-info-item"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("quiz_stats.correct_incorrect")+": "),_buf+='</span><span class="green-text">',_buf+=this.escape(this.correct_data().correct_num+" ("+this.correct_data().correct_percent+"%)"),_buf+='</span><span class="grey-text">',_buf+=this.escape(" / "),_buf+='</span><span class="red-text">',_buf+=this.escape(this.correct_data().incorrect_num+" ("+this.correct_data().incorrect_percent+"%)"),_buf+="</span></div>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/quiz_stat_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,complete_class,success_class;return _buf="",success_class=this.success?"is-success":"is-failed",complete_class=this.complete?"is-complete":"",_buf+='<li class="item quiz-stat-item ',_buf+=this.escape(success_class),_buf+=" ",_buf+=this.escape(complete_class),_buf+='"><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.username),_buf+='</a><span class="email">',_buf+=this.escape(this.email),_buf+='</span></div><div class="field quiz-name">',_buf+=this.escape(this.name),_buf+='</div><div class="field time-spent">',_buf+=this.time_spent,_buf+='</div><div class="field score-percent">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+='</div><div class="field finished-at">',_buf+=this.finished_time,_buf+='</div><div class="field">',!1===this.checked&&this.complete&&(_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quiz_stats/quiz_stat_question_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _answer,_buf,_index,_klass,_show_answer,_success,false_klass,flag,i,j,k,klass,klass2,l,len,len1,len2,len3,len4,m,n,opt,ref,ref1,ref2,ref3,ref4,ref5,ref6,true_klass;switch(_buf="",_success=this.stat.success,_show_answer=!0,this.question.type){case"short_answer":if(klass=_show_answer?_success?"is-correct":"is-incorrect":"",_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected ',_buf+=this.escape(klass),_buf+='"><div class="text-content">',_buf+=this.escape((null!=(ref=this.stat.answer.data)?ref.toString():void 0)||""),_buf+="</div></div>",_show_answer&&!this.stat.success)for(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.correct_answer")),_buf+="</span></div>",j=0,len=(ref1=this.question.data).length;j<len;j++)opt=ref1[j],_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected"><div class="text-content">',_buf+=this.escape(opt.name),_buf+="</div></div>";break;case"open_answer":_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.user_answer")),_buf+='</span></div><div class="open-answer-result select-text wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.stat.answer.data)),_buf+='</div><div class="clear"></div>',this.stat.answer.file_id&&(_buf+='<a class="open-answer-result-file dotted-link" download="',_buf+=this.escape(this.stat.file_name),_buf+='" href="',_buf+=this.escape(this.stat.file_download_url),_buf+='" target="_blank">',_buf+=this.escape(I18n.t("quiz_stats.user_answer_download")),_buf+="</a>"),_buf+='<div class="clear"></div>',this.stat.checked?this.stat.answer.comment&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.user_answer_comment")),_buf+='</span></div><div class="open-answer-result wysiwyg">',_buf+=JST.parseLinks(this.stat.answer.comment),_buf+="</div>"):(_buf+='<div class="form pi-form pi" data-on-submited="@@check_answer(',_buf+=this.escape(this.stat.id),_buf+=',e.data)" data-rails="true"><div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(I18n.t("quiz_stats.user_answer_comment")),_buf+="</span></div>",_buf+=JST["templates/shared/editor"]({name:"answer_stat[comment]"}),_buf+='<br /><div class="field full"><label class="field-label">',_buf+=this.escape(I18n.t("quizzes.question.score")+" ("+I18n.t("quizzes.question.max")+": "+this.question.score+")"),_buf+='</label><div class="score-field posrel"><div class="pi-text-input-wrap pi" data-name="answer_stat[score]" data-validates="presence digital max(',_buf+=this.escape(this.question.score),_buf+=')"><input class="text-input score-input" type="text" /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div><div class="button inline-right pi-button-green pi check-btn" data-on-click="@host.submit()">',_buf+=this.escape(""+I18n.t("helpers.accept")),_buf+="</div></div></div></div>");break;case"single_choice":for(_buf+='<div class="pi-radio-group list-container"><ul class="list">',k=0,len1=(ref2=this.question.data).length;k<len1;k++)klass="",klass2="",(opt=ref2[k]).key===this.stat.answer.data?(klass="is-selected",_show_answer&&(klass2=opt.correct?"is-correct":"is-incorrect")):opt.correct&&_show_answer&&(klass="is-selected"),_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(klass),_buf+=" ",_buf+=this.escape(klass2),_buf+='"><div class="text-content">',_buf+=this.escape(""+opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"true_false_question":_buf+='<div class="pi-radio-group list-container"><ul class="list">',true_klass="",false_klass="",klass="",_show_answer&&(klass=this.stat.success?" is-correct":" is-incorrect"),"t"===this.stat.answer.data?true_klass+="is-selected"+klass:false_klass+="is-selected"+klass,_buf+='<li class="item pi-radio-button option-item choice-item is-disabled ',_buf+=this.escape(true_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.true")),_buf+='</div></li><li class="item pi-radio-button option-item.choice-item is-disabled ',_buf+=this.escape(false_klass),_buf+='"><div class="text-content">',_buf+=this.escape(I18n.t("quizzes.question.false")),_buf+="</div></li></ul></div>";break;case"numeric_question":klass=_show_answer?_success?"is-correct":"is-incorrect":"",_buf+='<div class="pi-checkbox-wrap option-item choice-item is-selected ',_buf+=this.escape(klass),_buf+='"><div class="text-content">',_buf+=this.escape((null!=(ref3=this.stat.answer.data)?ref3.toString():void 0)||""),_buf+="</div></div>",_show_answer&&!this.stat.success&&(_buf+='<div class="user-answer-label"><span class="info-label grey-text">',_buf+=this.escape(""+I18n.t("quiz_stats.correct_answer")),_buf+='</span></div><div class="pi-checkbox-wrap option-item choice-item is-selected"><div class="text-content">',_buf+=this.question.data.min+" &mdash; "+this.question.data.max,_buf+="</div></div>");break;case"multiple_choice":for(_buf+='<div class="list-container"><ul class="list">',l=0,len2=(ref4=this.question.data).length;l<len2;l++)opt=ref4[l],klass="",klass2="",this.stat.answer.data.indexOf(opt.key)>-1?(klass="is-selected",_show_answer&&(klass2=opt.correct?"is-correct":"is-incorrect")):opt.correct&&_show_answer&&(klass="is-selected"),_buf+='<li class="pi-checkbox-wrap item option-item choice-item is-disabled ',_buf+=this.escape(klass),_buf+=" ",_buf+=this.escape(klass2),_buf+='"><div class="text-content">',_buf+=this.escape(""+opt.name),_buf+="</div></li>";_buf+="</ul></div>";break;case"match_question":for(_buf+='<div class="list-container"><ul class="list">',m=0,len3=(ref5=this.question.data.left||this.question.data).length;m<len3;m++)opt=ref5[m],_answer=this.question.fetch_match_answer(this.stat,opt.left_key),flag=!0,klass="",_show_answer&&(_answer.right_key===opt.right_key?(klass="is-correct",flag=!0):(klass="is-incorrect",flag=!1)),_buf+='<li class="item option-item match-item is-disabled ',_buf+=this.escape(klass),_buf+='"><div class="match-text match-input inline">',_buf+=this.escape(""+opt.left),_buf+='</div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop">',_answer&&(_buf+='<div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.right),_buf+="</div>"),_buf+="</div></li>",!1===flag&&(_buf+='<li class="item option-item match-item is-disabled"><div class="match-text match-input inline"></div><div class="match-arrow inline"><i class="fa fa-long-arrow-right"></i></div><div class="option-drop-area match-drop match-input pi-drop-input inline is-disabled has-drop"><div class="answer-option is-disabled is-dropped">',_buf+=this.escape(opt.right),_buf+="</div></div></li>");_buf+='</ul><div class="answer-options"></div></div>';break;case"position_question":for(_buf+='<div class="list-container"><ul class="list">',i=n=0,len4=(ref6=this.question.data).length;n<len4;i=++n)opt=ref6[i],_index=this.stat.answer.data.indexOf(opt.key),_show_answer?(_answer=opt,_klass=_index===i?"is-correct":"is-incorrect"):(_index=i,_answer=this.question.fetch_position_answer(this.stat,i)),_buf+='<li class="item option-item position-item is-disabled ',_buf+=this.escape(_klass),_buf+='"><div class="option-index inline">',_buf+=this.escape(""+(_index+1)),_buf+='</div><div class="option-drop-area position-drop pi-drop-input inline is-disabled has-drop"><div class="answer-option is-disabled is-dropped">',_buf+=this.escape(_answer.name),_buf+="</div></div></li>";_buf+='</ul><div class="answer-options"></div></div>'}return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/check_answer_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content"><p>',_buf+=I18n.t("quizzes.confirm.check_answer"),_buf+="</p></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/copy_course_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name"><a class="link" href="@@context.load_quizzes(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a><div class="count">',_buf+=this.escape(I18n.t("quizzes.quizzes_count")),_buf+=": ",_buf+=this.escape(this.total_tasks),_buf+="</div></div></li>"})}
}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/copy_question_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(JST.strip_html(this.name).slice(0,255)),_buf+='">',_buf+=this.escape(JST.strip_html(this.name)),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/copy_question_quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name"><a class="link" href="@@context.load_questions(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a><div class="count">',_buf+=this.escape(I18n.t("quizzes.questions_count")),_buf+=": ",_buf+=this.escape(this.questions_num),_buf+="</div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/copy_quiz_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("quizzes.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+="<div>",this.has_time_limit&&(_buf+='<div class="time-limit quiz-info-block">',null!=this.stat?(_buf+='<i class="fa fa-clock-o inline"></i><div class="quiz-timer pi-timer pi inline" data-danger="60" data-limit="',_buf+=this.escape(60*this.time_limit),_buf+='" data-on-stop="@@time_limit()" data-start-ts="',_buf+=this.escape(this.stat().started_at),_buf+='" pid="timer"></div>'):(_buf+='<i class="fa fa-clock-o inline"></i><div class="quiz-timer pi-timer pi inline" data-limit="',_buf+=this.escape(60*this.time_limit),_buf+='" pid="timer"></div>'),_buf+="</div>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/question_category_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,persisted_class;return _buf="",persisted_class=!0===this._persisted?"":"not-saved",_buf+='<div class="filter-item question-item item form-item ',_buf+=this.escape(persisted_class),_buf+='" data-component="question_category_form"><div class="text-info q-category-table"><div class="name inline">',this.name&&(_buf+='<span title="',_buf+=this.escape(JST.strip_html(this.name).slice(0,100)),_buf+='">',_buf+=this.escape(JST.strip_html(this.name)),_buf+="</span>"),_buf+='</div><div class="count inline"><span class="pi" data-pid="category_question_count"></span></div><div class="options inline-right score">',this.score&&(_buf+='<span class="red-text">',_buf+=this.escape(JST.strip_html(this.score)),_buf+="</span>"),_buf+='<span class="grey-text not-saved-label">',_buf+=this.escape(I18n.t("quizzes.question.not_saved")),_buf+='</span></div></div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form pi-form pi" data-on-submited="@@update_question_category_with_confirm(',_buf+=this.escape(this.id),_buf+=',e.data)" data-rails="true" data-serialize="true" pid="form"><div class="field q_category-fields"><div class="name-field-input inline"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("quizzes.question_category.name")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="name" data-validates="presence"><input class="text-input" style="width: 180px;" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div></div><div class="score-field inline"><label class="field-label">',_buf+=this.escape(I18n.t("quizzes.question.score")),_buf+='</label><div class="score-stepper pi-stepper pi" data-max="999" data-min="1" data-name="score"><input class="text-input score-input" type="text" value="',_buf+=this.escape(this.score||1),_buf+='" /><span class="step step-up"></span><span class="step step-down"></span></div></div><div class="score-field inline"><label class="field-label">',_buf+=this.escape(I18n.t("quizzes.edit.pool_size")),_buf+='</label><div class="score-stepper pi-stepper pi" data-max="999" data-min="1" data-name="pool_size" data-pid="pool_size_cq"><input class="text-input score-input" type="text" value="',_buf+=this.escape(this.pool_size||1),_buf+='" /><span class="step step-up"></span><span class="step step-down"></span></div></div></div><div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(I18n.t("helpers.save")),_buf+="</div></div></div></div></div>",I18n.t("quizzes.errors.question_category.questions_exist"),_buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/question_category_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item" data-value="',_buf+=this.escape(this.id),_buf+='">',_buf+=this.escape(""+this.name),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/question_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,persisted_class;return _buf="",persisted_class=!0===this._persisted?"":"not-saved",_buf+='<div class="filter-item question-item item form-item ',_buf+=this.escape(this.type),_buf+=" ",_buf+=this.escape(persisted_class),_buf+='" data-component="question_form"><div class="text-info"><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.question.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><span title="',_buf+=this.escape(JST.strip_html(this.name)),_buf+='">',_buf+=this.escape(JST.strip_html(this.name).slice(0,60)),_buf+="</span>",this.question_category_name&&(_buf+='<span class="question_category" title="',_buf+=this.escape(JST.strip_html(this.question_category_name)),_buf+='">',_buf+=this.escape(JST.strip_html(this.question_category_name).slice(0,20)),_buf+="</span>"),this.is_editor_js&&(_buf+='<span style="color:red;font-size: 11px;padding: 0;margin: 0;display: block;height: unset;line-height: 12px !important;margin-top: -12px;opacity: 0.7;margin-left: 110px;">',_buf+=this.escape("  "+I18n.t("materials.new_format_message")+"."),_buf+="</span>"),_buf+='<span class="grey-text not-saved-label inline-right">',_buf+=this.escape(""+I18n.t("quizzes.question.not_saved")),_buf+='</span></div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form pi-form pi" data-on-submited="@@update_question(',_buf+=this.escape(this.id),_buf+=',e.data)" data-rails="true" data-serialize="true" pid="form"><div class="field"><div class="categories-field pi" data-pid="categories"><h2 class="select-category-title">',_buf+=this.escape(""+I18n.t("quizzes.edit.choose_question_category")),_buf+='</h2><div class="edit-questions-categories"><div class="pi list-container categories-list pi-action-list" data-listen-load="true" data-on-selected="@view.select_category(@host)" data-pid="list" data-renderer="jst(templates/question_categories/edit_category_item)" data-select-type="radio"><ul class="list"></ul></div></div></div></div><div class="actions pi" data-pid="show_category_list"><div class="field"><div class="name-field-input inline"><label class="field-label" for="question_category_name">',_buf+=this.escape(""+I18n.t("quizzes.question_category.name")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="question_category_name"><input class="text-input" disabled="true" type="text" value="',_buf+=this.escape(this.question_category_name),_buf+='" /></div></div><input class="pi hidden" data-name="question_category_id" value="',_buf+=this.escape(this.question_category_id),_buf+='" /></div><a class="pi" data-on-click="@view.show_categories_list(@host)" href="#">',_buf+=this.escape(I18n.t("questions.select_category")),_buf+='</a></div><div class="field"><label class="field-label" for="name">',_buf+=this.escape(""+I18n.t("quizzes.question.name")),_buf+="</label>",_buf+=JST["templates/shared/editor"]({name:"name",value:this.name,validates:"presence"}),_buf+='</div><div class="field pi pi-uploader" data-name="temp_file_id" data-plugins="renderable" data-renderer="jst(templates/materials/file_upload)"><div class="question-file-upload ',_buf+=this.escape(this.file_name?"has-file":"no-file"),_buf+='">',this.external&&this.external_type&&(_buf+='<input name="external" type="hidden" value="',_buf+=this.escape(this.external),_buf+='" /><input name="external_type" type="hidden" value="',_buf+=this.escape(this.external_type),_buf+='" /><input name="file_name" type="hidden" value="',_buf+=this.escape(this.file_name),_buf+='" /><input name="external_thumb" type="hidden" value="',_buf+=this.escape(this.external_thumb),_buf+='" /><input name="external_file_type" type="hidden" value="',_buf+=this.escape(this.extension),_buf+='" />'),_buf+='<div class="upload-link"><div class="dotted-link pi" data-on-click="@@upload_file(@host)">',_buf+=this.escape(I18n.t("materials.upload_file")),_buf+='</div></div><div class="file-info"><div class="category-icon inline">',this.category?(_buf+='<i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i>'):_buf+='<i class="fa fa-file-text-o"></i>',_buf+='</div><span class="file-name">',_buf+=this.escape(this.file_name),_buf+="</span>",this.size&&(_buf+='<span class="file-size">&nbsp;&mdash;',_buf+=this.escape(this.size),_buf+="</span>"),_buf+='<div class="divider inline"></div><div class="dotted-link delete-btn inline pi" data-on-click="@@delete_file(@host)">',_buf+=this.escape(I18n.t("materials.delete_file")),_buf+='</div></div></div></div><div class="field"><label class="field-label" for="type">',_buf+=this.escape(""+I18n.t("quizzes.question.type")),_buf+='</label><div class="select-question-type pi-select-field pi" data-name="type" data-pid="type_select"><input type="hidden" value="',_buf+=this.escape(this.type),_buf+='" /><div class="pi placeholder" pid="placeholder"></div><div class="pi list-container pi-select-list has-scroller is-hidden" data-plugins="scrollable" pid="dropdown"><ul class="list"><li class="item" data-value="short_answer">',_buf+=this.escape(I18n.t("quizzes.question.types.short_answer")),_buf+='</li><li class="item" data-value="single_choice">',_buf+=this.escape(I18n.t("quizzes.question.types.single_choice")),_buf+='</li><li class="item" data-value="multiple_choice">',_buf+=this.escape(I18n.t("quizzes.question.types.multiple_choice")),_buf+='</li><li class="item" data-value="true_false_question">',_buf+=this.escape(I18n.t("quizzes.question.types.true_false")),_buf+='</li><li class="item" data-value="numeric_question">',_buf+=this.escape(I18n.t("quizzes.question.types.numeric")),_buf+='</li><li class="item" data-value="match_question">',_buf+=this.escape(I18n.t("quizzes.question.types.match_question")),_buf+='</li><li class="item" data-value="position_question">',_buf+=this.escape(I18n.t("quizzes.question.types.position_question")),_buf+='</li><li class="item" data-value="open_answer">',_buf+=this.escape(I18n.t("quizzes.question.types.open_answer")),_buf+='</li></ul></div></div></div><div class="field options-field pi" data-pid="options_list" data-plugins="renderable">',"numeric_question"===this.type||"open_answer"===this.type||"true_false_question"===this.type?_buf+=JST["templates/questions/"+this.type+"_options"](this):_buf+=JST["templates/questions/list_type_options"](this),_buf+='</div><div class="field answer_file pi" data-pid="answer_file"><div class="pi-checkbox-wrap pi" data-name="data[allow_attachment]"><input type="hidden" value="',_buf+=this.escape(0|this.allow_attachment),_buf+='" />',_buf+=this.escape(I18n.t("quizzes.question.has_attachment")),_buf+='</div></div><div class="field"><div class="score-field inline"><label class="field-label">',_buf+=this.escape(""+I18n.t("quizzes.question.score")),_buf+='</label><div class="score-stepper pi-stepper pi" data-max="999" data-min="1" data-name="score" data-pid="score"><input class="text-input score-input" type="text" value="',_buf+=this.escape(this.score||1),_buf+='" /><span class="step step-up"></span><span class="step step-down"></span></div></div><div class="incomplete-score-field inline"><div class="divider"></div><div class="pi-checkbox-wrap pi" data-name="incomplete_answer" data-pid="incomplete_answer"><input type="hidden" value="',_buf+=this.escape(0|this.incomplete_answer),_buf+='" />',_buf+=this.escape(I18n.t("quizzes.question.incomplete_score")),_buf+='</div></div><div class="round-up-score-field inline"><div class="pi-checkbox-wrap pi is-disabled" data-name="round_up" data-pid="round_up"><input type="hidden" value="',_buf+=this.escape(0|this.round_up),_buf+='" />',_buf+=this.escape(I18n.t("quizzes.question.round_up")),_buf+='</div></div></div><div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(""+I18n.t("helpers.save")),_buf+="</div></div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/quiz_finished"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="quiz-finished-info"><div class="quiz-image"></div><div class="quiz-finished-title">',_buf+=this.escape(I18n.t("quizzes.view.finished_test")),_buf+='<div class="quiz-name">',_buf+=this.escape(""+this.quiz().name),_buf+='</div></div><div class="buttons ct-text"><a class="button pi-button-blue" href="',_buf+=this.escape(pi.app.return_url),_buf+='">',_buf+=this.escape(I18n.t("quizzes.view.goto_quizzes_btn")),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/recount_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("quizzes.confirm.recount")),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/quizzes/start_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content"><p>',_buf+=I18n.t("quizzes.confirm.start.pre"),_buf+='<span class="name">',_buf+=""+this.time_limit_duration,_buf+="</span></p><p>",_buf+=I18n.t("quizzes.confirm.start.post"),_buf+="</p></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/ratings/listener_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.username),_buf+='"><span class="name">',_buf+=this.escape(this.username),_buf+='</span></div><div class="field time-spent">',_buf+=this.time_spent,_buf+='</div><div class="field last-activity">',_buf+=this.last_activity_at,_buf+='</div><div class="field progress ',_buf+=this.escape(this.complete?"is-completed":""),_buf+='">',this.progress>0?(_buf+=this.escape(this.progress_percent),_buf+="%"):_buf+="&mdash;",_buf+='</div><div class="field total-score ',_buf+=this.escape(0===this.score?"red-text":""),_buf+='">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/ratings/listener_manager_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.username),_buf+=" (",_buf+=this.escape(this.email||this.phone),_buf+=')"><span class="name">',_buf+=this.escape(this.username),_buf+='</span><span class="email is-hidden">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field time-spent">',_buf+=this.time_spent,_buf+='</div><div class="field last-activity">',_buf+=this.last_activity_at,_buf+='</div><div class="field progress ',_buf+=this.escape(this.complete?"is-completed":""),_buf+='">',this.progress>0?(_buf+=this.escape(this.progress_percent),_buf+="%"):_buf+="&mdash;",_buf+='</div><div class="field total-score ',_buf+=this.escape(0===this.score?"red-text":""),_buf+='">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/recordings/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("recordings.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/recordings/recording_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field datetime">',_buf+=this.escape(this.start_time),_buf+='</div><div class="field title"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field duration inline-right">',_buf+=this.escape(this.duration),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/recordings/recording_show"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="form info-form"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("title")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.name),_buf+='</div></div><div class="two-columns"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("date_and_time")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.start_time),_buf+='</div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("duration")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.duration),_buf+='</div></div></div><div class="two-columns"><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("size")),_buf+='</span><div class="info-field select-text">',_buf+=this.escape(this.size),_buf+='</div></div><div class="field"><a class="button inline button-save" href="',_buf+=this.escape(this.url),_buf+='" target="_blank">',_buf+=this.escape(I18n.t("recordings.watch")),_buf+='</a></div></div><div class="field"><span class="field-label">',_buf+=this.escape(I18n.t("recordings.info.url")),_buf+='</span><div class="url-field pi-text-input-wrap is-readonly"><input class="text-input" readonly="" type="text" value="',_buf+=this.escape(this.url),_buf+='" /></div></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/course_totals"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,course,group_id,i,label_id,labels,len,ref,session;if(_buf="",course=pi.app.course||{},session=$r.CourseSession.get(this.query.course_session_id),_buf+='<div class="quiz-totals-item report-totals-item item"><div class="report-totals-item-header"><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.course.course")+":"),_buf+='</span><span class="value">',_buf+=this.escape(""+(course.name||"")),_buf+="</span></div>",session&&(_buf+='<div class="divider"></div><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.quizzes.session")+":"),_buf+='</span><span class="value">',_buf+=this.escape(""+session.name),_buf+="</span></div>"),this.query.labels)for(group_id in _buf+='<div class="divider"></div><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.quizzes.labels")+":"),_buf+="</span></div>",ref=this.query.labels)for(i=0,len=(labels=ref[group_id]).length;i<len;i++)label_id=labels[i],_buf+='<div class="value user-label">',_buf+=""+$r.Label.get(label_id).name,_buf+="</div>";return _buf+='<div class="close-btn button-close white inline-right pi" data-on-click="@@destroy_report(',_buf+=this.escape(this.id),_buf+=')"></div></div><div class="report-totals-table"><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.course.table.started")),_buf+='</div><div class="value">',_buf+=this.escape((this.started_count||0)+" "+I18n.t("quizzes.view.of")+" "+(this.total_count||0)),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.quizzes.table.time_avg")),_buf+='</div><div class="value">',_buf+=""+(this.time_spent||"&mdash;"),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.quizzes.table.score_percent_avg")),_buf+="</div>",this.score_avg?(_buf+='<div class="value">',_buf+=this.escape(this.score_avg+" ("+this.score_percent_avg+"%)"),_buf+="</div>"):(_buf+='<div class="value">',_buf+="&mdash;",_buf+="</div>"),_buf+="</div></div>",this.total_count&&(_buf+='<div class="report-totals-labels"><div class="item"><div class="color inline"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.not_started")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.not_started+")"),_buf+='</span></div></div><div class="item"><div class="color inline yellow"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.in_progress")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.in_progress+")"),_buf+='</span></div></div><div class="item"><div class="color inline green"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.course.finished")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.completed_count+")"),_buf+='</span></div></div></div><div class="report-totals-chart inline-right pi" data-colors="#d7d7d7 #ebcc00 #03a88a" data-component="base_chart" data-keys="not_started in_progress completed_count" data-names="',_buf+=this.escape(I18n.t("reports.quizzes.not_started")),_buf+=" || ",_buf+=this.escape(I18n.t("reports.quizzes.in_progress")),_buf+=" || ",_buf+=this.escape(I18n.t("reports.course.finished")),_buf+='" data-pid="chart" data-plugins="restful" data-rest="CourseReport.find(',_buf+=this.escape(this.id),_buf+=')" data-type="pie"></div>'),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/question_totals_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,ques;return _buf="",ques=this.question(),_buf+='<li class="item question-totals-item"><div class="field position grey-text">',_buf+=this.escape((ques.position?ques.position:void 0)+"."),_buf+='</div><div class="field name" title="',_buf+=this.escape(ques.name?ques.name:void 0),_buf+='">',_buf+=this.escape(ques.name?JST.strip_html(ques.name):void 0),_buf+='</div><div class="field time-spent">',_buf+=this.time_spent,_buf+="</div>",this.total_count?(_buf+='<div class="field correct-num">',_buf+=this.escape(this.success_count+" ("+this.success_percent+"%)"),_buf+='</div><div class="field partition"><div class="partition-wrap"><div class="partition-bg"></div><div class="partition-value" style="width: ',_buf+=this.escape(this.success_percent),_buf+='%;"></div></div></div><div class="field incorrect-num">',_buf+=this.escape(this.unsuccess_count+" ("+this.unsuccess_percent+"%)"),_buf+='</div><div class="field score">',_buf+=this.escape(this.score_avg+" ("+this.score_percent_avg+"%)"),_buf+="</div>"):(_buf+='<div class="field correct-num">',_buf+="&mdash;",_buf+='</div><div class="field partition"></div><div class="field incorrect-num">',_buf+=this.escape("&mdash;"),_buf+='</div><div class="field score">',_buf+=this.escape("&mdash;"),_buf+="</div>"),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/quiz_select_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item">',_buf+=this.escape(""+this.name),_buf+="</li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/quiz_totals"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,group_id,i,label_id,labels,len,quiz,ref,session;if(_buf="",quiz=this.quiz()||{},session=$r.CourseSession.get(this.query.course_session_id),_buf+='<div class="quiz-totals-item report-totals-item item"><div class="report-totals-item-header"><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.quizzes.quiz")+":"),_buf+='</span><span class="value">',_buf+=this.escape(""+(quiz.name||"")),_buf+="</span></div>",session&&(_buf+='<div class="divider"></div><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.quizzes.session")+":"),_buf+='</span><span class="value">',_buf+=this.escape(""+session.name),_buf+="</span></div>"),this.query.labels)for(group_id in _buf+='<div class="divider"></div><div class="field"><span class="label grey-text">',_buf+=this.escape(I18n.t("reports.quizzes.labels")+":"),_buf+="</span></div>",ref=this.query.labels)for(i=0,len=(labels=ref[group_id]).length;i<len;i++)label_id=labels[i],_buf+='<div class="value user-label">',_buf+=""+$r.Label.get(label_id).name,_buf+="</div>";return _buf+='<div class="close-btn button-close white inline-right pi" data-on-click="@@destroy_report(',_buf+=this.escape(this.id),_buf+=')"></div></div><div class="report-totals-table"><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.quizzes.table.started")),_buf+='</div><div class="value">',_buf+=this.escape((this.total_users||0)+" "+I18n.t("quizzes.view.of")+" "+(this.total_assigned||0)),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.quizzes.table.time_avg")),_buf+='</div><div class="value">',_buf+=""+(this.time_spent||"&mdash;"),_buf+='</div></div><div class="item"><div class="heading">',_buf+=this.escape(""+I18n.t("reports.quizzes.table.score_percent_avg")),_buf+="</div>",this.score_avg?(_buf+='<div class="value">',_buf+=this.escape(this.score_avg+" ("+this.score_percent_avg+"%)"),_buf+="</div>"):(_buf+='<div class="value">',_buf+="&mdash;",_buf+="</div>"),_buf+="</div></div>",this.total_users&&(_buf+='<div class="report-totals-labels"><div class="item"><div class="color inline"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.not_started")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.not_started+")"),_buf+='</span></div></div><div class="item"><div class="color inline yellow"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.in_progress")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.in_progress+")"),_buf+='</span></div></div><div class="item"><div class="color inline red"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.unsuccessful")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.unsuccess_count+")"),_buf+='</span></div></div><div class="item"><div class="color inline green"></div><div class="label inline">',_buf+=this.escape(I18n.t("reports.quizzes.successful")),_buf+='<span class="grey-text">',_buf+=this.escape(" ("+this.success_count+")"),_buf+='</span></div></div></div><div class="report-totals-chart inline-right pi" data-colors="#d7d7d7 #ebcc00 #ea0037 #03a88a" data-component="base_chart" data-keys="not_started in_progress unsuccess_count success_count" data-names="',_buf+=this.escape(I18n.t("reports.quizzes.not_started")),_buf+=" || ",_buf+=this.escape(I18n.t("reports.quizzes.in_progress")),_buf+=" || ",_buf+=this.escape(I18n.t("reports.quizzes.unsuccessful")),_buf+=" || ",_buf+=this.escape(I18n.t("reports.quizzes.successful")),_buf+='" data-pid="chart" data-plugins="restful" data-rest="QuizReport.find(',_buf+=this.escape(this.id),_buf+=')" data-type="pie"></div>'),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/user/course_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item ',_buf+=this.escape(this.completed?"is-completed":"is-incomplete"),_buf+='"><div class="field cover">',this.thumb_url?(_buf+='<img class="cover-img" height="26" src="',_buf+=this.escape(this.thumb_url),_buf+='" />'):_buf+='<div class="no-cover"><i class="icon-logo"></i></div>',_buf+='</div><div class="field name" title="',_buf+=this.escape(this.name),_buf+='">',this.is_freezed&&(_buf+='<span class="is-freezed"><i class="fa fa-pause"></i></span>'),_buf+='<a class="link" href="@@show_course_stat(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.name),_buf+='</a></div><div class="field time-spent" title="',_buf+=this.escape(this.time_spent),_buf+='">',_buf+=this.time_spent,_buf+='</div><div class="field progress ',_buf+=this.escape(0===this.progress?"red-text":""),_buf+='">',_buf+=this.escape(this.progress_percent+"%"),this.cert_file&&(_buf+='<a class="link link-cert" href="',_buf+=this.escape(this.cert_file),_buf+='" target="_blank"></a>'),this.is_generate_cert&&(_buf+='<a class="link link-generate-cert" href="/courses/',_buf+=this.escape(this.course_id),_buf+="/listeners/",_buf+=this.escape(this.id),_buf+='/cert" target="_blank"></a>'),_buf+='</div><div class="field deadline" title="',_buf+=this.escape(this.deadline_at),_buf+='">',_buf+=this.deadline_at,_buf+='</div><div class="field tasks-completed ',_buf+=this.escape(0===this.completed_tasks&&this.total_tasks>0?"red-text":""),_buf+='">',_buf+=this.escape(this.completed_tasks+" "+I18n.t("of")+" "+this.total_tasks),_buf+='</div><div class="field total-score ',_buf+=this.escape(0===this.score?"red-text":""),_buf+='">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/user/labels_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,group_id,label_id,ref;if(_buf="",this.labels&&Object.keys(this.labels).length){for(group_id in _buf+='<div class="user-labels-list">',ref=this.labels)label_id=ref[group_id],_buf+='<div class="user-label" data-group-id="',_buf+=this.escape(group_id),_buf+='" data-id="',_buf+=this.escape(label_id),_buf+='">',_buf+=""+$r.Label.get(label_id).name,_buf+="</div>";_buf+="</div>"}else _buf+='<span class="no-labels">',_buf+="&mdash;",_buf+="</span>";return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),
this.JST["templates/reports/user/meeting_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field icon"><i class="icon-play"></i></div><div class="field title" title="',_buf+=this.escape(this.name),_buf+='">',_buf+=this.escape(this.name),_buf+='</div><div class="field started-at">',_buf+=this.escape(this.start_time),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/user/user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,group_id,label,label_id,ref;if(_buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='">',this.is_locked&&(_buf+='<span class="is-locked"><i class="fa fa-lock"></i></span>'),_buf+='<a class="link" href="/reports/users/',_buf+=this.escape(this.id),_buf+='" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+="</a>",!1===this.active&&(_buf+='<span class="no-active">',_buf+=this.escape(""+I18n.t("users.inactive")),_buf+="</span>"),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),_buf+='</div><div class="field registered">',_buf+=this.escape(this.registered_time),_buf+='</div><div class="field activity">',_buf+=this.last_activity,_buf+='</div><div class="labels">',this.labels)for(group_id in ref=this.labels)label_id=ref[group_id],(label=$r.Label.get(label_id))&&(_buf+='<div class="user-label" data-group-id="',_buf+=this.escape(group_id),_buf+='" data-id="',_buf+=this.escape(label_id),_buf+='">',_buf+=label.name,_buf+="</div>");return _buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/reports/user_activity_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.username),_buf+="(",_buf+=this.escape(this.email),_buf+=')">',_buf+=this.escape(this.username),_buf+='<span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field last-activity">',_buf+=this.escape(this.last_active_date),_buf+='</div><div class="field time-spent">',_buf+=this.time_spent_duration,_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/resources/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("materials.confirm.destroy_resource")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/scorm_packages/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("scorm_packages.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/section_contents/item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item item form-item">',_buf+=JST["templates/section_contents/"+this.content_type](this[this.content_type]),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/section_contents/material"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4,_skim_codeattributes5,_skim_codeattributes6,_skim_codeattributes7;if(_buf="",_buf+='<div class="text-info field"><i class="material-icon icon-material grey"></i><span class="part-item">',_buf+=this.escape(I18n.t("materials.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=".</span>","ok"===this.status_code){switch(_buf+='<a class="link"',_skim_codeattributes1=pi.app.new_version?this.new_view_path():this.view_path()){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+=">",_buf+=this.escape(this.name),_buf+="</a>"}else _buf+=this.escape(this.name),_buf+=' <span class="file-status">',_buf+=this.escape(this.status_name),_buf+="</span>";switch(this.is_editor_js&&(_buf+='<span style="color:red;font-size: 11px;padding: 0;margin: 0;display: block;height: unset;line-height: 20px !important;margin-top: -12px;opacity: 0.7;margin-left: 110px;">',_buf+=this.escape("  "+I18n.t("materials.new_format_message")+"."),_buf+="</span>"),_buf+='</div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form material-edit-form pi-form pi ',_buf+=this.escape(this.has_file?void 0:"is-text"),_buf+='" data-on-submited="@@update_material(',_buf+=this.escape(this.id),_buf+=',e.data)" data-serialize="true"><div class="field"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("materials.name")),_buf+='</label><div class="pi-text-input-wrap pi fw" data-name="name" data-validates="presence"><input class="text-input" type="text"',_skim_codeattributes2=this.name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}if(_buf+=' /></div><div class="two-columns"><div class="field pi-radio-group pi" data-item-klass="pi-radio-button" data-on-changed="e.data=&#39;file&#39; ? @host.removeClass(&#39;is-text&#39;) : @host.addClass(&#39;is-text&#39;)"><input type="hidden" value="',_buf+=this.escape(this.has_file?"file":"text"),_buf+='" /><ul class="list"><li class="pi-radio-button" data-value="file">',_buf+=this.escape(I18n.t("materials.types.file")),_buf+='</li><li class="pi-radio-button" data-value="text">',_buf+=this.escape(I18n.t("materials.types.text")),_buf+='</li></ul></div><div class="field pi pi-uploader" data-name="temp_file_id" data-plugins="renderable" data-renderer="jst(templates/materials/file_upload)"><div class="material-file-upload pi ',_buf+=this.escape(this.has_file?"has-file":""),_buf+='" pid="upload_info">',this.external&&this.external_type){switch(_buf+='<input name="external" type="hidden"',_skim_codeattributes3=this.external){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=' /><input name="external_type" type="hidden"',_skim_codeattributes4=this.external_type){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}switch(_buf+=' /><input name="file_name" type="hidden"',_skim_codeattributes5=this.file_name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes5),_buf+='"'}_buf+=" />"}if(_buf+='<div class="upload-link"><div class="dotted-link pi" data-on-click="@@upload_file(@host.host)">',_buf+=this.escape(I18n.t("materials.upload_file")),_buf+='</div></div><div class="file-info"><div class="category-icon inline"><i class="document-icon ',_buf+=this.escape(this.category),_buf+=" ",_buf+=this.escape(this.extension?this.extension:this.external_type),_buf+='"></i></div><span class="file-name ellipses inline">',_buf+=this.escape(this.file_name),_buf+="</span>",this.size&&(_buf+='<span class="file-size">&nbsp;&mdash;',_buf+=this.escape(this.size),_buf+="</span>"),_buf+='<div class="divider inline"></div><div class="dotted-link delete-btn inline pi" data-on-click="@@delete_file(@host.host)">',_buf+=this.escape(I18n.t("materials.delete_file")),_buf+="</div>",this.download_url){switch(_buf+='<a class="dotted-link inline pi"',_skim_codeattributes6=this.file_name){case!0:_buf+=' download="download"';break;case!1:case null:break;default:_buf+=' download="',_buf+=this.escape(_skim_codeattributes6),_buf+='"'}switch(_skim_codeattributes7=this.download_url){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes7),_buf+='"'}_buf+=' target="_blank">',this.is_external?_buf+=this.escape(I18n.t("materials.open_source")):_buf+=this.escape(I18n.t("materials.download_file")),_buf+="</a>"}return _buf+='</div></div></div></div></div><div class="field material-edit-description"><label class="field-label" for="description">',_buf+=this.escape(I18n.t("materials.description")),_buf+="</label>",this.markdown?_buf+=JST["templates/shared/markdown_editor"]({name:"description",value:this.description}):_buf+=JST["templates/shared/editor"]({name:"description",value:this.description}),_buf+='<div class="field"></div></div><div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(I18n.t("helpers.save")),_buf+="</div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/section_contents/quiz"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link"',_skim_codeattributes1=this.view_path()){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+="</a></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/section_contents/scorm_package"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("scorm_packages.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link"',_skim_codeattributes1=this.view_path()){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+="</a>",this.is_editor_js&&(_buf+='<span style="color:red;font-size: 11px;padding: 0;margin: 0;display: block;height: unset;line-height: 20px !important;margin-top: -12px;opacity: 0.7;margin-left: 110px;">',_buf+=this.escape("  "+I18n.t("materials.new_format_message")+"."),_buf+="</span>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/section_contents/task"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<div class="text-info field"><i class="material-icon quiz icon-quiz2"></i><span class="part-item">',_buf+=this.escape(I18n.t("tasks.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+='.</span><a class="link"',_skim_codeattributes1=this.view_path()){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=">",_buf+=this.escape(this.name),_buf+="</a>",this.is_editor_js&&(_buf+='<span style="color:red;font-size: 11px;padding: 0;margin: 0;display: block;height: unset;line-height: 20px !important;margin-top: -12px;opacity: 0.7;margin-left: 110px;">',_buf+=this.escape("  "+I18n.t("materials.new_format_message")+"."),_buf+="</span>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/sections/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("materials.confirm.destroy_section")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/sections/transfer_content"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,len,ref,section;for(_buf="",_buf+='<div class="form"><div class="pi-select-field pi" data-name="target" data-pid="section_select"><input id="" type="hidden" /><div class="pi placeholder" pid="placeholder">',_buf+=this.escape(""+I18n.t("courses.transfer_content.placeholder")),_buf+='</div><div class="pi list-container pi-select-list is-hidden" pid="dropdown"><ul class="list">',i=0,len=(ref=pi.resources.Section.all()).length;i<len;i++)section=ref[i],_buf+='<li class="item" data-value="',_buf+=this.escape(section.id),_buf+='">',_buf+=this.escape(section.position+". "+section.name),_buf+="</li>";return _buf+='</ul></div></div><div class="field inline is-hidden pi" data-pid="allow_force_complete"><label class="allow_force_complete field-label"></label><div class="pi pi-checkbox-wrap" data-name="allow_force_complete" data-pid="cb"><input type="hidden" value="0" />',_buf+=this.escape(I18n.t("sections.allow_force_complete")),_buf+='</div></div><div class="buttons"><a class="button inline pi-button-blue ok-btn" href="@@save()">',_buf+=this.escape("OK"),_buf+="</a></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/autocomplete_suggestion_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,ref,ref1,ref2,ref3,ref4;return _buf="",_buf+='<div class="autocomplete-suggestion" company="',_buf+=this.escape(this.item.value),_buf+='" data-val="',_buf+=this.escape(this.item.value),_buf+='" individual_entrepreneur="',_buf+=this.escape("INDIVIDUAL"===this.item.data.type),_buf+='" kpp="',_buf+=this.escape(this.item.data.kpp),_buf+='" legal_address="',_buf+=this.escape(null!=(ref=this.item.data.address)?ref.value:void 0),_buf+='" ogrn="',_buf+=this.escape(this.item.data.ogrn),_buf+='" opf="',_buf+=this.escape(null!=(ref1=this.item.data.opf)?ref1.full:void 0),_buf+='" owner_name="',_buf+=this.escape((null!=(ref2=this.item.data.management)?ref2.name:void 0)||(null!=(ref3=this.item.data.name)?ref3.full:void 0)),_buf+='" owner_position="',_buf+=this.escape(null!=(ref4=this.item.data.management)?ref4.post:void 0),_buf+='" tax_number="',_buf+=this.escape(this.item.data.inn),_buf+='">',_buf+=this.search,_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/avatar_circle"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3;if(_buf="",this.avatar_url){switch(_buf+="<img",_skim_codeattributes1=this.name){case!0:_buf+=' alt="alt"';break;case!1:case null:break;default:_buf+=' alt="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' class="avatar-circle"',_skim_codeattributes2=this.avatar_url){case!0:_buf+=' src="src"';break;case!1:case null:break;default:_buf+=' src="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_skim_codeattributes3=this.name){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}_buf+=" />"}else _buf+='<div class="avatar-circle letter">',_buf+=this.escape(JST.ava_name(this.name)),_buf+="</div>";return _buf})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/banner"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="banner ',_buf+=this.escape(this.style),_buf+='"><div class="banner-content ',_buf+=this.escape(this.multiline?"is-multiline":void 0),_buf+='">',_buf+=this.text,_buf+='<a class="button-close banner-close"></a></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/editor"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,len,ref,state;for(_buf="",_buf+='<div class="pi-text-editor pi" data-limit="',_buf+=this.escape(this.limit||""),_buf+='" data-name="',_buf+=this.escape(this.name||""),_buf+='" data-pid="',_buf+=this.escape(this.pid||""),_buf+='" data-validates="',_buf+=this.escape(this.validates||""),_buf+='"><div class="text-editor-buttons"><div class="fontsize-callout pi-callout pi right is-hidden" data-links="true" data-pid="font_callout"><div class="pi-list pi" data-on-item-click="@host.host.font_size(e.data.item.record.size); @host.hide()"><div class="list no-select" unselectable="on"><div class="fontsize-item item small" data-size="1" unselectable="on">',_buf+=this.escape("small"),_buf+='</div><div class="fontsize-item item normal" data-size="2" unselectable="on">',_buf+=this.escape("Normal"),_buf+='</div><div class="fontsize-item item heading" data-size="4" unselectable="on">',_buf+=this.escape("Heading"),_buf+='</div></div></div></div><a class="icon-button inline button pi no-select" data-on-click="@host.font_callout.show; e.cancel" href="#" unselectable="on"><i class="fa fa-font"></i></a><div class="dv"></div>',i=0,len=(ref=["bold","italic","underline","strikethrough"]).length;i<len;i++)state=ref[i],_buf+='<a class="icon-button inline button pi no-select ',_buf+=this.escape(state),_buf+='-btn" data-on-click="@host.toggle(&#39;',_buf+=this.escape(state),_buf+='&#39;); e.cancel" href="#" unselectable="on"><i class="fa fa-',_buf+=this.escape(state),_buf+='"></i></a>';return _buf+='<div class="dv"></div><a class="icon-button inline button pi no-select" data-on-click="@host.list(); e.cancel" href="#" unselectable="on"><i class="fa fa-list"></i></a><a class="icon-button inline button pi no-select" data-on-click="@host.list(true); e.cancel" href="#" unselectable="on"><i class="fa fa-list-ol"></i></a><div class="dv"></div><a class="icon-button inline button pi no-select" data-on-click="@host.edit_math(); e.cancel" href="#" tabindex="-1" unselectable="on"><i class="fa fa-superscript"></i></a><div class="dv"></div><a class="icon-button inline button pi no-select" data-on-click="@host.edit_yt(); e.cancel" href="#" tabindex="-1" unselectable="on"><i class="fa fa-youtube-play"></i></a><div class="dv"></div><a class="icon-button inline button pi no-select" data-on-click="@host.edit_code(); e.cancel" href="#" tabindex="-1" unselectable="on"><i class="fa fa-terminal"></i></a></div><div class="text-editor-input"><textarea class="text-editor-input-area">',_buf+=this.escape(this.value),_buf+="</textarea></div>",_buf+=JST["templates/shared/editor/math"](),_buf+=JST["templates/shared/editor/youtube"](),_buf+=JST["templates/shared/editor/code"](),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/editor/code"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="pi pi-callout pi-editor-callout code large is-hidden" data-pid="code_callout"><div class="close-btn button-close white inline pi" data-on-click="@host.hide"></div><div class="pi pi-editor" data-component="code_editor" data-on-submited="@host.host.insert_code(e.data); @host.hide" data-pid="editor"><div class="pi-editor-callout-header posrel"><h2 class="pi-editor-callout-title inline">',_buf+=this.escape(I18n.t("editor.code.title")),_buf+='</h2></div><div class="pi-editor-callout-content"><div class="pi-editor-callout-field"><label class="field-label">',_buf+=this.escape(I18n.t("editor.code.source_label")),_buf+='</label><div class="pi-text-input-wrap pi-textarea"><textarea class="text-input pi-editor-code-input pi" pid="input"></textarea></div></div><div class="math-editor-field pi-editor-preview"><label class="field-label">',_buf+=this.escape(I18n.t("editor.math.preview")),_buf+='</label><div class="pi-editor-preview-content pi" pid="preview"></div></div></div><div class="buttons"><button class="button pi pi-button-grey" data-on-click="@host.process()">',_buf+=this.escape(I18n.t("editor.math.preview")),_buf+='</button><button class="button pi pi-button-blue" data-on-click="@host.submit()">',_buf+=this.escape(I18n.t("helpers.insert")),_buf+="</button></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/editor/math"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="pi pi-callout pi-editor-callout math is-hidden" data-pid="math_callout"><div class="close-btn button-close white inline pi" data-on-click="@host.hide"></div><div class="pi math-editor pi-editor" data-component="math_editor" data-on-submited="@host.host.insert_math(e.data); @host.hide" data-pid="editor"><div class="pi-editor-callout-header posrel"><h2 class="pi-editor-callout-title inline">',_buf+=this.escape(I18n.t("editor.math.title")),_buf+='</h2><div class="pi inline info-callout-content"><i class="fa fa-info-circle info-callout-icon pi" data-on-click="@host.callout.show; e.cancel"></i><div class="pi-callout pi med info-callout is-hidden" data-pid="callout"><div class="close-callout-btn button-close pi" data-on-click="@host.hide"></div>',_buf+=I18n.t("editor.math.latex_callout"),_buf+='</div></div></div><div class="pi-editor-callout-content"><div class="pi-editor-callout-field"><label class="field-label">',_buf+=this.escape(I18n.t("editor.math.latex_input")),_buf+='</label><div class="pi-text-input-wrap pi-textarea"><textarea class="text-input pi-editor-code-input pi" pid="input"></textarea></div></div><div class="pi-editor-callout-field pi-editor-preview"><label class="field-label">',_buf+=this.escape(I18n.t("editor.math.preview")),_buf+='</label><div class="pi-editor-preview-content pi" pid="preview"></div></div></div><div class="buttons"><button class="button pi pi-button-grey" data-on-click="@host.process()">',_buf+=this.escape(I18n.t("editor.math.preview")),_buf+='</button><button class="button pi pi-button-blue" data-on-click="@host.submit()">',_buf+=this.escape(I18n.t("helpers.insert")),_buf+="</button></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/editor/youtube"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="pi pi-callout pi-editor-callout youtube is-hidden" data-pid="yt_callout"><div class="close-btn button-close white inline pi" data-on-click="@host.hide"></div><div class="pi-editor-callout-header posrel"><h2 class="pi-editor-callout-title inline">',_buf+=this.escape(I18n.t("editor.youtube.title")),_buf+='</h2></div><div class="pi-editor-callout-content"><div class="pi-editor-callout-field"><label class="field-label">',_buf+=this.escape(I18n.t("editor.youtube.embed_label")),_buf+='</label><div class="pi-text-input-wrap pi-textarea"><textarea class="text-input pi-editor-code-input pi" pid="input"></textarea></div></div></div><div class="buttons"><button class="button pi pi-button-blue" data-on-click="@host.host.insert_yt(@host.input.value); @host.hide; @host.input.clear()">',_buf+=this.escape(I18n.t("helpers.insert")),_buf+="</button></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/shared/markdown_editor"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="pi-markdown-editor pi" data-name="',_buf+=this.escape(this.name||""),_buf+='" data-pid="markdown_editor" data-text-value="',_buf+=this.escape(this.value||""),_buf+='" data-validates="',_buf+=this.escape(this.validates||""),_buf+='"><div class="markdown-editor-input"><textarea class="markdown-editor"></textarea></div></div>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/active_users_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field desc">',_buf+=this.escape(this.value),_buf+='&nbsp;<span class="grey-text">',_buf+=this.escape(I18n.t("subscriptions.buy.active_users")),_buf+="</span></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/bank_transfer_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes10,_skim_codeattributes11,_skim_codeattributes12,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4,_skim_codeattributes5,_skim_codeattributes6,_skim_codeattributes7,_skim_codeattributes8,_skim_codeattributes9;switch(_buf="",_buf+='<form class="agreement-info-form bank-transfer form pi-form pi" data-pid="bank_transfer_form" data-serialize="true"><div class="pi pi-autocomplete-egrul" data-pid="autocomplete-egrul"><div class="field inline"><div class="pi-checkbox-wrap pi ',_buf+=this.escape("true"===this.account.individual_entrepreneur?"is-selected":""),_buf+='" data-false-value="false" data-name="individual_entrepreneur" data-on-changed="e.data ? @host.kpp_txt.hide : @host.kpp_txt.show" data-pid="individual_entrepreneur_cb" data-true-value="true"><input id="individual_entrepreneur" type="hidden"',_skim_codeattributes1=this.account.individual_entrepreneur){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><label class="checkbox-label" for="individual-entrepreneur">',_buf+=this.escape(""+I18n.t("agreement.individual_entrepreneur")),_buf+='</label></div></div><div class="field inline"><label class="field-label" for="company">',_buf+=this.escape(I18n.t("agreement.autocomplete")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="company" data-validates="presence"><input class="text-input autocomplete-input" id="company" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.company_autocomplete")),_buf+='" type="text"',_skim_codeattributes2=this.account.company_name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="field inline"><label class="field-label" for="legal_address">',_buf+=this.escape(I18n.t("agreement.legal_address")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="legal_address" data-on-changed="@host.legal_address_changed" data-validates="presence" id="legal_address"><input class="text-input" data-pid="legal_address_txt" id="legal_address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes3=this.account.legal_address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="tax_number">',_buf+=this.escape(I18n.t("agreement.tax_number")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="tax_number" data-validates="presence"><input class="text-input" id="tax_number" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.tax_number")),_buf+='" type="text"',_skim_codeattributes4=this.account.tax_number){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="field inline pi" data-pid="kpp_txt"><label class="field-label" for="kpp">',_buf+=this.escape(I18n.t("agreement.kpp")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="kpp"><input class="text-input" id="kpp" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.kpp")),_buf+='" type="text"',_skim_codeattributes5=this.account.kpp){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes5),_buf+='"'}switch(_buf+=' /></div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="fullname">',_buf+=this.escape(I18n.t("agreement.fullname")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="fullname" data-validates="presence"><input class="text-input" id="fullname" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.fullname")),_buf+='" type="text"',_skim_codeattributes6=this.account.owner_fullname){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes6),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="field inline"><label class="field-label" for="phone">',_buf+=this.escape(I18n.t("agreement.phone")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="phone" data-validates="presence"><input class="text-input" id="phone" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.phone")),_buf+='" type="text"',_skim_codeattributes7=this.account.owner_phone){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes7),_buf+='"'}switch(_buf+=' /></div></div></div><div class="field inline"><label class="field-label" for="address">',_buf+=this.escape(I18n.t("agreement.address")),_buf+='</label><div class="pi-checkbox-wrap pi ',_buf+=this.escape(this.account.legal_address&&this.account.legal_address===this.account.address?"is-selected":""),_buf+='" data-false-value="false" data-name="coincides_with_the_legal_address" data-on-changed="@host.match_addresses(e.data)" data-pid="coincides_with_the_legal_address_cb" data-true-value="true" id="coincides_with_the_legal_address"><input id="coincides-with-the-legal-address" type="hidden" /><label class="checkbox-label" for="coincides-with-the-legal-address">',_buf+=this.escape(""+I18n.t("agreement.coincides_with_the_legal_address")),_buf+='</label></div><div class="pi-text-input-wrap pi" data-name="address" data-pid="address_txt" data-validates="presence"><input class="text-input" id="address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes8=this.account.address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes8),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="invisible-fields is-hidden pi"><div class="pi-text-input-wrap is-hidden pi" data-name="type"><input id="type" type="hidden" value="company" /></div><div class="pi-text-input-wrap is-hidden pi" data-name="ogrn"><input id="ogrn" type="hidden"',_skim_codeattributes9=this.account.ogrn){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes9),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="opf"><input id="opf" type="hidden"',_skim_codeattributes10=this.account.opf){case!0:_buf+=' value="value"';break
;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes10),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="owner_name"><input id="owner_name" type="hidden"',_skim_codeattributes11=this.account.owner_name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes11),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="owner_position"><input id="owner_position" type="hidden"',_skim_codeattributes12=this.account.owner_position){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes12),_buf+='"'}return _buf+=" /></div></div></div></form>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/buy_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="subsciption-preview"><div class="subs-preview-item"><div class="subs-preview-item-title">',_buf+=this.escape(I18n.t("subscriptions.buy.tariff_plan")),_buf+='</div><div class="subs-preview-value">',_buf+=this.escape(this.tariff_plan()?this.tariff_plan().name:I18n.t("subscriptions.buy.undefined")),_buf+='</div></div><div class="subs-preview-item"><div class="subs-preview-item-title">',_buf+=this.escape(I18n.t("subscriptions.buy.active_users")),_buf+='</div><div class="subs-preview-value">',_buf+=this.escape(this.active_users||I18n.t("subscriptions.buy.undefined")),_buf+='</div></div><div class="subs-preview-item"><div class="subs-preview-item-title">',_buf+=this.escape(I18n.t("subscriptions.buy.memory")),_buf+='</div><div class="subs-preview-value">',_buf+=this.escape(this.memory_available||I18n.t("subscriptions.buy.undefined")),_buf+='</div></div><div class="subs-preview-item"><div class="subs-preview-item-title">',_buf+=this.escape(I18n.t("subscriptions.buy.period")),_buf+='</div><div class="subs-preview-value">',this.start_date?(_buf+=this.escape(this.start_date),_buf+=" &mdash; ",_buf+=this.escape(this.finish_date)):_buf+="I18n.t('subscriptions.buy.undefined')",_buf+="</div></div>",this.promo_code&&(_buf+='<div class="subs-preview-item"></div><div class="subs-preview-item-title">',_buf+=this.escape(I18n.t("subscriptions.buy.promo_discount")),_buf+='</div><div class="subs-preview-value green-text">',"percent"===this.promo().type?(_buf+=this.escape(this.promo().value),_buf+="%",this.payment&&(_buf+="&nbsp;(",_buf+=this.escape(JST.currency(this.discount)),_buf+=" ",_buf+=this.escape(I18n.t("rub")),_buf+=")")):(_buf+=this.escape(JST.currency(this.promo().value)),_buf+=" ",_buf+=this.escape(I18n.t("rub"))),_buf+="</div>"),null!=this.payment&&(_buf+='<div class="subs-payment-block">',_buf+=this.escape(JST.currency(this.payment)+" "+I18n.t("rub")),_buf+="</div>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/cancel_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("subscriptions.confirm.cancel")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/creditcard_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4;switch(_buf="",_buf+='<form class="agreement-info-form creditcard form pi-form pi" data-pid="creditcard_form" data-serialize="true"><div class="field inline"><label class="field-label" for="fullname">',_buf+=this.escape(I18n.t("agreement.fullname")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="fullname" data-validates="presence"><input class="text-input" id="fullname" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.fullname")),_buf+='" type="text"',_skim_codeattributes1=this.account.owner_fullname){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="phone">',_buf+=this.escape(I18n.t("agreement.phone")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="phone" data-validates="presence"><input class="text-input" id="owner_phone" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.phone")),_buf+='" type="text"',_skim_codeattributes2=this.account.owner_phone){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="field inline date"><label class="field-label" for="birthday">',_buf+=this.escape(I18n.t("agreement.birthday")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="birthday" data-validates="presence date"><input class="text-input" id="birthday" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.birthday")),_buf+='" type="text"',_skim_codeattributes3=this.account.owner_birthday){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div></div><div class="field inline"><label class="field-label" for="address">',_buf+=this.escape(I18n.t("agreement.address")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="address" data-validates="presence"><input class="text-input" id="address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes4=this.account.address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}return _buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="invisible-fields is-hidden pi"><div class="pi-text-input-wrap is-hidden pi" data-name="type"><input id="type" type="hidden" value="personal" /></div></div></form>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/jur_credit_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes10,_skim_codeattributes11,_skim_codeattributes12,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4,_skim_codeattributes5,_skim_codeattributes6,_skim_codeattributes7,_skim_codeattributes8,_skim_codeattributes9;switch(_buf="",_buf+='<form class="agreement-info-form bank-transfer form pi-form pi" data-pid="jur_credit_form" data-serialize="true"><div class="pi pi-autocomplete-egrul" data-pid="autocomplete-egrul"><div class="field inline"><div class="pi-checkbox-wrap pi ',_buf+=this.escape("true"===this.account.individual_entrepreneur?"is-selected":""),_buf+='" data-false-value="false" data-name="individual_entrepreneur" data-on-changed="e.data ? @host.kpp_txt.hide : @host.kpp_txt.show" data-pid="individual_entrepreneur_cb" data-true-value="true"><input id="individual_entrepreneur" type="hidden"',_skim_codeattributes1=this.account.individual_entrepreneur){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><label class="checkbox-label" for="individual-entrepreneur">',_buf+=this.escape(""+I18n.t("agreement.individual_entrepreneur")),_buf+='</label></div></div><div class="field inline"><label class="field-label" for="company">',_buf+=this.escape(I18n.t("agreement.autocomplete")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="company" data-validates="presence"><input class="text-input autocomplete-input" id="company" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.company_autocomplete")),_buf+='" type="text"',_skim_codeattributes2=this.account.company_name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="field inline"><label class="field-label" for="legal_address">',_buf+=this.escape(I18n.t("agreement.legal_address")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="legal_address" data-on-changed="@host.legal_address_changed" data-validates="presence" id="legal_address"><input class="text-input" data-pid="legal_address_txt" id="legal_address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes3=this.account.legal_address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="tax_number">',_buf+=this.escape(I18n.t("agreement.tax_number")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="tax_number" data-validates="presence"><input class="text-input" id="tax_number" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.tax_number")),_buf+='" type="text"',_skim_codeattributes4=this.account.tax_number){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="field inline pi" data-pid="kpp_txt"><label class="field-label" for="kpp">',_buf+=this.escape(I18n.t("agreement.kpp")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="kpp"><input class="text-input" id="kpp" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.kpp")),_buf+='" type="text"',_skim_codeattributes5=this.account.kpp){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes5),_buf+='"'}switch(_buf+=' /></div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="fullname">',_buf+=this.escape(I18n.t("agreement.fullname")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="fullname" data-validates="presence"><input class="text-input" id="fullname" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.fullname")),_buf+='" type="text"',_skim_codeattributes6=this.account.owner_fullname){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes6),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="field inline"><label class="field-label" for="phone">',_buf+=this.escape(I18n.t("agreement.phone")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="phone" data-validates="presence"><input class="text-input" id="phone" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.phone")),_buf+='" type="text"',_skim_codeattributes7=this.account.owner_phone){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes7),_buf+='"'}switch(_buf+=' /></div></div></div><div class="field inline"><label class="field-label" for="address">',_buf+=this.escape(I18n.t("agreement.address")),_buf+='</label><div class="pi-checkbox-wrap pi ',_buf+=this.escape(this.account.legal_address&&this.account.legal_address===this.account.address?"is-selected":""),_buf+='" data-false-value="false" data-name="coincides_with_the_legal_address" data-on-changed="@host.match_addresses(e.data)" data-pid="coincides_with_the_legal_address_cb" data-true-value="true" id="coincides_with_the_legal_address"><input id="coincides-with-the-legal-address" type="hidden" /><label class="checkbox-label" for="coincides-with-the-legal-address">',_buf+=this.escape(""+I18n.t("agreement.coincides_with_the_legal_address")),_buf+='</label></div><div class="pi-text-input-wrap pi" data-name="address" data-pid="address_txt" data-validates="presence"><input class="text-input" id="address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes8=this.account.address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes8),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="invisible-fields is-hidden pi"><div class="pi-text-input-wrap is-hidden pi" data-name="type"><input id="type" type="hidden" value="company" /></div><div class="pi-text-input-wrap is-hidden pi" data-name="ogrn"><input id="ogrn" type="hidden"',_skim_codeattributes9=this.account.ogrn){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes9),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="opf"><input id="opf" type="hidden"',_skim_codeattributes10=this.account.opf){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes10),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="owner_name"><input id="owner_name" type="hidden"',_skim_codeattributes11=this.account.owner_name){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes11),_buf+='"'}switch(_buf+=' /></div><div class="pi-text-input-wrap is-hidden pi" data-name="owner_position"><input id="owner_position" type="hidden"',_skim_codeattributes12=this.account.owner_position){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes12),_buf+='"'}return _buf+=" /></div></div></div></form>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/memory_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field desc">',_buf+=this.escape(this.value),_buf+='&nbsp;<span class="grey-text">GB</span></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/payment_types_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,template_name;return _buf="",_buf+='<div class="payment_forms">',template_name="templates/subscriptions/"+this.type+"_form",_buf+=JST[template_name](this),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/receipt_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,_skim_codeattributes3,_skim_codeattributes4;switch(_buf="",_buf+='<form class="agreement-info-form receipt form pi-form pi" data-pid="receipt_form" data-serialize="true"><div class="field inline"><label class="field-label" for="fullname">',_buf+=this.escape(I18n.t("agreement.fullname")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="fullname" data-validates="presence"><input class="text-input" id="fullname" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.fullname")),_buf+='" type="text"',_skim_codeattributes1=this.account.owner_fullname){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div></div><div class="two-columns"><div class="field inline"><label class="field-label" for="phone">',_buf+=this.escape(I18n.t("agreement.phone")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="phone" data-validates="presence"><input class="text-input" id="owner_phone" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.phone")),_buf+='" type="text"',_skim_codeattributes2=this.account.owner_phone){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="field inline date"><label class="field-label" for="birthday">',_buf+=this.escape(I18n.t("agreement.birthday")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="birthday" data-validates="presence date"><input class="text-input" id="owner_birthday" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.birthday")),_buf+='" type="text"',_skim_codeattributes3=this.account.owner_birthday){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes3),_buf+='"'}switch(_buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div></div><div class="field inline"><label class="field-label" for="address">',_buf+=this.escape(I18n.t("agreement.address")),_buf+='</label><div class="pi-text-input-wrap pi" data-name="address" data-validates="presence"><input class="text-input" id="address" placeholder="',_buf+=this.escape(I18n.t("agreement.sample.address")),_buf+='" type="text"',_skim_codeattributes4=this.account.address){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes4),_buf+='"'}return _buf+=' /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.incorrect")),_buf+='</div></div></div><div class="invisible-fields is-hidden pi"><div class="pi-text-input-wrap is-hidden pi" data-name="type"><input id="type" type="hidden" value="personal" /></div></div></form>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/subscriptions/tariff_plan_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item"><div class="field name">',_buf+=this.escape(this.name),_buf+='</div><div class="field double-decker tariff-params">',this.users_limit?(_buf+='<div class="users">',_buf+=this.escape(I18n.t("upto")+" "+this.users_limit+" "+I18n.t("subscriptions.buy.users")),_buf+="</div>"):(_buf+='<div class="users">',_buf+=this.escape(I18n.t("upto")+" "+this.max_active_users()+" "+I18n.t("subscriptions.buy.active_users")),_buf+="</div>"),_buf+='<div class="payment">',_buf+=this.escape(I18n.t("from")+" "+JST.currency(this.minimal_payment())+" "+I18n.t("rub")),_buf+="</div></div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/attached_link"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_temple_coffeescript_attributeremover1,survey;return _buf="",survey=this.survey,_buf+="<div",_temple_coffeescript_attributeremover1="",(_temple_coffeescript_attributeremover1+=this.escape(survey?"is-attached":void 0)).length>0&&(_buf+=' class="',_buf+=_temple_coffeescript_attributeremover1,_buf+='"'),_buf+='><label class="inline-labels">',_buf+=this.escape(I18n.t("surveys.survey")+":"),_buf+="</label> ",survey?(_buf+='<div class="divided-links inline"><span class="divided-link"><a class="dotted-link grey" href="@@edit_survey">',_buf+=this.escape(I18n.t("helpers.edit")),_buf+='</a></span><span class="divided-link"><a class="dotted-link red" href="@@remove_survey">',_buf+=this.escape(I18n.t("helpers.remove")),_buf+="</a></span></div>"):(_buf+='<a class="dotted-link" href="@@edit_survey">',_buf+=this.escape(I18n.t("helpers.add")),_buf+="</a>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("surveys.confirm.destroy")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/edit_info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,target;return _buf="",target=this.surveyable(),_buf+="<div>","Meeting"===this.surveyable_type?(_buf+='<h1 class="title">',_buf+=this.escape(I18n.t("surveys.edit.title_meeting")),_buf+='</h1><div class="surveyable-info-table"><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.meeting")+":"),_buf+='</span> <span class="value">',_buf+=this.escape(target.name),_buf+='</span></div><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.meeting_start")+":"),_buf+='</span> <span class="value">',_buf+=this.escape(target.started_at_date+" "+target.started_at_time),_buf+="</span></div></div>"):"CourseSession"===this.surveyable_type?(_buf+='<h1 class="title">',_buf+=this.escape(I18n.t("surveys.edit.title_course")),_buf+='</h1><div class="surveyable-info-table"><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.course")+":"),_buf+='</span><span class="value">',_buf+=this.escape(target.course().name),_buf+='</span></div><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.session")+":"),_buf+='</span><span class="value">',_buf+=this.escape(target.name),_buf+="</span></div></div>"):"Product"===this.surveyable_type?(_buf+='<h1 class="title">',_buf+=this.escape(I18n.t("surveys.edit.title_product")),_buf+='</h1><div class="surveyable-info-table"><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.product")+":"),_buf+='</span><span class="value">',_buf+=this.escape(target.name),_buf+="</span></div></div>"):"ClickmeetingMeeting"===this.surveyable_type&&(_buf+='<h1 class="title">',_buf+=this.escape(I18n.t("surveys.edit.title_meeting")),_buf+='</h1><div class="surveyable-info-table"><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.meeting")+":"),_buf+='</span> <span class="value">',_buf+=this.escape(target.name),_buf+='</span></div><div class="surveyable-info-block"><span class="label">',_buf+=this.escape(I18n.t("surveys.edit.meeting_start")+":"),_buf+='</span> <span class="value">',_buf+=this.escape(target.starts_at_date+" "+target.starts_at_time),_buf+="</span></div></div>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/field_destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("surveys.confirm.destroy_field")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/field_edit_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="filter-item question-item item form-item ',_buf+=this.escape(this.type),_buf+=" ",_buf+=this.escape(!0===this._persisted?"":"not-saved"),_buf+='" data-component="survey_field_form"><div class="text-info"><span class="part-item">',_buf+=this.escape(I18n.t("quizzes.question.title")),_buf+=" ",_buf+=this.escape(this.position),_buf+=". </span><span>",_buf+=JST.strip_html(this.name),_buf+='</span><span class="grey-text not-saved-label inline-right">',_buf+=this.escape(I18n.t("quizzes.question.not_saved")),_buf+='</span></div><div class="form-wrapper item-edit-form"><div class="close-btn button-close white inline pi" data-on-click="@host.deactivate"></div><div class="form-content"><div class="form pi-form pi" data-on-submited="@@update_field(',_buf+=this.escape(this.id),_buf+=',e.data)" data-rails="true" data-serialize="true" pid="form"><div class="field"><label class="field-label" for="name">',_buf+=this.escape(I18n.t("quizzes.question.name")),_buf+="</label>",_buf+=JST["templates/shared/editor"]({name:"name",value:this.name,limit:"255"}),_buf+='</div><div class="field"><label class="field-label" for="type">',_buf+=this.escape(I18n.t("quizzes.question.type")),_buf+='</label><div class="select-question-type pi-select-field pi" data-name="type" data-pid="type_select"><input type="hidden" value="',_buf+=this.escape(this.type),_buf+='" /><div class="pi placeholder" pid="placeholder"></div><div class="pi list-container pi-select-list has-scroller is-hidden" data-plugins="scrollable" pid="dropdown"><ul class="list"><li class="item" data-value="text">',_buf+=this.escape(I18n.t("surveys.fields.type.text")),_buf+='</li><li class="item" data-value="single">',_buf+=this.escape(I18n.t("surveys.fields.type.single")),_buf+='</li><li class="item" data-value="multiple">',_buf+=this.escape(I18n.t("surveys.fields.type.multiple")),_buf+='</li></ul></div></div></div><div class="field options-field pi pi-list" data-pid="options_list" data-renderer="jst(templates/surveys/field_edit_options)">',"text"!==this.type&&(_buf+=JST["templates/surveys/field_edit_options"](this)),_buf+='</div><div class="pi-checkbox-wrap pi" data-name="required"><input type="hidden" value="',_buf+=this.escape(0|this.required),_buf+='" />',_buf+=this.escape(I18n.t("surveys.edit.required")),_buf+='</div><div class="submit-btn pi-button-green inline pi" data-on-click="@host.submit">',_buf+=this.escape(I18n.t("helpers.save")),_buf+="</div></div></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/field_edit_options"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,i,j,k,len,len1,option,ref,ref1;if(_buf="",_buf+='<div><label class="field-label options-label">',_buf+=this.escape(I18n.t("quizzes.question.options")),_buf+='</label><div class="pi options-list list-container pi-list" data-pid="list" data-plugins="renderable" data-renderer="jst(templates/surveys/field_option)" pid="options_list"><ul class="list">',null!=this.data&&this.data.length)for(i=j=0,len=(ref=this.data).length;j<len;i=++j)(option=ref[i]).__list_index__=i,_buf+=JST["templates/surveys/field_option"](option);else for(k=0,len1=(ref1=[0,1]).length;k<len1;k++)option={__list_index__:i=ref1[k]},_buf+=JST["templates/surveys/field_option"](option);return _buf+='</ul><div class="add-item add-option pi" data-on-click="@host.add_item"><span class="add-item-link">',_buf+=this.escape(I18n.t("quizzes.question.add_option")),_buf+="</span></div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/surveys/field_option"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item option-item"><div class="pi-text-input-wrap pi" data-name="data[][name]" data-validates="presence"><input class="text-input short-answer-input" type="text" value="',_buf+=this.escape(this.name),_buf+='" /></div><div class="delete-btn inline pi" data-on-click="@host.host.remove_item(@host)"></div></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/task_stats/accept_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("task_stats.confirm.accept")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/task_stats/change_score_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("task_stats.confirm.change_score")),_buf+='<span class="name">',_buf+=this.escape(" "+this.score),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/task_stats/decline_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("task_stats.confirm.decline")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/attachments"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,file,i,len,ref;for(_buf="",_buf+='<ul class="task-attachments">',i=0,len=(ref=this.attachments).length;i<len;i++){switch(file=ref[i],_buf+='<li class="task-attachment"><i class="task-attachment-icon document-icon ',_buf+=this.escape(file.category),_buf+=" ",_buf+=this.escape(file.extension),_buf+='"></i><a class="task-attachment-name"',_skim_codeattributes1=file.file_name){case!0:_buf+=' download="download"';break;case!1:case null:break;default:_buf+=' download="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_skim_codeattributes2=file.cors_url){case!0:_buf+=' href="href"';break;case!1:case null:break;default:_buf+=' href="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}_buf+=' rel="noopener noreferrer" target="_blank">',_buf+=this.escape(file.file_name),_buf+="</a></li>"}return _buf+="</ul>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/attachments_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="task-attachments-form"><div class="pi list-container pi-list" data-listen-load="true" data-pid="list" data-plugins="restful" data-renderer="jst(templates/tasks/file_form_item)" data-sort="position:asc"><ul class="list task-attachments-list"></ul></div><div class="upload-btn dotted-link pi-file-input-wrap pi" data-multiple="true" data-on-changed="@view.reload_files(e.data)" data-pid="upload_btn">',_buf+=this.escape(I18n.t("tasks.upload_files")),_buf+='<input class="file-input" name="attachments_attributes[]" tabindex="-1" type="file" /></div><div class="upload-hint">',_buf+=this.escape(I18n.t("tasks.upload_hint")),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/check_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,i,len,ref,score_step,task;if(_buf="",_buf+='<div class="task-stat-check pi" data-component="task_check_form" data-on-accepted="@@accept(@host.record,e.data)" data-on-declined="@@decline(@host.record,e.data)"><div class="task-stat-confirm"><div class="task-stat-comment">',_buf+=this.escape(I18n.t("tasks.show.check_comment")),_buf+='</div><div class="task-answer-form pi pi-form" data-pid="form" data-rails="true">',_buf+=JST["templates/shared/editor"]({name:"task_stat[comment]"}),_buf+=JST["templates/tasks/attachments_form"](),(task=this.task())&&task.allow_incomplete_score){switch(_buf+='<div class="task-stat-score pi" data-component="task_stat_slider"',_skim_codeattributes1=task.score){case!0:_buf+=' data-default-value="data-default-value"';break;case!1:case null:break;default:_buf+=' data-default-value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}
for(_buf+=' data-pid="slider"><input name="task_stat[score]" type="hidden" /><div class="task-stat-score-labels slider-labels posrel">',i=0,len=(ref=task.score_steps()).length;i<len;i++)score_step=ref[i],_buf+="<label>",_buf+=this.escape(score_step),_buf+="</label>";_buf+='</div><div class="task-stat-score-slider"><div class="task-stat-score-slider-thumb slider-thumb"></div></div></div>'}return _buf+='</div><div class="task-buttons"><div class="pi-button-grey button pi" data-on-click="@host.cancel">',_buf+=this.escape(I18n.t("helpers.cancel")),_buf+='</div><div class="pi-button-red decline-btn button pi" data-on-click="@host.submit(&#39;declined&#39;)" data-pid="decline_btn">',_buf+=this.escape(I18n.t("tasks.show.confirm_decline_btn")),_buf+='</div><div class="pi-button-green accept-btn button pi" data-on-click="@host.submit(&#39;accepted&#39;)" data-pid="accept_btn">',_buf+=this.escape(I18n.t("tasks.show.confirm_accept_btn")),_buf+='</div></div></div><div class="task-buttons"><div class="pi-button-red decline-btn button pi" data-on-click="@host.decline">',_buf+=this.escape(I18n.t("tasks.show.decline_btn")),_buf+='</div><div class="pi-button-green accept-btn button pi" data-on-click="@host.accept">',_buf+=this.escape(I18n.t("tasks.show.accept_btn")),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/comment"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="task-comment ',_buf+=this.escape(this.is_author()?"author":void 0),_buf+='"><div class="edit-form is-hidden pi pi-form" data-on-submited="@@update_comment(@host.edit_form)" data-pid="edit_form">',_buf+=JST["templates/shared/editor"]({name:"text",value:this.text,validates:"presence",pid:"text"}),_buf+='<div class="task-buttons"><div class="pi-button-grey button pi" data-on-click="@view.hide_edit_form(@host.host)">',_buf+=this.escape(I18n.t("helpers.cancel")),_buf+='</div><div class="pi-button-green button pi" data-on-click="@host.submit()">',_buf+=this.escape(I18n.t("helpers.save")),_buf+='</div></div></div><div class="pi" data-pid="content"><div class="task-comment-content">',_buf+=JST["templates/shared/avatar_circle"]({avatar_url:this.avatar_url,name:this.username}),_buf+='<div class="task-comment-block"><div class="task-comment-body"><div class="task-comment-author">',_buf+=this.escape(this.username),_buf+='</div><div class="wysiwyg">',_buf+=JST.parseLinks(JST.tough_sanitize(this.text)),_buf+="</div>",_buf+=JST["templates/tasks/attachments"](this),_buf+='</div><div class="task-comment-date">',_buf+=this.escape(this.created_time),_buf+="</div></div>",this.is_comment_author(pi.app.user_id)&&pi.app.role_id>1&&(_buf+='<div class="icon-button pi edit-btn" data-on-click="@view.show_edit_form(@host.host)"><i class="fa fa-pencil"></i></div>'),_buf+="</div></div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/comment_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2;switch(_buf="",_buf+='<form class="task-comment-form pi pi-form" data-on-submited="@@create_comment(@this,',_buf+=this.escape(this.id),_buf+=',e.data)"><div class="task-comment-input pi-text-input-wrap pi" data-validates="presence"><input class="text-input" name="text"',_skim_codeattributes1=I18n.t("tasks.new_comment")){case!0:_buf+=' placeholder="placeholder"';break;case!1:case null:break;default:_buf+=' placeholder="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}switch(_buf+=' type="text" /><div class="errors">',_buf+=this.escape(I18n.t("form.errors.blank")),_buf+='</div></div><input class="pi-button-blue button" type="submit"',_skim_codeattributes2=I18n.t("helpers.send")){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}return _buf+=" /></form>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("tasks.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" "+this.name),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/file_form_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="task-attachment"><i class="task-attachment-icon document-icon ',_buf+=this.escape(this.category||"other"),_buf+='"></i><span class="task-attachment-name">',_buf+=this.escape(this.name),_buf+='</span><span class="task-attachment-del-btn pi" data-on-click="@view.remove_file(@host)">&#x2715;</span></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/result_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="item quiz-stat-item ',_buf+=this.escape(this.success?"is-success":"is-failed"),_buf+=" ",_buf+=this.escape(this.complete?"is-complete":void 0),_buf+=" ",_buf+=this.escape(this.checked?void 0:"is-unchecked"),_buf+='"><div class="field name"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')">',_buf+=this.escape(this.username),_buf+='</a><span class="email">',_buf+=this.escape(this.email||this.phone),_buf+='</span></div><div class="field quiz-name" title="',_buf+=this.escape(this.quiz_name||this.task_name||this.scorm_name),_buf+='">',_buf+=this.escape(this.quiz_name||this.task_name||this.scorm_name),_buf+="</div>","QuizStat"===this.type||"ScormStat"===this.type?(_buf+='<div class="field time-spent">',_buf+=this.time_spent,_buf+="</div>"):_buf+='<div class="field time-spent"></div>',this.checked||"ScormStat"===this.type?(_buf+='<div class="field score-percent">',_buf+=this.escape(this.score+" ("+this.score_percent+"%)"),_buf+="</div>"):_buf+='<div class="field score-percent"></div>',_buf+='<div class="field finished-at">',_buf+=this.finished_time,_buf+='</div><div class="field">',!1!==this.checked||!this.complete&&"TaskStat"!==this.type||(_buf+='<i class="fa not-checked-icon fa-exclamation"></i>'),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/stat_check_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,_skim_codeattributes2,accepting,checked_by_user,checking_comment,last,_this;if(_buf="",last=pi.resources.TaskStat.where({user_id:this.user_id,task_id:this.task_id}).sort(function(a,b){return a.attempt-b.attempt}).slice(-1).pop().id===this.id,accepting="accepted"===this.status,checked_by_user=void 0!==(checking_comment=pi.resources.TaskComment.where({task_stat_id:this.id,accepting:accepting}).sort(function(a,b){return a.created_at-b.created_at}).slice(-1).pop())&&checking_comment.user_id===pi.app.user_id,_buf+='<div class="task-content form"><div class="task-description"><div class="task-header"><h2 class="task-title">',_buf+=this.escape(""+I18n.t("tasks.take.num")+this.attempt),_buf+="</h2>",last&&this.checked&&checked_by_user){switch(_buf+='<div class="wrapper"><div class="task-select-status pi-select-field pi" data-on-changed="@@change_status(e.data, ',_buf+=this.escape(this.id),_buf+=')" data-pid="status"><input type="hidden"',_skim_codeattributes1=this.status){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}if(_buf+=' /><div class="pi placeholder task-status ',_buf+=this.escape(this.status),_buf+='" pid="placeholder"></div><div class="pi list-container pi-select-list is-hidden" pid="dropdown"><ul class="list"><li class="item task-status accepted" data-value="accepted">',_buf+=this.escape(I18n.t("tasks.take.status.accepted")),_buf+='</li><li class="item task-status declined" data-value="declined">',_buf+=this.escape(I18n.t("tasks.take.status.declined")),_buf+="</li></ul></div></div>",this.success&&this.task().allow_incomplete_score){switch(_buf+='<div class="task-select-status pi-select-field pi" data-on-changed="@@change_score(e.data, ',_buf+=this.escape(this.id),_buf+=')" data-pid="score"><input type="hidden"',_skim_codeattributes2=this.score){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes2),_buf+='"'}_buf+=' /><div class="pi placeholder task-status accepted" pid="placeholder"></div><div class="pi list-container pi-select-list is-hidden" pid="dropdown"><ul class="list">',this.task().score_steps().forEach((_this=this,function(step){return _buf+='<li class="item task-status accepted" data-value="',_buf+=_this.escape(step),_buf+='">',_buf+=_this.escape(""+step),_buf+="</li>"})),_buf+="</ul></div></div>"}_buf+="</div>"}else _buf+='<div class="task-status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.status_name),_buf+="</div>";return _buf+='</div><div class="task-comment author"><div class="task-comment-content">',this.offline||(_buf+=JST["templates/shared/avatar_circle"]({avatar_url:this.avatar_url,name:this.username})),_buf+='<div class="task-comment-block full"><div class="task-comment-body ',_buf+=this.escape(this.offline?"full-width":void 0),_buf+='">',this.offline||(_buf+='<div class="task-comment-author">',_buf+=this.escape(this.username),_buf+="</div>"),_buf+='<div class="wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.answer.text)),_buf+="</div>",_buf+=JST["templates/tasks/attachments"](this),_buf+="</div>",this.offline||(_buf+='<div class="task-comment-date">',_buf+=this.escape(this.started_time),_buf+="</div>"),_buf+='</div></div></div><div class="pi pi-list" data-listen-create="true" data-load-rest="true" data-plugins="restful" data-renderer="jst(templates/tasks/comment)" data-rest="TaskComment.where(task_stat_id:',_buf+=this.escape(this.id),_buf+=')"></div>',this.checked?this.can_comment()&&(_buf+=JST["templates/tasks/comment_form"](this)):_buf+=JST["templates/tasks/check_form"](this),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/stat_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="task-content">',(pi.app.course_stat.can_answer||this._persisted)&&(_buf+='<div class="task-description"><div class="task-header"><h2 class="task-title">',_buf+=this.escape(""+I18n.t("tasks.take.num")+this.attempt),_buf+='</h2><div class="task-status ',_buf+=this.escape(this.status),_buf+='">',_buf+=this.escape(this.status_name),_buf+="</div></div>",this._persisted?(_buf+='<div class="task-comment author"><div class="task-comment-content">',_buf+=JST["templates/shared/avatar_circle"]({avatar_url:this.avatar_url,name:this.username}),_buf+='<div class="task-comment-block full"><div class="task-comment-body"><div class="task-comment-author">',_buf+=this.escape(this.username),_buf+='</div><div class="wysiwyg">',_buf+=JST.parseLinks(JST.sanitize(this.answer.text)),_buf+="</div>",_buf+=JST["templates/tasks/attachments"](this),_buf+='</div><div class="task-comment-date">',_buf+=this.escape(this.started_time),_buf+='</div></div></div></div><div class="pi pi-list" data-listen-create="true" data-load-rest="true" data-plugins="restful" data-renderer="jst(templates/tasks/comment)" data-rest="TaskComment.where(task_stat_id:',_buf+=this.escape(this.id),_buf+=')"></div>',this.can_comment()&&(_buf+=JST["templates/tasks/comment_form"](this))):_buf+=JST["templates/tasks/submit_form"](this),_buf+="</div>"),_buf+="</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/submit_form"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;switch(_buf="",_buf+='<form class="task-answer-form pi pi-form" data-on-submited="@@submit(@host.record,e.data)" data-pid="form" data-rails="true"><progress-wrapper><div class="pi pi-progressbar is-hidden" data-pid="loader"></div></progress-wrapper><div class="title">',_buf+=this.escape(I18n.t("quizzes.view.helpers.open_answer_title")),_buf+="</div>",_buf+=JST["templates/shared/editor"]({name:"answer[text]",validates:"presence",pid:"text"}),_buf+=JST["templates/tasks/attachments_form"](),_buf+='<div class="task-buttons"><input class="pi pi-button-blue button is-disabled" data-component="base_input" data-pid="submit_btn" type="submit"',_skim_codeattributes1=I18n.t("tasks.take.submit_btn")){case!0:_buf+=' value="value"';break;case!1:case null:break;default:_buf+=' value="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}return _buf+=" /></div></form>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tasks/task_stat_list_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<li class="task-stats-list-item item ',_buf+=this.escape(this.checked?void 0:"unchecked"),_buf+='"><div class="field name select-text ellipses"><div class="dotted-link">',_buf+=this.escape(this.username),_buf+='</div></div><div class="field created-at">',_buf+=this.escape(this.started_time),_buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tokens"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+="<div>I18n.t('users.last_name')I18n.t('users.name')I18n.t('users.email')I18n.t('users.phone')I18n.t('users.password')I18n.t('reports.questions.question_name')I18n.t('reports.questions.success_percent')I18n.t('reports.questions.unsuccess_percent')I18n.t('reports.questions.score_percent_avg')I18n.t('reports.questions.success_count')I18n.t('reports.questions.unsuccess_count')I18n.t('reports.questions.score_avg')I18n.t('reports.questions.time_spent')I18n.t('tours.next')I18n.t('tours.skip')I18n.t('tours.back')I18n.t('date.formats.default')I18n.t('labels.messages.filter_save')I18n.t('http_error.app_error')I18n.t('widget.powered_by')</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/add_user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,group_id,label,label_id,ref;if(_buf="",_buf+='<li class="item"><div class="field email" title="',_buf+=this.escape(this.login),_buf+='">',_buf+=this.escape(this.login),_buf+='</div><div class="field role">',2===this.role_id?_buf+=this.escape(I18n.t("users.specialist")):3===this.role_id?_buf+=this.escape(I18n.t("users.mentor")):4===this.role_id&&(_buf+=this.escape(I18n.t("users.manager"))),_buf+='</div><div class="labels">',this.labels)for(group_id in ref=this.labels)label_id=ref[group_id],(label=$r.Label.get(label_id))&&(_buf+='<div class="user-label" data-group-id="',_buf+=this.escape(group_id),_buf+='" data-id="',_buf+=this.escape(label_id),_buf+='">',_buf+=this.escape(label.name),_buf+='<a class="link-button delete-label fa fa-times" href="@@delete_label(',_buf+=this.escape(this.id),_buf+=",",_buf+=this.escape(group_id),_buf+=",",_buf+=this.escape(label_id),_buf+=')"></a></div>');return _buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/all_notification_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.confirm.all_notification")),_buf+="?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/destroy_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.confirm.destroy")),_buf+='<span class="name">',_buf+=this.escape(" ("+this.users.length+")"),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/info"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="user-info"><div class="fullname inline"><p class="name">',_buf+=this.escape(""+this.name),_buf+='</p><p class="name">',_buf+=this.escape(""+this.last_name),_buf+='</p></div><div class="avatar inline">',this.avatar_url?(_buf+='<img class="avatar-img" src="',_buf+=this.escape(this.avatar_url),_buf+='" title="',_buf+=this.escape(this.fullname),_buf+='" />'):(_buf+='<div class="avatar-letter">',_buf+=this.escape(""+(this.name[0]||"").toUpperCase()+(this.last_name[0]||"").toUpperCase()),_buf+="</div>"),_buf+="</div></div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/lock_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.confirm.lock")),_buf+='<span class="name">',_buf+=this.escape(" ("+this.users.length+")"),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/mentored_user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,group_id,label,label_id,ref;if(_buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='"><a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+="</a>",!1===this.active&&(_buf+='<span class="no-active">',_buf+=this.escape(""+I18n.t("users.inactive")),_buf+="</span>"),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),this.email&&!this.email_verified){switch(_buf+='<span class="email-not-verified"',_skim_codeattributes1=I18n.t("users.email_not_verified_message")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+='><i class="fa fa-envelope-o"></i></span>'}if(_buf+='</div><div class="field activity">',_buf+=this.escape(this.last_activity),_buf+='</div><div class="field role">',this.role_id>1&&(_buf+=this.escape(this.role_name)),_buf+='</div><div class="labels">',this.labels)for(group_id in ref=this.labels)label_id=ref[group_id],(label=$r.Label.get(label_id))&&(_buf+='<div class="user-label" data-group-id="',_buf+=this.escape(group_id),_buf+='" data-id="',_buf+=this.escape(label_id),_buf+='">',_buf+=this.escape(label.name),_buf+="</div>");return _buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/notification_confirm"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div class="message-content">',_buf+=this.escape(I18n.t("users.confirm.notification")),_buf+='<span class="name">',_buf+=this.escape(" ("+this.users.length+")"),_buf+="</span>?</div>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/select_user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1;if(_buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),this.email&&!this.email_verified){switch(_buf+='<span class="email-not-verified"',_skim_codeattributes1=I18n.t("users.email_not_verified_message")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+='><i class="fa fa-envelope-o"></i></span>'}return _buf+='</div><i class="fa fa-check"></i></li>'})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/users/user_item"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf,_skim_codeattributes1,group_id,label,label_id,ref;if(_buf="",_buf+='<li class="item"><div class="field name" title="',_buf+=this.escape(this.fullname),_buf+='">',this.is_locked&&(_buf+='<span class="is-locked"><i class="fa fa-lock"></i></span>'),_buf+='<a class="link" href="@@show(',_buf+=this.escape(this.id),_buf+=')" title="',_buf+=this.escape(this.fullname),_buf+='">',_buf+=this.escape(this.fullname),_buf+="</a>",!1===this.active&&(_buf+='<span class="no-active">',_buf+=this.escape(""+I18n.t("users.inactive")),_buf+="</span>"),_buf+='</div><div class="field email" title="',_buf+=this.escape(this.email||this.phone),_buf+='">',_buf+=this.escape(this.email||this.phone),this.email&&!this.email_verified){switch(_buf+='<span class="email-not-verified"',_skim_codeattributes1=I18n.t("users.email_not_verified_message")){case!0:_buf+=' title="title"';break;case!1:case null:break;default:_buf+=' title="',_buf+=this.escape(_skim_codeattributes1),_buf+='"'}_buf+='><i class="fa fa-envelope-o"></i></span>'}if(_buf+='</div><div class="field activity">',_buf+=this.escape(this.last_activity),_buf+='</div><div class="field role">',this.role_id>1&&(_buf+=this.escape(this.role_name)),_buf+='</div><div class="labels">',this.labels)for(group_id in ref=this.labels)label_id=ref[group_id],(label=$r.Label.get(label_id))&&(_buf+='<div class="user-label" data-group-id="',_buf+=this.escape(group_id),_buf+='" data-id="',_buf+=this.escape(label_id),_buf+='">',_buf+=this.escape(label.name),_buf+='<a class="link-button delete-label fa fa-times" href="@@delete_label(',_buf+=this.escape(this.id),_buf+=",",_buf+=this.escape(group_id),_buf+=",",_buf+=this.escape(label_id),_buf+=')"></a></div>');return _buf+="</div></li>"})}}.call(this)}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/widget"]=function(){return function(context){return null==context&&(context={}),(context.Skim||Skim).withContext.call({},context,function(){var _buf;return _buf="",_buf+='<div id="tb_widget"><script src="http://',_buf+=this.escape(this.params.host),_buf+="/libs/assets/javascripts/widget.js?",_buf+=this.escape(this.params.version),_buf+='" type="text/javascript"></script><script>new TBWidget({type: \'',_buf+=this.escape(this.params.type),_buf+="', resourceId: '",_buf+=this.escape(this.params.resource_id),_buf+="', accountId: '",_buf+=this.escape(this.params.account_id),_buf+="', orientation: '",_buf+=this.escape(this.params.orientation),_buf+="', host: 'http://",_buf+=this.escape(this.params.host),_buf+='\'});</script><a href="http://teachbase.ru?utm_source=widget" id="tb_link" target="_blank">',_buf+=this.escape(I18n.t("widget.powered_by")),_buf+="</a></div>"})}}.call(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.TBResource=function(superClass){function TBResource(){return TBResource.__super__.constructor.apply(this,arguments)}return extend(TBResource,superClass),TBResource.prototype.wrap_attributes=!0,TBResource.routes_scope("/api/:path.json"),TBResource.prototype.path=function(route,params,target){return null==target&&(target=this),params=utils.extend(params,{resources:this.constructor.resources_name,resource:this.constructor.resource_name}),this.constructor._interpolate_path(route,params,target)},TBResource}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminResource=function(superClass){function AdminResource(){return AdminResource.__super__.constructor.apply(this,arguments)}return extend(AdminResource,superClass),AdminResource.prototype.wrap_attributes=!0,AdminResource.routes_scope("/api/admin/:path.json"),AdminResource}(pi.resources.REST)}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.UploadMethod=function(){function UploadMethod(){}return UploadMethod.extended=function(klass){return klass.include(this)},UploadMethod.included=function(){return!0},UploadMethod.has_upload_method=function(name,path,options){var base,klass;if(null==options&&(options={}),base=!0===options.member?this.prototype:this,klass=this,base[name]=function(form,params,progress,xhr){var upload_path;return upload_path=klass._interpolate_path(path,utils.extend(params,{resources:klass.resources_name,resource:klass.resource_name}),this),klass._upload_(upload_path,form,params,progress,xhr,base,name)},!0===options.creates)return base["on_"+name]=function(response){var i,len,ref;if(null!=klass.__deps__)for(i=0,len=(ref=klass.__deps__).length;i<len;i++)ref[i].from_data(response);return klass.from_data(response)}},UploadMethod._upload_=function(path,form,params,progress,xhr,target,name){var fun,_this;return pi.net.XHR_UPLOAD?fun=utils.curry(pi.net.upload,[path,params,{progress:progress},xhr],pi.net):(params.authenticity_token=window.AUTH_TOKEN,fun=utils.curry(pi.net.iframe_upload,[form,path,params],pi.net)),fun().then(function(response){if(Array.isArray(response))throw Error(response.join(", "));return null!=target["on_"+name]&&target["on_"+name](response),response},(_this=this,function(error){throw _this.error(error.message),error}))},UploadMethod}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.User=function(superClass){function User(){return User.__super__.constructor.apply(this,arguments)}return extend(User,superClass),User.LISTENER=1,User.SPECIALIST=2,User.MENTOR=3,User.MANAGER=4,User.set_resource("users"),User.extend(pi.resources.Query,pi.resources.UploadMethod),User.routes({collection:[{action:"create_labels",path:":resources/labels",method:"post"},{action:"destroy_labels",path:":resources/labels",method:"delete"},{action:"invite",path:":resources",method:"post"},{action:"destroy_all",path:":resources/destroy_all",method:"delete"},{action:"activation_notification",path:":resources/activation_notification",method:"post"},{action:"all_activation_notification",path:":resources/all_activation_notification",method:"get"},{action:"transfer_ownership",path:":resources/transfer_ownership",method:"patch"},{action:"mail",path:":resources/messages/send_messages",method:"post"},{action:"update_role",path:":resources/update_role",method:"patch"},{action:"import_from_ad",path:":resources/import_from_ad",method:"post"},{action:"mentorized_index",path:":resources/mentorized_index",method:"get"},{action:"lock",path:":resources/lock",method:"post"},{action:"unlock",path:":resources/unlock",method:"post"},{action:"coach_summary_report",path:":resources/coach_summary_report",method:"post"}]}),User.routes({member:[{action:"update_profile",path:":resources/:id/profile",method:"post"},{action:"reconfirmation_email",path:":resources/:id/reconfirmation_email",method:"get"},{action:"remove_provider",path:":resources/:provider/remove_provider",method:"delete"},{action:"update_congregations",path:":resources/:id/congregations",method:"post"}]}),User.has_upload_method("import",":resources/import"),User.params("name","avatar","last_name","fullname","email","labels","password","password_confirmation","notice_email","lang","notice_status","timezone","email_verified","phone","auth_type"),User.after_save(function(user){return user.password=user.password_confirmation=""}),User.on_destroy_all=function(response){var i,len,ref,results,user_id;for(results=[],i=0,len=(ref=response.users).length;i<len;i++)user_id=ref[i],results.push(this.remove_by_id(user_id));return results},User.prototype.on_update_profile=function(response){return null!=response.user&&(pi.app.user=$r.User.build(response.user)),{user:response.user,message:response.message}},User.prototype.on_remove_provider=function(response){return null!=response.user&&this.set({providers:response.user.providers}),{user:response.user,message:response.message}},User.prototype.on_reconfirmation_email=function(response){return{message:response.message}},User.prototype.local_avatar=function(url){return this.set({avatar_url:url,avatar_large_url:url})},User.prototype.role_tours=function(){return this.role_id&&this.role_id>1?this.visited_tours[1]:this.visited_tours[0]},User.prototype.has_tour=function(code){return code|=0,utils.info("visited_tours: "+Number("0x"+this.role_tours())+"; code: "+code+"; local: "+this.has_local_tour(code)),code>100&&this.has_local_tour(code)||code<100&&this.role_tours()&&(Number("0x"+this.role_tours())&Math.pow(2,code))>0},User.prototype.has_local_tour=function(code){return!!localStorage.getItem(this._local_key(code))},User.prototype.commit_tour=function(tour){return tour.temporary?this.commit_locally_tour(tour):tour.commit_visit()["catch"](utils.error).then((_this=this,function(data){if(null!=data?data.user:void 0)return _this.visited_tours=data.user.visited_tours}));var _this},User.prototype.commit_locally_tour=function(tour){return localStorage.setItem(this._local_key(tour.code),"1")},User.prototype._local_key=function(code){return"tb:"+this.id+":tours:"+this.role_id+":"+code},User}(pi.resources.TBResource)}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.ActAsList=function(){function ActAsList(){}return ActAsList.extended=function(klass){return klass.routes({member:[{action:"move",path:":resources/:id/move",method:"post"}]}),klass.prototype.act_as_list=!0,klass.include(this)},ActAsList.included=function(){return!0},ActAsList.prototype.move_delay=1500,ActAsList.prototype.moved=function(position){return null!=this._move_tid&&clearTimeout(this._move_tid),this._move_tid=after(this.move_delay,(_this=this,function(){return utils.info(utils.camelCase(_this.constructor.resource_name)+":"+_this.id+" moved from "+_this._snapshot.position+" to "+position),_this.move({position:position})}));var _this},ActAsList}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ActAsListScope=function(){function ActAsListScope(){}return ActAsListScope.extended=function(klass){return klass.include(this)},ActAsListScope.included=function(){return!0},ActAsListScope.act_as_scope_for=function(name){return this.prototype["on_"+name+"_update"]=function(type,data){var collection,ref;if(collection="function"==typeof this[name]&&null!=(ref=this[name]())?ref.all():void 0)return"destroy"===type&&null!=(null!=data?data.position:void 0)?this._update_positions_in_range(collection,data.position,collection.length,-1):void 0}},ActAsListScope.prototype._get_index=function(target,to,size){var index
;return(index="down"===to?target.position-1:"up"===to?target.position+1:0|to)>size?index=size:index<1&&(index=1),index},ActAsListScope.prototype._update_positions=function(collection,target,index){var left,right,sign;return target.position>index?(left=index,right=target.position,sign=1):(left=target.position,right=index,sign=-1),target.set({position:index}),this._update_positions_in_range(collection,left,right,sign,target)},ActAsListScope.prototype._update_positions_in_range=function(collection,left,right,sign,target){var i,item,len,results;for(results=[],i=0,len=collection.length;i<len;i++)(item=collection[i])===target||item.position<left||item.position>right||results.push(item.set({position:item.position- -1*sign}));return results},ActAsListScope.prototype.move_element=function(item,to){var association,collection,index,resources_name;if(null!=(association="function"==typeof this[resources_name=item.constructor.resources_name]?this[resources_name]():void 0)&&(collection=association.all(),index=this._get_index(item,to,collection.length),item.position!==index))return this._update_positions(collection,item,index),item.moved(index)},ActAsListScope}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Assignable=function(){function Assignable(){}return Assignable.extended=function(klass){return"function"!=typeof klass.has_many&&klass.extend(pi.resources.HasMany),klass.has_many("participants",{source:pi.resources.User,params:["changed","role_id"],attribute:!0,route:!0})},Assignable.included=function(){return!0},Assignable}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.WithContext=function(){function WithContext(){}return WithContext.extended=function(klass){return klass.include(this)},WithContext.included=function(){return!0},WithContext.set_context=function(resources){return this.routes_scope(this._rscope.replace("/api","/api/"+resources+"/:"+resources.slice(0,-1)+"_id"))},WithContext.set_index_context=function(resources,action,path){return null==action&&(action="fetch"),null==path&&(path=""),this.routes({collection:[{action:action,path:resources+"/:"+resources.slice(0,-1)+"_id/:resources"+path,method:"get"}]}),this.query_path=this.fetch_path},WithContext.set_index_namespace=function(namespace,action,path){return null==action&&(action="fetch"),null==path&&(path=""),this.routes({collection:[{action:action,path:namespace+"/:resources"+path,method:"get"}]}),this.query_path=this.fetch_path},WithContext.set_shallow_context=function(resources,param_name){var prefix;return resources&&(resources+="/"),param_name||(param_name=":"+resources.slice(0,-1)+"_id"),prefix=""+resources+param_name,this.routes({collection:[{action:"fetch",path:prefix+"/:resources",method:"get"},{action:"create",path:prefix+"/:resources",method:"post"}]}),this.query_path=this.fetch_path},WithContext}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AnswerStat=function(superClass){function AnswerStat(){return AnswerStat.__super__.constructor.apply(this,arguments)}return extend(AnswerStat,superClass),AnswerStat.set_resource("answer_stats"),AnswerStat.routes({member:[{action:"check",path:":resources/:id/check",method:"patch"}]}),AnswerStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.QuizStat=function(superClass){function QuizStat(){return QuizStat.__super__.constructor.apply(this,arguments)}return extend(QuizStat,superClass),QuizStat.extend(pi.resources.WithContext),QuizStat.set_resource("quiz_stats"),QuizStat.routes({member:[{action:"track",path:":resources/:id/track",method:"post"}],collection:[{action:"fetch",path:"courses/:course_id/:resources",method:"get"},{action:"bulk_recount",path:":resources/bulk_recount",method:"post"}]}),QuizStat.extend(pi.resources.HasMany,pi.resources.Query),QuizStat.has_many("answer_stats",{source:$r.AnswerStat,belongs_to:!0,destroy:!0,route:!0}),QuizStat.prototype.on_load_answer_stats=function(data){return this.answer_stats_loaded=!0,null!=data.answer_stats&&this.answer_stats().load(data.answer_stats),null!=data.questions&&$r.Question.load(data.questions),data},QuizStat.prototype.quiz=function(){if(this.quiz_id)return $r.Quiz.get(this.quiz_id)},QuizStat.prototype.correct_data=function(recount){var data,i,len,ref,sum;if(null==recount&&(recount=!1),this._correct_data&&!recount)return this._correct_data;if(this._can_count_correct()&&this._show_answers()){for((data={}).total_num=this.quiz().effective_questions_count,sum=0,i=0,len=(ref=this.answer_stats().all()).length;i<len;i++)ref[i].success&&sum++;return data.correct_num=sum,data.incorrect_num=data.total_num-data.correct_num,data.correct_percent=100*data.correct_num/data.total_num|0,data.incorrect_percent=100*data.incorrect_num/data.total_num|0,this._correct_data=data}},QuizStat.prototype._can_count_correct=function(){return!(!this.quiz()||!this.quiz().questions().all().length||!this.answer_stats().all().length)},QuizStat.prototype._show_answers=function(){return"1"===this.quiz().show_answers},QuizStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Question=function(superClass){function Question(){return Question.__super__.constructor.apply(this,arguments)}return extend(Question,superClass),Question.SHORT="short_answer",Question.MULTIPLE_CHOICE="multiple_choice",Question.SINGLE_CHOICE="single_choice",Question.OPEN_ANSWER="open_answer",Question.MATCH="match_question",Question.POSITION="position_question",Question.TRUE_FALSE="true_false_question",Question.NUMERIC="numeric_question",Question.set_resource("questions"),Question.params("id","name","course_id","quiz_id","type","incomplete_answer","has_attachment","score",{data:["name","correct","left","right"]}),Question.can_create($r.AnswerStat,$r.QuizStat),Question.routes({member:[{action:"create",path:"quizzes/:quiz_id/:resources",method:"post"},{action:"recount",path:":resources/:id/recount",method:"patch"},{action:"submit",path:"course_sessions/:course_session_id/:resources/:id/submit",method:"patch"},{action:"track",path:"course_sessions/:course_session_id/:resources/:id/track",method:"post"},{action:"copy",path:":resources/:id/copy",method:"post"}],collection:[{action:"fetch",path:"quizzes/:quiz_id/:resources",method:"get"},{action:"take",path:"course_sessions/:course_session_id/:resources/:id/take",method:"get"},{action:"view",path:"course_sessions/:course_session_id/:resources/:id/view",method:"get"},{action:"update_category",path:"quizzes/:quiz_id/:resources/update_category",method:"patch"}]}),Question.extend(pi.resources.Query,pi.resources.ActAsList,pi.resources.HasOne),Question.has_one("stat",{source:$r.AnswerStat,belongs_to:!0,update_if:function(e,el){return!0===el.complete}}),Question.after_initialize(function(){return this.course_session_id=pi.app.course_session_id}),Question.class_alias("on_take","on_show"),Question.class_alias("on_view","on_show"),Question.find_for_session=function(session_id,id){var q;return null!=(q=this.get(id))?Promise.resolve(q):this.view({course_session_id:session_id,id:id})},Question.prototype.on_copy=function(data){return null!=data.question&&this.constructor.build(data.question),data},Question.prototype.on_update=function(data){return this.on_all(data),this.need_recount=!!data.recount,{question:this,quiz:data.quiz}},Question.prototype.fetch_match_answer=function(stat,key){var ref1,ref2;return null!=stat&&(!(!(ref1=stat.answer.data.filter(function(opt){return opt.left===key})).length||(key=ref1[0].right,!(ref2=(this.data.right||this.data).filter(function(opt){return opt.right_key===key})).length))&&ref2[0])},Question.prototype.fetch_position_answer=function(stat,index){var key,ref;return null!=stat&&stat.answer.data.length>index&&(key=stat.answer.data[index],!!(ref=this.data.filter(function(opt){return opt.key===key})).length&&ref[0])},Question}(pi.resources.TBResource),$r.AnswerStat.can_create(pi.resources.Question)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.QuestionCategory=function(superClass){function QuestionCategory(){return QuestionCategory.__super__.constructor.apply(this,arguments)}return extend(QuestionCategory,superClass),QuestionCategory.set_resource("question_categories","question_category"),QuestionCategory.routes({member:[{action:"create",path:"quizzes/:quiz_id/:resources",method:"post"}]}),QuestionCategory.extend(pi.resources.HasMany),QuestionCategory.has_many("questions",{source:pi.resources.Question,belongs_to:!0}),QuestionCategory}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.Quiz=function(superClass){function Quiz(){return Quiz.__super__.constructor.apply(this,arguments)}return extend(Quiz,superClass),Quiz.set_resource("quizzes","quiz"),Quiz.routes({member:[{action:"create",path:"sections/:section_id/:resources",method:"post"},{action:"recount",path:":resources/:id/recount",method:"patch"},{action:"copy",path:":resources/:id/copy",method:"post"}],collection:[{action:"fetch",path:"courses/:course_id/:resources",method:"get"}]}),Quiz.extend(pi.resources.Query,pi.resources.ActAsList,pi.resources.HasMany,pi.resources.ActAsListScope),Quiz.extend(pi.resources.UploadMethod),Quiz.act_as_scope_for("questions"),Quiz.params("id","name","course_id","section_id","position","time_limit","passing_grade","show_answers","show_results","attempts","navigation","grading_method","pool_size","show_correct_answers_only","disable_on_mobile"),Quiz.has_many("questions",{source:pi.resources.Question,belongs_to:!0,destroy:!0,route:!0,update_if:function(type){return"destroy"===type}}),Quiz.has_many("question_categories",{source:pi.resources.QuestionCategory,belongs_to:!0,route:!0}),Quiz.has_many("quiz_stats",{source:pi.resources.QuizStat,belongs_to:!0}),Quiz.has_upload_method("upload_gift",":resources/:id/gift",{creates:!0,member:!0}),Quiz.can_create($r.Question),Quiz.after_initialize(function(){return this.user=pi.app.user,this.course_session_id=pi.app.course_session_id,this.course_stat=pi.app.course_stat}),Quiz.prototype.set_flags=function(){return this.has_attempts=!!this.grading_method,this.has_time_limit=!!this.time_limit,this.has_passing_grade=!!this.passing_grade,this.grading_method||(this.grading_method="highest"),this.pool_size||(this.pool_size=this.questions_num),this.navigation=null!=this.navigation?this.navigation:1},Quiz.after_update(Quiz.prototype.set_flags),Quiz.prototype.on_copy=function(data){return null!=data.quiz&&this.constructor.build(data.quiz),data},Quiz.prototype.on_update=function(data){return this.on_all(data),this.need_recount=!!data.recount,this},Quiz.prototype.stat_for_user=function(id){var len,ref,sort_key,stats;if(len=(stats=this.quiz_stats().where({user_id:id})).length)return 1===len?stats[0]:(ref=stats.slice(),sort_key="latest"===this.grading_method?"finished_at":"score",utils.sort_by(ref,sort_key,"desc"),ref[0])},Quiz.prototype.stat_for_user_by_session=function(id,course_session_id){var len,ref,sort_key,stats;if(len=(stats=this.quiz_stats().where({user_id:id,course_session_id:course_session_id})).length)return 1===len?stats[0]:(ref=stats.slice(),sort_key="latest"===this.grading_method?"finished_at":"score",utils.sort_by(ref,sort_key,"desc"),ref[0])},Quiz.prototype.weight_percent=function(){var course,sum;return null!=this._weight_percent?this._weight_percent:(course=$r.Course.get(this.course_id))?(sum=course.weights_sum(),this._weight_percent=100*this.weight/sum|0):void 0},Quiz.prototype.max_score=function(){var total;return this.questions().all().length?(total=this.questions().all().reduce(function(acc,q){return acc+q.score},0),this.is_pool()?this.pool_max_score(total):total):this.is_pool()&&this.questions_num?this.pool_size:this.total_score},Quiz.prototype.pool_max_score=function(total){var category,i,len1,ref1,score_count;if(this.question_categories().all().length){for(score_count=0,i=0,len1=(ref1=this.question_categories().all()).length;i<len1;i++)score_count+=(category=ref1[i]).pool_size*category.score;return score_count}return this.pool_size/this.questions().all().length*total},Quiz.prototype.is_pool=function(){return 2===this.navigation&&this.pool_size},Quiz.prototype.stat=function(){return this.stat_for_user(this.user.id)},Quiz.prototype.attempts_made=function(){return this.quiz_stats().where({complete:!0}).length},Quiz.prototype.attempts_available=function(){return!1===this.course_stat.can_take?0:Math.max(this.attempts-this.attempts_made(),0)},Quiz.prototype.view_path=function(){return this.course_session_id?"/course_sessions/"+this.course_session_id+"/quizzes/"+this.id+"/view":"/courses/"+this.course_id+"/quizzes/"+this.id},Quiz.prototype.new_view_path=function(){return this.course_session_id?"/viewer/courses/"+this.course_id+"/quizzes/"+this.id+"?returnUrl=/course_sessions/"+this.course_session_id+"&sessionId="+this.course_session_id:"/viewer/courses/"+this.course_id+"/quizzes/"+this.id},Quiz.prototype.export_path=function(){return"/courses/"+this.course_id+"/quizzes/"+this.id+"/export"},Quiz.prototype.take_path=function(){return"/course_sessions/"+this.course_session_id+"/quizzes/"+this.id+"/take"},Quiz}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.MaterialStat=function(superClass){function MaterialStat(){return MaterialStat.__super__.constructor.apply(this,arguments)}return extend(MaterialStat,superClass),MaterialStat.set_resource("material_stats"),MaterialStat}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Material=function(superClass){function Material(){return Material.__super__.constructor.apply(this,arguments)}return extend(Material,superClass),Material.extend($r.WithContext),Material.set_resource("materials"),Material.routes({member:[{action:"create",path:"sections/:section_id/:resources",method:"post"},{action:"track",path:"course_sessions/:course_session_id/:resources/:id/track",method:"post"},{action:"take",path:"course_sessions/:course_session_id/:resources/:id/take",method:"get"},{action:"view",path:"course_sessions/:course_session_id/:resources/:id/view",method:"get"},{action:"demo",path:":resources/:id/demo",method:"get"},{action:"show",path:":resources/:id",method:"get"}]}),Material.extend(pi.resources.Query,pi.resources.ActAsList,pi.resources.HasOne),Material.params("name","description","file","temp_file_id","external","external_type","file_name","external_file_type","external_thumb","external_class"),Material.has_one("stat",{source:$r.MaterialStat,foreign_key:"material_id",update_if:function(e,el){return!0===el.complete}}),Material.can_create($r.MaterialStat),Material.after_initialize(function(){return this.course_session_id=pi.app.course_session_id}),Material.prototype.is_expired=function(){return"netology"===this.external_type&&!(this.expiring_url&&this.expires_in>+new Date)},Material.prototype.view_expiring=function(){var _this;return this.is_expired()?(null!=this.course_session_id?this.view():this.constructor.show({id:this.id})).then((_this=this,function(){return _this.expires_in=+new Date+3e5})):Promise.resolve()},Material.prototype.take_expiring=function(){return this.is_expired()?this.take().then((_this=this,function(){return _this.expires_in=+new Date+3e5})):Promise.resolve();var _this},Material.prototype.demo_expiring=function(){return this.is_expired()?this.demo().then((_this=this,function(){return _this.expires_in=+new Date+3e5})):Promise.resolve();var _this},Material.prototype.view_path=function(){return this.course_session_id?"/course_sessions/"+this.course_session_id+"/view?material_id="+this.id+"#id="+this.id:"/courses/"+this.course_id+"/view#id="+this.id},Material.prototype.new_view_path=function(){return this.course_session_id?"/viewer/courses/"+this.course_id+"/materials/"+this.id+"?returnUrl=/course_sessions/"+this.course_session_id+"&sessionId="+this.course_session_id:"/viewer/courses/"+this.course_id+"/materials/"+this.id},Material.prototype.take_path=function(){return"/course_sessions/"+this.course_session_id+"/take?material_id="+this.id+"#id="+this.id},Material}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Attachment=function(superClass){function Attachment(){return Attachment.__super__.constructor.apply(this,arguments)}return extend(Attachment,superClass),Attachment.set_resource("attachments"),Attachment}(pi.resources.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.TaskComment=function(superClass){function TaskComment(){return TaskComment.__super__.constructor.apply(this,arguments)}return extend(TaskComment,superClass),TaskComment.routes_scope("/api/task_stats/:task_stat_id/:path.json"),TaskComment.set_resource("comments"),TaskComment.extend(pi.resources.Query),TaskComment.params("text","meta","attachments_attributes"),TaskComment.prototype.task_stat=function(){if(this.task_stat_id)return $r.TaskStat.get(this.task_stat_id)},TaskComment.prototype.is_author=function(){var ref;return(null!=(ref=this.task_stat())?ref.user_id:void 0)===this.user_id},TaskComment.prototype.is_comment_author=function(user_id){return this.user_id===user_id},TaskComment}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.TaskStat=function(superClass){function TaskStat(){return TaskStat.__super__.constructor.apply(this,arguments)}return extend(TaskStat,superClass),TaskStat.extend(pi.resources.WithContext),TaskStat.set_resource("task_stats"),TaskStat.extend(pi.resources.Query,pi.resources.HasMany),TaskStat.routes({member:[{action:"create",path:"tasks/:task_id/:resources",method:"post"},{action:"accept",path:":resources/:id/accept",method:"patch"},{action:"decline",path:":resources/:id/decline",method:"patch"}],collection:[{action:"latest",path:":resources/latest",method:"get"}]}),TaskStat.has_many("comments",{source:pi.resources.TaskComment,belongs_to:!0,destroy:!0}),TaskStat.prototype.save=function(){return pi.Net.use_json=!1,TaskStat.__super__.save.apply(this,arguments).then(function(){return pi.Net.use_json=!0})["catch"](function(e){throw pi.Net.use_json=!0,e})},TaskStat.prototype.offline_checking=function(params,accepting){return params.course_session_id=this.course_session_id,params.user_id=this.user_id,params.task_id=this.task_id,params.accepting=accepting,pi.Net.patch("/api/task_stats/offline_check",params)},TaskStat.prototype.view_path=function(){return pi.app.course_session_id?"/course_sessions/"+this.course_session_id+"/tasks/"+this.task_id+"#user_id="+this.user_id+"&session_id="+this.course_session_id:"/courses/"+this.course_id+"/tasks/"+this.task_id+"#user_id="+this.user_id+"&session_id="+this.course_session_id},TaskStat.prototype.result_view_path=function(){return pi.app.course_session_id||this.course_session_id?"/course_sessions/"+this.course_session_id+"/tasks/"+this.task_id+"/view#user_id="+this.user_id+"&session_id="+this.course_session_id:"/courses/"+this.course_id+"/tasks/"+this.task_id+"#user_id="+this.user_id+"&session_id="+this.course_session_id},TaskStat.prototype.task=function(){if(this.task_id)return $r.Task.get(this.task_id)},TaskStat.prototype.can_comment=function(){return!!this._persisted&&this.attempt===$r.TaskStat.where({user_id:this.user_id,course_session_id:this.course_session_id,task_id:this.task_id,_persisted:!0}).length},TaskStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var TOTAL_STEPS,pi,utils;pi=context.pi,utils=pi.utils,TOTAL_STEPS=10,pi.resources.Task=function(superClass){function Task(){return Task.__super__.constructor.apply(this,arguments)}return extend(Task,superClass),Task.set_resource("tasks"),Task.routes({member:[{action:"create",path:"sections/:section_id/:resources",method:"post"}],collection:[{action:"fetch",path:"courses/:course_id/:resources",method:"get"}]}),Task.extend(pi.resources.Query,pi.resources.ActAsList,pi.resources.ActAsListScope,pi.resources.HasMany),Task.has_many("stats",{source:pi.resources.TaskStat,belongs_to:!0}),Task.params("id","name","score","description","attachment_attributes","required"),Task.after_initialize(function(){return this.course_session_id=pi.app.course_session_id}),Task.prototype.stat_for_user=function(id){var len,ref,stats;if(len=(stats=this.stats().where({user_id:id})).length)return 1===len?stats[0]:(ref=stats.slice(),utils.sort_by(ref,"attempt","desc"),ref[0])},Task.prototype.stat_for_user_by_session=function(id,course_session_id){var len,ref,stats;if(len=(stats=this.stats().where({user_id:id,course_session_id:course_session_id})).length)return 1===len?stats[0]:(ref=stats.slice(),utils.sort_by(ref,"attempt","desc"),ref[0])},Task.prototype.score_steps=function(){return this._score_steps||(this._score_steps=function(score){var i,steps,total_steps;for(steps=[],i=total_steps=Math.min(TOTAL_STEPS,score);i>0;)steps.unshift(Math.floor(i/total_steps*score)),i--;return steps}(this.score))},Task.prototype.save=function(){return pi.Net.use_json=!1,Task.__super__.save.apply(this,arguments).then(function(task){return $r.SectionContent.build(task.section_content),pi.Net.use_json=!0})["catch"](function(e){throw pi.Net.use_json=!0,e})},Task.prototype.view_path=function(){return this.course_session_id?"/course_sessions/"+this.course_session_id+"/tasks/"+this.id+"/view":"/courses/"+this.course_id+"/tasks/"+this.id},Task.prototype.new_view_path=function(){return this.course_session_id?"/viewer/courses/"+this.course_id+"/tasks/"+this.id+"?returnUrl=/course_sessions/"+this.course_session_id+"&sessionId="+this.course_session_id:"/viewer/courses/"+this.course_id+"/tasks/"+this.id},Task.prototype.take_path=function(){return"/course_sessions/"+this.course_session_id+"/tasks/"+this.id+"/take"},Task}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ScormStat=function(superClass){function ScormStat(){return ScormStat.__super__.constructor.apply(this,arguments)}return extend(ScormStat,superClass),ScormStat.extend(pi.resources.WithContext),ScormStat.set_resource("scorm_stats"),ScormStat.prototype.scorm_package=function(){if(this.scorm_package_id)return $r.ScormPackage.get(this.scorm_package_id)},ScormStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.ScormPackage=function(superClass){function ScormPackage(){return ScormPackage.__super__.constructor.apply(this,arguments)}return extend(ScormPackage,superClass),ScormPackage.set_resource("scorm_packages"),ScormPackage.routes({member:[{action:"create",path:"sections/:section_id/:resources",method:"post"}]}),ScormPackage.extend(pi.resources.HasMany,pi.resources.ActAsList),ScormPackage.has_many("stats",{source:pi.resources.ScormStat,belongs_to:!0}),ScormPackage.params("id","name","description"),ScormPackage.after_initialize(function(){return this.course_session_id=pi.app.course_session_id}),ScormPackage.prototype.stat_for_user=function(id){var len,ref,stats;if(len=(stats=this.stats().where({user_id:id})).length)return 1===len?stats[0]:(ref=stats.slice(),utils.sort_by(ref,"id","desc"),ref[0])},ScormPackage.prototype.view_path=function(){return this.course_session_id?"/course_sessions/"+this.course_session_id+"/scorm_packages/"+this.id+"/view":"/courses/"+this.course_id+"/scorm_packages/"+this.id},ScormPackage.prototype.new_view_path=function(){return this.course_session_id?"/viewer/courses/"+this.course_id+"/scorms/"+this.id+"?returnUrl=/course_sessions/"+this.course_session_id+"&sessionId="+this.course_session_id:"/viewer/courses/"+this.course_id+"/scorms/"+this.id},ScormPackage.prototype.take_path=function(){return"/course_sessions/"+this.course_session_id+"/scorm_packages/"+this.id+"/take"},ScormPackage}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Resource=function(superClass){function Resource(){return Resource.__super__.constructor.apply(this,arguments)}return extend(Resource,superClass),Resource.set_resource("resources"),Resource.extend(pi.resources.Query,pi.resources.UploadMethod),Resource.params("id","name","section_id","position","file","course_id"),Resource.has_upload_method("upload","sections/:section_id/:resources",{creates:!0}),Resource}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Discussion=function(superClass){function Discussion(){return Discussion.__super__.constructor.apply(this,arguments)}return extend(Discussion,superClass),Discussion.extend(pi.resources.WithContext),Discussion.set_resource("discussions"),Discussion.params("title","text","course_id","course_session_id","meta"),Discussion.routes({member:[{action:"subscribe",path:":resources/:id/subscribe",method:"post"},{action:"unsubscribe",path:":resources/:id/unsubscribe",method:"delete"},{action:"pin",path:":resources/:id/pin",method:"patch"},{action:"unpin",path:":resources/:id/unpin",method:"patch"}]}),Discussion.extend(pi.resources.Query),Discussion.alias("on_unsubscribe","on_subscribe"),Discussion.alias("on_pin","on_subscribe"),Discussion.alias("on_unpin","on_subscribe"),Discussion.after_initialize(function(){return this.course_session_id||(this.course_session_id=pi.app.course_session_id)}),Discussion.prototype.on_subscribe=function(data){return data},Discussion.prototype.show_url=function(){return this.path(this.constructor.show_path,{},this).slice(4).replace(".json","")},Discussion}(pi.resources.TBResource),pi.resources.Discussion.Searcher=function(superClass){function Searcher(){return Searcher.__super__.constructor.apply(this,arguments)}return extend(Searcher,superClass),Searcher.routes_scope("/api/discussions_search.json"),Searcher.set_resource("discussions_searchers"),Searcher.extend(pi.resources.Query,pi.resources.WithContext),Searcher.after_initialize(function(){return this.course_session_id||(this.course_session_id=pi.app.course_session_id)}),Searcher.prototype.show_url=function(){var base_url;return base_url=this.path("",{},this).slice(4).replace("discussions_search.json","discussions/"+this.discussion_id),"Comment"===this.searchable_type&&(base_url+="#comment_id="+this.searchable_id),base_url},Searcher}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.SectionContent=function(superClass){function SectionContent(){return SectionContent.__super__.constructor.apply(this,arguments)}return extend(SectionContent,superClass),SectionContent.set_resource("section_contents"),SectionContent.extend(pi.resources.Query,pi.resources.ActAsList,pi.resources.HasOne),SectionContent.routes({member:[{action:"move",path:"sections/:section_id/:content_type/:content_id/move",method:"post"},{action:"destroy",path:"/:contents_type/:content_id",method:"delete"}]}),SectionContent.has_one("material",{source:pi.resources.Material,belongs_to:!0,destroy:!0}),SectionContent.has_one("scorm_package",{source:pi.resources.ScormPackage,belongs_to:!0,destroy:!0}),SectionContent.has_one("quiz",{source:pi.resources.Quiz,belongs_to:!0,destroy:!0}),SectionContent.has_one("task",{source:pi.resources.Task,belongs_to:!0,destroy:!0}),SectionContent.after_initialize(function(){return this.contents_type=this[this.content_type].constructor.resources_name}),SectionContent.prototype.recount_content_positions=function(){return this[this.content_type].position=this.position_for_type(),this},SectionContent.prototype.entity=function(){return this[this.content_type]},SectionContent.prototype.position_for_type=function(){var array,_this;return array=$r.SectionContent.where({section_id:this.section_id,content_type:this.content_type}),(array=utils.sort_by(array,"position")).findIndex((_this=this,function(elem){return elem.position===_this.position}))+1},
SectionContent}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.SectionStat=function(superClass){function SectionStat(){return SectionStat.__super__.constructor.apply(this,arguments)}return extend(SectionStat,superClass),SectionStat.set_resource("section_stats"),SectionStat}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Section=function(superClass){function Section(){return Section.__super__.constructor.apply(this,arguments)}return extend(Section,superClass),Section.set_resource("sections"),Section.routes({member:[{action:"create",path:"courses/:course_id/:resources",method:"post"},{action:"publish",path:":resources/:id/publish",method:"patch"}]}),Section.extend(pi.resources.Query,pi.resources.HasMany,pi.resources.ActAsList,pi.resources.ActAsListScope,pi.resources.UploadMethod,pi.resources.HasOne),Section.params("id","name","course_id","position","draft","send_notification","notification_txt"),Section.has_many("section_contents",{source:pi.resources.SectionContent,belongs_to:!0,destroy:!0}),Section.has_many("materials",{source:pi.resources.Material,belongs_to:!0,destroy:!0}),Section.has_many("resources",{source:pi.resources.Resource,belongs_to:!0,destroy:!0}),Section.has_many("scorm_packages",{source:pi.resources.ScormPackage,belongs_to:!0,destroy:!0}),Section.has_many("quizzes",{source:pi.resources.Quiz,belongs_to:!0,destroy:!0}),Section.has_many("tasks",{source:pi.resources.Task,belongs_to:!0,destroy:!0}),Section.has_one("stat",{source:$r.SectionStat,foreign_key:"section_id"}),Section.has_upload_method("import_quiz",":resources/:id/import_quiz",{member:!0}),Section.act_as_scope_for("section_contents"),Section.act_as_scope_for("materials"),Section.act_as_scope_for("quizzes"),Section.act_as_scope_for("tasks"),Section.prototype.take_path=function(session_id){return"/course_sessions/"+session_id+"/take#section_id="+this.id},Section.prototype.view_path=function(session_id){return"/course_sessions/"+session_id+"/view#section_id="+this.id},Section.prototype.has_protected_content=function(){return this.scorm_packages().all().length>0||this.materials().where({copyright_protected:!0}).length>0},Section}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.SurveyField=function(superClass){function SurveyField(){return SurveyField.__super__.constructor.apply(this,arguments)}return extend(SurveyField,superClass),SurveyField.TEXT="text",SurveyField.MULTIPLE="multiple",SurveyField.SINGLE="single",SurveyField.set_resource("fields"),SurveyField.params("id","name","position","type",{data:["name"]}),SurveyField.routes({member:[{action:"create",path:"surveys/:survey_id/:resources",method:"post"}],collection:[{action:"fetch",path:"surveys/:survey_id/:resources",method:"get"}]}),SurveyField.extend(pi.resources.Query,pi.resources.ActAsList),SurveyField}(pi.resources.TBResource),pi.resources.Survey=function(superClass){function Survey(){return Survey.__super__.constructor.apply(this,arguments)}return extend(Survey,superClass),Survey.set_resource("surveys"),Survey.params("id","moderation","labels"),Survey.extend(pi.resources.HasMany,pi.resources.ActAsListScope),Survey.has_many("fields",{source:pi.resources.SurveyField,belongs_to:!0,destroy:!0,route:!0,update_if:function(type){return"destroy"===type}}),Survey.after_update(function(){if(this._persisted&&this.surveyable())return this.surveyable().trigger("update")}),Survey.remove=function(instance){var ref,ref1;return null!=(ref=instance.surveyable())&&delete ref.survey,null!=(ref1=instance.surveyable())&&ref1.trigger("update"),Survey.__super__.constructor.remove.apply(this,arguments)},Survey.build=function(data,silent,add){var klass;if(null==data&&(data={}),null==silent&&(silent=!1),null==add&&(add=!0),klass=$r[data.surveyable_type+"Survey"])return klass.build(data,silent,add)},Survey}(pi.resources.TBResource),pi.resources.MeetingSurvey=function(superClass){function MeetingSurvey(){return MeetingSurvey.__super__.constructor.apply(this,arguments)}return extend(MeetingSurvey,superClass),MeetingSurvey.routes({member:[{action:"create",path:"meetings/:surveyable_id/:resources",method:"post"}],collection:[{action:"fetch",path:"meetings/:surveyable_id/:resources",method:"get"}]}),MeetingSurvey.extend(pi.resources.Query),MeetingSurvey.build=pi.resources.TBResource.build,MeetingSurvey.prototype.surveyable=function(){return $r.Meeting.get(this.surveyable_id)},MeetingSurvey}(pi.resources.Survey),pi.resources.ClickmeetingMeetingSurvey=function(superClass){function ClickmeetingMeetingSurvey(){return ClickmeetingMeetingSurvey.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingSurvey,superClass),ClickmeetingMeetingSurvey.routes({member:[{action:"create",path:"clickmeeting_meetings/:surveyable_id/:resources",method:"post"}],collection:[{action:"fetch",path:"clickmeeting_meetings/:surveyable_id/:resources",method:"get"}]}),ClickmeetingMeetingSurvey.extend(pi.resources.Query),ClickmeetingMeetingSurvey.build=pi.resources.TBResource.build,ClickmeetingMeetingSurvey.prototype.surveyable=function(){return $r.ClickmeetingMeeting.get(this.surveyable_id)},ClickmeetingMeetingSurvey}(pi.resources.Survey),pi.resources.MeetBaseMeetingSurvey=function(superClass){function MeetBaseMeetingSurvey(){return MeetBaseMeetingSurvey.__super__.constructor.apply(this,arguments)}return extend(MeetBaseMeetingSurvey,superClass),MeetBaseMeetingSurvey.routes({collection:[{action:"fetch",path:"meetbase_meetings/:surveyable_id/:resources",method:"get"}]}),MeetBaseMeetingSurvey.extend(pi.resources.Query),MeetBaseMeetingSurvey.build=pi.resources.TBResource.build,MeetBaseMeetingSurvey.prototype.surveyable=function(){return $r.MeetBaseMeeting.get(this.surveyable_id)},MeetBaseMeetingSurvey}(pi.resources.Survey),pi.resources.CourseSessionSurvey=function(superClass){function CourseSessionSurvey(){return CourseSessionSurvey.__super__.constructor.apply(this,arguments)}return extend(CourseSessionSurvey,superClass),CourseSessionSurvey.routes({member:[{action:"create",path:"course_sessions/:surveyable_id/:resources",method:"post"}],collection:[{action:"fetch",path:"course_sessions/:surveyable_id/:resources",method:"get"}]}),CourseSessionSurvey.extend(pi.resources.Query),CourseSessionSurvey.build=pi.resources.TBResource.build,CourseSessionSurvey.prototype.surveyable=function(){return $r.CourseSession.get(this.surveyable_id)},CourseSessionSurvey}(pi.resources.Survey),pi.resources.ProductSurvey=function(superClass){function ProductSurvey(){return ProductSurvey.__super__.constructor.apply(this,arguments)}return extend(ProductSurvey,superClass),ProductSurvey.routes({member:[{action:"create",path:"products/:surveyable_id/:resources",method:"post"}],collection:[{action:"fetch",path:"products/:surveyable_id/:resources",method:"get"}]}),ProductSurvey.extend(pi.resources.Query),ProductSurvey.build=pi.resources.TBResource.build,ProductSurvey.prototype.surveyable=function(){return $r.Product.get(this.surveyable_id)},ProductSurvey}(pi.resources.Survey)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.CourseSession=function(superClass){function CourseSession(){return CourseSession.__super__.constructor.apply(this,arguments)}return extend(CourseSession,superClass),CourseSession.extend($r.WithContext),CourseSession.LISTENER=1,CourseSession.MODERATOR=2,CourseSession.MENTOR=3,CourseSession.INTERVAL_NAV=2,CourseSession.set_resource("course_sessions"),CourseSession.routes({member:[{action:"create",path:"courses/:course_id/:resources",method:"post"},{action:"finish",path:":resources/:id/finish",method:"post"}],collection:[{action:"open",path:":resources/open",method:"get"},{action:"moderate",path:":resources/moderate",method:"get"},{action:"applications",path:":resources/applications",method:"get"}]}),CourseSession.extend(pi.resources.Assignable,pi.resources.Query,pi.resources.HasOne),CourseSession.params("id","course_id","name","infinitely","started_at_date","started_at_time","finished_at_date","finished_at_time","access_type","users_limit","days_to_cert_expiration"),CourseSession.has_one("survey",{source:$r.CourseSessionSurvey,foreign_key:"surveyable_id"}),CourseSession.prototype.build_survey=function(data){return null==data&&(data={}),$r.Survey.build(utils.merge(data,{surveyable_id:this.id,surveyable_type:"CourseSession"}))},CourseSession.prototype.period_string=function(){var end;return end=this.finished_at_date||"&infin;",this.started_at_date+" - "+end},CourseSession.prototype.course=function(){return $r.Course.get(this.course_id)},CourseSession.prototype.product_name=function(){return this.course_name+" ("+this.name+")"},CourseSession.prototype.product_type=function(){return"Products::CourseSession"},CourseSession.prototype.product_event_type=function(){return"CourseSession"},CourseSession}(pi.resources.TBResource)}(this),pi.resources.AccountCourseSession=function(superClass){function AccountCourseSession(){return AccountCourseSession.__super__.constructor.apply(this,arguments)}return extend(AccountCourseSession,superClass),AccountCourseSession.set_index_namespace("account"),AccountCourseSession}(pi.resources.CourseSession)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ProgramSession=function(superClass){function ProgramSession(){null!=pi.app.program_id&&(this.program_id=pi.app.program_id),ProgramSession.__super__.constructor.apply(this,arguments)}return extend(ProgramSession,superClass),ProgramSession.extend($r.WithContext),ProgramSession.set_resource("program_sessions"),ProgramSession.extend(pi.resources.Query,pi.resources.HasOne,pi.resources.ActAsList),ProgramSession.routes({member:[{action:"finish",path:":resources/:id/finish",method:"post"}]}),ProgramSession.params("id","program_id","course_id","name","infinitely","started_at_date","started_at_time","finished_at_date","finished_at_time","access_type"),ProgramSession}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.RestoreResource=function(superClass){function RestoreResource(){return RestoreResource.__super__.constructor.apply(this,arguments)}return extend(RestoreResource,superClass),RestoreResource.prototype.wrap_attributes=!0,RestoreResource.routes_scope("/api/admin/restore/:path.json"),RestoreResource}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.Subscription=function(superClass){function Subscription(){return Subscription.__super__.constructor.apply(this,arguments)}return extend(Subscription,superClass),Subscription.set_resource("subscriptions"),Subscription.routes({member:[{action:"cancel",path:":resources/:id/cancel",method:"delete"}]}),Subscription.params("tariff_plan_id","active_users","memory","months","started_at","promo_code","payment_type"),Subscription.after_initialize(function(){return this.started_at_utc&&this.set_start_date(this.started_at_utc)}),Subscription.after_update(function(){if(this.started_at_utc)return this.started_at=utils.time.format(new Date(this.started_at_utc),"%Y-%m-%d")}),Subscription.prototype.set_start_date=function(val){if(this.started_at_utc=+new Date(val),this.start_date=utils.time.format(new Date(this.started_at_utc),I18n.t("date.formats.default")),this.started_at_utc)return this.started_at=utils.time.format(new Date(this.started_at_utc),"%Y-%m-%d")},Subscription.prototype.tariff_plan=function(){if(this.tariff_plan_id)return $r.TariffPlan.get(this.tariff_plan_id)},Subscription.prototype.recount=function(){var payment,tariff,val;if(tariff=this.tariff_plan())return payment=(0|this.active_users)*tariff.price+(0|this.memory)*tariff.memory_price,this.promo()?(val=this.promo().apply(payment),this.discount=payment-val,payment=val):this.months>=12?payment*=.8:this.months>=6&&(payment*=.9),payment*=this.months||1,this.set({payment:payment})},Subscription.prototype.promo=function(){if(this.promo_code)return this._promo||(this._promo=$r.PromoCode.get_by({code:this.promo_code}))},Subscription}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AccountForm=function(superClass){function AccountForm(){return AccountForm.__super__.constructor.apply(this,arguments)}return extend(AccountForm,superClass),AccountForm.set_resource("accounts"),AccountForm.params("name","last_name","password","company","notice_email","token"),AccountForm.can_create($r.User),AccountForm}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AccountLogin=function(superClass){function AccountLogin(){return AccountLogin.__super__.constructor.apply(this,arguments)}return extend(AccountLogin,superClass),AccountLogin.prototype.wrap_attributes=!0,AccountLogin.routes_scope("/api/accounts/:account_id/:path.json"),AccountLogin.set_resource("account_login"),AccountLogin.params("name","last_name","password","email","phone","remember_me","login"),AccountLogin.routes({collection:[{action:"register",path:":resources/register",method:"post"},{action:"guest_login",path:":resources/guest",method:"post"},{action:"authenticate",path:":resources/authenticate",method:"post"}]}),AccountLogin}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AccountSettings=function(superClass){function AccountSettings(){return AccountSettings.__super__.constructor.apply(this,arguments)}return extend(AccountSettings,superClass),AccountSettings.set_resource("settings"),AccountSettings.routes_scope("/api/accounts/:resource.json"),AccountSettings.extend(pi.resources.Query),AccountSettings.params("course_stats_export","answer_stats_export"),AccountSettings}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminAccount=function(superClass){function AdminAccount(){return AdminAccount.__super__.constructor.apply(this,arguments)}return extend(AdminAccount,superClass),AdminAccount.set_resource("accounts"),AdminAccount.extend(pi.resources.Query),AdminAccount.routes({member:[{action:"initialize_destroy",path:":resources/:id/initialize_destroy",method:"get"},{action:"copy_netology_course",path:":resources/:id/copy_netology_course",method:"post"},{action:"apply_color_theme",path:":resources/:id/apply_color_theme",method:"post"},{action:"copy_courses",path:":resources/:id/copy_courses",method:"post"},{action:"toggle_status",path:":resources/:id/toggle_status",method:"patch"},{action:"test_ad_connection",path:":resources/:id/test_ad_connection",method:"post"},{action:"invite_users",path:":resources/:id/users/invite",method:"post"},{action:"choose",path:":resources/:id/choose",method:"get"},{action:"convert_to_master",path:":resources/:id/convert_to_master",method:"post"}],collection:[{action:"report_tariffs",path:":resources/report_tariffs",method:"post"}]}),AdminAccount.params("name","cp_key_id","system_version"),AdminAccount.STATUSES=function(){return{disabled:"disabled",enabled:"enabled",pending:"pending"}},AdminAccount.on_show=function(data){return{account:$r.AdminAccount.build(data.account),managers:data.managers,orders:data.orders,subscriptions:data.subscriptions}},AdminAccount.prototype.on_initialize_destroy=function(data){return{message:data.message}},AdminAccount.prototype.on_convert_to_master=function(data){return{message:data.message}},AdminAccount.prototype.on_copy_netology_course=function(data){return{message:data.message}},AdminAccount.prototype.on_copy_courses=function(data){return{message:data.message}},AdminAccount.prototype.on_test_ad_connection=function(data){return{result_connection:data.status}},AdminAccount.prototype.master=function(){return"MasterAccount"===this.type},AdminAccount.prototype.slave=function(){return"SlaveAccount"===this.type},AdminAccount}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.NetologyCourse=function(superClass){function NetologyCourse(){return NetologyCourse.__super__.constructor.apply(this,arguments)}return extend(NetologyCourse,superClass),NetologyCourse.set_resource("netology"),NetologyCourse.extend(pi.resources.Query),NetologyCourse.params("id","name"),NetologyCourse}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.NorthStarReport=function(superClass){function NorthStarReport(){return NorthStarReport.__super__.constructor.apply(this,arguments)}return extend(NorthStarReport,superClass),NorthStarReport.set_resource("north_star_reports"),NorthStarReport.extend($r.Query),NorthStarReport}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminOrder=function(superClass){function AdminOrder(){return AdminOrder.__super__.constructor.apply(this,arguments)}return extend(AdminOrder,superClass),AdminOrder.set_resource("orders"),AdminOrder.extend(pi.resources.Query),AdminOrder.routes({member:[{action:"confirm",path:":resources/:id/confirm",method:"patch"}]}),AdminOrder.params("memory","months","amount","account_id","tariff_plan_id","payment_type","invoice_file_id","doc_file_id","act_file_id"),AdminOrder.prototype.update_file_info=function(type,file_obj){return this[type+"_file_name"]=file_obj.file_name,this["has_"+type]=!0,this},AdminOrder.prototype.update_files_value=function(type,file_id){var obj;return(obj={})[type+"_file_id"]=file_id,obj},AdminOrder.on_show=function(response){return response.order.account_name=response.account.name,response.order.user_id&&(response.order.user_email=response.user.email,response.order.user_name=response.user.fullname),response.order},AdminOrder}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.BrowserReport=function(superClass){function BrowserReport(){return BrowserReport.__super__.constructor.apply(this,arguments)}return extend(BrowserReport,superClass),BrowserReport.set_resource("browser_reports"),BrowserReport.after_update(function(){return this.browser_name=this.browser+" "+this.browser_version}),BrowserReport}(pi.resources.Base),pi.resources.OsReport=function(superClass){function OsReport(){return OsReport.__super__.constructor.apply(this,arguments)}return extend(OsReport,superClass),OsReport.set_resource("os_reports"),OsReport}(pi.resources.Base),pi.resources.SlowPageReport=function(superClass){function SlowPageReport(){return SlowPageReport.__super__.constructor.apply(this,arguments)}return extend(SlowPageReport,superClass),SlowPageReport.set_resource("slow_page_reports"),SlowPageReport.after_update(function(){return this.page_name=this.page_id.replace(/\_\_/g,"/").replace(/\/id\//,"/:id/")}),SlowPageReport}(pi.resources.Base),pi.resources.SlowAjaxReport=function(superClass){function SlowAjaxReport(){return SlowAjaxReport.__super__.constructor.apply(this,arguments)}return extend(SlowAjaxReport,superClass),SlowAjaxReport.set_resource("slow_ajax_reports"),SlowAjaxReport.after_update(function(){return this.method=this.page_id.replace(/^([getposuachdl]+)\_\_.*$/i,"$1").toUpperCase(),this.page_name=this.page_id.replace(/^[getposuachdl]+\_\_(.*$)/i,"$1").replace(/\_\_/g,"/").replace(/\/id\//,"/:id/")}),SlowAjaxReport}(pi.resources.Base),pi.resources.PerfReports=function(superClass){function PerfReports(){return PerfReports.__super__.constructor.apply(this,arguments)}return extend(PerfReports,superClass),PerfReports.set_resource("perf_reports"),PerfReports.can_create($r.BrowserReport,$r.OsReport,$r.SlowAjaxReport,$r.SlowPageReport),PerfReports.query=function(params){return this._request(this.fetch_path,"get",params).then((_this=this,function(response){var i,len,ref;if(null!=_this.__deps__)for(i=0,len=(ref=_this.__deps__).length;i<len;i++)ref[i].from_data(response);return _this.on_all(response)}));var _this},PerfReports}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminProductsOrder=function(superClass){function AdminProductsOrder(){return AdminProductsOrder.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrder,superClass),AdminProductsOrder.set_resource("orders"),AdminProductsOrder.routes_scope("/api/admin/products/:path.json"),AdminProductsOrder.routes({member:[{action:"confirm",path:":resources/:id/confirm",method:"patch"}]}),AdminProductsOrder.extend(pi.resources.Query),AdminProductsOrder.params("amount"),AdminProductsOrder}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminProductsStore=function(superClass){function AdminProductsStore(){return AdminProductsStore.__super__.constructor.apply(this,arguments)}return extend(AdminProductsStore,superClass),AdminProductsStore.set_resource("stores"),AdminProductsStore.routes_scope("/api/admin/products/:path.json"),AdminProductsStore.extend(pi.resources.Query),AdminProductsStore.params("legal_info","account_id"),AdminProductsStore}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminPromoCode=function(superClass){function AdminPromoCode(){return AdminPromoCode.__super__.constructor.apply(this,arguments)}return extend(AdminPromoCode,superClass),AdminPromoCode.set_resource("promo_codes"),AdminPromoCode.extend(pi.resources.Query),AdminPromoCode.params("code","user_id","account_id","expired_at","count","discount"),AdminPromoCode}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminReportsSubscription=function(superClass){function AdminReportsSubscription(){return AdminReportsSubscription.__super__.constructor.apply(this,arguments)}return extend(AdminReportsSubscription,superClass),AdminReportsSubscription.set_resource("reports_subscriptions"),AdminReportsSubscription.extend(pi.resources.Query),AdminReportsSubscription.params("name","started_at","closed_at","finished_at","tariff_plan_id","payment","active_users","users_limit","account_id","memory","days","months","payment_type"),AdminReportsSubscription}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.RestoreCourseStat=function(superClass){function RestoreCourseStat(){return RestoreCourseStat.__super__.constructor.apply(this,arguments)}return extend(RestoreCourseStat,superClass),RestoreCourseStat.set_resource("course_stats"),RestoreCourseStat.extend(pi.resources.Query),RestoreCourseStat.routes({member:[{action:"restore",path:":resources/:id/restore",method:"post"}]}),RestoreCourseStat.prototype.on_restore=function(data){return data},RestoreCourseStat}(pi.resources.RestoreResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminSubscription=function(superClass){function AdminSubscription(){return AdminSubscription.__super__.constructor.apply(this,arguments)}return extend(AdminSubscription,superClass),AdminSubscription.set_resource("subscriptions"),AdminSubscription.extend(pi.resources.Query),AdminSubscription.routes({member:[{action:"freeze",path:":resources/:id/freeze",method:"patch"}]}),AdminSubscription.params("name","started_at","closed_at","finished_at","tariff_plan_id","payment","active_users","users_limit","account_id","memory","days","months","payment_type"),AdminSubscription}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.SystemColorTheme=function(superClass){function SystemColorTheme(){return SystemColorTheme.__super__.constructor.apply(this,arguments)}return extend(SystemColorTheme,superClass),SystemColorTheme.set_resource("system_color_themes"),SystemColorTheme.extend(pi.resources.Query),SystemColorTheme}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminTariffPlan=function(superClass){function AdminTariffPlan(){return AdminTariffPlan.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlan,superClass),AdminTariffPlan.set_resource("tariff_plans"),AdminTariffPlan.extend(pi.resources.Query),AdminTariffPlan.params("name","free","default","price","tariff_price","overhead_price","memory_price","active_users","memory","users_limit"),AdminTariffPlan.prototype.save=function(params){return null==params&&(params={}),null!=params.memory&&(params.memory=this.string_to_array(params.memory)),null!=params.active_users&&(params.active_users=this.string_to_array(params.active_users)),AdminTariffPlan.__super__.save.apply(this,arguments)},AdminTariffPlan.prototype.string_to_array=function(param){return(""+param).split(/\s*,\s*/)},AdminTariffPlan}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.TourStep=function(superClass){function TourStep(){return TourStep.__super__.constructor.apply(this,arguments)}return extend(TourStep,superClass),TourStep.set_resource("steps"),TourStep.prototype.moved=function(index){return this.position=index},TourStep}(pi.resources.Base),pi.resources.AdminTour=function(superClass){function AdminTour(){return AdminTour.__super__.constructor.apply(this,arguments)}return extend(AdminTour,superClass),AdminTour.set_resource("tours"),AdminTour.extend($r.Query,$r.HasMany,$r.ActAsListScope,$r.UploadMethod),AdminTour.routes({member:[{action:"publish",path:":resources/:id/publish",method:"patch"},{action:"unpublish",path:":resources/:id/publish",method:"patch"}]}),
AdminTour.act_as_scope_for("steps"),AdminTour.has_many("steps",{source:pi.resources.TourStep,params:["attachTo","text","video","show","hide","position"],attribute:!0,belongs_to:!0}),AdminTour.has_upload_method("import",":resources/import",{creates:!0}),AdminTour.params("controller_id","temporary","active","name","role"),AdminTour.after_initialize(function(){var i,len,ref,results,step;for(results=[],i=0,len=(ref=this.steps().all()).length;i<len;i++)step=ref[i],results.push(delete step.__temp__);return results}),AdminTour.prototype.steps_num=function(){return this.steps().all().length},AdminTour}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AdminUser=function(superClass){function AdminUser(){return AdminUser.__super__.constructor.apply(this,arguments)}return extend(AdminUser,superClass),AdminUser.set_resource("users"),AdminUser.routes({collection:[{action:"invite",path:":resources/invite",method:"post"}]}),AdminUser.routes({member:[{action:"authorize_admin",path:":resources/:id/authorize_admin",method:"get"}]}),AdminUser.extend(pi.resources.Query),AdminUser.params("name","avatar","last_name","fullname","email","labels","password","password_confirmation","notice_email","lang","notice_status","timezone","auth_type"),AdminUser.prototype.on_authorize_admin=function(response){return{url:response.url,message:response.message}},AdminUser.on_show=function(data){return{user:$r.AdminUser.build(data.user),accounts:data.accounts}},AdminUser}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.VisitsReport=function(superClass){function VisitsReport(){return VisitsReport.__super__.constructor.apply(this,arguments)}return extend(VisitsReport,superClass),VisitsReport.set_resource("visits_reports"),VisitsReport.extend($r.Query),VisitsReport.after_update(function(){return this.avg_spent=this.total_spent/this.user_count|0}),VisitsReport}(pi.resources.AdminResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AppAnswer=function(superClass){function AppAnswer(){return AppAnswer.__super__.constructor.apply(this,arguments)}return extend(AppAnswer,superClass),AppAnswer.set_resource("application_answers"),AppAnswer}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Application=function(superClass){function Application(){return Application.__super__.constructor.apply(this,arguments)}return extend(Application,superClass),Application.extend(pi.resources.WithContext),Application.set_resource("applications"),Application.routes({member:[{action:"confirm",path:":resources/:id/confirm",method:"post"},{action:"decline",path:":resources/:id/decline",method:"post"}],collection:[{action:"show",path:":resources/:id",method:"get"}]}),Application.extend($r.Query,$r.HasMany),Application.has_many("answers",{source:pi.resources.AppAnswer}),Application.after_initialize(function(){return this.course_session_id||(this.course_session_id=pi.app.course_session_id)}),Application}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AssignmentRule=function(superClass){function AssignmentRule(){return AssignmentRule.__super__.constructor.apply(this,arguments)}return extend(AssignmentRule,superClass),AssignmentRule.set_resource("assignment_rules"),AssignmentRule.extend(pi.resources.Query),AssignmentRule.routes({member:[{action:"apply",path:":resources/:id/apply",method:"post"}]}),AssignmentRule.prototype.on_apply=function(data){return{message:data.message}},AssignmentRule}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Booking=function(superClass){function Booking(){return Booking.__super__.constructor.apply(this,arguments)}return extend(Booking,superClass),Booking.extend(pi.resources.WithContext),Booking.routes_scope("/api/products/:product_id/:path.json"),Booking.set_resource("bookings"),Booking.extend(pi.resources.Query),Booking}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.ClickmeetingMeeting=function(superClass){function ClickmeetingMeeting(){return ClickmeetingMeeting.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeeting,superClass),ClickmeetingMeeting.LISTENER=1,ClickmeetingMeeting.PRESENTER=2,ClickmeetingMeeting.set_resource("clickmeeting_meetings"),ClickmeetingMeeting.extend(pi.resources.Assignable),ClickmeetingMeeting.extend(pi.resources.Query),ClickmeetingMeeting.extend(pi.resources.HasOne),ClickmeetingMeeting.routes({member:[{action:"send_report",path:":resources/:id/send_report",method:"post"}],collection:[{action:"guest_login",path:":resources/guest_login",method:"post"},{action:"register",path:":resources/register",method:"post"}]}),ClickmeetingMeeting.has_one("survey",{source:$r.ClickmeetingMeetingSurvey,foreign_key:"surveyable_id"}),ClickmeetingMeeting.prototype.product_name=function(){return this.name},ClickmeetingMeeting.prototype.product_type=function(){return"Products::ClickmeetingMeeting"},ClickmeetingMeeting.prototype.product_event_type=function(){return"ClickmeetingMeeting"},ClickmeetingMeeting.prototype.build_survey=function(data){return null==data&&(data={}),$r.Survey.build(utils.merge(data,{surveyable_id:this.id,surveyable_type:"ClickmeetingMeeting"}))},ClickmeetingMeeting.prototype.is_not_created=function(){return!this.external_id&&Date.now()/1e3-this.created_at>900},ClickmeetingMeeting.prototype.is_creating=function(){return!this.external_id&&Date.now()/1e3-this.created_at<=900},ClickmeetingMeeting.prototype.enter_is_available=function(){return("running"===this.status||"soon"===this.status||this.permanent_room)&&this.external_id},ClickmeetingMeeting.prototype.is_started=function(){return Date.parse(this.starts_at)<Date.now()},ClickmeetingMeeting.prototype.on_send_report=function(response){return{message:response.message}},ClickmeetingMeeting}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CoachRule=function(superClass){function CoachRule(){return CoachRule.__super__.constructor.apply(this,arguments)}return extend(CoachRule,superClass),CoachRule.routes_scope("/api/coaches/:path.json"),CoachRule.set_resource("rules"),CoachRule.routes({collection:[{action:"bulk_refresh",path:":resources/bulk_refresh",method:"patch"}]}),CoachRule.extend(pi.resources.Query),CoachRule.params("user_id","rules"),CoachRule}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Comment=function(superClass){function Comment(){return Comment.__super__.constructor.apply(this,arguments)}return extend(Comment,superClass),Comment.extend(pi.resources.WithContext),Comment.routes_scope("/api/discussions/:discussion_id/:path.json"),Comment.set_resource("comments"),Comment.extend(pi.resources.Query),Comment.params("text","meta"),Comment.after_initialize(function(){return this.course_session_id||(this.course_session_id=pi.app.course_session_id)}),Comment}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Competence=function(superClass){function Competence(){return Competence.__super__.constructor.apply(this,arguments)}return extend(Competence,superClass),Competence.set_resource("competences"),Competence.extend(pi.resources.HasMany),Competence.params("name","group_id"),Competence}(pi.resources.TBResource),pi.resources.Competence.has_many("competences",{source:pi.resources.Competence,belongs_to:!0,key:"group_id",destroy:!0})}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Congregation=function(superClass){function Congregation(){return Congregation.__super__.constructor.apply(this,arguments)}return extend(Congregation,superClass),Congregation.set_resource("congregations"),Congregation.routes({collection:[{action:"show",path:":resources",method:"get"}]}),Congregation.extend($r.Query),Congregation.params("groups","labels","intersections"),Congregation}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Course=function(superClass){function Course(){return Course.__super__.constructor.apply(this,arguments)}return extend(Course,superClass),Course.AUTHOR=2,Course.set_resource("courses"),Course.extend(pi.resources.Query,pi.resources.HasMany,pi.resources.Assignable,pi.resources.ActAsListScope),Course.routes({member:[{action:"update_types",path:"courses/:id/update_types",method:"patch"},{action:"update_competences",path:"courses/:id/update_competences",method:"patch"},{action:"clone",path:"courses/:id/clone",method:"post"},{action:"share",path:"admin/courses/:id/share",method:"post"},{action:"revoke_share",path:"admin/courses/:id/share",method:"delete"}]}),Course.act_as_scope_for("sections"),Course.params("name","icon","description","course_type_id","demo","bg","video_url","watermarks","cert_template","cert_params","cert_score","unchangeable","custom_contents_link","competences","content_type","include_weekly_report"),Course.has_many("sections",{source:pi.resources.Section,belongs_to:!0,destroy:!0,update_if:function(type){return"destroy"===type}}),Course.has_many("materials",{source:pi.resources.Material,belongs_to:!0,destroy:!0,update_if:function(type){return"destroy"===type}}),Course.has_many("quizzes",{source:pi.resources.Quiz,belongs_to:!0,destroy:!0,route:!0,update_if:function(type){return"destroy"===type}}),Course.has_many("resources",{source:pi.resources.Resource,belongs_to:!0,destroy:!0}),Course.has_many("course_sessions",{source:pi.resources.CourseSession,belongs_to:!0,destroy:!0}),Course.prototype.on_clone=function(data){return{message:data.message}},Course.prototype.weights_sum=function(){var i,len,ref,sum;if(this._weights_sum)return this._weights_sum;for(sum=0,i=0,len=(ref=this.quizzes().all()).length;i<len;i++)sum+=ref[i].weight;return this._weights_sum=sum},Course}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Result=function(superClass){function Result(){return Result.__super__.constructor.apply(this,arguments)}return extend(Result,superClass),Result.extend(pi.resources.WithContext),Result.set_resource("results"),Result.extend(pi.resources.HasMany,pi.resources.Query),Result.has_many("answer_stats",{source:$r.AnswerStat,belongs_to:!0,destroy:!0,route:!0}),Result.build=function(data,silent,add){return null!=data.type&&("QuizStat"===data.type?$r.QuizStat.build(data,silent,add):"TaskStat"===data.type?$r.TaskStat.build(data,silent,add):"ScormStat"===data.type&&$r.ScormStat.build(data,silent,add)),Result.__super__.constructor.build.apply(this,arguments)},Result.prototype.on_load_answer_stats=function(data){return this.answer_stats_loaded=!0,null!=data.answer_stats&&this.answer_stats().load(data.answer_stats),null!=data.questions&&$r.Question.load(data.questions),data},Result.prototype.quiz=function(){if(this.quiz_id)return $r.Quiz.get(this.quiz_id)},Result.prototype.task=function(){if(this.task_id)return $r.Task.get(this.task_id)},Result.prototype.to_quiz_stat=function(){var stat;return(stat=$r.QuizStat.get(this.id))?stat:$r.QuizStat.build(this.attributes())},Result.prototype.to_task_stat=function(){var stat;return(stat=$r.TaskStat.get(this.id))?stat:$r.TaskStat.build(this.attributes())},Result.prototype.correct_data=function(recount){var data,i,len,ref,sum;if(null==recount&&(recount=!1),this._correct_data&&!recount)return this._correct_data;if(this._can_count_correct()){for((data={}).total_num=this.quiz().effective_questions_count,sum=0,i=0,len=(ref=this.answer_stats().all()).length;i<len;i++)ref[i].success&&sum++;return data.correct_num=sum,data.incorrect_num=data.total_num-data.correct_num,data.correct_percent=100*data.correct_num/data.total_num|0,data.incorrect_percent=100*data.incorrect_num/data.total_num|0,this._correct_data=data}},Result.prototype._can_count_correct=function(){return!(!this.quiz()||!this.quiz().questions().all().length||!this.answer_stats().all().length)},Result}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CourseListenerStat=function(superClass){function CourseListenerStat(){return CourseListenerStat.__super__.constructor.apply(this,arguments)}return extend(CourseListenerStat,superClass),CourseListenerStat.extend(pi.resources.WithContext),CourseListenerStat.set_resource("course_stats"),CourseListenerStat.routes({collection:[{action:"fetch",path:"courses/:course_id/:resources",method:"get"}]}),CourseListenerStat.extend(pi.resources.Query,pi.resources.HasMany),CourseListenerStat.has_many("quiz_stats",{source:pi.resources.QuizStat,route:!0,belongs_to:!0}),CourseListenerStat.has_many("results",{source:pi.resources.Result,route:!0,belongs_to:!0}),CourseListenerStat.prototype.on_load_quiz_stats=function(data){var stats,_this;if(this.quiz_stats_loaded=!0,null!=data.quiz_stats)return stats=data.quiz_stats.map((_this=this,function(stat){var quiz;return(quiz=$r.Quiz.get(stat.quiz_id))&&(stat.name=quiz.name),stat.username=_this.username,stat.email=_this.email,stat})),this.quiz_stats().load(stats)},CourseListenerStat.prototype.on_load_results=function(data){var stats,_this;if(this.results_loaded=!0,null!=data.results)return stats=data.results.map((_this=this,function(stat){var target;return"QuizStat"===stat.type?target=$r.Quiz.get(stat.quiz_id):"TaskStat"===stat.type&&(target=$r.Task.get(stat.task_id)),target&&(stat.name=target.name),stat.username=_this.username,stat.email=_this.email,stat})),this.results().load(stats)},CourseListenerStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CourseStat=function(superClass){function CourseStat(){return CourseStat.__super__.constructor.apply(this,arguments)}return extend(CourseStat,superClass),CourseStat.set_resource("course_stats"),CourseStat.extend(pi.resources.Query),CourseStat.routes({collection:[{action:"transfer",path:"courses/:course_id/:resources/transfer",method:"patch"}]}),CourseStat}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CourseType=function(superClass){function CourseType(){return CourseType.__super__.constructor.apply(this,arguments)}return extend(CourseType,superClass),CourseType.extend(pi.resources.Query),CourseType.set_resource("course_types"),CourseType.params("name"),CourseType}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Document=function(superClass){function Document(){return Document.__super__.constructor.apply(this,arguments)}return extend(Document,superClass),Document.LISTENER=1,Document.set_resource("documents"),Document.prototype.wrap_attributes=!0,Document.extend(pi.resources.Assignable),Document.extend(pi.resources.Query),Document.extend(pi.resources.UploadMethod),Document.routes({collection:[{action:"show_all",path:":resources/show_all",method:"get"},{action:"move",path:":resources/move",method:"post"}],member:[{action:"parents",path:":resources/:id/parents",method:"get"},{action:"shares",path:":resources/:id/shares",method:"get"},{action:"share_folder",path:":resources/:id/share_folder",method:"patch"}]}),Document.params("name","file","is_folder","parent_id","extension","size","created_at","id","send_notify"),Document.has_upload_method("upload",":resources",{creates:!0}),Document.prototype.on_shares=function(response){return this.loaded_shares=response.shares},Document}(pi.resources.TBResource),pi.DocumentChecker=function(){function DocumentChecker(_interval){this._interval=null!=_interval?_interval:1e4,this._ids=[],this._running=!1,this._polling=!1}return DocumentChecker.instance=function(){return this.__instance__||(this.__instance__=new DocumentChecker)},DocumentChecker.add=function(id){return this.instance().add(id)},DocumentChecker.prototype.add=function(id){return indexOf.call(this._ids,id)>=0||this._ids.push(id),this.poll()},DocumentChecker.prototype.stop=function(){if(this._running)return clearTimeout(this._tid),this._ids.length=0,this._xhr.abort(),this._polling=this._running=!1,!0},DocumentChecker.prototype.poll=function(){var _this;if(!this._polling)return this._running=!0,$r.Document.show_all({ids:this._ids}).then((_this=this,function(response){var doc,i,len,ref,ref1;for(i=0,len=(ref=response.documents).length;i<len;i++)"ok"!==(doc=ref[i]).status_code&&"failed"!==doc.status_code||(_this._ids.splice(_this._ids.indexOf(doc.id),1),null!=(ref1=$r.Document.get(doc.id))&&ref1.trigger("update"));if(_this._ids.length)return _this._tid=after(_this._interval,function(){return _this.poll()})}))},DocumentChecker}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.GoogleImage=function(superClass){function GoogleImage(){return GoogleImage.__super__.constructor.apply(this,arguments)}return extend(GoogleImage,superClass),GoogleImage.set_resource("google"),GoogleImage.extend(pi.resources.Query),GoogleImage.routes({collection:[{action:"search",path:":resources/search_images",method:"get"}]}),GoogleImage.params("id","title","thumb"),GoogleImage}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Label=function(superClass){function Label(){return Label.__super__.constructor.apply(this,arguments)}return extend(Label,superClass),Label.set_resource("labels"),Label.extend(pi.resources.HasMany),Label.params("name","group_id"),Label}(pi.resources.TBResource),pi.resources.Label.has_many("labels",{source:pi.resources.Label,belongs_to:!0,key:"group_id",destroy:!0})}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.MeetBaseMeeting=function(superClass){function MeetBaseMeeting(){return MeetBaseMeeting.__super__.constructor.apply(this,arguments)}return extend(MeetBaseMeeting,superClass),MeetBaseMeeting.set_resource("webinars"),MeetBaseMeeting.extend(pi.resources.Query),MeetBaseMeeting.extend(pi.resources.Query),MeetBaseMeeting.extend(pi.resources.HasOne),MeetBaseMeeting.routes({collection:[{action:"register",path:":resources/register",method:"post"}]}),MeetBaseMeeting.has_one("survey",{source:$r.MeetBaseMeetingSurvey,foreign_key:"surveyable_id"}),MeetBaseMeeting.prototype.product_name=function(){return this.name},MeetBaseMeeting.prototype.product_type=function(){return"Products::MeetBase"},MeetBaseMeeting.prototype.product_event_type=function(){return"MeetBase::Meeting"},MeetBaseMeeting}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.Meeting=function(superClass){function Meeting(){return Meeting.__super__.constructor.apply(this,arguments)}return extend(Meeting,superClass),Meeting.LISTENER=1,Meeting.PRESENTER=2,Meeting.set_resource("meetings"),Meeting.extend(pi.resources.Assignable),Meeting.extend(pi.resources.Query),Meeting.extend(pi.resources.HasOne),Meeting.routes({member:[{action:"finish",path:":resources/:id/finish",method:"post"}]}),Meeting.params("name","started_at_date","started_at_time","icon","bg","description"),Meeting.has_one("survey",{source:$r.MeetingSurvey,foreign_key:"surveyable_id"}),Meeting.prototype.build_survey=function(data){return null==data&&(data={}),$r.Survey.build(utils.merge(data,{surveyable_id:this.id,surveyable_type:"Meeting"}))},Meeting.prototype.product_name=function(){return this.name},Meeting.prototype.product_type=function(){return"Products::Meeting"},Meeting.prototype.product_event_type=function(){return"Meeting"},Meeting}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.MeetingListener=function(superClass){function MeetingListener(){return MeetingListener.__super__.constructor.apply(this,arguments)}return extend(MeetingListener,superClass),MeetingListener.set_resource("listeners"),MeetingListener.routes({collection:[{action:"fetch",path:"meetings/:meeting_id/listeners",method:"get"}]}),MeetingListener.extend(pi.resources.Query),MeetingListener}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.MeetingRecording=function(superClass){function MeetingRecording(){return MeetingRecording.__super__.constructor.apply(this,arguments)}return extend(MeetingRecording,superClass),MeetingRecording.set_resource("recordings"),MeetingRecording.routes({collection:[{action:"fetch",path:"meetings/:meeting_id/recordings",method:"get"}]}),MeetingRecording.extend(pi.resources.Query),MeetingRecording}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Order=function(superClass){function Order(){return Order.__super__.constructor.apply(this,arguments)}return extend(Order,superClass),Order.set_resource("orders"),Order.extend(pi.resources.Query),Order}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.resources.Product=function(superClass){function Product(){return Product.__super__.constructor.apply(this,arguments)}return extend(Product,superClass),Product.extend(pi.resources.WithContext),Product.AUTHOR=1,Product.set_resource("products"),Product.extend(pi.resources.Assignable,pi.resources.Query,pi.resources.HasOne),Product.routes({member:[{action:"buy",path:":resources/:id/buy",method:"post"},{action:"register_user",path:":resources/:id/register_user",method:"post"}]}),Product.params("type","name","icon","bg","description","amount","event_id","event_type"),Product.has_one("survey",{source:$r.ProductSurvey,foreign_key:"surveyable_id"}),Product.from_event=function(event){return this.build({event:event,event_id:event.id,event_type:event.product_event_type(),name:event.product_name(),type:event.product_type()})},Product.prototype.build_survey=function(data){return null==data&&(data={}),$r.Survey.build(utils.merge(data,{surveyable_id:this.id,surveyable_type:"Product"}))},Product.prototype.on_buy=function(data){return data.order&&(data.order=$r.ProductsOrder.build(data.order)),data.receipt=data.receipt,data},Product.prototype.on_register_user=function(response){return response},Product}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ProductsOrder=function(superClass){function ProductsOrder(){return ProductsOrder.__super__.constructor.apply(this,arguments)}return extend(ProductsOrder,superClass),ProductsOrder.extend(pi.resources.WithContext),ProductsOrder.set_resource("orders"),ProductsOrder.routes({collection:[{action:"show",path:"products/:resources/:id",method:"get"}],member:[{action:"apply_promo",path:"products/:resources/:id/apply_promo",method:"patch"},{action:"stub_payment",path:"products/:resources/:id/stub_payment",method:"patch"},{action:"cancel",path:"profiles/:resources/:id/cancel",method:"patch"},{action:"make",path:"products/:resources/:id/make",method:"get"}]}),ProductsOrder.extend(pi.resources.Query),ProductsOrder.prototype.on_apply_promo=function(response){return{order:$r.ProductsOrder.build(response.order),message:response.message}},ProductsOrder.get_order_with_cp_key=function(order_id){var order;return null!=(order=this.get(order_id)).cp_key_id?Promise.resolve(order):this.show({id:order_id})},ProductsOrder.prototype.on_make=function(data){return data},ProductsOrder}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ProductsPromoCode=function(superClass){function ProductsPromoCode(){return ProductsPromoCode.__super__.constructor.apply(this,arguments)}return extend(ProductsPromoCode,superClass),ProductsPromoCode.extend(pi.resources.WithContext),ProductsPromoCode.routes_scope("/api/products/:path.json"),ProductsPromoCode.set_resource("promo_codes"),ProductsPromoCode.extend(pi.resources.Query),ProductsPromoCode.params("code","product_id","account_id","expired_at","count","discount"),ProductsPromoCode}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ProductsStore=function(superClass){function ProductsStore(){
return ProductsStore.__super__.constructor.apply(this,arguments)}return extend(ProductsStore,superClass),ProductsStore.set_resource("stores"),ProductsStore.extend(pi.resources.Query),ProductsStore.params("name","description","icon","bg","contacts"),ProductsStore}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Account=function(superClass){function Account(){return Account.__super__.constructor.apply(this,arguments)}return extend(Account,superClass),Account.set_resource("accounts"),Account.routes_scope("/api/profiles/:path.json"),Account.extend(pi.resources.Query),Account.routes({member:[{action:"update_profile",path:":resource",method:"post"},{action:"update_agreement",path:"agreement",method:"post"},{action:"clear_payment_credentials",path:"clear_payment_credentials",method:"patch"},{action:"test_ad_connection",path:"test_ad_connection",method:"post"}]}),Account.params("name","logo","code","lang"),Account.after_initialize(function(){if(this.memory_total)return this.memory_gb=this.memory_total/1073741824}),Account.prototype.on_update_profile=function(response){return null!=response.account&&(pi.app.account=$r.Account.build(response.account)),{account:response.account,message:response.message}},Account.prototype.on_update_agreement=function(response){var ref;return null!=response.account&&null!=(ref=pi.app.account)&&ref.set({settings:response.account.settings}),response},Account.prototype.on_test_ad_connection=function(data){return{result_connection:data.status}},Account.prototype.local_logo=function(url){return this.set({logo_url:url,logo_large_url:url})},Account.prototype.login_path=function(){if(this.code)return window.location.protocol+"//"+window.location.hostname+(window.location.port?":":"")+window.location.port+"/with/"+this.code},Account}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.OauthApplication=function(superClass){function OauthApplication(){return OauthApplication.__super__.constructor.apply(this,arguments)}return extend(OauthApplication,superClass),OauthApplication.set_resource("credentials"),OauthApplication.routes_scope("/api/profiles/:path.json"),OauthApplication.extend(pi.resources.Query),OauthApplication.params("name","redirect_uri"),OauthApplication}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Program=function(superClass){function Program(){return Program.__super__.constructor.apply(this,arguments)}return extend(Program,superClass),Program.LISTENER=1,Program.MODERATOR=2,Program.set_resource("programs"),Program.extend(pi.resources.Query,pi.resources.HasMany,pi.resources.Assignable,pi.resources.ActAsListScope),Program.act_as_scope_for("program_sessions"),Program.routes({member:[{action:"finish",path:":resources/:id/finish",method:"post"}],collection:[{action:"index",path:":resources/",method:"get"}]}),Program.params("name","icon","bg","description","infinitely","started_at_date","started_at_time","finished_at_date","finished_at_time","access_type","navigation","program_navigation","period"),Program.has_many("courses",{source:pi.resources.Course,params:["id","name"],attribute:!0}),Program.has_many("program_sessions",{source:pi.resources.ProgramSession,belongs_to:!0}),Program}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ModeratedProgram=function(superClass){function ModeratedProgram(){return ModeratedProgram.__super__.constructor.apply(this,arguments)}return extend(ModeratedProgram,superClass),ModeratedProgram.extend($r.WithContext),ModeratedProgram.LISTENER=1,ModeratedProgram.MODERATOR=2,ModeratedProgram.set_resource("moderated_programs"),ModeratedProgram.extend(pi.resources.Query,pi.resources.HasMany,pi.resources.Assignable),ModeratedProgram.params("name","icon","bg","description","infinitely","started_at_date","started_at_time","finished_at_date","finished_at_time","access_type","navigation"),ModeratedProgram.has_many("courses",{source:pi.resources.Course,params:["id","name"],attribute:!0}),ModeratedProgram.has_many("program_sessions",{source:pi.resources.ProgramSession}),ModeratedProgram}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.PromoCode=function(superClass){function PromoCode(){return PromoCode.__super__.constructor.apply(this,arguments)}return extend(PromoCode,superClass),PromoCode.set_resource("promo_codes"),PromoCode.prototype.wrap_attributes=!0,PromoCode.routes({collection:[{action:"check",path:":resources/check",method:"get"}]}),PromoCode.on_check=function(data){return null!=data.promo_code&&(data.promo_code=this.build(data.promo_code)),data},PromoCode.prototype.apply=function(val){return"percent"===this.type?Math.round(val*(1-this.value/100)):"amount"===this.type?val-this.value:void 0},PromoCode}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.RatingListeners=function(superClass){function RatingListeners(){return RatingListeners.__super__.constructor.apply(this,arguments)}return extend(RatingListeners,superClass),RatingListeners.extend(pi.resources.WithContext),RatingListeners.set_resource("rating_listeners"),RatingListeners.routes({collection:[{action:"fetch",path:"courses/:course_id/:resources",method:"get"}]}),RatingListeners.extend(pi.resources.Query,pi.resources.HasMany),RatingListeners.has_many("quiz_stats",{source:pi.resources.QuizStat,route:!0,belongs_to:!0}),RatingListeners.has_many("results",{source:pi.resources.Result,route:!0,belongs_to:!0}),RatingListeners.prototype.on_load_quiz_stats=function(data){var stats,_this;if(this.quiz_stats_loaded=!0,null!=data.quiz_stats)return stats=data.quiz_stats.map((_this=this,function(stat){var quiz;return(quiz=$r.Quiz.get(stat.quiz_id))&&(stat.name=quiz.name),stat.username=_this.username,stat.email=_this.email,stat})),this.quiz_stats().load(stats)},RatingListeners.prototype.on_load_results=function(data){var stats,_this;if(this.results_loaded=!0,null!=data.results)return stats=data.results.map((_this=this,function(stat){var target;return"QuizStat"===stat.type?target=$r.Quiz.get(stat.quiz_id):"TaskStat"===stat.type&&(target=$r.Task.get(stat.task_id)),target&&(stat.name=target.name),stat.username=_this.username,stat.email=_this.email,stat})),this.results().load(stats)},RatingListeners}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Recording=function(superClass){function Recording(){return Recording.__super__.constructor.apply(this,arguments)}return extend(Recording,superClass),Recording.LISTENER=1,Recording.set_resource("recordings"),Recording.extend(pi.resources.Assignable),Recording.extend(pi.resources.Query),Recording.routes({member:[{action:"share",path:":resources/:id/share",method:"patch"},{action:"convert",path:":resources/:id/convert",method:"get"}]}),Recording.params("name","size","duration","created_at"),Recording}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.AccountVisitsReport=function(superClass){function AccountVisitsReport(){return AccountVisitsReport.__super__.constructor.apply(this,arguments)}return extend(AccountVisitsReport,superClass),AccountVisitsReport.set_resource("visits_reports"),AccountVisitsReport.extend(pi.resources.Query),AccountVisitsReport.routes_scope("/api/reports/visits.json"),AccountVisitsReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CourseReport=function(superClass){function CourseReport(){return CourseReport.__super__.constructor.apply(this,arguments)}return extend(CourseReport,superClass),CourseReport.extend(pi.resources.WithContext),CourseReport.set_resource("course_reports"),CourseReport.extend(pi.resources.Query),CourseReport.routes_scope("/api/reports.json"),CourseReport.after_update(function(){if(this.total_count)return pi.app.course.total_score&&(this.score_percent_avg=100*(0|this.score_avg)/pi.app.course.total_score|0),this.not_started=this.total_count-this.started_count,this.in_progress=this.started_count-this.completed_count}),CourseReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.CourseVisitsReport=function(superClass){function CourseVisitsReport(){return CourseVisitsReport.__super__.constructor.apply(this,arguments)}return extend(CourseVisitsReport,superClass),CourseVisitsReport.extend(pi.resources.WithContext),CourseVisitsReport.set_resource("course_visits_reports"),CourseVisitsReport.extend(pi.resources.Query),CourseVisitsReport.routes_scope("/api/reports/course_visits.json"),CourseVisitsReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.QuestionReport=function(superClass){function QuestionReport(){return QuestionReport.__super__.constructor.apply(this,arguments)}return extend(QuestionReport,superClass),QuestionReport.extend(pi.resources.WithContext),QuestionReport.set_resource("question_reports"),QuestionReport.extend(pi.resources.Query),QuestionReport.routes_scope("/api/reports/questions/:quiz_id.json"),QuestionReport.after_update(function(){if(this.unsuccess_count=this.total_count-this.success_count,this.question()&&(this.position=this.question().position||"",this.question_name=this.question().name||""),this.total_count&&(this.success_percent=this.success_count/this.total_count*100|0,this.unsuccess_percent=100-this.success_percent,this.question()))return this.score_percent_avg=this.score_avg/this.question().score*100|0}),QuestionReport.prototype.question=function(){return this.__question||(this.__question=$r.Question.get(this.question_id)||{})},QuestionReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.QuizReport=function(superClass){function QuizReport(){return QuizReport.__super__.constructor.apply(this,arguments)}return extend(QuizReport,superClass),QuizReport.extend(pi.resources.WithContext),QuizReport.set_resource("quiz_reports"),QuizReport.extend(pi.resources.Query,pi.resources.HasOne),QuizReport.has_one("course_report",{source:$r.CourseReport}),QuizReport.routes_scope("/api/reports/quizzes/:quiz_id.json"),QuizReport.after_update(function(){var ref;return this.total_assigned=null!=(ref=this.course_report)?ref.total_count:void 0,this.not_started=this.total_assigned-this.total_users,this.in_progress=this.total_count-this.completed_count,this.unsuccess_count=this.completed_count-this.success_count}),QuizReport.prototype.quiz=function(){return this.__quiz||(this.__quiz=$r.Quiz.get(this.quiz_id))},QuizReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.QuizVisitsReport=function(superClass){function QuizVisitsReport(){return QuizVisitsReport.__super__.constructor.apply(this,arguments)}return extend(QuizVisitsReport,superClass),QuizVisitsReport.extend(pi.resources.WithContext),QuizVisitsReport.set_resource("quiz_visits_reports"),QuizVisitsReport.extend(pi.resources.Query),QuizVisitsReport.routes_scope("/api/reports/quiz_visits/:quiz_id.json"),QuizVisitsReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.UserAccountReport=function(superClass){function UserAccountReport(){return UserAccountReport.__super__.constructor.apply(this,arguments)}return extend(UserAccountReport,superClass),UserAccountReport.set_resource("users"),UserAccountReport.extend(pi.resources.Query),UserAccountReport.routes_scope("/api/reports/users/:user_id.json"),UserAccountReport.on_all=function(data){return $r.CourseListenerStat.load(data.current_courses),$r.CourseListenerStat.load(data.finished_courses),data},UserAccountReport}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.ScormAttachment=function(superClass){function ScormAttachment(){return ScormAttachment.__super__.constructor.apply(this,arguments)}return extend(ScormAttachment,superClass),ScormAttachment.set_resource("scorm_attachments"),ScormAttachment.extend(pi.resources.Query,pi.resources.UploadMethod),ScormAttachment.routes({collection:[{action:"fetch",path:"scorm_packages/:scorm_package_id/:resource",method:"get"},{action:"destroy",path:"scorm_packages/:scorm_package_id/:resource",method:"delete"}]}),ScormAttachment.params("file","scorm_package_id"),ScormAttachment.has_upload_method("upload","scorm_packages/:scorm_package_id/:resource",{creates:!0}),ScormAttachment}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.SimpleRegistration=function(superClass){function SimpleRegistration(){return SimpleRegistration.__super__.constructor.apply(this,arguments)}return extend(SimpleRegistration,superClass),SimpleRegistration.prototype.wrap_attributes=!0,SimpleRegistration.routes_scope("/api/:path.json"),SimpleRegistration.set_resource("simple_registrations"),SimpleRegistration.params("email"),SimpleRegistration.register=function(data,xhr){return pi.Net.post("/api/simple_registrations",data,{},xhr)},SimpleRegistration.on_register=function(response){return console.log(response),{user:response.user,message:response.message}},SimpleRegistration}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var MAX_TRACK_TIME,MIN_TRACK_TIME,TRACK_INTERVAL,TrackItem,pi,utils;pi=context.pi,utils=pi.utils,TRACK_INTERVAL=2e4,MIN_TRACK_TIME=2,MAX_TRACK_TIME=20,TrackItem=function(){function TrackItem(target,active){this.target=target,null==active&&(active=!1),this.flushed=!0,this.active=!1,active&&this.activate()}return TrackItem.prototype.activate=function(force){if(null==force&&(force=!1),!this.active||force)return this.active=!0,this.flushed&&(this._start=+new Date),this.flushed=!1},TrackItem.prototype.deactivate=function(){if(this.active)return this.active=!1,this.ts=(+new Date-this._start)/1e3|0},TrackItem.prototype.dispose=function(){return this.disposed=!0},TrackItem.prototype.flush=function(){var _now,_ts;return this.active?(_ts=(_now=+new Date)-this._start,this._start=_now,_ts/1e3|0):(this.flushed=!0,_ts=this.ts,this.ts=0,_ts)},TrackItem.prototype.commit=function(){var _ts;if(!(this.disposed||this.flushed||this.target._disposed)&&(_ts=this.flush())>MIN_TRACK_TIME)return _ts=Math.min(MAX_TRACK_TIME,_ts),this.target.track({ts:_ts})},TrackItem}(),pi.resources.StatTracker=function(superClass){function StatTracker(){this._items=[],this._items_by_id={},this.running=!1}return extend(StatTracker,superClass),StatTracker.prototype.start=function(interval){return this.interval=null!=interval?interval:TRACK_INTERVAL,this.running=!0,this.run()},StatTracker.prototype.run=function(){var _this;if(this.running)return this._tid=after(this.interval,(_this=this,function(){return _this.commit()}))},StatTracker.prototype.commit=function(){var ref,_this;if(this._items.length)return ref=this._items.slice(),this._commit_next(ref).then((_this=this,function(){return _this.run()}))},StatTracker.prototype._commit_next=function(items){var promise,_this;return items.length?null!=(promise=items.pop().commit())?promise["catch"](function(e){return utils.local_error(e)}).then((_this=this,function(){return _this._commit_next(items)})):utils.as_promise(function(_this){return function(){return _this._commit_next(items)}}(this)):utils.resolved_promise()},StatTracker.prototype.stop=function(){var i,len,ref1;for(this.running=!1,i=0,len=(ref1=this._items).length;i<len;i++)ref1[i].deactivate();return clearTimeout(this._tid),this.commit()},StatTracker.prototype.clear=function(){var i,len,ref1;for(i=0,len=(ref1=this._items).length;i<len;i++)ref1[i].dispose();return this._items.length=0,this._items_by_id={}},StatTracker.prototype.track=function(item,force){var track_item;if(null==force&&(force=!1),null!=item)return(track_item=this._items_by_id[item.id])?this.running?track_item.activate(force):void 0:(track_item=new TrackItem(item,this.running),this._items_by_id[item.id]=track_item,this._items.push(track_item))},StatTracker.prototype.flush=function(item){var track_item;if(null!=item&&(track_item=this._items_by_id[item.id]))return track_item.deactivate()},StatTracker.prototype.untrack=function(item){var track_item;if(null!=item)return(track_item=this._items_by_id[item.id])?(track_item.deactivate(),track_item.flush()):void 0},StatTracker}(pi.Core)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.TariffPlan=function(superClass){function TariffPlan(){return TariffPlan.__super__.constructor.apply(this,arguments)}return extend(TariffPlan,superClass),TariffPlan.set_resource("tariff_plans"),TariffPlan.prototype.max_active_users=function(){return this.active_users[this.active_users.length-1]},TariffPlan.prototype.minimal_payment=function(){return this.active_users[0]*this.price+this.memory[0]*this.memory_price},TariffPlan}(pi.resources.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.TempAttachment=function(superClass){function TempAttachment(){return TempAttachment.__super__.constructor.apply(this,arguments)}return extend(TempAttachment,superClass),TempAttachment.set_resource("files"),TempAttachment.extend(pi.resources.UploadMethod),TempAttachment.prototype.wrap_attributes=!0,TempAttachment.params("file"),TempAttachment.has_upload_method("upload","tmp/upload",{creates:!0}),TempAttachment}(pi.resources.REST)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.Tour=function(superClass){function Tour(){return Tour.__super__.constructor.apply(this,arguments)}return extend(Tour,superClass),Tour.set_resource("tours"),Tour.prototype.wrap_attributes=!0,Tour.routes({member:[{action:"commit_visit",path:":resources/:code/commit",method:"post"}]}),Tour.prototype.on_commit_visit=function(data){return data},Tour}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.UserActivity=function(superClass){function UserActivity(){return UserActivity.__super__.constructor.apply(this,arguments)}return extend(UserActivity,superClass),UserActivity.set_resource("user_activities"),UserActivity.extend(pi.resources.Query),UserActivity}(pi.resources.TBResource)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.resources.YoutubeVideo=function(superClass){function YoutubeVideo(){return YoutubeVideo.__super__.constructor.apply(this,arguments)}return extend(YoutubeVideo,superClass),YoutubeVideo.set_resource("youtube"),YoutubeVideo.extend(pi.resources.Query),YoutubeVideo.routes({collection:[{action:"search",path:":resources/search",method:"get"}]}),YoutubeVideo.params("id","title","thumb"),YoutubeVideo}(pi.resources.TBResource)}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CompetencesFilter=function(){function CompetencesFilter(){}return CompetencesFilter.included=function(base){base.prototype.scope_rules.competences=function(old,val){return JSON.stringify(old||{})===JSON.stringify(val)&&val}},CompetencesFilter.prototype.competences_filter=function(competences){var params,_this;return params=this._competences_to_params(competences),this.with_loader(this.query({},{competences:params}).then((_this=this,function(data){return data&&_this.view.reload(_this._parse_response(data)),_this.view.ensure_competence(params),data})))},CompetencesFilter.prototype._competences_to_params=function(competences){var competence,i,len,params;if(competences){for(params=[],"number"==typeof competences&&(competences=[$r.Competence.get(competences)]),i=0,len=competences.length;i<len;i++)competence=competences[i],params.push(String(competence.id));return params}},CompetencesFilter}()}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.CourseTypesFilter=function(){function CourseTypesFilter(){}return CourseTypesFilter.included=function(base){base.prototype.scope_rules.course_type_id=function(old,val){return JSON.stringify(old||{})===JSON.stringify(val)&&val}},CourseTypesFilter.prototype.course_type_filter=function(types){var params,_this;return params=this._types_to_params(types),this.with_loader(this.query({},{course_type_id:params}).then((_this=this,function(data){return data&&_this.view.reload(_this._parse_response(data)),_this.view.ensure_course_type(params),data})))},CourseTypesFilter.prototype._types_to_params=function(types){if(types)return utils.to_a(types).map(function(item){return item instanceof $r.Base?item.id:item})},CourseTypesFilter.prototype.course_content_type_filter=function(types){var params,_this;return params=this._content_types_to_params(types),this.with_loader(this.query({},{course_content_type:params}).then((_this=this,function(data){return data&&_this.view.reload(_this._parse_response(data)),_this.view.ensure_course_content_type(params),data})))},CourseTypesFilter.prototype._content_types_to_params=function(types){var i,len,params,type;if(types){for(params=[],i=0,len=types.length;i<len;i++)(type=types[i]).record.value>0&&params.push(type.record.value);return params}},CourseTypesFilter}()}(this)}.call(this),function(){!function(context){"use strict";var LS_KEY,pi;(pi=context.pi).utils,LS_KEY="tb:labels_filter",pi.controllers.LabelsFilter=function(){function LabelsFilter(){}return LabelsFilter.included=function(base){base.prototype.scope_rules.labels=function(old,val){return JSON.stringify(old||{})===JSON.stringify(val)&&val}},LabelsFilter.prototype.filter_by_labels=function(labels){var data,_this;if(pi.app.labels_is_loaded)return data=this._labels_to_params(labels),this.with_loader(this.query({},{labels:data}).then((_this=this,function(data){return data&&_this.view.reload(_this._parse_response(data)),data})))},LabelsFilter.prototype.clear_labels=function(){return this.labels.length=0,localStorage.removeItem(this._storage_key()),this.view.labels_loaded(this.labels),this.filter_by_labels(this.labels)},LabelsFilter.prototype.store_labels=function(){if(this.labels.length)return localStorage.setItem(this._storage_key(),JSON.stringify(this.labels.map(function(label){return label.id}))),pi.app.view.success.show(I18n.t("labels.messages.filter_save"))},LabelsFilter.prototype.labels_filter_initialize=function(){var ids,ids_str;(ids_str=localStorage.getItem(this._storage_key()))&&(ids=JSON.parse(ids_str),this.labels=$r.Label.where({"id?":ids}),this.view.labels_loaded(this.labels),this.scope().set({labels:this._labels_to_params(this.labels)}))},LabelsFilter.prototype.labels_filter_reload=function(context){if(null!=context.data.labels)return this.labels=context.data.labels,this.filter_by_labels(this.labels).then((_this=this,function(){return _this.view.labels_loaded(_this.labels)}));var _this},LabelsFilter.prototype.remove_label=function(id){var label,ref;if((ref=this.labels.filter(function(label){return label.id===id}))&&ref.length)return label=ref[0],this.labels.splice(this.labels.indexOf(label),1),this.view.labels_loaded(this.labels),this.filter_by_labels(this.labels)},LabelsFilter.prototype.select_labels=function(){return this["switch"]("labels_filter")},LabelsFilter.prototype._storage_key=function(){var key;return key=LS_KEY,null!=pi.app.course_id&&(key=key+":course:"+pi.app.course_id),key},LabelsFilter.prototype._labels_to_params=function(labels){var data,i,label,len,name;if(null!=labels){for(data={},i=0,len=labels.length;i<len;i++)(label=labels[i]).group_id&&(data[name=label.group_id]||(data[name]=[]),data[label.group_id].push(label.id));return data}},LabelsFilter}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Popuped=function(){function Popuped(){}return Popuped.included=function(){},Popuped.prototype.postinitialize=function(){return this.view.one("loaded",(_this=this,function(){return _this.start_tour()}));var _this},Popuped.prototype.close=function(data){return this.view.close().then((_this=this,function(){return _this.exit(data)}));var _this},Popuped}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SessionsFilter=function(){function SessionsFilter(){}return SessionsFilter.included=function(){return!0},SessionsFilter.prototype.filter_by_session=function(id){return this.with_loader(this.query({},{course_session_id:id}).then((_this=this,function(data){return id?hash.add({session_id:id}):hash.remove("session_id"),_this.session_id=id,data&&_this.view.reload(_this._parse_response(data)),data})));var _this},SessionsFilter}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.TBController=function(superClass){function TBController(){return TBController.__super__.constructor.apply(this,arguments)}return extend(TBController,superClass),TBController.prototype.id="base_tb",TBController.prototype.initialize=function(){return TBController.__super__.initialize.apply(this,arguments),this.postinitialize()},TBController.prototype.postinitialize=function(){return after(2e3,(_this=this,function(){return _this.start_tour()}));var _this},TBController}(pi.controllers.Base),pi.controllers.TBListController=function(superClass){function TBListController(){return TBListController.__super__.constructor.apply(this,arguments)}return extend(TBListController,superClass),TBListController.prototype.id="list_tb",TBListController.prototype.initialize=function(){return TBListController.__super__.initialize.apply(this,arguments),this.postinitialize()},TBListController.prototype.load=function(){var list,ref,ref1,ref2
;return(list=null!=(ref=pi.app.tours_map)?ref[this.id]:void 0)&&list.length?null!=(ref1=pi.app.view.help_callout)&&ref1.removeClass("no-tour"):null!=(ref2=pi.app.view.help_callout)&&ref2.addClass("no-tour"),TBListController.__super__.load.apply(this,arguments)},TBListController.prototype.postinitialize=function(){return after(2e3,(_this=this,function(){return _this.start_tour()}));var _this},TBListController}(pi.controllers.ListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Popup=function(superClass){function Popup(){return Popup.__super__.constructor.apply(this,arguments)}return extend(Popup,superClass),Popup.include(pi.controllers.Popuped),Popup.prototype.id="popup",Popup}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.TBCourseController=function(superClass){function TBCourseController(){return TBCourseController.__super__.constructor.apply(this,arguments)}return extend(TBCourseController,superClass),TBCourseController.include(pi.controllers.Scoped),TBCourseController.prototype.id="base_course",TBCourseController.has_resource($r.Section),TBCourseController.has_resource($r.Material),TBCourseController.has_resource($r.Resource),TBCourseController.prototype.initialize=function(){var ref,ref1;return null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course.id},!1),pi.app.course_session_id&&null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:0|pi.app.course_session_id},!1),TBCourseController.__super__.initialize.apply(this,arguments)},TBCourseController.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},TBCourseController}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Apply=function(superClass){function Apply(){return Apply.__super__.constructor.apply(this,arguments)}return extend(Apply,superClass),Apply.prototype.id="apply",Apply.prototype.auth=function(){return this["switch"]("authorize")},Apply.prototype.show_video=function(url){if(!this._loading&&url)return this["switch"]("document_show",{category:"video",external_type:"youtube",external:url})},Apply.prototype.show_material=function(id){var mat,_this;if(!this._loading&&(mat=$r.Material.get(id)))return this._loading=!0,mat.demo_expiring().then((_this=this,function(){return _this._loading=!1,_this["switch"]("document_show",mat)}))},Apply}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Authorize=function(superClass){function Authorize(){return Authorize.__super__.constructor.apply(this,arguments)}return extend(Authorize,superClass),Authorize.prototype.id="authorize",Authorize.prototype.always_switch_hard=!0,Authorize.prototype.switch_context=function(from,to){return Authorize.__super__.switch_context.apply(this,arguments).then((_this=this,function(){return _this.view.switched_to(to)}));var _this},Authorize.prototype.unload=function(){var ref;return null!=(ref=this.context)&&ref.unload(),this._initialized=!1,this.context=void 0,this.context_id=void 0,Authorize.__super__.unload.apply(this,arguments)},Authorize}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.GuestLogin=function(superClass){function GuestLogin(){return GuestLogin.__super__.constructor.apply(this,arguments)}return extend(GuestLogin,superClass),GuestLogin.prototype.id="guest_login",GuestLogin.prototype.login=function(data){var params,_this;return params={account_login:data,account_id:pi.app.account.id},this.with_loader($r.AccountLogin.guest_login(params).then((_this=this,function(){return _this.location(_this.view.data().redirect)})))},GuestLogin}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Login=function(superClass){function Login(){return Login.__super__.constructor.apply(this,arguments)}return extend(Login,superClass),Login.prototype.id="login",Login.prototype.login=function(data){return this.user=$r.AccountLogin.build(data),this.user.account_id=pi.app.account.id,this.with_loader(this.user.save().then((_this=this,function(){return _this.location(_this.view.data().redirect)})));var _this},Login.prototype.authenticate=function(data){var params,_this;return params={account_login:{login:data.login,password:data.password},account_id:pi.app.account.id},this.with_loader($r.AccountLogin.authenticate(params).then((_this=this,function(){return _this.location(_this.view.data().redirect)})))},Login}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Registration=function(superClass){function Registration(){return Registration.__super__.constructor.apply(this,arguments)}return extend(Registration,superClass),Registration.prototype.id="registration",Registration.prototype.register=function(data){var params,_this;return params={account_login:data,account_id:pi.app.account.id},this.with_loader($r.AccountLogin.register(params).then((_this=this,function(){return _this.location(_this.view.data().redirect)})))},Registration}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.CoverUpload=function(superClass){function CoverUpload(){return CoverUpload.__super__.constructor.apply(this,arguments)}return extend(CoverUpload,superClass),CoverUpload.prototype.id="cover_upload",CoverUpload.prototype.always_switch_hard=!0,CoverUpload.prototype.close=function(data){var _this;return(this.context&&"function"==typeof this.context.preunload?this.context.preunload():utils.resolved_promise()).then((_this=this,function(){return CoverUpload.__super__.close.call(_this,data)})),!1},CoverUpload.prototype.submit=function(){var ref;return this.close({file:null!=(ref=this.context)?ref.data():void 0})},CoverUpload.prototype.switch_context=function(from,to){return CoverUpload.__super__.switch_context.apply(this,arguments).then((_this=this,function(){return _this.view.switched_to(to)}));var _this},CoverUpload.prototype.unload=function(){var ref;return null!=(ref=this.context)&&ref.unload(),this._initialized=!1,this.context=void 0,this.context_id=void 0,CoverUpload.__super__.unload.apply(this,arguments)},CoverUpload}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,slice=[].slice;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.FileUpload=function(superClass){function FileUpload(){return FileUpload.__super__.constructor.apply(this,arguments)}return extend(FileUpload,superClass),FileUpload.prototype.id="file_upload",FileUpload.prototype.data_wrap="files",FileUpload.upload_resource=function(){var params,resource;return resource=arguments[0],params=2<=arguments.length?slice.call(arguments,1):[],this.prototype.resource=resource,this.prototype.upload_params=params},FileUpload.upload_resource($r.TempAttachment,"file","extension","category","file_name","size"),FileUpload.prototype.load=function(){return this.res_view=new pi.resources.View(this.resource,null,{params:this.upload_params}),this.view.bind_resources(this.res_view),this.__index__=0,FileUpload.__super__.load.apply(this,arguments)},FileUpload.prototype.add_files=function(files){var file,i,len;for(i=0,len=(files=utils.to_a(files)).length;i<len;i++)file=files[i],this.build_resource(file);if(this.res_view.all().length)return this.view.activate(),this.do_upload()},FileUpload.prototype.build_resource=function(file){var el;return el=this.res_view.build({name:file.name,id:"temp_"+utils.uid()}),pi.net.XHR_UPLOAD&&el.set({file:file},!0),el},FileUpload.prototype.file_uploaded=function(el,data){return el.set(data)},FileUpload.prototype.submit=function(){return this.close(this.res_view.serialize())},FileUpload.prototype.do_upload=function(){var data,_this;if(!this._uploading)return this.res_view.all().length>this.__index__?(this.current_item=this.res_view.all()[this.__index__],this._uploading=!0,null!=context.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),data=this.resource.prototype.wrap_attributes?utils.wrap(this.resource.resource_name,this.current_item.attributes()):this.current_item.attributes(),this.resource.upload(this.view.form,data,(_this=this,function(val){return _this.view.update_progress(_this.current_item,val)}),this.xhr)["catch"](function(_this){return function(e){throw _this._uploading=!1,_this.view.error(e.message),_this.current_item.set({failed:!0}),_this.__index__++,_this.do_upload(),e}}(this)).then(function(_this){return function(response){return _this._uploading=!1,null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),null!=(data=_this.resource.prototype.wrap_attributes?response[_this.resource.resource_name]:response)&&_this.file_uploaded(_this.current_item,data),_this.current_item.set({loaded:!0}),_this.__index__++,_this.do_upload(),response}}(this))):void 0},FileUpload.prototype.unload=function(){var ref;return this.res_view.clear_all(),this.res_view.off(),this.res_view=null,this._uploading&&null!=(ref=this.xhr)&&ref.abort(),this.xhr=null,FileUpload.__super__.unload.apply(this,arguments)},FileUpload.prototype.close=function(){return this._uploading?(this.confirm((_this=this,function(){return FileUpload.__super__.close.apply(_this,arguments)}))["with"](null,"documents/abort_confirm"),!1):FileUpload.__super__.close.apply(this,arguments);var _this},FileUpload}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.UpdateRole=function(superClass){function UpdateRole(){return UpdateRole.__super__.constructor.apply(this,arguments)}return extend(UpdateRole,superClass),UpdateRole.prototype.id="update_role",UpdateRole.prototype.data_wrap="role",UpdateRole.has_resource($r.User),UpdateRole.prototype.load=function(context){return this.selected_users=context.data.users,this.mode=context.data.mode,UpdateRole.__super__.load.apply(this,arguments)},UpdateRole.prototype.close=function(role){var i,len,ref,role_id,role_name,user,user_ids,_this;if(void 0===role)return UpdateRole.__super__.close.apply(this,arguments);if(null!=(role_id=role.value())&&null!=this.selected_users)if(role_id|=0,"select"===this.mode)role_name=role.dropdown.selected_item().node.textContent,user_ids=this.selected_users.map(function(u){return u.id}),this.view.loading(!0),this.with_loader(this.users.update_role({update_role:{users:user_ids,role_id:role_id}}))["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){var i,len,ref;for(_this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),i=0,len=(ref=_this.selected_users).length;i<len;i++)ref[i].set({role_id:role_id,role_name:role_name});return response}}(this));else for(i=0,len=(ref=this.selected_users).length;i<len;i++)(user=ref[i]).__old_role__||(user.__old_role__=user.role_id),user.set({role_id:role_id,changed:user.__old_role__!==role_id});return UpdateRole.__super__.close.apply(this,arguments)},UpdateRole.prototype.unload=function(){return this.selected_users=null,UpdateRole.__super__.unload.apply(this,arguments)},UpdateRole}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.DiscussionEdit=function(superClass){function DiscussionEdit(){return DiscussionEdit.__super__.constructor.apply(this,arguments)}return extend(DiscussionEdit,superClass),DiscussionEdit.prototype.id="discussion_edit",DiscussionEdit.prototype.load=function(context){var meta,ref;return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.Discussion?this.discussion=context.data:(meta=this.build_meta(context.data.resource),this.discussion=$r.Discussion.build({course_id:pi.app.course_id,course_session_id:null!=(ref=context.data)?ref.session_id:void 0,meta:meta})),null!=pi.app.program_id&&(this.discussion.program_id=pi.app.program_id),this.view.loaded(this.discussion)},DiscussionEdit.prototype.reload=function(context){if("select_material"===context.context&&context.data instanceof $r.Base)return this.discussion.set({meta:this.build_meta(context.data)})},DiscussionEdit.prototype.save=function(data){return null!=this.discussion?this.with_loader(this.discussion.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},DiscussionEdit.prototype.select_material=function(){return this["switch"]("select_material")},DiscussionEdit.prototype.remove_material=function(){return this.discussion.set({meta:null})},DiscussionEdit.prototype.unload=function(){return this.discussion=null,DiscussionEdit.__super__.unload.apply(this,arguments)},DiscussionEdit.prototype.build_meta=function(resource){var meta,ref;return meta={},null==resource?meta:(resource instanceof $r.Quiz?(meta.quiz_pos=resource.position,meta.quiz_id=resource.id):(meta.material_pos=resource.position,meta.material_id=resource.id),meta.section_id=resource.section_id,meta.section_pos=null!=(ref=$r.Section.get(resource.section_id))?ref.position:void 0,meta)},DiscussionEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.DiscussionChatEdit=function(superClass){function DiscussionChatEdit(){return DiscussionChatEdit.__super__.constructor.apply(this,arguments)}return extend(DiscussionChatEdit,superClass),DiscussionChatEdit.prototype.id="discussion_edit",DiscussionChatEdit.prototype.close=function(data){return this.exit(data)},DiscussionChatEdit}(pi.controllers.DiscussionEdit)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CommentEdit=function(superClass){function CommentEdit(){return CommentEdit.__super__.constructor.apply(this,arguments)}return extend(CommentEdit,superClass),CommentEdit.prototype.id="comment_edit",CommentEdit.prototype.load=function(context){var ref;return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.Comment?this.comment=context.data:(null!=pi.app.course_session_id?this.comment=$r.Comment.build({course_id:pi.app.course_id,course_session_id:pi.app.course_session_id}):this.comment=$r.Comment.build({course_id:pi.app.course_id,course_session_id:null!=(ref=context.data)?ref.session_id:void 0}),this.comment.discussion_id=pi.app.discussion.id),this.view.loaded(this.comment)},CommentEdit.prototype.save=function(data){return null!=this.comment?this.with_loader(this.comment.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},CommentEdit.prototype.unload=function(){return this.comment=null,CommentEdit.__super__.unload.apply(this,arguments)},CommentEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Discussions=function(superClass){function Discussions(){return Discussions.__super__.constructor.apply(this,arguments)}return extend(Discussions,superClass),Discussions.include(pi.controllers.Paginated,pi.controllers.SessionsFilter),Discussions.prototype.id="discussions",Discussions.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},Discussions.list_resource($r.Discussion),Discussions.prototype.initialize=function(){var hash_data,ref,ref1;return Discussions.__super__.initialize.apply(this,arguments),this.view.options.per_page&&(this.per_page=this.view.options.per_page),null!=pi.app.program_id?this.scope().set({program_id:pi.app.program_id}):(this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1)),null!=pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.session_id=0|hash_data.session_id,this.scope().set({course_session_id:this.session_id}),this.view.ensure_session(this.session_id)),this.searching=!1,this.base_resource=this.resources,this.search_resource=this.resources.Searcher,this.next_page()},Discussions.prototype.load=function(){var ref;return null!=(null!=(ref=this.host_context)?ref.args:void 0)&&(this.scope().set(this.host_context.args),this._initialized=!1),Discussions.__super__.load.apply(this,arguments)},Discussions.prototype["new"]=function(resource){return this["switch"]("discussion_edit",{session_id:this.session_id,resource:resource})},Discussions.prototype.edit=function(data){return this["switch"]("discussion_edit",data)},Discussions.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},Discussions.prototype.edit_program=function(){return this["switch"]("program_edit",pi.app.program)},Discussions.prototype.show=function(id){var discussion;if(null!=(discussion=this.resources.get(id)))return this["switch"]("discussion_show",discussion)},Discussions.prototype.search=function(q){if(q)return this.scope().reload(),this.toggle_search_state(!0),Discussions.__super__.search.apply(this,arguments);this.toggle_search_state(!1)&&Discussions.__super__.search.apply(this,arguments)},Discussions.prototype.toggle_search_state=function(val){if(val!==this.searching)return this.searching=val,this.searching?this.resources=this.search_resource:(this.scope().reload(),this.resources=this.base_resource),this.view.searching(val),!0},Discussions.prototype._parse_response=function(data){return data[this.resources.resources_name]},Discussions.prototype.unload=function(){return Discussions.__super__.unload.apply(this,arguments),delete this._scope,delete this._page,this._initialized=!1},Discussions}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.PopupDiscussions=function(superClass){function PopupDiscussions(){return PopupDiscussions.__super__.constructor.apply(this,arguments)}return extend(PopupDiscussions,superClass),PopupDiscussions.prototype.id="chat_discussions",PopupDiscussions.prototype.load=function(context){var ref,ref1;return this.args=context.data,(null!=(ref=this.args)?ref.material_id:void 0)&&(this.material=$r.Material.get(this.args.material_id)),(null!=(ref1=this.args)?ref1.quiz_id:void 0)&&(this.material=$r.Quiz.get(this.args.quiz_id)),PopupDiscussions.__super__.load.apply(this,arguments)},PopupDiscussions.prototype.close=function(data){var _this;return(this.context&&"function"==typeof this.context.preunload?this.context.preunload():utils.resolved_promise()).then((_this=this,function(){return PopupDiscussions.__super__.close.call(_this,data)})),!1},PopupDiscussions.prototype.unload=function(){var ref;return null!=(ref=this.context)&&ref.unload(),this._initialized=!1,this.context=void 0,this.context_id=void 0,PopupDiscussions.__super__.unload.apply(this,arguments)},PopupDiscussions.prototype.next_page=function(){var ref;return null!=(ref=this.context)&&"function"==typeof ref.next_page?ref.next_page():void 0},PopupDiscussions}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SelectMaterial=function(superClass){function SelectMaterial(){return SelectMaterial.__super__.constructor.apply(this,arguments)}return extend(SelectMaterial,superClass),SelectMaterial.prototype.id="select_material",SelectMaterial.prototype.select=function(item){return this.close(item)},SelectMaterial}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.DiscussionShow=function(superClass){function DiscussionShow(){return DiscussionShow.__super__.constructor.apply(this,arguments)}return extend(DiscussionShow,superClass),DiscussionShow.include(pi.controllers.Paginated),DiscussionShow.prototype.id="discussion_show",DiscussionShow.list_resource($r.Comment),DiscussionShow.prototype.initialize=function(){var comment_id,course_id,hash_data,ref,ref1,_this;return DiscussionShow.__super__.initialize.apply(this,arguments),this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.discussion||(this.discussion=pi.app.discussion),null!=pi.app.program_id&&(this.discussion.program_id=pi.app.program_id),course_id=pi.app.course_id||this.discussion.course_id,this.scope().set({discussion_id:this.discussion.id,course_id:course_id,program_id:pi.app.program_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:course_id},!1),null!=pi.app.course_session_id&&(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1)),null!=(hash_data=hash.get()).comment_id&&(comment_id=0|hash_data.comment_id),this.index().then((_this=this,function(){if(null!=comment_id)return _this.show_comment(comment_id)}))},DiscussionShow.prototype.load=function(context){return(null!=context?context.data:void 0)instanceof $r.Discussion&&(this.discussion=context.data),DiscussionShow.__super__.load.apply(this,arguments)},DiscussionShow.prototype.edit_discussion=function(){return this["switch"]("discussion_edit",pi.app.discussion)},DiscussionShow.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},DiscussionShow.prototype.edit_program=function(){return this["switch"]("program_edit",pi.app.program)},DiscussionShow.prototype.create_answer=function(data){var comment,_this;return(comment=$r.Comment.build(data)).discussion_id=this.discussion.id,comment.course_id=this.discussion.course_id,pi.app.program_id&&(comment.program_id=pi.app.program_id),this.with_loader(comment.save().then((_this=this,function(){return _this.view.form.clear()})))},DiscussionShow.prototype.destroy_discussion=function(){return this.confirm((_this=this,function(){return _this.with_loader(pi.app.discussion.destroy().then(function(){return _this.location(window.location.href.replace(/\d+\/?$/,""))}))}))["with"](pi.app.discussion,"discussions/destroy_confirm");var _this},DiscussionShow.prototype.show_comment=function(id){var _old_per_page,first_id,_this;return null!=$r.Comment.get(id)?this.view.show_comment(id):(first_id=this.view.list.items[0].record.id,_old_per_page=this.per_page,this.per_page=Math.max(this.per_page,first_id-id+5),this.index({first_id:first_id}).then((_this=this,function(){return _this.per_page=_old_per_page,_this.view.show_comment(id)}))["catch"](function(_this){return function(e){return utils.error(e),_this.per_page=_old_per_page}}(this)))},DiscussionShow.prototype.edit_comment=function(id){var comment;if(null!=(comment=$r.Comment.get(id)))return this["switch"]("comment_edit",comment)},DiscussionShow.prototype.destroy_comment=function(id){var comment,_this;if(null!=(comment=$r.Comment.get(id)))return this.confirm((_this=this,function(){return _this.with_loader(comment.destroy())}))["with"](comment,"discussions/destroy_comment_confirm")},DiscussionShow.prototype.reply=function(){return this.view.show_form()},DiscussionShow.prototype.reply_to=function(id){var comment;if(null!=(comment=$r.Comment.get(id)))return this.view.show_form(comment)},DiscussionShow.prototype.subscribe=function(){return this.with_loader(this.discussion.subscribe({course_session_id:this.discussion.course_session_id||pi.app.course_session_id})).then((_this=this,function(){return _this.view.subscribed()}));var _this},DiscussionShow.prototype.unsubscribe=function(){return this.with_loader(this.discussion.unsubscribe({course_session_id:this.discussion.course_session_id||pi.app.course_session_id})).then((_this=this,function(){return _this.view.unsubscribed()}));var _this},DiscussionShow.prototype.pin=function(){return this.with_loader(this.discussion.pin()).then((_this=this,function(){return _this.view.pinned()}));var _this},DiscussionShow.prototype.unpin=function(){return this.with_loader(this.discussion.unpin()).then((_this=this,function(){return _this.view.unpinned()}));var _this},DiscussionShow.prototype.unload=function(){return DiscussionShow.__super__.unload.apply(this,arguments),delete this._scope,delete this._page,this._initialized=!1},DiscussionShow}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.MeetingEdit=function(superClass){function MeetingEdit(){return MeetingEdit.__super__.constructor.apply(this,arguments)}return extend(MeetingEdit,superClass),MeetingEdit.prototype.id="meeting_edit",MeetingEdit.prototype.initialize=function(){return MeetingEdit.__super__.initialize.apply(this,arguments)},MeetingEdit.prototype.load=function(context){var date,ts,_this;return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.Meeting?(this.meeting=context.data,this.meeting.participants_loaded?this.view.loaded(this.meeting):this.with_loader($r.Meeting.show({id:this.meeting.id}).then((_this=this,function(){return _this.view.loaded(_this.meeting)})))):(ts="en"===("undefined"!=typeof I18n&&null!==I18n?I18n.locale:void 0)?utils.time.now("%I:%M %p"):utils.time.now("%H:%M"),date=utils.time.now("%Y-%m-%d"),this.meeting=$r.Meeting.build({started_at_time:ts,started_at_date:date}),this.meeting.participants().build(pi.app.user,!0,{role_id:$r.Meeting.PRESENTER}),this.meeting.participants_loaded=!0,this.view.default_type(),this.view.loaded(this.meeting))},MeetingEdit.prototype.reload=function(context){var file_obj,i,len,ref,results,user;if(null!=context.data.file&&(utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)),null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.meeting.participants().build(user,!1,{changed:!0,role_id:$r.Meeting.LISTENER}));return results}},MeetingEdit.prototype.destroy=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.meeting.participants().remove(user));return results},MeetingEdit.prototype.add_users=function(users){return pi.app.tour.stop(),this["switch"]("select_users",{users:users})},MeetingEdit.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},MeetingEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},MeetingEdit.prototype.edit_survey=function(){return this.meeting._persisted?this["switch"]("survey_edit",{target:this.meeting,survey:this.meeting.survey}):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this["switch"]("survey_edit",{target:_this.meeting,survey:_this.meeting.survey})})):pi.Nod.win.scrollToNod(this.view.form);var _this},MeetingEdit.prototype.generate_widget=function(account_id){return this.meeting._persisted?this.view.show_widget_code(account_id,this.meeting.id):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this.view.show_widget_code(account_id,_this.meeting.id)})):pi.Nod.win.scrollToNod(this.view.form);var _this},MeetingEdit.prototype.update_slug=function(value){return this.with_loader(this.meeting.save({slug:value})).then((_this=this,function(){
return _this.view.slug_updated()}));var _this},MeetingEdit.prototype.remove_survey=function(){var ref,_this;if(null!=(ref=this.meeting.survey)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.meeting.survey.destroy().then(function(){return _this.meeting.trigger("update")}))}))["with"](this.meeting,"surveys/destroy_confirm")},MeetingEdit.prototype.preview=function(){if(null!=this.meeting.apply_url)return window.open(this.meeting.apply_url,"_blank")},MeetingEdit.prototype.save=function(data){var _this;if(!this._xhr_loading)return null!=this.meeting?this.with_loader(this.meeting.save(data)).then((_this=this,function(){var i,len,ref;for(i=0,len=(ref=_this.meeting.participants().all()).length;i<len;i++)delete ref[i].changed;return _this.view.handle_type_changed(_this.meeting.access_type)})):this.exit()},MeetingEdit.prototype.unload=function(){return this._participants_updated&&(this.meeting.participants().clear_all(),this.meeting.participants_loaded=!1),this.meeting=null,MeetingEdit.__super__.unload.apply(this,arguments)},MeetingEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Meetings=function(superClass){function Meetings(){return Meetings.__super__.constructor.apply(this,arguments)}return extend(Meetings,superClass),Meetings.include(pi.controllers.Paginated),Meetings.list_resource(pi.resources.Meeting),Meetings.prototype.id="meetings",Meetings.prototype.initialize=function(){if(Meetings.__super__.initialize.apply(this,arguments),this.view.options.filter&&this.scope().set({filter:this.view.options.filter}),this.next_page(),"new"===hash.get().goto)return this["new"]()},Meetings.prototype["new"]=function(){return pi.app.tour.stop(),this["switch"]("meeting_edit")},Meetings.prototype.edit=function(data){return pi.app.tour.stop(),this["switch"]("meeting_edit",data)},Meetings.prototype.destroy=function(meeting){return this.confirm((_this=this,function(){return _this.with_loader(meeting.destroy())}))["with"](meeting,"meetings/destroy_confirm");var _this},Meetings.prototype.finish=function(id){var meeting,_this;return meeting=this.meetings.get(id),this.confirm((_this=this,function(){return _this.with_loader(meeting.finish())}))["with"](meeting,"meetings/finish_confirm")},Meetings}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetingRecordings=function(superClass){function MeetingRecordings(){return MeetingRecordings.__super__.constructor.apply(this,arguments)}return extend(MeetingRecordings,superClass),MeetingRecordings.include(pi.controllers.Scoped),MeetingRecordings.include(pi.controllers.Paginated),MeetingRecordings.list_resource(pi.resources.MeetingRecording),MeetingRecordings.prototype.id="meeting_recordings",MeetingRecordings.prototype.initialize=function(){return MeetingRecordings.__super__.initialize.apply(this,arguments),this.meeting=pi.app.meeting,null!=pi.app.meeting_id&&this.scope().set({meeting_id:pi.app.meeting_id}),this.next_page()},MeetingRecordings.prototype.edit_meeting=function(){return this["switch"]("meeting_edit",this.meeting)},MeetingRecordings.prototype.show=function(id){return $r.Recording.find(id)["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(el){return _this["switch"]("recording_show",el)}}(this));var _this},MeetingRecordings.prototype.unload=function(){return MeetingRecordings.__super__.unload.apply(this,arguments)},MeetingRecordings}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetingSelect=function(superClass){function MeetingSelect(){return MeetingSelect.__super__.constructor.apply(this,arguments)}return extend(MeetingSelect,superClass),MeetingSelect.include(pi.controllers.Popuped),MeetingSelect.prototype.id="meeting_select",MeetingSelect.prototype.initialize=function(){return this.scope().set({filter:"all"}),MeetingSelect.__super__.initialize.apply(this,arguments)},MeetingSelect.prototype.select=function(data){return this.close(data)},MeetingSelect}(pi.controllers.Meetings)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetingShow=function(superClass){function MeetingShow(){return MeetingShow.__super__.constructor.apply(this,arguments)}return extend(MeetingShow,superClass),MeetingShow.include(pi.controllers.Scoped),MeetingShow.include(pi.controllers.Paginated),MeetingShow.list_resource(pi.resources.MeetingListener),MeetingShow.prototype.id="meeting_show",MeetingShow.prototype.initialize=function(){if(MeetingShow.__super__.initialize.apply(this,arguments),this.meeting=pi.app.meeting,null!=pi.app.meeting_id&&this.scope().set({meeting_id:pi.app.meeting_id}),this.next_page(),"edit"===hash.get().goto)return this.edit_meeting()},MeetingShow.prototype.reload=function(context){if("meeting_edit"===context.context)return this.scope().reload(),this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))}));var _this},MeetingShow.prototype.edit_meeting=function(){return this["switch"]("meeting_edit",this.meeting)},MeetingShow.prototype.unload=function(){return MeetingShow.__super__.unload.apply(this,arguments)},MeetingShow}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingGuestLogin=function(superClass){function ClickmeetingGuestLogin(){return ClickmeetingGuestLogin.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingGuestLogin,superClass),ClickmeetingGuestLogin.prototype.id="clickmeeting_guest_login",ClickmeetingGuestLogin.prototype.load=function(){return ClickmeetingGuestLogin.__super__.load.apply(this,arguments),this.view.form.value({nickname:pi.app.user.fullname,email:pi.app.user.notification_email})},ClickmeetingGuestLogin.prototype.register=function(data){var params,_this;return params={id:data.meeting_id,nickname:data.nickname,email:data.email,password:data.password},this.with_loader($r.ClickmeetingMeeting.guest_login(params).then((_this=this,function(response){return _this.location(response.url)})))},ClickmeetingGuestLogin}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingRegister=function(superClass){function ClickmeetingRegister(){return ClickmeetingRegister.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingRegister,superClass),ClickmeetingRegister.prototype.id="clickmeeting_register",ClickmeetingRegister.prototype.register=function(data){var params,_this;return params={id:data.meeting_id,password:data.password},this.with_loader($r.ClickmeetingMeeting.register(params).then((_this=this,function(){return _this.location(_this.view.data().redirect)})))},ClickmeetingRegister}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingApply=function(superClass){function ClickmeetingApply(){return ClickmeetingApply.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingApply,superClass),ClickmeetingApply.prototype.id="clickmeeting_apply",ClickmeetingApply.prototype.auth=function(){return this["switch"]("authorize")},ClickmeetingApply.prototype.show_video=function(url){if(!this._loading&&url)return this["switch"]("document_show",{category:"video",external_type:"youtube",external:url})},ClickmeetingApply.prototype.show_material=function(id){var mat,_this;if(!this._loading&&(mat=$r.Material.get(id)))return this._loading=!0,mat.demo_expiring().then((_this=this,function(){return _this._loading=!1,_this["switch"]("document_show",mat)}))},ClickmeetingApply.prototype.register=function(meeting_id,access_type){var params,_this;return 2===access_type?this["switch"]("authorize"):(params={id:meeting_id},$r.ClickmeetingMeeting.register(params).then((_this=this,function(){return _this.location(_this.view.data().redirect)}))["catch"](function(_this){return function(error){return _this.view.error(error.message)}}(this)))},ClickmeetingApply}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.ClickmeetingMeetingEdit=function(superClass){function ClickmeetingMeetingEdit(){return ClickmeetingMeetingEdit.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingEdit,superClass),ClickmeetingMeetingEdit.prototype.id="clickmeeting_meeting_edit",ClickmeetingMeetingEdit.prototype.initialize=function(){return ClickmeetingMeetingEdit.__super__.initialize.apply(this,arguments)},ClickmeetingMeetingEdit.prototype.load=function(context){var date,time,ts,_this;return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&Object.keys(context.data).length>0?context.data instanceof $r.ClickmeetingMeeting?(this.meeting=context.data,this.meeting.participants_loaded?this.view.loaded(this.meeting):this.with_loader($r.ClickmeetingMeeting.show({id:this.meeting.id}).then((_this=this,function(){return _this.view.loaded(_this.meeting)})))):null!=context.data.id?this.with_loader($r.ClickmeetingMeeting.show({id:context.data.id}).then(function(_this){return function(response){return _this.meeting=response,_this.view.loaded(_this.meeting)}}(this))):void 0:(time=new Date,ts="en"===("undefined"!=typeof I18n&&null!==I18n?I18n.locale:void 0)?utils.time.format(new Date(time.getTime()+6e5),"%I:%M %p"):utils.time.format(new Date(time.getTime()+6e5),"%H:%M"),date=utils.time.now("%Y-%m-%d"),this.meeting=$r.ClickmeetingMeeting.build({starts_at_time:ts,starts_at_date:date,duration_h:0,duration_m:30,room_type:"webinar"}),this.meeting.participants().build(pi.app.user,!0,{role_id:$r.ClickmeetingMeeting.PRESENTER}),this.meeting.participants_loaded=!0,this.view.default_type(),this.view.loaded(this.meeting))},ClickmeetingMeetingEdit.prototype.destroy=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.meeting.participants().remove(user));return results},ClickmeetingMeetingEdit.prototype.add_users=function(users){return this["switch"]("select_users",{users:users})},ClickmeetingMeetingEdit.prototype.reload=function(context){var file_obj,i,len,ref,results,user;if(null!=context.data.file&&(utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)),null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.meeting.participants().build(user,!1,{changed:!0,role_id:$r.Meeting.LISTENER}));return results}},ClickmeetingMeetingEdit.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},ClickmeetingMeetingEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},ClickmeetingMeetingEdit.prototype.edit_survey=function(){return this.meeting._persisted?this["switch"]("survey_edit",{target:this.meeting,survey:this.meeting.survey}):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this["switch"]("survey_edit",{target:_this.meeting,survey:_this.meeting.survey})})):pi.Nod.win.scrollToNod(this.view.form);var _this},ClickmeetingMeetingEdit.prototype.remove_survey=function(){var ref,_this;if(null!=(ref=this.meeting.survey)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.meeting.survey.destroy().then(function(){return _this.meeting.trigger("update")}))}))["with"](this.meeting,"surveys/destroy_confirm")},ClickmeetingMeetingEdit.prototype.update_slug=function(value){return this.with_loader(this.meeting.save({custom_room_url_name:value})).then((_this=this,function(){return _this.view.slug_updated()}));var _this},ClickmeetingMeetingEdit.prototype.preview=function(){if(null!=this.meeting.apply_url)return window.open(this.meeting.apply_url,"_blank")},ClickmeetingMeetingEdit.prototype.save=function(data){var _this;if(!this._xhr_loading)return null!=this.meeting?(data.duration=data.duration_h+":"+data.duration_m,this.with_loader(this.meeting.save(data)).then((_this=this,function(){var i,len,ref;for(i=0,len=(ref=_this.meeting.participants().all()).length;i<len;i++)delete ref[i].changed;return _this.view.handle_type_changed(_this.meeting.access_type),_this.view.toggle_permanent(_this.meeting.permanent)}))):this.exit()},ClickmeetingMeetingEdit.prototype.exit=function(){var goto_action;if(ClickmeetingMeetingEdit.__super__.exit.apply(this,arguments),"new"===(goto_action=hash.get().goto)||"edit"===goto_action)return location.href="/manager/active/meetings"},ClickmeetingMeetingEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingMeetings=function(superClass){function ClickmeetingMeetings(){return ClickmeetingMeetings.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetings,superClass),ClickmeetingMeetings.include(pi.controllers.Paginated),ClickmeetingMeetings.list_resource(pi.resources.ClickmeetingMeeting),ClickmeetingMeetings.prototype.id="clickmeeting_meetings",ClickmeetingMeetings.prototype.initialize=function(){return ClickmeetingMeetings.__super__.initialize.apply(this,arguments),this.view.options.filter&&this.scope().set({filter:this.view.options.filter}),this.next_page().then((_this=this,function(){var hash_data;return"new"===(hash_data=hash.get()).goto?_this["new"]():"edit"===hash_data.goto?_this.edit({id:hash_data.id}):void 0}));var _this},ClickmeetingMeetings.prototype["new"]=function(){return pi.app.tour.stop(),this["switch"]("clickmeeting_meeting_edit")},ClickmeetingMeetings.prototype.edit=function(data){return pi.app.tour.stop(),this["switch"]("clickmeeting_meeting_edit",data)},ClickmeetingMeetings.prototype.destroy=function(meeting){return this.confirm((_this=this,function(){return _this.with_loader(meeting.destroy())}))["with"](meeting,"meetings/destroy_confirm");var _this},ClickmeetingMeetings.prototype.send_report=function(id){return $r.ClickmeetingMeeting.find(id)["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(meeting){return _this.with_loader(meeting.send_report()).then(response(function(){if(null!=("undefined"!=typeof response&&null!==response?response.message:void 0))return _this.view.success(response.message)}))}}(this));var _this},ClickmeetingMeetings.prototype.go_to_applications=function(id){return this.with_loader($r.ClickmeetingMeeting.show({id:id}).then((_this=this,function(meeting){if(meeting.is_moderator)return _this.location("/clickmeeting_meetings/"+meeting.id+"/applications","_blank")})));var _this},ClickmeetingMeetings}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingMeetingSelect=function(superClass){function ClickmeetingMeetingSelect(){return ClickmeetingMeetingSelect.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingSelect,superClass),ClickmeetingMeetingSelect.include(pi.controllers.Popuped),ClickmeetingMeetingSelect.prototype.id="clickmeeting_meeting_select",ClickmeetingMeetingSelect.prototype.initialize=function(){return this.scope().set({filter:"active"}),ClickmeetingMeetingSelect.__super__.initialize.apply(this,arguments)},ClickmeetingMeetingSelect.prototype.select=function(data){return this.close(data)},ClickmeetingMeetingSelect}(pi.controllers.ClickmeetingMeetings)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.LabelsEdit=function(superClass){function LabelsEdit(){return LabelsEdit.__super__.constructor.apply(this,arguments)}return extend(LabelsEdit,superClass),LabelsEdit.prototype.id="labels_edit",LabelsEdit.has_resource($r.Label),LabelsEdit.has_resource($r.User),LabelsEdit.prototype.load=function(context_data){return this.selected_users=context_data.data.users,LabelsEdit.__super__.load.apply(this,arguments)},LabelsEdit.prototype.unload=function(){return this.selected_users=null,LabelsEdit.__super__.unload.apply(this,arguments)},LabelsEdit.prototype.create=function(params){return this.view.loading(!0),this.with_loader(this.labels.create(params))},LabelsEdit.prototype.update=function(id,data){var label,_this;if(null!=(label=$r.Label.get(id)))return this.with_loader(label.save(data)).then((_this=this,function(){return _this.view.label_updated(label)}))},LabelsEdit.prototype.destroy=function(label){return this.confirm((_this=this,function(){return _this.with_loader(label.destroy())}))["with"](label,"labels/destroy_confirm");var _this},LabelsEdit.prototype.select=function(labels){var i,j,label,labels_data,len,len1,ref,user;if(null==this.selected_users)return this.close(labels);for(labels_data={},i=0,len=labels.length;i<len;i++)labels_data[(label=labels[i]).group_id]=label.id;for(j=0,len1=(ref=this.selected_users).length;j<len1;j++)user=ref[j],utils.extend(user.labels,labels_data,!0),user.trigger("update");return this.close()},LabelsEdit.prototype.save=function(labels){var data,i,label,len;if(null!=this.selected_users){for((data={users:this.selected_users.map(function(u){return u.id})}).labels={},i=0,len=labels.length;i<len;i++)label=labels[i],data.labels[label.group_id]=label.id;return this.view.loading(!0),this.users.create_labels(data)["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){var j,len1,ref,user;for(_this.view.loading(!1),j=0,len1=(ref=_this.selected_users).length;j<len1;j++)user=ref[j],utils.extend(user.labels,data.labels),user.trigger("update");return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this));var _this}},LabelsEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.LabelFilter=function(superClass){function LabelFilter(){return LabelFilter.__super__.constructor.apply(this,arguments)}return extend(LabelFilter,superClass),LabelFilter.prototype.id="labels_filter",LabelFilter.prototype.load=function(){return LabelFilter.__super__.load.apply(this,arguments),this.resolve_loaded()},LabelFilter.prototype.resolve_loaded=function(){return pi.app.labels_is_loaded?this.view.select_labels():after(800,(_this=this,function(){return _this.load_labels()}));var _this},LabelFilter.prototype.choose=function(labels){return this.close({labels:labels})},LabelFilter.prototype.load_labels=function(){return this.with_loader($r.Label.fetch().then((_this=this,function(data){return data.labels.length>0?(_this.view.load_labels(data.labels),_this.view.hide_loading(),_this.view.select_labels()):_this.view.show_empty_labels(),pi.app.labels_is_loaded=!0,data})));var _this},LabelFilter}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.UserEdit=function(superClass){function UserEdit(){return UserEdit.__super__.constructor.apply(this,arguments)}return extend(UserEdit,superClass),UserEdit.prototype.id="user_edit",UserEdit.prototype.load=function(context_data){return context_data.data instanceof $r.User&&(this.user=context_data.data),UserEdit.__super__.load.apply(this,arguments)},UserEdit.prototype.unload=function(){return this.user=null,UserEdit.__super__.unload.apply(this,arguments)},UserEdit.prototype.save=function(data){return utils.debug(data),this.view.loading(!0),this.user.save(data)["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this));var _this},UserEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,/^[^\[]+\[\#(\d+)\][^\[]+\[\#(\d+)\]/,pi.controllers.UsersImport=function(superClass){function UsersImport(){return UsersImport.__super__.constructor.apply(this,arguments)}return extend(UsersImport,superClass),UsersImport.prototype.id="users_import",UsersImport.prototype.initialize=function(){return UsersImport.__super__.initialize.apply(this,arguments),this._fields=["email","last_name","name","password","phone","description"],this._dummy=["example@mail.tb","\u0418\u0432\u0430\u043d\u043e\u0432","\u0418\u0432\u0430\u043d","","71231234567","\u041f\u043e\u0440\u0442\u0444\u043e\u043b\u0438\u043e: http://example.com"]},UsersImport.prototype.download_template=function(){var data,field,headers,i,j,k,label,len,len1,ref,ref1,wb_binary,workbook,worksheet;if(pi.tools.LocalDownload.available()){for(headers=[],data=[],i=j=0,len=(ref=this._fields).length;j<len;i=++j)field=ref[i],headers.push(field),data.push(this._dummy[i]);for(k=0,len1=(ref1=$r.Label.all()).length;k<len1;k++)(label=ref1[k]).group_id||function(label){var l;headers.push(label.name),null!=(l=$r.Label.get_by({group_id:label.id}))?data.push(l.name):data.push("")}(label);return utils.debug({headers:headers,rows:[data]}),(workbook=XLSX.utils.book_new()).SheetNames.push("ImportExample"),worksheet=XLSX.utils.aoa_to_sheet([headers,data]),workbook.Sheets.ImportExample=worksheet,wb_binary=XLSX.write(workbook,{bookType:"xlsx",type:"binary"}),data=pi.tools.LocalDownload.binary_to_octet(wb_binary),pi.tools.LocalDownload.serve(data,"import_example.xlsx","text/xlsx;charset=utf-8")}},UsersImport.prototype.upload=function(file){return this._uploading=!0,this.with_loader($r.User["import"](this.view.form,{file:file},null,this.xhr)).then((_this=this,function(){return _this._uploading=!1,_this.close()}))["catch"](function(_this){return function(e){return utils.error(e),_this._uploading=!1}}(this));var _this},UsersImport.prototype.unload=function(){var ref;return this._uploading&&null!=(ref=this.xhr)&&ref.abort(),this.xhr=null,UsersImport.__super__.unload.apply(this,arguments)},UsersImport}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Users=function(superClass){function Users(){return Users.__super__.constructor.apply(this,arguments)}return extend(Users,superClass),Users.include(pi.controllers.Paginated,pi.controllers.LabelsFilter),Users.list_resource(pi.resources.User),Users.prototype.id="users",Users.prototype.initialize=function(){var roles,_this;return Users.__super__.initialize.apply(this,arguments),hash.get().administration?(roles=[$r.User.SPECIALIST,$r.User.MENTOR,$r.User.MANAGER],this._page=1,this.query({page:1},{role:roles}).then((_this=this,function(response){return _this.view.load(response.users)}))):this.next_page()},Users.prototype.delete_label=function(user_id,group_id,label_id){var data,_this;return(data={users:[user_id],labels:{}}).labels[group_id]=label_id,this.with_loader(this.users.destroy_labels(data)).then((_this=this,function(response){var user;return null!=(user=_this.users.get(user_id))&&(delete user.labels[group_id],user.trigger("update")),response}))},Users.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},Users.prototype["new"]=function(){return this["switch"]("users_invite")},Users.prototype.destroy=function(users){var danger_destroy,data,destroy,_this;return data=users.map(function(u){return u.id}),_this=this,danger_destroy=function(){return _this.with_loader(_this.users.destroy_all({users:data,remove_stats:!0}))},destroy=function(_this){return function(){return _this.with_loader(_this.users.destroy_all({users:data}))}}(this),this.danger_confirm("users/destroy_confirm",{users:data},danger_destroy,destroy)},Users.prototype.lock=function(users){var data,_this;return data=users.map(function(u){return u.id}),this.confirm((_this=this,function(){return _this.with_loader(_this.users.lock({users:data})).then(function(){return _this.reload({data:{reload:!0}})})}))["with"]({users:data},"users/lock_confirm")},Users.prototype.unlock=function(users){var data,_this;return data=users.map(function(u){return u.id}),this.with_loader(this.users.unlock({users:data})).then((_this=this,function(){return _this.reload({data:{reload:!0}})}))},Users.prototype["import"]=function(){return this["switch"]("users_import")},Users.prototype["export"]=function(){var params,qs;return params={labels:this.scope().params.labels},qs=pi.net._data_to_query(params),this.location("/users/export?"+qs,"_blank")},Users.prototype.import_from_active_directory=function(){return this.with_loader(this.users.import_from_ad().then((_this=this,function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),response})));var _this},Users.prototype.all_activation_notify=function(){return this.confirm((_this=this,function(){return _this.with_loader(_this.users.all_activation_notification())}))["with"](null,"users/all_notification_confirm");var _this},Users.prototype.activation_notify=function(users){var data,_this;return data=users.map(function(u){return u.id}),console.log(data),this.confirm((_this=this,function(){return _this.with_loader(_this.users.activation_notification({users:data}))}))["with"]({users:data},"users/notification_confirm")},Users.prototype.edit=function(user){return this["switch"]("user_edit",user)},Users.prototype.edit_labels=function(){return this["switch"]("labels_edit",{mode:"edit"})},Users.prototype.assign_labels=function(users){return this["switch"]("labels_edit",{mode:"update",users:users})},Users.prototype.transfer_ownership=function(user){return this["switch"]("user_transfer_ownership",user)},Users.prototype.mail=function(users){return this["switch"]("users_message",users)},Users.prototype.update_role=function(users){return this["switch"]("update_role",{mode:"select",users:users})},Users.prototype.edit_congregation=function(user){return $r.CoachRule.fetch({user_id:user.id}).then((_this=this,function(response){return _this["switch"]("congregation_edit",{user:user,rules:response.rules})}));var _this},Users.prototype.danger_confirm=function(template,target,danger_confirm,confirm){var _cancel,danger_success,success,template_name;if(_cancel=function(){return pi.app.view.popup.close(pi.app.view.extended_confirm_modal)},template_name="templates/"+template,JST[template_name]&&pi.app.view.extended_confirm_modal)return danger_success=function(){return _cancel().then(danger_confirm)},success=function(){return _cancel().then(confirm)},pi.app.view.extended_confirm_modal.init(JST[template_name](target),danger_success,success,_cancel),pi.app.view.popup.open(pi.app.view.extended_confirm_modal)},Users}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.UsersInvite=function(superClass){function UsersInvite(){return UsersInvite.__super__.constructor.apply(this,arguments)}return extend(UsersInvite,superClass),UsersInvite.prototype.id="users_invite",UsersInvite.prototype.user_params=["name","last_name","phone","email","password","role_id","labels","login"],UsersInvite.prototype.route_resource=$r.User,UsersInvite.prototype.load=function(){return this.users_view=new $r.View($r.User,null,{params:this.user_params}),this.view.bind_resource(this.users_view),UsersInvite.__super__.load.apply(this,arguments)},UsersInvite.prototype.unload=function(){return this.users_view.clear_all(),this.users_view.off(),this.users_view=null,UsersInvite.__super__.unload.apply(this,arguments)},UsersInvite.prototype.reload=function(context_data){if(Array.isArray(context_data.data.users))return this.users_view.load(context_data.data.users.map(function(u){return u.role_id=1,u.id="temp_"+utils.uid(),u.labels||(u.labels={}),u}).filter(function(u){return!!u.email&&utils.is_email(u.email)}))},
UsersInvite.prototype.save=function(){var data,_this;return data=this.users_view.serialize(),utils.debug(this.users_view.serialize()),data.length?this.with_loader(this.route_resource.invite({users:data})).then((_this=this,function(){return _this.close({reload:!0})})):this.close()},UsersInvite.prototype.import_users=function(){return this["switch"]("users_import")},UsersInvite.prototype.add_user=function(data){return data.id="temp_"+utils.uid(),data.labels={},this.users_view.build(data)},UsersInvite.prototype.destroy=function(users){var i,len,results,user;for(results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.users_view.remove_by_id(user.id));return results},UsersInvite.prototype.assign_labels=function(users){return this["switch"]("labels_edit",{mode:"select",users:users})},UsersInvite.prototype.delete_label=function(user_id,group_id,label_id){var user;if(null!=(user=this.users_view.get(user_id))&&user.labels[group_id]===label_id)return delete user.labels[group_id],user.trigger("update")},UsersInvite.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},UsersInvite}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MentoredUsers=function(superClass){function MentoredUsers(){return MentoredUsers.__super__.constructor.apply(this,arguments)}return extend(MentoredUsers,superClass),MentoredUsers.include(pi.controllers.Paginated,pi.controllers.LabelsFilter),MentoredUsers.list_resource($r.User),MentoredUsers.prototype.id="users",MentoredUsers.prototype.initialize=function(){return MentoredUsers.__super__.initialize.apply(this,arguments),this.load_labels().then((_this=this,function(){return _this.next_page()}));var _this},MentoredUsers.prototype.load_labels=function(){return $r.Label.fetch().then((_this=this,function(data){return data.labels.length>0?(_this.view.load_labels(data.labels),_this.view.hide_loading()):_this.view.show_empty_labels(),pi.app.labels_is_loaded=!0,data}));var _this},MentoredUsers.prototype.all_activation_notify=function(){return this.confirm((_this=this,function(){return _this.with_loader(_this.users.all_activation_notification())}))["with"](null,"users/all_notification_confirm");var _this},MentoredUsers.prototype.activation_notify=function(users){var data,_this;return data=users.map(function(u){return u.id}),console.log(data),this.confirm((_this=this,function(){return _this.with_loader(_this.users.activation_notification({users:data}))}))["with"]({users:data},"users/notification_confirm")},MentoredUsers.prototype.mail=function(users){return this["switch"]("users_message",users)},MentoredUsers}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _equal_roles,pi;(pi=context.pi).utils,_equal_roles=function(old,val){return!old&&!val||!(!old||!val)&&old.join(".")===val.sort().join(".")},pi.controllers.SelectUsers=function(superClass){function SelectUsers(){return SelectUsers.__super__.constructor.apply(this,arguments)}return extend(SelectUsers,superClass),SelectUsers.include(pi.controllers.Paginated,pi.controllers.LabelsFilter,pi.controllers.Popuped),SelectUsers.list_resource(pi.resources.User),SelectUsers.prototype.id="select_users",SelectUsers.prototype.data_wrap="users",SelectUsers.prototype.initialize=function(){return SelectUsers.__super__.initialize.apply(this,arguments),this.next_page()},SelectUsers.prototype.postinitialize=function(){return SelectUsers.__super__.postinitialize.apply(this,arguments)},SelectUsers.prototype.load=function(context){if("radio"===context.data.select_type&&(this.view.list.selectable.is_radio=!0),_equal_roles(this._role_ids,context.data.role_ids)||(this._role_ids=context.data.role_ids,this.scope().clear(),this.view.clear(),delete this._page,Array.isArray(this._role_ids)?(this._initialized=!0,this.filter({"memberships.role":this._role_ids})):(this._initialized=!1,this.scope().reload())),SelectUsers.__super__.load.apply(this,arguments),!pi.app.labels_is_loaded&&!pi.app.hide_labels)return after(800,(_this=this,function(){return _this.load_labels()}));var _this},SelectUsers.prototype.load_labels=function(){return $r.Label.fetch().then((_this=this,function(data){return data.labels.length>0?(_this.view.load_labels(data.labels),_this.view.hide_loading()):_this.view.show_empty_labels(),pi.app.labels_is_loaded=!0,data}));var _this},SelectUsers}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.UserTransferOwnership=function(superClass){function UserTransferOwnership(){return UserTransferOwnership.__super__.constructor.apply(this,arguments)}return extend(UserTransferOwnership,superClass),UserTransferOwnership.prototype.id="user_transfer_ownership",UserTransferOwnership.prototype.load=function(){return UserTransferOwnership.__super__.load.apply(this,arguments)},UserTransferOwnership.prototype.select=function(){return this["switch"]("select_users",{select_type:"radio",users:[this.view.from],role_ids:[$r.User.SPECIALIST,$r.User.MANAGER]})},UserTransferOwnership.prototype.reload=function(context){if(null!=context.data.users)return this.target=context.data.users[0],this.view.load_target_user(this.target)},UserTransferOwnership.prototype.transfer_ownership=function(data){var params;return params={user:data.source.id,target:data.target.id},this.target=null,this.with_loader($r.User.transfer_ownership(params))},UserTransferOwnership}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.UsersMessage=function(superClass){function UsersMessage(){return UsersMessage.__super__.constructor.apply(this,arguments)}return extend(UsersMessage,superClass),UsersMessage.prototype.id="users_message",UsersMessage.prototype.load=function(){return UsersMessage.__super__.load.apply(this,arguments)},UsersMessage.prototype.mail=function(data){var params,_this;return(params={message:data.message}).message.users=this.view.to,params.message.course_session_ids=this.view.course_session_ids,this.with_loader($r.User.mail(params)).then((_this=this,function(){return _this.close()}))},UsersMessage}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseTypes=function(superClass){function CourseTypes(){return CourseTypes.__super__.constructor.apply(this,arguments)}return extend(CourseTypes,superClass),CourseTypes.prototype.id="course_types",CourseTypes.prototype.load=function(context){return this.course=context.data.course,CourseTypes.__super__.load.apply(this,arguments)},CourseTypes.prototype.unload=function(){return this.course=null,CourseTypes.__super__.unload.apply(this,arguments)},CourseTypes.prototype.create=function(data){return this.with_loader($r.CourseType.create(data))},CourseTypes.prototype.destroy=function(course_type){return this.confirm(function(){return course_type.destroy()})["with"](course_type,"course_types/destroy_confirm")},CourseTypes.prototype.update=function(id,data){var course_type,_this;if(null!=(course_type=$r.CourseType.get(id)))return this.with_loader(course_type.save(data)).then((_this=this,function(){return _this.view.item_updated(course_type)}))},CourseTypes.prototype.save=function(types){var params,_this;if(null!=this.course)return params={types:types.map(function(type){return type.id})},this.with_loader(this.course.update_types(params)).then((_this=this,function(response){return _this.close(),response}))},CourseTypes}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.CourseSessionEdit=function(superClass){function CourseSessionEdit(){return CourseSessionEdit.__super__.constructor.apply(this,arguments)}return extend(CourseSessionEdit,superClass),CourseSessionEdit.include(pi.controllers.Scoped),CourseSessionEdit.prototype.id="course_session_edit",CourseSessionEdit.prototype.initialize=function(){return CourseSessionEdit.__super__.initialize.apply(this,arguments),this.scope().set({course_id:pi.app.course_id})},CourseSessionEdit.prototype.load=function(context){return CourseSessionEdit.__super__.load.apply(this,arguments),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.CourseSession?this.load_session(context.data):this.new_session()},CourseSessionEdit.prototype.reload=function(context){var i,len,ref,results,user;if("course_sessions_select"===context.context&&context.data instanceof $r.CourseSession&&context.data.id!==this.course_session.id&&this.load_session(context.data),null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.course_session.participants().build(user,!1,{changed:!0,role_id:this.role_to_add}));return results}},CourseSessionEdit.prototype.add_users=function(users){return this.role_to_add=$r.CourseSession.LISTENER,this["switch"]("select_users",{users:users})},CourseSessionEdit.prototype.add_moderators=function(users){return this.role_to_add=$r.CourseSession.MODERATOR,this["switch"]("select_users",{users:users,role_ids:[$r.User.SPECIALIST,$r.User.MANAGER]})},CourseSessionEdit.prototype.new_session=function(){var _finish_date,_start_date,d,ts;return _start_date=utils.time.now("%Y-%m-%d"),(d=new Date).setMonth(d.getMonth()+1),_finish_date=utils.time.format(d,"%Y-%m-%d"),ts="en"===("undefined"!=typeof I18n&&null!==I18n?I18n.locale:void 0)?utils.time.now("%I:%M %p"):utils.time.now("%H:%M"),this.course_session=$r.CourseSession.build({name:"",infinitely:!1,access_type:2,navigation:0,started_at_date:_start_date,finished_at_date:_finish_date,started_at_time:ts,finished_at_time:ts,course_id:pi.app.course.id,include_weekly_report:pi.app.course.include_weekly_report}),this.course_session.participants_loaded=!0,this.view.load_session(this.course_session)},CourseSessionEdit.prototype.load_session=function(session){var _this;if(null!=session)return this.course_session=session,this.course_session.participants_loaded?this.view.load_session(this.course_session):this.with_loader($r.CourseSession.show({id:this.course_session.id}).then((_this=this,function(){return _this.view.load_session(_this.course_session)})))},CourseSessionEdit.prototype.change_session=function(){return this["switch"]("course_sessions_select")},CourseSessionEdit.prototype.save=function(data){var _this;if(!this._xhr_loading)return null!=this.course_session?(data.navigation!==$r.CourseSession.INTERVAL_NAV&&(data.section_opening_interval=null),this.with_loader(this.course_session.save(data)).then((_this=this,function(){var i,len,ref;for(i=0,len=(ref=_this.course_session.participants().all()).length;i<len;i++)delete ref[i].changed;return _this.view.handle_type_changed(_this.course_session.access_type),_this.close()}))):void 0},CourseSessionEdit.prototype.update_slug=function(value){return this.with_loader(this.course_session.save({slug:value})).then((_this=this,function(){return _this.view.slug_updated()}));var _this},CourseSessionEdit.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},CourseSessionEdit.prototype.edit_survey=function(){return this.course_session._persisted?this["switch"]("survey_edit",{target:this.course_session,survey:this.course_session.survey}):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this["switch"]("survey_edit",{target:_this.course_session,survey:_this.course_session.survey})})):pi.Nod.win.scrollToNod(this.view.form);var _this},CourseSessionEdit.prototype.generate_widget=function(account_id){return this.course_session._persisted?this.view.show_widget_code(account_id,this.course_session.id):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this.view.show_widget_code(account_id,_this.course_session.id)})):pi.Nod.win.scrollToNod(this.view.form);var _this},CourseSessionEdit.prototype.remove_survey=function(){var ref,_this;if(null!=(ref=this.course_session.survey)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.course_session.survey.destroy().then(function(){return _this.course_session.trigger("update")}))}))["with"](this.course_session,"surveys/destroy_confirm")},CourseSessionEdit.prototype.remove_participants=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.course_session.participants().remove(user));return results},CourseSessionEdit.prototype.destroy=function(){var ref,_this;if(null!=(ref=this.course_session)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.course_session.destroy().then(function(){return _this.close()}))}))["with"](this.course_session,"course_sessions/destroy_confirm")},CourseSessionEdit.prototype.finish=function(){var ref,_this;if(null!=(ref=this.course_session)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.course_session.finish().then(function(){return _this.close()}))}))["with"](this.course_session,"course_sessions/finish_confirm")},CourseSessionEdit.prototype.unload=function(){return this._participants_updated&&(this.course_session.participants().clear_all(),this.course_session.participants_loaded=!1),this.course_session=null,CourseSessionEdit.__super__.unload.apply(this,arguments)},CourseSessionEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseSessions=function(superClass){function CourseSessions(){return CourseSessions.__super__.constructor.apply(this,arguments)}return extend(CourseSessions,superClass),CourseSessions.include(pi.controllers.Paginated,pi.controllers.CourseTypesFilter),CourseSessions.list_resource(pi.resources.CourseSession),CourseSessions.prototype.id="course_sessions",CourseSessions.prototype.initialize=function(){var hash_data;return CourseSessions.__super__.initialize.apply(this,arguments),this.scope().set({role_id:1}),(hash_data=hash.get()).filter&&(this.scope().set({filter:hash_data.filter}),this.view.filtered(hash_data.filter)),this.next_page()},CourseSessions.prototype["new"]=function(){return this["switch"]("course_edit")},CourseSessions}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseSessionsModerate=function(superClass){function CourseSessionsModerate(){return CourseSessionsModerate.__super__.constructor.apply(this,arguments)}return extend(CourseSessionsModerate,superClass),CourseSessionsModerate.include(pi.controllers.Paginated,pi.controllers.CourseTypesFilter),CourseSessionsModerate.list_resource(pi.resources.CourseSession),CourseSessionsModerate.prototype.id="course_sessions_moderate",CourseSessionsModerate.prototype.initialize=function(){return CourseSessionsModerate.__super__.initialize.apply(this,arguments),this.next_page()},CourseSessionsModerate.prototype["new"]=function(){return this["switch"]("course_edit")},CourseSessionsModerate.prototype._resource_query=function(params){return params.filter||(params.filter="active"),this.with_loader(this.resources.moderate(params))},CourseSessionsModerate}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.OpenCourseSessions=function(superClass){function OpenCourseSessions(){return OpenCourseSessions.__super__.constructor.apply(this,arguments)}return extend(OpenCourseSessions,superClass),OpenCourseSessions.include(pi.controllers.Paginated,pi.controllers.CourseTypesFilter),OpenCourseSessions.list_resource(pi.resources.CourseSession),OpenCourseSessions.prototype.id="open_course_sessions",OpenCourseSessions.prototype.initialize=function(){return OpenCourseSessions.__super__.initialize.apply(this,arguments),this.next_page()},OpenCourseSessions.prototype["new"]=function(){return this["switch"]("course_edit")},OpenCourseSessions.prototype._resource_query=function(params){return this.with_loader(this.resources.open(params))},OpenCourseSessions}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseSessionsSelect=function(superClass){function CourseSessionsSelect(){return CourseSessionsSelect.__super__.constructor.apply(this,arguments)}return extend(CourseSessionsSelect,superClass),CourseSessionsSelect.prototype.id="course_sessions_select",CourseSessionsSelect.prototype.initialize=function(){return CourseSessionsSelect.__super__.initialize.apply(this,arguments)},CourseSessionsSelect.prototype.unload=function(){return CourseSessionsSelect.__super__.unload.apply(this,arguments)},CourseSessionsSelect.prototype.set_session=function(item){return this.close(item)},CourseSessionsSelect}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SessionSelect=function(superClass){function SessionSelect(){return SessionSelect.__super__.constructor.apply(this,arguments)}return extend(SessionSelect,superClass),SessionSelect.include(pi.controllers.Popuped),SessionSelect.prototype.id="session_select",SessionSelect.list_resource(pi.resources.AccountCourseSession),SessionSelect.prototype.initialize=function(){if(SessionSelect.__super__.initialize.apply(this,arguments),this.view.options.filter)return this.scope().set({filter:this.view.options.filter})},SessionSelect.prototype.select=function(data){return this.close(data)},SessionSelect}(pi.controllers.CourseSessions)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseSessionShow=function(superClass){function CourseSessionShow(){return CourseSessionShow.__super__.constructor.apply(this,arguments)}return extend(CourseSessionShow,superClass),CourseSessionShow.prototype.id="course_session_show",CourseSessionShow.prototype.load=function(context){var _this;if(CourseSessionShow.__super__.load.apply(this,arguments),this.course_session=context.data,null!=this.course_session&&this.course_session instanceof $r.CourseSession)return this.course_session.participants_loaded?this.view.load(this.course_session.participants().all()):this.with_loader($r.CourseSession.show({id:this.course_session.id}).then((_this=this,function(){return _this.view.load(_this.course_session.participants().all())})))},CourseSessionShow.prototype.unload=function(){return this.course_session=null,CourseSessionShow.__super__.unload.apply(this,arguments)},CourseSessionShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AgreementForm=function(superClass){function AgreementForm(){return AgreementForm.__super__.constructor.apply(this,arguments)}return extend(AgreementForm,superClass),AgreementForm.prototype.id="agreement_form",AgreementForm.prototype.load=function(){return this.account=pi.app.account,AgreementForm.__super__.load.apply(this,arguments)},AgreementForm.prototype.save=function(data){if(null!=this.account)return this.with_loader(this.account.update_agreement(data)).then((_this=this,function(){return _this.close(!0)}));var _this},AgreementForm}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.Orders=function(superClass){function Orders(){return Orders.__super__.constructor.apply(this,arguments)}return extend(Orders,superClass),Orders.prototype.id="orders",Orders.prototype.load=function(){var hash_data;if(Orders.__super__.load.apply(this,arguments),null!=(hash_data=hash.get()).code)return hash.remove("code"),this["switch"]("subscription_buy",{promo:hash_data.code})},Orders.prototype.buy=function(){return this["switch"]("subscription_buy")},Orders.prototype.extend=function(){return this["switch"]("subscription_buy",{extend:!0})},Orders.prototype.pay=function(id){if(this.order=$r.Order.get(id))return pi.app.account.settings.agreement_type?this["switch"]("payment_form",this.order):this["switch"]("agreement_form")},Orders.prototype.cancel=function(id){var sub,_this;if(null!=(sub=null!=id?$r.Subscription.get(id):pi.app.subscription))return this.confirm((_this=this,function(){return _this.with_loader(sub.cancel()).then(function(){return window.location.reload()})}))["with"](sub,"subscriptions/cancel_confirm")},Orders.prototype.reload=function(context_data){if(Orders.__super__.reload.apply(this,arguments),"agreement_form"===context_data.context&&!0===context_data.data)return this.pay(this.order.id)},Orders}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.PaymentForm=function(superClass){function PaymentForm(){return PaymentForm.__super__.constructor.apply(this,arguments)}return extend(PaymentForm,superClass),PaymentForm.prototype.id="payment_form",PaymentForm.prototype.load=function(context_data){return this.order=context_data.data,PaymentForm.__super__.load.apply(this,arguments)},PaymentForm.prototype.pay=function(data){var url;return null!=(url=this.order[data.type+"_url"])&&this.location(url,"_blank"),this.close()},PaymentForm}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.OrderShow=function(superClass){function OrderShow(){return OrderShow.__super__.constructor.apply(this,arguments)}return extend(OrderShow,superClass),OrderShow.prototype.id="order_show",OrderShow.prototype.load=function(context){var _this;if(null!=context.data)return pi.resources.Order.show({id:context.data})["catch"]((_this=this,function(err){return utils.error(err),_this.view.error(error.message)})).then(function(_this){return function(response){if(_this.order=response,null!=_this.order)return _this.view.loaded(_this.order)}}(this))},OrderShow.prototype.unload=function(){return this.order=null,OrderShow.__super__.unload.apply(this,arguments)},OrderShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.SubscriptionBuy=function(superClass){function SubscriptionBuy(){return SubscriptionBuy.__super__.constructor.apply(this,arguments)}return extend(SubscriptionBuy,superClass),SubscriptionBuy.prototype.id="subscription_buy",SubscriptionBuy.prototype.load=function(context){var attrs,ref,ref1,ref2;if(SubscriptionBuy.__super__.load.apply(this,arguments),this.account=pi.app.account,!0===(null!=(ref=context.data)?ref.extend:void 0)&&null!=pi.app.subscription?(delete(attrs=pi.app.subscription.attributes()).id,attrs.started_at_utc=1e3*(pi.app.subscription.finished_at_utc+86400),this.subscription=$r.Subscription.build(attrs),this.update_memory(attrs.memory),this.update_months(attrs.months)):this.subscription=$r.Subscription.build({started_at_utc:+new Date}),$r.TariffPlan.get_by({free:!0}),this.view.init(this.account,this.subscription),null!=(ref1=context.data)?ref1.promo:void 0)return this.update_promo({code:null!=(ref2=context.data)?ref2.promo:void 0})},SubscriptionBuy.prototype.prev_step=function(){return this.view.prev_step()},SubscriptionBuy.prototype.next_step=function(){return this.view.next_step()},SubscriptionBuy.prototype.update_tariff=function(tariff_plan){return tariff_plan.free?this.subscription.set({tariff_plan_id:tariff_plan.id,free:!0,active_users:tariff_plan.active_users[0],memory:tariff_plan.memory[0],memory_available:tariff_plan.memory[0]+"GB",months:null,finished_at:null,finish_date:null,payment:0}):this.subscription.set({tariff_plan_id:tariff_plan.id,free:!1,active_users:null,memory:null,memory_available:null,payment:null}),this.view.update_nav()},SubscriptionBuy.prototype.update_active_users=function(value){return this.subscription.active_users=value,this.subscription.recount()},SubscriptionBuy.prototype.update_memory=function(value){return this.subscription.memory=value,this.subscription.memory_available=value+"GB",this.subscription.recount()},SubscriptionBuy.prototype.update_months=function(value){var finish_date,finished_at;return finished_at=this.shift_date_months(new Date(this.subscription.started_at_utc),value),finish_date=utils.time.format(new Date(finished_at),I18n.t("date.formats.default")),this.subscription.months=value,this.subscription.finish_date=finish_date,this.subscription.payment=0,this.subscription.recount()},SubscriptionBuy.prototype.update_started_at=function(value){return this.subscription.set_start_date(value),this.subscription.months?this.update_months(this.subscription.months):this.subscription.trigger("update")},SubscriptionBuy.prototype.update_promo=function(data){return this.with_loader($r.PromoCode.check(data)).then((_this=this,function(data){return null!=_this.subscription.payment?(_this.subscription.promo_code=data.promo_code.code,_this.subscription.recount()):_this.subscription.set({promo_code:data.promo_code.code})}));var _this},SubscriptionBuy.prototype.update_payment_types=function(value){return this.subscription.payment_type=value,this.subscription.trigger("update"),this.view.draw_agreement_form(),this.subscription.recount()},SubscriptionBuy.prototype.save=function(){var data,ref,_this;if(null!=this.account)return data=null!=(ref=this.view.selected_form())?ref.read_values():void 0,this.with_loader(this.account.update_agreement(data)).then((_this=this,function(){return _this.with_loader(_this.subscription.save()).then(function(){return window.location.reload()})}))},SubscriptionBuy.prototype.shift_date_months=function(date,months){var d,m,new_date,y;return new_date=new Date(date),m=date.getMonth(),y=date.getFullYear(),d=date.getDate(),m+months>11&&new_date.setFullYear(y+1),1===(m=(m+months)%12)&&d>28&&new_date.setDate(28),(3===m||5===m||8===m||10===m)&&d>30&&new_date.setDate(30),new_date.setMonth(m),new_date},SubscriptionBuy}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.PaymentHistory=function(superClass){function PaymentHistory(){return PaymentHistory.__super__.constructor.apply(this,arguments)}return extend(PaymentHistory,superClass),PaymentHistory.include(pi.controllers.Paginated),PaymentHistory.list_resource(pi.resources.Order),PaymentHistory.prototype.id="payment_history",PaymentHistory.prototype.initialize=function(){return PaymentHistory.__super__.initialize.apply(this,arguments),this.next_page()},PaymentHistory.prototype.show=function(data){return this["switch"]("order_show",data)},PaymentHistory.prototype.pay=function(id){if(this.order=$r.Order.get(id))return pi.app.account.settings.agreement_type?this["switch"]("payment_form",this.order):this["switch"]("agreement_form")},PaymentHistory.prototype.reload=function(context_data){if(PaymentHistory.__super__.reload.apply(this,arguments),"agreement_form"===context_data.context&&!0===context_data.data)return this.pay(this.order.id)},PaymentHistory}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1}
;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Listeners=function(superClass){function Listeners(){return Listeners.__super__.constructor.apply(this,arguments)}return extend(Listeners,superClass),Listeners.include(pi.controllers.Paginated,pi.controllers.LabelsFilter,pi.controllers.SessionsFilter,pi.controllers.CourseTypesFilter),Listeners.list_resource(pi.resources.CourseListenerStat),Listeners.prototype.id="listeners",Listeners.prototype.initialize=function(){var hash_data,ids,ref,ref1,ref2;return Listeners.__super__.initialize.apply(this,arguments),pi.app.course_id&&(this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1)),pi.app.program_id&&(this.scope().set({program_id:pi.app.program_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({program_id:pi.app.program_id},!1)),hash_data=hash.get(),pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref2=pi.app.visitor)&&ref2.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.session_id=0|hash_data.session_id,this.scope().set({course_session_id:this.session_id}),this.view.ensure_session(this.session_id)),null!=hash_data.course_type_ids&&(ids=hash_data.course_type_ids.split(",").map(parseInt),this.scope().set({course_type_id:ids}),this.view.ensure_course_type(ids)),null!=hash_data.course_content_types&&(ids=hash_data.course_content_types.split(",").map(parseInt),this.scope().set({course_content_type:ids}),this.view.ensure_course_content_type(ids)),this.view.buttons_loaded(this.session_id||pi.app.course_session_id),this.labels_filter_initialize(),null!=hash_data.q?($(".search-head-field").input.value(hash_data.q),this.search(hash_data.q)):this.next_page()},Listeners.prototype.reload=function(context){var contexts,ref,_this;return contexts=["course_session_edit","course_stats_transfer"],(!0===context.data.reload||(ref=context.context,indexOf.call(contexts,ref)>=0))&&(this.scope().reload(),this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))}))),this.labels_filter_reload(context)},Listeners.prototype.destroy=function(stat){return this.confirm((_this=this,function(){return _this.with_loader(stat.destroy())}))["with"](stat,"course_stats/destroy_confirm");var _this},Listeners.prototype.edit_course_stats_export=function(){return this["switch"]("course_stats_export_edit",{query_string:this.query_string("course_stats")},{session_id:this.session_id})},Listeners.prototype.edit_answer_stats_export=function(){return this["switch"]("answer_stats_export_edit",{query_string:this.query_string("answer_stats")},{session_id:this.session_id})},Listeners.prototype.query_string=function(report){var params,qs;return params={labels:this._labels_to_params(this.labels),report:report},null==pi.app.course_session_id&&(params.course_session_id=this.session_id),qs=pi.net._data_to_query(params),null!=pi.app.course_session_id?"/api/course_sessions/"+pi.app.course_session_id+"/export?"+qs:null!=pi.app.program_id?"/api/programs/"+pi.app.program_id+"/export?"+qs:"/api/courses/"+pi.app.course.id+"/export?"+qs},Listeners.prototype.export_labeled=function(){var params,qs,query_string,_this;return null!=pi.app.course_session_id?(params={labels:this._labels_to_params(this.labels)},qs=pi.net._data_to_query(params),query_string="/api/course_sessions/"+pi.app.course_session_id+"/export_labeled?"+qs):(params={course_session_id:this.session_id,labels:this._labels_to_params(this.labels)},qs=pi.net._data_to_query(params),query_string=null!=pi.app.program_id?"/api/programs/"+pi.app.program_id+"/export_labeled?"+qs:"/api/courses/"+pi.app.course.id+"/export_labeled?"+qs),pi.Net.get(query_string)["catch"]((_this=this,function(error){throw _this.view.error(error.message),error})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close()}}(this))},Listeners.prototype.show_results=function(id){var stat;if(null!=(stat=$r.CourseListenerStat.get(id)))return this["switch"]("course_stat_show",stat)},Listeners.prototype.mail=function(users){return this["switch"]("users_message",users)},Listeners.prototype.transfer=function(data){return this["switch"]("course_stats_transfer",{users:data,from:this.session_id})},Listeners.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},Listeners.prototype.edit_program=function(){return this["switch"]("program_edit",pi.app.program)},Listeners.prototype.add_listeners=function(){return this["switch"]("course_session_edit",null!=this.session_id?$r.CourseSession.get(this.session_id):void 0)},Listeners}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ListenersTotals=function(superClass){function ListenersTotals(){return ListenersTotals.__super__.constructor.apply(this,arguments)}return extend(ListenersTotals,superClass),ListenersTotals.include(pi.controllers.Paginated,pi.controllers.CourseTypesFilter,pi.controllers.SessionsFilter),ListenersTotals.list_resource(pi.resources.CourseListenerStat),ListenersTotals.prototype.id="listeners_totals",ListenersTotals.prototype.initialize=function(){var ref;return ListenersTotals.__super__.initialize.apply(this,arguments),this.scope().set({program_id:pi.app.program_id}),null!=(ref=pi.app.visitor)&&ref.update_context({program_id:pi.app.program_id},!1),this.next_page()},ListenersTotals.prototype.edit_program=function(){return this["switch"]("program_edit",pi.app.program)},ListenersTotals.prototype.view_details=function(){return this.view.find(".details-link").attrs({href:this._build_details_link()}).node.click()},ListenersTotals.prototype._build_details_link=function(){var current_params,qs,ref,ref1;return current_params=this.scope().params,qs=pi.net._data_to_query({q:current_params.q,course_type_ids:null!=(ref=current_params.course_type_id)?ref.join(","):void 0,course_content_types:null!=(ref1=current_params.course_content_type)?ref1.join(","):void 0}),"/programs/"+pi.app.program_id+"/listeners#"+qs},ListenersTotals.prototype._resource_query=function(params){return this.with_loader(this.resources.totals(params))},ListenersTotals}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.AboutCourse=function(superClass){function AboutCourse(){return AboutCourse.__super__.constructor.apply(this,arguments)}return extend(AboutCourse,superClass),AboutCourse.prototype.id="about_course",AboutCourse.prototype.initialize=function(){return AboutCourse.__super__.initialize.apply(this,arguments),this.course=pi.app.course,this.course.load_participants().then((_this=this,function(){return _this.view.load_participants(_this.course)}));var _this},AboutCourse}(pi.controllers.TBCourseController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.CourseEdit=function(superClass){function CourseEdit(){return CourseEdit.__super__.constructor.apply(this,arguments)}return extend(CourseEdit,superClass),CourseEdit.prototype.id="course_edit",CourseEdit.prototype.load=function(context){return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.Course?(this.course=context.data,this.course.participants_loaded||(this.view.loading(!0),this.course.load_participants()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.view.load_participants(_this.course),response}}(this))),this.view.loaded(this.course)):(this.course=$r.Course.build(),this.course.participants().build(pi.app.user,!0,{role_id:$r.Course.AUTHOR}),this.course.participants_loaded=!0,null!=context.data&&"test"===context.data.type&&(this.course.content_type=2),this.view.loaded(this.course));var _this},CourseEdit.prototype.reload=function(context){var file_obj,i,len,ref,results,user;if(null!=context.data.file&&(utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)),null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.course.participants().build(user,!1,{role_id:$r.Course.AUTHOR}));return results}},CourseEdit.prototype.save=function(data){var _persisted,_this;return null!=this.course?(_persisted=this.course._persisted,this.with_loader(this.course.save(data).then((_this=this,function(){return _persisted?_this.close():_this.location("/courses/"+_this.course.id)})))):this.exit()},CourseEdit.prototype.destroy=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.course.participants().remove(user));return results},CourseEdit.prototype.add_users=function(users){return this["switch"]("select_users",{users:users,role_ids:[$r.User.SPECIALIST,$r.User.MANAGER]})},CourseEdit.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},CourseEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},CourseEdit.prototype.unload=function(){return this._participants_updated&&this.course.participants().clear_all(),this.course=null,CourseEdit.__super__.unload.apply(this,arguments)},CourseEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.Courses=function(superClass){function Courses(){return Courses.__super__.constructor.apply(this,arguments)}return extend(Courses,superClass),Courses.include(pi.controllers.Paginated,pi.controllers.CourseTypesFilter,pi.controllers.CompetencesFilter),Courses.list_resource(pi.resources.Course),Courses.prototype.id="courses",Courses.prototype.start_tour=function(force){null==force&&(force=!1)},Courses.prototype.initialize=function(){var hash_data;if(Courses.__super__.initialize.apply(this,arguments),this.scope(),utils.extend(this._scope.rules,{q:function(prev,query){var ref;return 0===(null!=(ref=query.match(prev))?ref.index:void 0)&&(prev||"")},sort:function(){return!0}}),this.view.options.filter&&this.scope().set({filter:this.view.options.filter}),this.next_page(),"new"===(hash_data=hash.get()).goto)return"test"===hash_data.type?this.new_test():this["new"]()},Courses.prototype["new"]=function(){return this["switch"]("course_edit")},Courses.prototype.new_test=function(){return this["switch"]("course_edit",{type:"test"})},Courses.prototype.edit_competences=function(){return this["switch"]("competences",{mode:"update"})},Courses.prototype.assign_competences=function(data){return this["switch"]("competences",{mode:"select",course:data})},Courses.prototype.edit=function(data){return this["switch"]("course_edit",data)},Courses.prototype.assign_labels=function(data){return this["switch"]("course_types",{mode:"select",course:data})},Courses.prototype.edit_course_types=function(){return this["switch"]("course_types",{mode:"update"})},Courses.prototype.copy=function(data){return this["switch"]("course_copy",data)},Courses.prototype.clone=function(course){return this.with_loader(course.clone().then((_this=this,function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),response})));var _this},Courses.prototype.destroy=function(course){return this.confirm((_this=this,function(){return _this.with_loader(course.destroy())}))["with"](course,"courses/destroy_confirm");var _this},Courses.prototype.share=function(course){return this["switch"]("admin_course_share",course)},Courses.prototype.revoke_share=function(course){return this.with_loader(course.revoke_share().then(window.location.reload()))},Courses}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseCourseSessions=function(superClass){function CourseCourseSessions(){return CourseCourseSessions.__super__.constructor.apply(this,arguments)}return extend(CourseCourseSessions,superClass),CourseCourseSessions.include(pi.controllers.Paginated),CourseCourseSessions.list_resource(pi.resources.CourseSession),CourseCourseSessions.prototype.id="course_course_sessions",CourseCourseSessions.prototype.initialize=function(){var id,_this;if(CourseCourseSessions.__super__.initialize.apply(this,arguments),this.course=pi.app.course,this.scope().set({course_id:this.course.id}),this.next_page(),"new"===hash.get().goto&&this["new"](),null!==hash.get().goto.match(/^[0-9]+$/))return id=hash.get().goto,$r.CourseSession.show({id:id}).then((_this=this,function(course_session){return _this.edit(course_session)}))},CourseCourseSessions.prototype.show=function(id){var session;if(session=$r.CourseSession.get(id))return this["switch"]("course_session_show",session)},CourseCourseSessions.prototype.edit=function(session){return this["switch"]("course_session_edit",session)},CourseCourseSessions.prototype["new"]=function(){return this["switch"]("course_session_edit")},CourseCourseSessions.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},CourseCourseSessions.prototype.destroy=function(session){return this.confirm((_this=this,function(){return _this.with_loader(session.destroy())}))["with"](session,"course_sessions/destroy_confirm");var _this},CourseCourseSessions}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.CourseView=function(superClass){function CourseView(){return CourseView.__super__.constructor.apply(this,arguments)}return extend(CourseView,superClass),CourseView.prototype.id="course_view",CourseView.prototype.load=function(){var id,mat,ref;if(CourseView.__super__.load.apply(this,arguments),this.course=pi.app.course,null!=(ref=pi.app.visitor)&&ref.update_context({course_id:this.course.id},!1),(id=hash.get().id)&&(mat=this.course.materials().get(id))&&"ok"===mat.status_code||(mat=this.find_first()),null!=mat)return this.goto(mat)},CourseView.prototype.open_chat=function(){return this["switch"]("chat_discussions",{material_id:this.material.id})},CourseView.prototype.find_first=function(){return this.course.materials().get_by({status_code:"ok"})},CourseView.prototype.goto=function(material,navigation){var path,_this;if(null==navigation&&(navigation=!1),this.material!==material)return material instanceof $r.Quiz||material instanceof $r.Task||material instanceof $r.ScormPackage?(path=pi.app.user.role_id<2?material.take_path():material.view_path(),this.location(path,"_blank_quiz"),void utils.after(100,(_this=this,function(){return _this.view.ensure_selected(material,!0)}))):(this.material=material,null!=this.material&&hash.add({id:this.material.id}),this.load_material(this.material))},CourseView.prototype.load_material=function(material){return material.view_expiring().then((_this=this,function(){return _this.view.show_material(material),_this.view.set_next(_this.find_next(material)),_this.view.set_prev(_this.find_prev(material))}));var _this},CourseView.prototype.next=function(){var mat;if(mat=this.find_next(this.material))return this.goto(mat,!0)},CourseView.prototype.prev=function(){var mat;if(mat=this.find_prev(this.material))return this.goto(mat,!0)},CourseView.prototype.find_in_section=function(section,next,position){if(null==next&&(next=!0),null==position&&(position=0),section)return next?section.materials().get_by({position:position+1}):(0===position&&(position=section.materials().all().length+1),section.materials().get_by({position:position-1}))},CourseView.prototype.find_relative=function(next){var el,query_object,section;if(null==next&&(next=!0),this.material)return section=this.course.sections().get(this.material.section_id),null!=(el=this.find_in_section(section,next,this.material.position))?el:(query_object=next?{"position>":section.position+1}:{"position<":section.position-1},section=this.course.sections().get_by(query_object),this.find_in_section(section,next))},CourseView.prototype.find_next=function(){return this.find_relative()},CourseView.prototype.find_prev=function(){return this.find_relative(!1)},CourseView}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.CourseTake=function(superClass){function CourseTake(){return CourseTake.__super__.constructor.apply(this,arguments)}return extend(CourseTake,superClass),CourseTake.prototype.id="course_take",CourseTake.prototype.load=function(){var ref,ref1,watcher,_this;return watcher=pi.app.activity_watcher,this.tracker=new $r.StatTracker,this._track=!(null!=(ref=pi.app.course_stat)?ref.deadline_passed:void 0),this._track&&(null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1),watcher.active&&this.tracker.start(),watcher.on("active",(_this=this,function(e){return e.data?(_this.tracker.start(),null!=_this.material?_this.tracker.track(_this.material,!0):void 0):_this.tracker.stop()}))),CourseTake.__super__.load.apply(this,arguments)},CourseTake.prototype.goto=function(material,navigation){var ref,_this;if(null==navigation&&(navigation=!1),this.material!==material)return this.tracker.flush(this.material),material instanceof $r.ScormPackage?(this.location(material.take_path(),"_blank"),void this.tracker.flush(this.material)):material instanceof $r.Task?(this.location(material.take_path(),"_blank"),void this.tracker.flush(this.material)):material instanceof $r.Quiz?(this.confirm((_this=this,function(){return _this.location(material.take_path())}),function(_this){return function(){var mat,quiz,section;if(navigation){if(section=_this.course.sections().get(material.section_id),quiz=_this.find_next_quiz(section,material.position))return utils.after(300,function(){return _this.goto(quiz,!0)});if(section=_this.course.sections().get_by({"position>":section.position+1}),mat=_this.find_in_section(section,!0))return _this.goto(mat,!0)}return _this.tracker.track(_this.material)}}(this))["with"](material,"materials/listeners/quiz_take_confirm"),void(navigation||this.view.ensure_selected(this.material,!0))):(CourseTake.__super__.goto.apply(this,arguments),this._track&&null!=(ref=pi.app.visitor)&&ref.update_context({material_id:this.material.id}),this.tracker.track(this.material))},CourseTake.prototype.load_material=function(material){return material.take_expiring().then((_this=this,function(){return _this.view.show_material(material),_this.view.set_next(_this.find_next(material)),_this.view.set_prev(_this.find_prev(material))}));var _this},CourseTake.prototype.find_in_section=function(section,next,position){if(null==next&&(next=!0),null==position&&(position=0),section)return next?section.materials().get_by({position:position+1})||this.find_next_scorm(section)||this.find_next_quiz(section):CourseTake.__super__.find_in_section.apply(this,arguments)},CourseTake.prototype.find_next_quiz=function(section,position){var i,len,quiz,ref;if(null==position&&(position=0),section)for(i=0,len=(ref=section.quizzes().all()).length;i<len;i++)if((quiz=ref[i]).position>position&&quiz.attempts_available())return quiz},CourseTake.prototype.find_next_scorm=function(section,position){var i,len,ref,scorm;if(null==position&&(position=0),section)for(i=0,len=(ref=section.scorm_packages().all()).length;i<len;i++)if((scorm=ref[i]).position>position)return scorm},CourseTake.prototype.find_first=function(){var _buf,i,len,mat,ref;for(_buf=null,i=0,len=(ref=this.course.materials().all()).length;i<len&&null!=(mat=ref[i]).stat;i++)_buf=mat;return null!=_buf?_buf:CourseTake.__super__.find_first.apply(this,arguments)},CourseTake}(pi.controllers.CourseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.TransferContent=function(superClass){function TransferContent(){return TransferContent.__super__.constructor.apply(this,arguments)}return extend(TransferContent,superClass),TransferContent.prototype.id="transfer_content",TransferContent.prototype.load=function(context){return TransferContent.__super__.load.apply(this,arguments),this.content=context.data.item,this.list=context.data.list},TransferContent.prototype.save=function(){var position,_this;return this.section_id=parseInt(this.view.content.section_select.value()),this.allow_force_complete=this.view.content.allow_force_complete.cb.value(),this.content.section_id===this.section_id?this.close():(position=$r.SectionContent.where({section_id:this.section_id}).length+1,this.content.position=position,this.content.move({position:position,target_section_id:this.section_id,allow_force_complete:this.allow_force_complete}).then((_this=this,function(){var lists;return lists=_this.view.transfer(_this.list,_this.content,_this.section_id),_this.close(lists)}))["catch"](function(_this){return function(err){return _this.view.show_error(err.message)}}(this)))},TransferContent}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Recordings=function(superClass){function Recordings(){return Recordings.__super__.constructor.apply(this,arguments)}return extend(Recordings,superClass),Recordings.include(pi.controllers.Paginated),Recordings.list_resource(pi.resources.Recording),Recordings.prototype.id="recordings",Recordings.prototype.initialize=function(){return Recordings.__super__.initialize.apply(this,arguments),this.scope().set({filter:"all"}),this.next_page()},Recordings.prototype.show=function(id){return this.recordings.find(id)["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(el){return _this["switch"]("recording_show",el)}}(this));var _this},Recordings.prototype["new"]=function(){return this["switch"]("meeting_edit")},Recordings.prototype.share=function(rec){return this["switch"]("share_recording",rec)},Recordings.prototype.convert=function(rec){if(null!=rec)return this.with_loader(rec.convert())},Recordings.prototype.destroy=function(recording){return this.confirm(function(){return recording.destroy()})["with"](recording,"recordings/destroy_confirm")},Recordings}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.ShareRecording=function(superClass){function ShareRecording(){return ShareRecording.__super__.constructor.apply(this,arguments)}return extend(ShareRecording,superClass),ShareRecording.include(pi.controllers.Scoped),ShareRecording.prototype.id="share_recording",ShareRecording.prototype.load=function(context){return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.Recording?(this.recording=context.data,this.recording.participants_loaded||(this.view.loading(!0),this.recording.load_participants()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.view.load_participants(_this.recording),response}}(this))),this.view.loaded(this.recording)):this.close();var _this},ShareRecording.prototype.add_users=function(users){return this["switch"]("select_users",{users:users})},ShareRecording.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},ShareRecording.prototype.unload=function(){return this._participants_updated&&this.recording.participants().clear_all(),this.recording=null,ShareRecording.__super__.unload.apply(this,arguments)},ShareRecording.prototype.reload=function(context){var i,len,ref,results,user;if(null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.recording.participants().build(user,!1,{changed:!0,role_id:user.role_id}));return results}},ShareRecording.prototype.destroy=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.recording.participants().remove(user));return results},ShareRecording.prototype.save=function(data){return this.recording.send_notify=data.send_notify,this.view.loading(!0),this.recording.share({recording:this.recording.attributes()})["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this));var _this},ShareRecording}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.RecordingShow=function(superClass){function RecordingShow(){return RecordingShow.__super__.constructor.apply(this,arguments)}return extend(RecordingShow,superClass),RecordingShow.prototype.id="recording_show",RecordingShow.prototype.load=function(context){RecordingShow.__super__.load.apply(this,arguments),this.rec=context.data,null!=this.rec&&(this.rec,$r.Recording)},RecordingShow.prototype.unload=function(){return this.rec=null,RecordingShow.__super__.unload.apply(this,arguments)},RecordingShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.DocumentEdit=function(superClass){function DocumentEdit(){return DocumentEdit.__super__.constructor.apply(this,arguments)}return extend(DocumentEdit,superClass),DocumentEdit.prototype.id="document_edit",DocumentEdit.prototype.load=function(context){if(DocumentEdit.__super__.load.apply(this,arguments),this._initialized||this.initialize(),this.document=context.data,null!=context.data.parent_id&&(this.parent_id=context.data.parent_id),!(this.document instanceof $r.Document))return this.document=$r.Document.build(),this.document.is_folder=!0,this.document.parent_id=this.parent_id},DocumentEdit.prototype.unload=function(){return DocumentEdit.__super__.unload.apply(this,arguments),this.document=null},DocumentEdit.prototype.save=function(data){if(null!=this.document)return this.document.save(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.close(),response}}(this));var _this},DocumentEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.Documents=function(superClass){function Documents(){return Documents.__super__.constructor.apply(this,arguments)}return extend(Documents,superClass),Documents.include(pi.controllers.Paginated),Documents.prototype.id="documents",Documents.list_resource(pi.resources.Document),Documents.prototype.initialize=function(){var _promise,hash_data,_this;if(Documents.__super__.initialize.apply(this,arguments),this.scope().set({filter:"all"}),_promise=null!=(hash_data=hash.get()).folder_id?this.show_folder(0|hash_data.folder_id):this.show_folder(),hash_data.id)return _promise.then((_this=this,function(){return _this.show(0|hash_data.id)}))},Documents.prototype.reload=function(arg){if(Documents.__super__.reload.apply(this,arguments),hash.remove("id"),"move_document"===arg.context)return this.scope().reload(),this.show_folder(0|hash.get().folder_id)},Documents.prototype.upload=function(){return this["switch"]("documents_upload",{parent_id:this.current_folder_id})},Documents.prototype.share=function(doc){var _this;if(doc.is_folder)return this.with_loader(doc.shares()).then((_this=this,function(){return _this["switch"]("share_document",doc)}))},Documents.prototype.destroy=function(doc){return this.confirm((_this=this,function(){return _this.with_loader(doc.destroy())}))["with"](doc,"documents/destroy_confirm");var _this},Documents.prototype["new"]=function(){return this["switch"]("document_edit",{parent_id:this.current_folder_id,new_folder:!0})},Documents.prototype.edit=function(data){return this["switch"]("document_edit",data)},Documents.prototype.show=function(id){return this.with_loader(this.documents.find(id)).then((_this=this,function(doc){return"ok"!==doc.status_code?_this.view.error(doc.name+" "+doc.status_name):(hash.add({id:doc.id}),_this["switch"]("document_show",doc))}));var _this},Documents.prototype.search=function(){return this.scope().params.q||this.scope().reload(),Documents.__super__.search.apply(this,arguments)},Documents.prototype.move=function(ids){return this["switch"]("move_document",ids)},
Documents.prototype.show_folder=function(id){return null==id||0===id?(id=null,hash.remove("folder_id")):hash.add({folder_id:id}),this.scope().set({q:null}),this.view.reset_search(),this.query({},{folder_id:id}).then((_this=this,function(data){return null!=data&&_this.view.reload(_this._parse_response(data)),data})).then(function(_this){return function(data){return null!=data&&null!=_this.view.breadcrumbs&&_this.view.breadcrumbs.reload(id),_this.current_folder_id=id}}(this))["catch"](function(_this){return function(e){return utils.error(e),_this._promise=null,null!=_this.current_folder_id?hash.add({folder_id:_this.current_folder_id}):hash.remove("folder_id")}}(this));var _this},Documents.prototype.download=function(item){return this.view.find(".download-link").attrs({href:item.download_url,download:item.file_name}).node.click()},Documents}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MoveDocument=function(superClass){function MoveDocument(){return MoveDocument.__super__.constructor.apply(this,arguments)}return extend(MoveDocument,superClass),MoveDocument.include(pi.controllers.Popuped),MoveDocument.prototype.id="move_document",MoveDocument.list_resource(pi.resources.Document),MoveDocument.prototype.initialize=function(){return MoveDocument.__super__.initialize.apply(this,arguments),this.scope().set({filter:"all"})},MoveDocument.prototype.load=function(context){return this.show_folder(),null!=context.data&&(this.move_docs=context.data.map(function(doc){return doc.id})),MoveDocument.__super__.load.apply(this,arguments)},MoveDocument.prototype.show_folder=function(id){return this.query({},{folder_id:id}).then((_this=this,function(data){return _this.view.reload(_this._parse_response(data)),data})).then(function(_this){return function(){return null!=_this.view.breadcrumbs&&_this.view.breadcrumbs.reload(id),_this.current_folder_id=id}}(this));var _this},MoveDocument.prototype.move=function(data){var params,_this;return params={folder:null!=data?data.id:null,files:this.move_docs},$r.Document.move(params)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return _this.close(response),response}}(this))},MoveDocument.prototype.unload=function(){return this.move_docs=null,hash.remove("folder_id"),MoveDocument.__super__.unload.apply(this,arguments)},MoveDocument}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.ShareDocument=function(superClass){function ShareDocument(){return ShareDocument.__super__.constructor.apply(this,arguments)}return extend(ShareDocument,superClass),ShareDocument.include(pi.controllers.Scoped),ShareDocument.prototype.id="share_document",ShareDocument.prototype.load=function(context){return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.Document?(this.document=context.data,this.document.participants_loaded||(this.view.loading(!0),this.document.load_participants()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.view.load_participants(_this.document),response}}(this))),this.view.loaded(this.document)):this.close();var _this},ShareDocument.prototype.add_users=function(users){return this["switch"]("select_users",{users:users,role_ids:[$r.User.LISTENER]})},ShareDocument.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},ShareDocument.prototype.unload=function(){return this._participants_updated&&this.document.participants().clear_all(),this.document=null,ShareDocument.__super__.unload.apply(this,arguments)},ShareDocument.prototype.reload=function(context){var i,len,ref,results,user;if(null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.document.participants().build(user,!1,{changed:!0,role_id:$r.User.LISTENER}));return results}},ShareDocument.prototype.destroy=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.document.participants().remove(user));return results},ShareDocument.prototype.save=function(data){var id,key,params,prop,shares,_this;for(key in shares=[],data)hasProp.call(data,key)&&(prop=data[key],"send_notify"!==key&&prop&&(id=key.split("-").pop(),shares.push({target_id:id,target_type:"Label"})));return this.view.loading(!0),params=utils.extend(this.document.attributes(),{shares:shares,send_notify:data.send_notify}),this.document.share_folder({document:params})["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this))},ShareDocument}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.DocumentShow=function(superClass){function DocumentShow(){return DocumentShow.__super__.constructor.apply(this,arguments)}return extend(DocumentShow,superClass),DocumentShow.prototype.id="document_show",DocumentShow.prototype.load=function(context_data){var ref;return context_data.data instanceof $r.Document&&null!=context_data.data&&null!=(ref=pi.app.visitor)&&ref.update_context({document_id:context_data.data.id}),DocumentShow.__super__.load.apply(this,arguments)},DocumentShow.prototype.unload=function(){var ref;return null!=(ref=pi.app.visitor)&&ref.update_context({document_id:0}),DocumentShow.__super__.unload.apply(this,arguments)},DocumentShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.DocumentsUpload=function(superClass){function DocumentsUpload(){return DocumentsUpload.__super__.constructor.apply(this,arguments)}return extend(DocumentsUpload,superClass),DocumentsUpload.prototype.id="documents_upload",DocumentsUpload.upload_resource($r.Document,"file","parent_id"),DocumentsUpload.prototype.load=function(context){if(DocumentsUpload.__super__.load.apply(this,arguments),null!=context.data.parent_id)return this.parent_id=context.data.parent_id},DocumentsUpload.prototype.build_resource=function(){var el;return(el=DocumentsUpload.__super__.build_resource.apply(this,arguments)).set({parent_id:this.parent_id},!0),el},DocumentsUpload.prototype.file_uploaded=function(el){return DocumentsUpload.__super__.file_uploaded.apply(this,arguments),pi.DocumentChecker.add(el.id)},DocumentsUpload}(pi.controllers.FileUpload)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.AccountEdit=function(superClass){function AccountEdit(){return AccountEdit.__super__.constructor.apply(this,arguments)}return extend(AccountEdit,superClass),AccountEdit.prototype.id="account_edit",AccountEdit.prototype.load=function(context){return this._initialized||this.initialize(),this.new_logo_url=null,null!=context.data&&context.data instanceof $r.Account?this.account=context.data:this.account=pi.app.account,this.view.loaded(this.account)},AccountEdit.prototype.reload=function(context){var file_obj;if(context.data.file)return utils.debug(context.data.file),file_obj=context.data.file,this.view.logo_loaded(file_obj)},AccountEdit.prototype.unload=function(){return AccountEdit.__super__.unload.apply(this,arguments),this.account=null},AccountEdit.prototype.save=function(data){if(null!=this.account)return this.with_loader(this.account.update_profile({account:data})).then((_this=this,function(response){return null!=_this.new_logo_url&&_this.account.local_logo(_this.new_logo_url),_this.close({account:response.account})}));var _this},AccountEdit.prototype.upload_logo=function(){return this["switch"]("cover_upload")},AccountEdit.prototype.test_ad_connection=function(data){return this.view.show_result_connection("Establishing connection..."),this.with_loader(this.account.test_ad_connection(data).then((_this=this,function(response){return null!=(null!=response?response.result_connection:void 0)&&_this.view.show_result_connection(response.result_connection),response})));var _this},AccountEdit.prototype.delete_logo=function(){return this.view.delete_logo(),this.new_logo_url=!1},AccountEdit.prototype.delete_yakassa_settings=function(){var ref,_this;if(null!=(ref=this.account)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.account.clear_payment_credentials()).then(function(){return _this.view.clear_yakassa_fields()})}))["with"](this.account,"accounts/clear_payment_credentials_confirm")},AccountEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.AccountShow=function(superClass){function AccountShow(){return AccountShow.__super__.constructor.apply(this,arguments)}return extend(AccountShow,superClass),AccountShow.prototype.id="account_show",AccountShow.prototype.load=function(){return this.view.loaded(pi.app.account)},AccountShow.prototype.edit=function(){return this["switch"]("account_edit",pi.app.account)},AccountShow}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProfileConfirmPhone=function(superClass){function ProfileConfirmPhone(){return ProfileConfirmPhone.__super__.constructor.apply(this,arguments)}return extend(ProfileConfirmPhone,superClass),ProfileConfirmPhone.prototype.id="profile_confirm_phone",ProfileConfirmPhone.prototype.load=function(context){var _this;return this._initialized||this.initialize(),this.user=context.data,null!=this.user&&this.user instanceof $r.User&&$r.User.confirm_phone()["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.view.unloading(),response}}(this)),ProfileConfirmPhone.__super__.load.apply(this,arguments)},ProfileConfirmPhone.prototype.unload=function(){return this.user=null,ProfileConfirmPhone.__super__.unload.apply(this,arguments)},ProfileConfirmPhone.prototype.confirm=function(data){var code,_this;if(null!=(code=data.phone_confirm_code))return $r.User.check_confirm_phone({phone_confirm_code:code})["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close({user:response.user}),response}}(this))},ProfileConfirmPhone}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProfileCredentialEdit=function(superClass){function ProfileCredentialEdit(){return ProfileCredentialEdit.__super__.constructor.apply(this,arguments)}return extend(ProfileCredentialEdit,superClass),ProfileCredentialEdit.prototype.id="profile_credential_edit",ProfileCredentialEdit.prototype.load=function(){return this._initialized||this.initialize(),this.app=$r.OauthApplication.build(),this.view.loaded(this.app)},ProfileCredentialEdit.prototype.save=function(data){return null!=this.app?this.with_loader(this.app.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},ProfileCredentialEdit.prototype.unload=function(){return this.app=null,ProfileCredentialEdit.__super__.unload.apply(this,arguments)},ProfileCredentialEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.ProfileCredentials=function(superClass){function ProfileCredentials(){return ProfileCredentials.__super__.constructor.apply(this,arguments)}return extend(ProfileCredentials,superClass),ProfileCredentials.prototype.id="profile_credentials",ProfileCredentials.include(pi.controllers.Paginated),ProfileCredentials.list_resource(pi.resources.OauthApplication),ProfileCredentials.prototype.initialize=function(){return ProfileCredentials.__super__.initialize.apply(this,arguments),this.next_page()},ProfileCredentials.prototype["new"]=function(){return this["switch"]("profile_credential_edit")},ProfileCredentials.prototype.show=function(data){return this["switch"]("profile_credential_show",data)},ProfileCredentials.prototype.destroy=function(app){return this.confirm((_this=this,function(){return _this.with_loader(app.destroy())}))["with"](app,"profile/credentials/destroy_confirm");var _this},ProfileCredentials}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.ProfileEdit=function(superClass){function ProfileEdit(){return ProfileEdit.__super__.constructor.apply(this,arguments)}return extend(ProfileEdit,superClass),ProfileEdit.prototype.id="profile_edit",ProfileEdit.prototype.load=function(context){return this._initialized||this.initialize(),this.new_avatar_url=null,null!=context.data&&context.data instanceof $r.User?this.user=context.data:this.user=pi.app.user,this.view.loaded(this.user)},ProfileEdit.prototype.reload=function(context){var file_obj;if(context.data.file)return utils.debug(context.data.file),file_obj=context.data.file,this.view.avatar_loaded(file_obj)},ProfileEdit.prototype.unload=function(){return ProfileEdit.__super__.unload.apply(this,arguments),this.user=null},ProfileEdit.prototype.save=function(data){if(null!=this.user)return this.user.update_profile({user:data})["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),null!=_this.new_avatar_url&&_this.user.local_avatar(_this.new_avatar_url),_this.close({user:response.user})}}(this));var _this},ProfileEdit.prototype.upload_avatar=function(){return this["switch"]("cover_upload")},ProfileEdit.prototype.delete_avatar=function(){return this.view.delete_avatar(),this.new_avatar_url=!1},ProfileEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.Profile=function(superClass){function Profile(){return Profile.__super__.constructor.apply(this,arguments)}return extend(Profile,superClass),Profile.include(pi.controllers.Scoped),Profile.prototype.id="profile",Profile.has_resource($r.User),Profile.prototype.initialize=function(){if(Profile.__super__.initialize.apply(this,arguments),"edit"===hash.get().goto)return this.edit()},Profile.prototype.load=function(){return this.view.loaded(pi.app.user),this.initialize()},Profile.prototype.reconfirm_email=function(){return pi.app.user.reconfirmation_email()["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),response}}(this));var _this},Profile.prototype.edit=function(){return this["switch"]("profile_edit",pi.app.user)},Profile.prototype.remove_provider=function(provider){return this.confirm((_this=this,function(){return pi.app.user.remove_provider({provider:provider})["catch"](function(e){throw _this.view.error(e.message),e}).then(function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),response})}))["with"](pi.app.user,"profile/remove_provider_confirm");var _this},Profile}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.MaterialAttach=function(superClass){function MaterialAttach(){return MaterialAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialAttach,superClass),MaterialAttach.prototype.id="material_attach",MaterialAttach.prototype.always_switch_hard=!0,MaterialAttach.prototype.close=function(data){var _this;return(this.context&&"function"==typeof this.context.preunload?this.context.preunload():utils.resolved_promise()).then((_this=this,function(){return MaterialAttach.__super__.close.call(_this,data)})),!1},MaterialAttach.prototype.submit=function(){var ref;return this.close({file:null!=(ref=this.context)?ref.data():void 0})},MaterialAttach.prototype.switch_context=function(from,to){return MaterialAttach.__super__.switch_context.apply(this,arguments).then((_this=this,function(){return _this.view.switched_to(to)}));var _this},MaterialAttach.prototype.unload=function(){var ref;return null!=(ref=this.context)&&ref.unload(),this._initialized=!1,this.context=void 0,this.context_id=void 0,MaterialAttach.__super__.unload.apply(this,arguments)},MaterialAttach}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MaterialDropbox=function(superClass){function MaterialDropbox(){return MaterialDropbox.__super__.constructor.apply(this,arguments)}return extend(MaterialDropbox,superClass),MaterialDropbox.prototype.id="material_dropbox",MaterialDropbox.prototype.data=function(){var _file;return this.view.list.items.length?{name:(_file=this.view.list.items[0].record).name,external:_file.link,external_type:"dropbox",file_name:_file.name}:null},MaterialDropbox.prototype.choose=function(){var options,_this;return options={success:(_this=this,function(files){var file;return file=files[0],_this.view.load(file)}),linkType:"direct",multiselect:!1,extensions:[".pdf",".doc",".docx",".xls",".xlsx",".ods",".ppt",".pptx",".odp",".odt",".rtf",".jpg",".jpeg",".gif",".png",".mp4",".flv",".mov",".wmv",".avi",".mp3",".wav","m4a"]},Dropbox.choose(options)},MaterialDropbox}(pi.controllers.FileUpload)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _embed_rxp,pi;(pi=context.pi).utils,_embed_rxp=/https?:(\/\/([^\/]+)[^"'\s]+)/i,pi.controllers.MaterialEmbedAttach=function(superClass){function MaterialEmbedAttach(){return MaterialEmbedAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialEmbedAttach,superClass),MaterialEmbedAttach.prototype.id="material_embed",MaterialEmbedAttach.prototype.data=function(){return this._data},MaterialEmbedAttach.prototype.add_link=function(link){var _name,matches;return(matches=_embed_rxp.exec(link))?(this.view.error(!1),_name=matches[2],this.host_context.submit(this._data={name:_name,file_name:_name,external:link,external_type:"embed",category:"other"})):this.view.error(!0)},MaterialEmbedAttach}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MaterialGoogleImage=function(superClass){function MaterialGoogleImage(){return MaterialGoogleImage.__super__.constructor.apply(this,arguments)}return extend(MaterialGoogleImage,superClass),MaterialGoogleImage.include(pi.controllers.Paginated),MaterialGoogleImage.prototype.id="material_google_image",MaterialGoogleImage.list_resource(pi.resources.GoogleImage),MaterialGoogleImage.prototype.initialize=function(){return MaterialGoogleImage.__super__.initialize.apply(this,arguments)},MaterialGoogleImage.prototype.data=function(){var item;return null!=(item=this.view.list.selected_record())?{name:item.title,external:item.url,external_type:"google_image",category:"image",file_name:item.file_name,external_thumb:item.thumb}:null},MaterialGoogleImage.prototype.search=function(){return this.scope().params.q||this.scope().reload(),MaterialGoogleImage.__super__.search.apply(this,arguments)},MaterialGoogleImage}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _embed_rxp,pi;(pi=context.pi).utils,_embed_rxp=/https?:(\/\/([^\/]+)[^"'\s]+)/i,pi.controllers.MaterialHtmlAttach=function(superClass){function MaterialHtmlAttach(){return MaterialHtmlAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialHtmlAttach,superClass),MaterialHtmlAttach.prototype.id="material_html",MaterialHtmlAttach.prototype.data=function(){return this._data},MaterialHtmlAttach.prototype.add_link=function(link){var _name,matches;return(matches=_embed_rxp.exec(link))?(this.view.error(!1),_name=matches[2],this.host_context.submit(this._data={name:_name,file_name:_name,external:link,external_type:"html",category:"other"})):this.view.error(!0)},MaterialHtmlAttach}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MaterialDocumentAttach=function(superClass){function MaterialDocumentAttach(){return MaterialDocumentAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialDocumentAttach,superClass),MaterialDocumentAttach.include(pi.controllers.Paginated),MaterialDocumentAttach.prototype.id="material_document",MaterialDocumentAttach.list_resource(pi.resources.Document),MaterialDocumentAttach.prototype.initialize=function(){var hash_data;return MaterialDocumentAttach.__super__.initialize.apply(this,arguments),this.scope().set({filter:"all"}),null!=(hash_data=hash.get()).folder_id?this.show_folder(0|hash_data.folder_id):this.show_folder()},MaterialDocumentAttach.prototype.reload=function(){return MaterialDocumentAttach.__super__.reload.apply(this,arguments),hash.remove("id")},MaterialDocumentAttach.prototype.search=function(){return this.scope().params.q||this.scope().reload(),MaterialDocumentAttach.__super__.search.apply(this,arguments)},MaterialDocumentAttach.prototype.show_folder=function(id){return null==id||0===id?(id=null,hash.remove("folder_id")):hash.add({folder_id:id}),this.scope().set({q:null}),this.view.reset_search(),this.query({filter:"all"},{folder_id:id}).then((_this=this,function(data){return _this.view.reload(_this._parse_response(data)),data})).then(function(_this){return function(){return null!=_this.view.breadcrumbs&&_this.view.breadcrumbs.reload(id),_this.current_folder_id=id}}(this));var _this},MaterialDocumentAttach.prototype.data=function(){var item;return null==(item=this.view.list.selected_record())||item.is_folder?null:{name:item.name,external:item.id,external_type:"attachment",external_class:"Document",category:item.category,file_name:item.name,extension:item.extension}},MaterialDocumentAttach.prototype.unload=function(){return MaterialDocumentAttach.__super__.unload.apply(this,arguments),hash.remove("id"),hash.remove("folder_id")},MaterialDocumentAttach}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.MaterialUpload=function(superClass){function MaterialUpload(){return MaterialUpload.__super__.constructor.apply(this,arguments)}return extend(MaterialUpload,superClass),MaterialUpload.prototype.id="material_upload",MaterialUpload.prototype.data=function(){var _files;return(_files=this.res_view.serialize()).length?_files[0]:null},MaterialUpload.prototype.preunload=function(){return this._uploading?new Promise((_this=this,function(resolve,reject){return _this.confirm(resolve,reject)["with"](null,"documents/abort_confirm")})):utils.resolved_promise();var _this},MaterialUpload}(pi.controllers.FileUpload)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _vimeo_rxp,pi;(pi=context.pi).utils,_vimeo_rxp=/^(?:https?\:\/\/)?[^\/]*vimeo\.com\/(?:video\/)?(\d+)/,pi.controllers.MaterialVimeoAttach=function(superClass){function MaterialVimeoAttach(){return MaterialVimeoAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialVimeoAttach,superClass),MaterialVimeoAttach.prototype.id="material_vimeo",MaterialVimeoAttach.prototype._extract_id=function(link){var matches;return!!(matches=link.match(_vimeo_rxp))&&matches[1]},MaterialVimeoAttach.prototype.data=function(){return this._data},MaterialVimeoAttach.prototype.add_link=function(link){var _name,id;return(id=this._extract_id(link))?(this.view.error(!1),_name="Vimeo video ["+id+"]",this.host_context.submit(this._data={name:_name,file_name:_name,external:id,external_type:"vimeo",category:"video"})):this.view.error(!0)},MaterialVimeoAttach}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MaterialYoutubeAttach=function(superClass){function MaterialYoutubeAttach(){return MaterialYoutubeAttach.__super__.constructor.apply(this,arguments)}return extend(MaterialYoutubeAttach,superClass),MaterialYoutubeAttach.prototype.id="material_youtube",MaterialYoutubeAttach.prototype.data=function(){var item;return null!=(item=this.view.list.selected_record())?{name:item.title,external:item.id,external_type:"youtube",category:"video",file_name:item.title,external_thumb:item.thumb}:null},MaterialYoutubeAttach.prototype.search=function(q){return this.view.list.clear(),this.view.loading(!0),$r.YoutubeVideo.search({q:q})["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.view.load(response),response}}(this));var _this},MaterialYoutubeAttach}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.Materials=function(superClass){function Materials(){return Materials.__super__.constructor.apply(this,arguments)}return extend(Materials,superClass),Materials.prototype.id="materials",Materials.prototype.initialize=function(){var hash_data;return Materials.__super__.initialize.apply(this,arguments),this.course=pi.app.course,"edit"===(hash_data=hash.get()).goto?this.edit_course():"new_quiz"===hash_data.goto&&hash_data.section_id?this.create_quiz(hash_data.section_id):void 0},Materials.prototype.postinitialize=function(){var data,hash_data;if(Materials.__super__.postinitialize.apply(this,arguments),"edit_quiz"===(hash_data=hash.get()).goto&&hash_data.quiz_id&&(data=$r.Quiz.where({id:Number(hash_data.quiz_id),course_id:pi.app.course.id})).length>0)return this["switch"]("quiz_edit",data[0])},Materials.prototype.goto=function(id){var mat;return(mat=this.course.materials().get(id))&&"ok"===mat.status_code?this.location(mat.view_path()):(mat=this.course.quizzes().get(id))?this.location(mat.view_path()):void 0},
Materials.prototype.update_section=function(id,data){var section,_this;if(section=this.sections.get(id))return this.with_loader(section.save(data)).then((_this=this,function(){return _this.view.ensure_form_hidden()}))},Materials.prototype.update_material=function(id,data){var material,_this;if(material=this.materials.get(id))return this.with_loader(material.save(data)).then((_this=this,function(){return _this.view.ensure_form_hidden()}))},Materials.prototype.edit=function(item){if(!(item.record instanceof $r.SectionContent&&"material"!==item.record.content_type))return this.view.list.edit_item(item);switch(item.record.content_type){case"quiz":return this["switch"]("quiz_edit",item.record.quiz);case"task":return this["switch"]("task_edit",item.record.task);case"scorm_package":return this["switch"]("scorm_package_edit",item.record.scorm_package)}},Materials.prototype.move_item=function(item,to){var section;return item instanceof $r.Section?this.course.move_element(item,to):(section=$r.Section.get(item.section_id))?(section.move_element(item,to),this.view.recount_content_positions_after_move(item)):void 0},Materials.prototype.transfer_content=function(item){return this["switch"]("transfer_content",{item:item,list:this.view.list})},Materials.prototype.create_section=function(data){return data.course_id=pi.app.course_id,this.with_loader(this.sections.create(data))},Materials.prototype.publish_section=function(section_id){var section;return section=$r.Section.get(section_id),this.with_loader(section.publish())},Materials.prototype.create_material=function(data){return data.course_id=pi.app.course_id,this.with_loader(this.materials.create(data).then(function(material){return $r.SectionContent.build(material.section_content)}))},Materials.prototype.create_scorm=function(section_id){return this["switch"]("scorm_package_edit",{section_id:section_id})},Materials.prototype.create_task=function(section_id){return this["switch"]("task_edit",{section_id:section_id})},Materials.prototype.create_quiz=function(section_id){return this["switch"]("quiz_edit",{section_id:section_id})},Materials.prototype.import_quiz=function(section_id){var section;return section=$r.Section.get(section_id),this["switch"]("quiz_import",section)},Materials.prototype.copy_quiz=function(section_id){var section;return section=$r.Section.get(section_id),this["switch"]("quiz_copy",section)},Materials.prototype.destroy=function(el){var confirmation,_this;return confirmation=el instanceof $r.SectionContent?el[el.content_type].constructor.resources_name+"/destroy_confirm":el.constructor.resources_name+"/destroy_confirm",el.course_id=pi.app.course_id,el instanceof $r.SectionContent&&(this._section_id=el.section_id),this.confirm((_this=this,function(){return _this.with_loader(el.destroy().then(function(){if(_this._section_id)return _this.view.recount_content_positions_in_list(_this.view.find_list(_this._section_id))}))}))["with"](el,confirmation)},Materials.prototype.destroy_resource=function(id){var resource,_this;if(resource=$r.Resource.get(id))return resource.course_id=pi.app.course_id,this.confirm((_this=this,function(){return _this.with_loader(resource.destroy({course_id:pi.app.course_id}))}))["with"](resource,"resources/destroy_confirm")},Materials.prototype.add_resources=function(id){if(this.sections.get(id))return this["switch"]("resources_upload",{section_id:id})},Materials.prototype.upload_file=function(uploader1){return this.uploader=uploader1,this["switch"]("material_attach")},Materials.prototype.delete_file=function(uploader){return uploader.value(null)},Materials.prototype.reload=function(context){var i,len,list,lists,ref;if("transfer_content"===context.context)for(i=0,len=(lists=context.data).length;i<len;i++)list=lists[i],this.view.recount_content_positions_in_list(list);return context.data.file&&(utils.debug(context.data.file),null!=(ref=this.uploader)&&ref.value(context.data.file)),this.uploader=null},Materials.prototype.take_quiz=function(id){var quiz,_this;if(null!=(quiz=this.course.quizzes().get(id)))return quiz.time_limit>0?this.confirm((_this=this,function(){return _this.location(quiz.take_path())}))["with"](quiz,"quizzes/start_confirm"):this.location(quiz.take_path())},Materials.prototype.show_results=function(id){var quiz,quiz_stats;if(quiz_stats=$r.QuizStat.where({quiz_id:id}),(quiz=this.course.quizzes().get(id))&&quiz_stats.length)return this["switch"]("quiz_stat_listener_show",{quiz_stats:quiz_stats,quiz:quiz})},Materials.prototype.add_listeners=function(){return this["switch"]("course_session_edit",null!=this.session_id?$r.CourseSession.get(this.session_id):void 0)},Materials}(pi.controllers.TBCourseController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MaterialShow=function(superClass){function MaterialShow(){return MaterialShow.__super__.constructor.apply(this,arguments)}return extend(MaterialShow,superClass),MaterialShow.prototype.id="material_show",MaterialShow.prototype.load=function(){return this.material=pi.app.material,this.load_material(this.material)},MaterialShow.prototype.load_material=function(material){return material.view_expiring().then((_this=this,function(){return _this.view.show_material(material)}));var _this},MaterialShow}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ResourcesUpload=function(superClass){function ResourcesUpload(){return ResourcesUpload.__super__.constructor.apply(this,arguments)}return extend(ResourcesUpload,superClass),ResourcesUpload.prototype.id="resources_upload",ResourcesUpload.upload_resource($r.Resource,"file","section_id","course_id"),ResourcesUpload.prototype.load=function(context){if(ResourcesUpload.__super__.load.apply(this,arguments),null!=context.data.section_id)return this.section_id=context.data.section_id},ResourcesUpload.prototype.build_resource=function(){var el,params;return el=ResourcesUpload.__super__.build_resource.apply(this,arguments),params={course_id:pi.app.course_id,section_id:this.section_id},el.set(params,!0),el},ResourcesUpload.prototype.file_uploaded=function(){return ResourcesUpload.__super__.file_uploaded.apply(this,arguments)},ResourcesUpload.prototype.submit=function(){return this.close()},ResourcesUpload}(pi.controllers.FileUpload)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseStats=function(superClass){function CourseStats(){return CourseStats.__super__.constructor.apply(this,arguments)}return extend(CourseStats,superClass),CourseStats.include(pi.controllers.Paginated),CourseStats.list_resource(pi.resources.CourseStat),CourseStats.prototype.id="course_stats",CourseStats.prototype.initialize=function(){return CourseStats.__super__.initialize.apply(this,arguments),this.next_page()},CourseStats.prototype.course_type_filter=function(id){return this.with_loader(this.query({},{course_type_id:id})).then((_this=this,function(data){return _this.view.reload(_this._parse_response(data)),_this.view.ensure_course_type(id),data}));var _this},CourseStats}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseStatShow=function(superClass){function CourseStatShow(){return CourseStatShow.__super__.constructor.apply(this,arguments)}return extend(CourseStatShow,superClass),CourseStatShow.prototype.id="course_stat_show",CourseStatShow.prototype.search=function(q){return this.view.search(q)},CourseStatShow.prototype.initialize=function(){return CourseStatShow.__super__.initialize.apply(this,arguments),this.course=pi.app.course},CourseStatShow.prototype.load=function(context_data){if(CourseStatShow.__super__.load.apply(this,arguments),null!=context_data.data)return this.load_stat(context_data.data.id)},CourseStatShow.prototype.unload=function(){return CourseStatShow.__super__.unload.apply(this,arguments),this.course_stat=null},CourseStatShow.prototype.show_quiz_stat=function(quiz_id){var quiz,quiz_stat;if(null!=(quiz=$r.Quiz.get(quiz_id))&&(quiz_stat=quiz.stat_for_user_by_session(this.course_stat.user_id,this.course_stat.course_session_id)))return this["switch"]("quiz_stat_show",quiz_stat)},CourseStatShow.prototype.load_stat=function(id){var stat,_this;if((stat=$r.CourseListenerStat.get(id))&&(!this.course_stat||this.course_stat.id!==id))return this.course_stat=stat,this.view.load_stat(this.course_stat),this.with_loader(this.course_stat.load_results({course_id:this.course_stat.course_id})).then((_this=this,function(){return _this.view.reload(_this._build_stats(_this.course_stat.user_id))}))},CourseStatShow.prototype._build_stats=function(id){var buf;return buf=this._build_quiz_stats(id),this._build_task_stats(id,buf)},CourseStatShow.prototype._build_task_stats=function(user_id,data){var i,j,len,len1,ref,ref1,task;for(null==data&&(data=[]),i=0,len=(ref=$r.Course.get(this.course_stat.course_id).sections().all()).length;i<len;i++)for(j=0,len1=(ref1=ref[i].tasks().all()).length;j<len1;j++)task=ref1[j],data.push({type:"task",task:task,stat:task.stat_for_user_by_session(user_id,this.course_stat.course_session_id)});return data},CourseStatShow.prototype._build_quiz_stats=function(user_id,data){var i,j,len,len1,quiz,ref,ref1;for(null==data&&(data=[]),i=0,len=(ref=$r.Course.get(this.course_stat.course_id).sections().all()).length;i<len;i++)for(j=0,len1=(ref1=ref[i].quizzes().all()).length;j<len1;j++)quiz=ref1[j],data.push({type:"quiz",quiz:quiz,stat:quiz.stat_for_user_by_session(user_id,this.course_stat.course_session_id)});return data},CourseStatShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseStatsTransfer=function(superClass){function CourseStatsTransfer(){return CourseStatsTransfer.__super__.constructor.apply(this,arguments)}return extend(CourseStatsTransfer,superClass),CourseStatsTransfer.prototype.id="course_stats_transfer",CourseStatsTransfer.prototype.initialize=function(){return CourseStatsTransfer.__super__.initialize.apply(this,arguments)},CourseStatsTransfer.prototype.load=function(context){if(context.data.from)return this.course=pi.app.course,this.from=context.data.from,this.users=context.data.users.map(function(e){return e.user_id}),CourseStatsTransfer.__super__.load.apply(this,arguments)},CourseStatsTransfer.prototype.unload=function(){return this.users=null,CourseStatsTransfer.__super__.unload.apply(this,arguments)},CourseStatsTransfer.prototype.set_session=function(item){var to,_this;return null!=item?(to=item.id,this.with_loader($r.CourseStat.transfer({course_id:pi.app.course_id,course_stat:{users:this.users,from:this.from,to:to}}))["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(){return _this.close()}}(this))):this.close()},CourseStatsTransfer}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizCopy=function(superClass){function QuizCopy(){return QuizCopy.__super__.constructor.apply(this,arguments)}return extend(QuizCopy,superClass),QuizCopy.prototype.id="quiz_copy",QuizCopy.prototype.always_switch_hard=!0,QuizCopy.prototype.copy_quiz=function(quiz){return this.with_loader(quiz.copy({section_id:this.target.id})).then((_this=this,function(response){return $r.SectionContent.build(response.quiz.section_content),_this.close(response)}));var _this},QuizCopy.prototype.close=function(data){var _this;return(this.context&&"function"==typeof this.context.preunload?this.context.preunload():utils.resolved_promise()).then((_this=this,function(){return QuizCopy.__super__.close.call(_this,data)})),!1},QuizCopy.prototype.load=function(context){return QuizCopy.__super__.load.apply(this,arguments),this.target=context.data},QuizCopy.prototype.unload=function(){var ref;return null!=(ref=this.context)&&ref.unload(),this._initialized=!1,this.context=void 0,this.context_id=void 0,QuizCopy.__super__.unload.apply(this,arguments)},QuizCopy}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuizCopyCourses=function(superClass){function QuizCopyCourses(){return QuizCopyCourses.__super__.constructor.apply(this,arguments)}return extend(QuizCopyCourses,superClass),QuizCopyCourses.include(pi.controllers.Paginated),QuizCopyCourses.include(pi.controllers.Popuped),QuizCopyCourses.prototype.id="quiz_copy_courses",QuizCopyCourses.list_resource(pi.resources.Course),QuizCopyCourses.prototype.initialize=function(){return QuizCopyCourses.__super__.initialize.apply(this,arguments),pi.app.user.role_id===$r.User.MANAGER&&this.scope().set({filter:"all"}),this.next_page()},QuizCopyCourses.prototype.load_quizzes=function(id){return this["switch"]("quiz_copy_quizzes",id)},QuizCopyCourses.prototype.unload=function(){return QuizCopyCourses.__super__.unload.apply(this,arguments)},QuizCopyCourses}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuizCopyQuestions=function(superClass){function QuizCopyQuestions(){return QuizCopyQuestions.__super__.constructor.apply(this,arguments)}return extend(QuizCopyQuestions,superClass),QuizCopyQuestions.include(pi.controllers.Popuped),QuizCopyQuestions.prototype.id="quiz_copy_questions",QuizCopyQuestions.prototype.initialize=function(){return QuizCopyQuestions.__super__.initialize.apply(this,arguments)},QuizCopyQuestions.prototype.load_courses=function(){return this["switch"]("quiz_copy_courses")},QuizCopyQuestions.prototype.load_quiz=function(){return this["switch"]("quiz_copy_quizzes",this.quiz.course_id)},QuizCopyQuestions.prototype.load=function(context){return QuizCopyQuestions.__super__.load.apply(this,arguments),this.quiz=context.data,this.view.quiz_loaded(this.quiz),this.quiz.questions_loaded?this.view.reload(this.quiz.questions().all()):this.with_loader(this.quiz.load_questions()).then((_this=this,function(response){return _this.view.reload(_this.quiz.questions().all()),response}));var _this},QuizCopyQuestions.prototype.unload=function(){return QuizCopyQuestions.__super__.unload.apply(this,arguments)},QuizCopyQuestions}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuizCopyQuizzes=function(superClass){function QuizCopyQuizzes(){return QuizCopyQuizzes.__super__.constructor.apply(this,arguments)}return extend(QuizCopyQuizzes,superClass),QuizCopyQuizzes.include(pi.controllers.Popuped),QuizCopyQuizzes.prototype.id="quiz_copy_quizzes",QuizCopyQuizzes.prototype.initialize=function(){return QuizCopyQuizzes.__super__.initialize.apply(this,arguments)},QuizCopyQuizzes.prototype.load_courses=function(){return this["switch"]("quiz_copy_courses")},QuizCopyQuizzes.prototype.load_questions=function(id){return this["switch"]("quiz_copy_questions",$r.Quiz.get(id))},QuizCopyQuizzes.prototype.load=function(context){return QuizCopyQuizzes.__super__.load.apply(this,arguments),this.course=$r.Course.get(context.data),this.view.course_loaded(this.course),this.course.quizzes_loaded?this.view.reload(this.course.quizzes().all()):this.with_loader(this.course.load_quizzes()).then((_this=this,function(response){return _this.view.reload(_this.course.quizzes().all()),response}));var _this},QuizCopyQuizzes.prototype.unload=function(){return QuizCopyQuizzes.__super__.unload.apply(this,arguments)},QuizCopyQuizzes}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuestionCopy=function(superClass){function QuestionCopy(){return QuestionCopy.__super__.constructor.apply(this,arguments)}return extend(QuestionCopy,superClass),QuestionCopy.prototype.id="question_copy",QuestionCopy.prototype.copy_question=function(question){return this.with_loader(question.copy({quiz_id:this.target.id})).then((_this=this,function(response){return _this.close(response)}));var _this},QuestionCopy}(pi.controllers.QuizCopy)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizEdit=function(superClass){function QuizEdit(){return QuizEdit.__super__.constructor.apply(this,arguments)}return extend(QuizEdit,superClass),QuizEdit.prototype.id="quiz_edit",QuizEdit.prototype.load=function(context){if(this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.Quiz)return this.quiz=context.data,this.view.loaded(this.quiz),this.load_categories();if(this.section_id=context.data.section_id,!this.section_id)throw Error("quiz need section!");return this.quiz=$r.Quiz.build({section_id:this.section_id,course_id:pi.app.course.id,weight:1}),this.quiz.questions_loaded=!0,this.quiz.question_categories_loaded=!0,this.view.loaded(this.quiz),this.view.disable_preview(),this.add_question()},QuizEdit.prototype.close=function(){if(QuizEdit.__super__.close.apply(this,arguments),hash.get().goto)return this.location("/manager/courses/"+pi.app.course.id+"/edit")},QuizEdit.prototype.load_questions=function(){return this.quiz.questions_loaded?(this.view.enable_preview(),this.view.ensure_sorted()):(this.view.loading(!0),this.quiz.load_questions()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.view.enable_preview(),_this.quiz.questions().all().length?(_this.view.load_questions(_this.quiz),_this.view.recount_category_questions(_this.quiz.navigation)):_this.add_question(),response}}(this)));var _this},QuizEdit.prototype.reload_questions=function(){return this.clear_categories_questions(),this.view.loading(!0),this.quiz.load_questions()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.quiz.questions().all().length&&(_this.view.reload_questions(_this.quiz),_this.view.recount_category_questions(_this.quiz.navigation)),response}}(this));var _this},QuizEdit.prototype.clear_categories_questions=function(){var category,i,len,ref,results;if(0!==this.quiz.question_categories().all().length){for(results=[],i=0,len=(ref=this.quiz.question_categories().all()).length;i<len;i++)category=ref[i],results.push(category.questions().clear_all());return results}},QuizEdit.prototype.load_categories=function(){if(!this.quiz.question_categories_loaded)return this.view.loading(!0),this.quiz.load_question_categories()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.load_questions(),_this.view.define_select_type(_this.quiz),_this.quiz.question_categories().all().length&&(_this.view.load_categories(_this.quiz),_this.view.resolve_page_by_categories()),response}}(this));var _this},QuizEdit.prototype.reload=function(context){var ref;return context.data.file&&(utils.debug(context.data.file),null!=(ref=this.uploader)&&ref.value(context.data.file)),this.uploader=null},QuizEdit.prototype.add_question=function(){var position;return position=this.quiz.questions().all().length+1,this.quiz.questions().build({course_id:pi.app.course.id,type:$r.Question.SINGLE_CHOICE,position:position}),this.view.activate_item(position-1)},QuizEdit.prototype.add_question_category=function(){var position;return position=this.quiz.question_categories().all().length+1,this.quiz.question_categories().build(),this.view.list.clear_selection(),this.view.activate_categories_item(position-1),this.view.resolve_page_by_categories()},QuizEdit.prototype.copy_question=function(){return this["switch"]("question_copy",this.quiz)},QuizEdit.prototype.upload_file=function(uploader1){return this.uploader=uploader1,this["switch"]("material_attach")},QuizEdit.prototype.import_gift=function(){return this.quiz._persisted?this["switch"]("gift_upload",{quiz_id:this.quiz.id}):this.with_loader(this.quiz.save()).then((_this=this,function(){return _this["switch"]("gift_upload",{quiz_id:_this.quiz.id})}));var _this},QuizEdit.prototype.export_gift=function(){return this.location(this.quiz.export_path(),"_blank")},QuizEdit.prototype.delete_file=function(uploader){return uploader.value(null)},QuizEdit.prototype.update_question=function(id,data){var question,_this;if(null!=(question=this.quiz.questions().get(id)))return this.quiz._persisted?(data.quiz_id=this.quiz.id,this.with_loader(question.save(data)).then(function(_this){return function(response){if(_this.view.question_updated(_this.quiz,question),_this.resolve_temp_questions(question),_this.view.form.value(response.quiz),_this.updated_quiz=$r.Quiz.build(response.quiz),!0===question.need_recount)return _this.confirm(function(){return _this.with_loader(question.recount())})["with"](question,"questions/recount_confirm")}}(this))):this.view.form.validate()?this.with_loader(this.quiz.save(this.view.form.read_values())).then((_this=this,function(){return data.quiz_id=_this.quiz.id,_this.view.enable_preview(),_this.with_loader(question.save(data)).then(function(){return _this.view.question_updated(_this.quiz,question),_this.resolve_temp_questions(question)})})):pi.Nod.win.scrollToNod(this.view.form)},QuizEdit.prototype.update_question_category_with_confirm=function(id,data){return this.quiz.question_categories().all().length-1?this.update_question_category(id,data):this.confirm((_this=this,function(){return _this.update_question_category(id,data)}))["with"](data,"question_categories/create_confirm");var _this},QuizEdit.prototype.update_question_category=function(id,data){var category,_this;if(data.quiz_id=this.quiz.id,null!=(category=this.quiz.question_categories().get(id)))return this.with_loader(category.save(data)).then((_this=this,function(){return _this.view.form.options_field.enable_show_quiz_categories_cb.disable(),_this.reload_questions(),_this.view.define_select_type(_this.quiz)}))},QuizEdit.prototype.preview=function(){return this.location("/courses/"+this.quiz.course_id+"/quizzes/"+this.quiz.id,"_blank_"+this.quiz.id)},QuizEdit.prototype.move_item=function(item,to){if(this.resolve_temp_questions(),item._persisted)return this.quiz.move_element(item,to)},QuizEdit.prototype.destroy=function(question){return question._persisted?this.confirm((_this=this,function(){return _this.with_loader(question.destroy()).then(function(response){return _this.view.question_removed(_this.quiz,question),_this.view.form.value(response.quiz),_this.updated_quiz=$r.Quiz.build(response.quiz)})}))["with"](question,"questions/destroy_confirm"):question.destroy();var _this},QuizEdit.prototype.destroy_category=function(category){var enable_categories_check_box;if(category._persisted&&category.questions().all().length>0?this.view.error(I18n.t("quizzes.errors.question_category.questions_exist")):category.destroy(),enable_categories_check_box=this.view.form.options_field.enable_show_quiz_categories_cb,1===this.quiz.question_categories().all().length)return enable_categories_check_box.enable()},QuizEdit.prototype.move_to_category=function(questions){var ids;return ids=questions.map(function(e){return e.id}),console.log(ids),this["switch"]("question_categories_edit",{questions:questions,categories:this.view.categories.list.records(),quiz:this.quiz,context_controller:this})},QuizEdit.prototype.save=function(data){if(null!=this.quiz)return this.with_loader(this.quiz.save(data).then((_this=this,function(quiz){if($r.SectionContent.build(quiz.section_content),_this.view.enable_preview(),_this.quiz._persisted&&_this.quiz.need_recount)return _this.confirm(function(){return _this.with_loader(_this.quiz.recount()),_this.view.recount_category_questions(_this.quiz.navigation),_this.view.resolve_category_pool_size(_this.quiz.navigation)})["with"](_this.quiz,"quizzes/recount_confirm")})));var _this},QuizEdit.prototype.unload=function(){return this.quiz=this.updated_quiz,this.quiz=null,QuizEdit.__super__.unload.apply(this,arguments)},QuizEdit.prototype.resolve_temp_questions=function(question){var temp_questions;if((temp_questions=this.quiz.questions().all().filter(function(q){return q.__temp__&&q!==question})).length)return temp_questions.forEach(function(q){return q.destroy()}),this.quiz.questions().all().forEach(function(q,index){var data;return data={position:index+1},q.save(data)})},QuizEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.GiftUpload=function(superClass){function GiftUpload(){return GiftUpload.__super__.constructor.apply(this,arguments)}return extend(GiftUpload,superClass),GiftUpload.prototype.id="gift_upload",GiftUpload.prototype.load=function(context){if(GiftUpload.__super__.load.apply(this,arguments),null!=context.data.quiz_id)return this.quiz=$r.Quiz.get(context.data.quiz_id)},GiftUpload.prototype.upload_file=function(data){return null!=context.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.with_loader(this.quiz.upload_gift(this.view.form,data,null,this.xhr)).then((_this=this,function(){return _this.close()}));var _this},GiftUpload.prototype.unload=function(){var ref;return this._uploading&&null!=(ref=this.xhr)&&ref.abort(),this.xhr=null,GiftUpload.__super__.unload.apply(this,arguments)},GiftUpload.prototype.submit=function(){return this.close()},GiftUpload}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuizImport=function(superClass){function QuizImport(){return QuizImport.__super__.constructor.apply(this,arguments)}return extend(QuizImport,superClass),QuizImport.prototype.id="quiz_import",QuizImport.prototype.load=function(context_data){if(QuizImport.__super__.load.apply(this,arguments),this.section=context_data.data,null==this.section)return this.close()},QuizImport.prototype.upload_file=function(file){return null!=context.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.with_loader(this.section.import_quiz(this.view.form,{file:file},null,this.xhr).then((_this=this,function(){return _this.close()})));var _this},QuizImport.prototype.unload=function(){var ref;return this._uploading&&null!=(ref=this.xhr)&&ref.abort(),this.xhr=null,QuizImport.__super__.unload.apply(this,arguments)},QuizImport}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Quizzes=function(superClass){function Quizzes(){return Quizzes.__super__.constructor.apply(this,arguments)}return extend(Quizzes,superClass),Quizzes.prototype.id="quizzes",Quizzes.prototype.initialize=function(){return Quizzes.__super__.initialize.apply(this,arguments),this.course=pi.app.course},Quizzes.prototype.edit=function(item){return this["switch"]("quiz_edit",item)},Quizzes.prototype.create_quiz=function(section_id){return this["switch"]("quiz_edit",{section_id:section_id})},Quizzes.prototype.import_quiz=function(section_id){var section;return section=$r.Section.get(section_id),this["switch"]("quiz_import",section)},Quizzes.prototype.move_item=function(item,to){return this.course.move_element(item,to)},Quizzes.prototype.destroy=function(el){return el.course_id=pi.app.course_id,this.confirm((_this=this,function(){return _this.with_loader(el.destroy())}))["with"](el,"quizzes/destroy_confirm");var _this},Quizzes.prototype.take_quiz=function(id){var quiz,_this;if(null!=(quiz=this.course.quizzes().get(id)))return quiz.time_limit>0?this.confirm((_this=this,function(){return _this.location(quiz.view_path())}))["with"](quiz,"quizzes/start_confirm"):this.location(quiz.view_path())},Quizzes.prototype.show_results=function(id){var quiz,quiz_stats;if(quiz_stats=$r.QuizStat.where({quiz_id:id}),(quiz=this.course.quizzes().get(id))&&quiz_stats.length)return this["switch"]("quiz_stat_listener_show",{quiz_stats:quiz_stats,quiz:quiz})},Quizzes}(pi.controllers.TBCourseController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizView=function(superClass){function QuizView(){return QuizView.__super__.constructor.apply(this,arguments)}return extend(QuizView,superClass),QuizView.prototype.id="quiz_view",QuizView.prototype.initialize=function(){var ref;return QuizView.__super__.initialize.apply(this,arguments),this.quiz=pi.app.quiz,null!=(ref=pi.app.visitor)?ref.update_context({
course_id:this.quiz.course_id},!1):void 0},QuizView.prototype.load=function(){return QuizView.__super__.load.apply(this,arguments),this.goto(1)},QuizView.prototype.goto=function(index){var _this;if(!(this._loading||index>this.quiz.questions_num||index===this.current_index||this.quiz.question_ids.length<index))return this._loading=!0,this.with_loader(this.load_question(this.quiz.question_ids[index-1])).then((_this=this,function(){return _this.question=_this.quiz.questions().get(_this.quiz.question_ids[index-1]),_this.view.load_question(_this.question,index),_this.current_index=index,_this._loading=!1}))["catch"](function(_this){return function(){return utils.error(e),_this._loading=!1}}(this))},QuizView.prototype.find_next=function(){return this.question?this.current_index+1:this.current_index},QuizView.prototype.find_prev=function(){return this.question?this.current_index-1:this.current_index},QuizView.prototype.next=function(){return this.goto(this.find_next())},QuizView.prototype.prev=function(){return this.goto(this.find_prev())},QuizView.prototype.load_question=function(id){return pi.app.course_session_id?$r.Question.find_for_session(pi.app.course_session_id,id):$r.Question.find(id)},QuizView.prototype.show_media=function(){return"ok"!==this.question.status_code?this.view.error(this.question.file_name+" "+this.question.status_name):this["switch"]("document_show",this.question)},QuizView}(pi.controllers.TBController)}(this)}.call(this);class Proctoring{constructor(options){this.quiz_stat_id=options.quiz_stat_id,this.httpClient=options.httpClient||pi.Net,this.supervisor=options.supervisor,this.status="new",this.endpoint=options.endpoint}init(){return new Promise((resolve,reject)=>{this.__fetchParams().then(response=>(this.__proctoringSession=new this.supervisor({url:response.url}),this.__proctoringSession.init(response.params))).then(()=>this.__proctoringSession.start()).then(()=>{this.status="process",resolve()})["catch"](err=>reject(err))})}stop(){"process"===this.status&&this.__proctoringSession.stop().then(()=>this.__proctoringSession.logout()),this.status="finished"}__fetchParams(){return this.httpClient.get(this.endpoint)}}(function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizTake=function(superClass){function QuizTake(){return QuizTake.__super__.constructor.apply(this,arguments)}return extend(QuizTake,superClass),QuizTake.prototype.id="quiz_take",QuizTake.prototype.initialize=function(){var ref,ref1;return this.quiz=pi.app.quiz,this.stat=pi.app.quiz_stat,this.proctoring=new Proctoring({supervisor:this._supervisor(),endpoint:"/api/quiz_stats/"+this.stat.id+"/proctoring"}),QuizTake.__super__.initialize.apply(this,arguments),null!=(ref=pi.app.visitor)&&ref.studying(),null!=(ref1=pi.app.visitor)&&ref1.update_context({quiz_id:this.quiz.id,course_session_id:this.stat.course_session_id},!1),this._first_loaded=!1},QuizTake.prototype.load=function(context_data){var watcher,_this;return watcher=pi.app.activity_watcher,this.tracker=new $r.StatTracker,watcher.active&&this.tracker.start(),watcher.on("active",(_this=this,function(e){return e.data?(_this.tracker.start(),null==_this.question||_this.question.stat&&_this.question.stat.complete?void 0:_this.tracker.track(_this.question,!0)):_this.tracker.stop()})),pi.controllers.TBController.prototype.load.call(this,context_data),this.quiz.proctoring?this.load_with_proctoring():this.goto(this._find_first())},QuizTake.prototype.load_with_proctoring=function(){return this.proctoring.init().then((_this=this,function(){return _this.goto(_this._find_first())}),function(err){var path;return path=new URLSearchParams(window.location.search).get("return_url")||"/",alert(err.toString()),location.href=path});var _this},QuizTake.prototype._supervisor=function(){return this.quiz.proctoring?Supervisor:{}},QuizTake.prototype._find_first=function(){var i,id,j,len,ref;for(i=j=0,len=(ref=this.quiz.question_ids).length;j<len;i=++j)if(id=ref[i],!$r.AnswerStat.get_by({complete:!0,question_id:id}))return i+1;return 1},QuizTake.prototype.goto=function(index){var _this;if(!(this._loading||index>this.quiz.questions_num||index===this.current_index||this.quiz.question_ids.length<index))return this.tracker.flush(this.question),QuizTake.__super__.goto.apply(this,arguments).then((_this=this,function(){var ref,ref1,ref2;if(!0!==(null!=(ref=_this.question)&&null!=(ref1=ref.stat)?ref1.complete:void 0)&&(_this.tracker.track(_this.question),null!=(ref2=pi.app.visitor)&&ref2.update_context({question_id:_this.question.id})),!_this._first_loaded)return _this._first_loaded=!0,_this.view.start_timer()}))},QuizTake.prototype.load_question=function(id){var ques;return(ques=$r.Question.get(id))?utils.resolved_promise(ques):$r.Question.take({course_session_id:pi.app.course_session_id,id:id})},QuizTake.prototype.time_limit=function(){var ref,_this;return this.tracker.clear(),this.tracker.stop(),null!=(ref=pi.app.visitor)&&ref.off(),this.proctoring.stop(),this.stat.track().then((_this=this,function(){return _this.view.quiz_finished(_this.stat)}))},QuizTake.prototype.upload_answer_file=function(){return this["switch"]("file_upload")},QuizTake.prototype.reload=function(context){var file_obj;return null!=context.data.files&&context.data.files.length&&(utils.debug(context.data.files),file_obj=context.data.files[0],this.view.form.content.render(file_obj),this.view.form.value({answer:{temp_file_id:file_obj.id}})),QuizTake.__super__.reload.apply(this,arguments)},QuizTake.prototype.submit=function(data){var ts,_this;if(null!=this.question&&!this._loading)return ts=this.tracker.untrack(this.question),this.view.disable_submit(),this.with_loader(this.question.submit({question:data,ts:ts})).then((_this=this,function(){var ref;if(0!==_this.quiz.navigation&&_this.next(),_this._is_finished())return _this.view.quiz_finished(_this.stat),null!=(ref=pi.app.visitor)&&ref.off(),_this.tracker.clear(),_this.tracker.stop(),_this.proctoring.stop()}))["catch"](function(_this){return function(){return null==_this.question||_this.question.stat&&_this.question.stat.complete||_this.tracker.track(_this.question,!0),_this.view.enable_submit()}}(this))},QuizTake.prototype._is_finished=function(){var j,len,ref,stat;if(this.quiz.question_ids.length>$r.AnswerStat.all().length)return!1;for(j=0,len=(ref=$r.AnswerStat.all()).length;j<len;j++)if(!(null!=(stat=ref[j])?stat.complete:void 0))return!1;return!0},QuizTake}(pi.controllers.QuizView)}(this)}).call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ChooseTaskStatScore=function(superClass){function ChooseTaskStatScore(){return ChooseTaskStatScore.__super__.constructor.apply(this,arguments)}return extend(ChooseTaskStatScore,superClass),ChooseTaskStatScore.prototype.id="choose_task_stat_score",ChooseTaskStatScore.prototype.load=function(context){return ChooseTaskStatScore.__super__.load.apply(this,arguments),this.task_stat=context.data},ChooseTaskStatScore.prototype.accept=function(host){var value;return value=host.slider.input.value(),this.close({task_stat:this.task_stat,value:value})},ChooseTaskStatScore}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _orig_clone,pi,utils;pi=context.pi,utils=pi.utils,_orig_clone=utils.clone,utils.clone=function(obj,except){return null==except&&(except=[]),window.File&&(obj instanceof File||obj instanceof Blob)?obj:_orig_clone.call(utils,obj,except)},pi.controllers.TaskEdit=function(superClass){function TaskEdit(){return TaskEdit.__super__.constructor.apply(this,arguments)}return extend(TaskEdit,superClass),TaskEdit.prototype.id="task_edit",TaskEdit.prototype.load=function(context){if(this._initialized||this.initialize(),!(null!=context.data&&context.data instanceof $r.Task)){if(this.section_id=context.data.section_id,!this.section_id)throw Error("task need section!");return this.task=$r.Task.build({score:1,section_id:this.section_id,course_id:pi.app.course.id}),this.view.disable_preview(),this.view.loaded(this.task)}if(this.task=context.data,this.view.enable_preview(),this.view.loaded(this.task),this.task.attachments)return this.view.loaded_attachments(this.task.attachments)},TaskEdit.prototype.save=function(data){if(null!=this.task)return data.attachments_attributes=this.view.file_attributes(),this.with_loader(this.task.save(data).then((_this=this,function(){return _this.close()})));var _this},TaskEdit.prototype.preview=function(){return this.location(this.task.view_path(),"_blank_task_"+this.task.id)},TaskEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Results=function(superClass){function Results(){return Results.__super__.constructor.apply(this,arguments)}return extend(Results,superClass),Results.include(pi.controllers.Paginated,pi.controllers.LabelsFilter,pi.controllers.SessionsFilter),Results.list_resource(pi.resources.Result),Results.prototype.id="results",Results.prototype.initialize=function(){var hash_data,ref,ref1,ref2;return Results.__super__.initialize.apply(this,arguments),pi.app.course_id?(this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1)):pi.app.program_id&&(this.scope().set({program_id:pi.app.program_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({program_id:pi.app.program_id},!1)),pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref2=pi.app.visitor)&&ref2.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.scope().set({course_session_id:hash_data.session_id}),this.view.ensure_session(0|hash_data.session_id)),this.labels_filter_initialize(),this.next_page()},Results.prototype.reload=function(context){var _this;return!0===context.data.reload&&this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))})),this.labels_filter_reload(context)},Results.prototype.filter=function(type){var params;return params=function(){switch(!1){case"checked"!==type:return{checked:!1};case"scorm"!==type:return{is_scorm:!0};default:return null}}(),Results.__super__.filter.call(this,params)},Results.prototype.show=function(id){var res;if(null!=(res=$r.Result.get(id)))return"QuizStat"===res.type?this["switch"]("quiz_stat_show",res.to_quiz_stat()):"TaskStat"===res.type?this.location(res.to_task_stat().result_view_path()):void 0},Results.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},Results.prototype.edit_program=function(){return this["switch"]("program_edit",pi.app.program)},Results.prototype.recount=function(data){return this.with_loader($r.QuizStat.bulk_recount({ids:data.map(function(el){return el.id})}).then((_this=this,function(response){return _this.view.list.clear_selection(),response})));var _this},Results}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.TaskShow=function(superClass){function TaskShow(){return TaskShow.__super__.constructor.apply(this,arguments)}return extend(TaskShow,superClass),TaskShow.include(pi.controllers.Paginated),TaskShow.list_resource(pi.resources.TaskStat),TaskShow.prototype.id="task_show",TaskShow.prototype.initialize=function(){return TaskShow.__super__.initialize.apply(this,arguments),this.scope().set({course_id:pi.app.course_id}),null!=pi.app.course_session_id&&this.scope().set({course_session_id:pi.app.course_session_id}),null!=pi.app.task_id&&this.scope().set({task_id:pi.app.task_id}),this.next_page().then((_this=this,function(){var hash_data,stat;return(hash_data=hash.get()).user_id&&hash_data.session_id?_this.show_answers(hash_data.user_id,hash_data.session_id):_this.resources.all().length?(stat=_this.resources.all()[0],_this.show_answers(stat.user_id,stat.course_session_id)):void 0}));var _this},TaskShow.prototype._resource_query=function(params){return pi.app.task.allow_offline_answers?this.with_loader(this.resources.offline(params)):this.with_loader(this.resources.latest(params))},TaskShow.prototype.accept=function(stat,data){var ref1,_this;return null!=(ref1=this.view.form.host.accept_btn)&&ref1.disable(),data.comment={text:data.task_stat.comment,attachments_attributes:this.view.file_attributes()},pi.Net.use_json=!1,this.with_loader(stat.offline?stat.offline_checking(data,!0):stat.accept(data))["catch"]((_this=this,function(){var ref2;return pi.Net.use_json=!0,null!=(ref2=_this.view.form.host.accept_btn)?ref2.enable():void 0})).then(function(_this){return function(response){return pi.Net.use_json=!0,_this.view.refresh_answers_list(response)}}(this))},TaskShow.prototype.decline=function(stat,data){var ref1,_this;return null!=(ref1=this.view.form.host.decline_btn)&&ref1.disable(),data.comment={text:data.task_stat.comment,attachments_attributes:this.view.file_attributes()},pi.Net.use_json=!1,this.with_loader(stat.offline?stat.offline_checking(data,!1):stat.decline(data))["catch"]((_this=this,function(){var ref2;return pi.Net.use_json=!0,null!=(ref2=_this.view.form.host.decline_btn)?ref2.enable():void 0})).then(function(_this){return function(response){return pi.Net.use_json=!0,_this.view.refresh_answers_list(response)}}(this))},TaskShow.prototype.change_status=function(data,stat_id){var task,task_stat,_this;if(data!==(task_stat=$r.TaskStat.get(stat_id)).status)return this.view.change_last_answer_status(data),"declined"===data&&this.confirm((_this=this,function(){return _this.with_loader(task_stat.save({success:!1}))}),function(_this){return function(){return _this.view.change_last_answer_status("accepted")}}(this))["with"](null,"task_stats/decline_confirm"),"accepted"===data?(task=$r.Task.get(task_stat.task_id)).allow_incomplete_score?task.score>1?this["switch"]("choose_task_stat_score",task_stat):this.confirm_answer(task_stat,1):this.confirm_answer(task_stat):void 0},TaskShow.prototype.change_score=function(score,stat_id){var task_stat,_this;if(task_stat=$r.TaskStat.get(stat_id),score!==task_stat.score)return this.confirm((_this=this,function(){return _this.with_loader(task_stat.save({score:score}))}),function(_this){return function(){return _this.view.change_last_answer_score(task_stat.score)}}(this))["with"]({score:score},"task_stats/change_score_confirm")},TaskShow.prototype.update_comment=function(edit_form){var comment,query_string,text;return comment=edit_form.host.record,text=edit_form.value().text,query_string="/api/task_stats/"+comment.task_stat_id+"/comments/"+comment.id+".json",this.with_loader(pi.Net.patch(query_string,{comment:{text:text}})).then(function(){return comment.task_stat().save()})},TaskShow.prototype.create_comment=function(form,stat_id,data){var comment,task_stat,_this;if(!this.comment_loading&&(task_stat=$r.TaskStat.get(stat_id)))return comment=task_stat.comments().build(data),this.comment_loading=!0,this.with_loader(comment.save()).then((_this=this,function(){return form.clear(),_this.comment_loading=!1}))["catch"](function(_this){return function(){return _this.comment_loading=!1}}(this))},TaskShow.prototype.confirm_answer=function(task_stat,score){return null==score&&(score=0),this.confirm((_this=this,function(){return _this.with_loader(task_stat.save({success:!0,score:score}))}),function(_this){return function(){return _this.view.change_last_answer_status("declined")}}(this))["with"](null,"task_stats/accept_confirm");var _this},TaskShow.prototype.reload=function(context){var task_stat;if("choose_task_stat_score"===context.context)return null!=context.data.value?(task_stat=context.data.task_stat,this.with_loader(task_stat.save({success:!0,score:context.data.value}))):this.view.change_last_answer_status("declined")},TaskShow.prototype.show_answers=function(user_id,course_session_id){var answers,ref,_this;return pi.app.task.allow_offline_answers?(1===(answers=$r.TaskStat.where({user_id:parseInt(user_id),course_session_id:parseInt(course_session_id),task_id:parseInt(pi.app.task_id)})).length&&answers[0].offline&&1===answers[0].attempt?this.view.load_answers(answers):this.load_stats(user_id,course_session_id).then((_this=this,function(data){var stats;return stats=(answers=$r.TaskStat.where({user_id:parseInt(user_id),course_session_id:parseInt(course_session_id),task_id:parseInt(pi.app.task_id)})).length>1&&answers[0].offline&&!answers[0].checked?data.task_stats.concat(answers[0]):data.task_stats,_this.view.load_answers(stats)})),hash.add({user_id:user_id,session_id:course_session_id}),(ref=this.resources.where({user_id:0|user_id,course_session_id:0|course_session_id})).length?this.view.ensure_selected(ref[0]):void 0):this.load_stats(user_id,course_session_id).then(function(_this){return function(data){if(hash.add({user_id:user_id,session_id:course_session_id}),_this.view.load_answers(data.task_stats,data.pagination),(ref=_this.resources.where({user_id:0|user_id,course_session_id:0|course_session_id})).length)return _this.view.ensure_selected(ref[0])}}(this))},TaskShow.prototype.load_stats=function(user_id,course_session_id){return this.with_loader($r.TaskStat.query({user_id:user_id,course_session_id:course_session_id,task_id:pi.app.task_id,course_id:pi.app.course_id,serializer:"full"}))},TaskShow}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.TaskTake=function(superClass){function TaskTake(){return TaskTake.__super__.constructor.apply(this,arguments)}return extend(TaskTake,superClass),TaskTake.prototype.id="task_take",TaskTake.prototype.initialize=function(){return TaskTake.__super__.initialize.apply(this,arguments),this.scope().set({course_session_id:pi.app.course_session_id}),this.scope().set({task_id:pi.app.task_id})},TaskTake.prototype.submit=function(task_stat,data){return task_stat.course_session_id=pi.app.course_session_id,task_stat.task_id=pi.app.task_id,data.attachments_attributes=this.view.file_attributes(),this.with_loader(task_stat.save(data))},TaskTake.prototype.create_comment=function(form,stat_id,data){var comment,task_stat,_this;if(!this.comment_loading&&(task_stat=$r.TaskStat.get(stat_id)))return comment=task_stat.comments().build(data),this.comment_loading=!0,this.with_loader(comment.save()).then((_this=this,function(){return form.clear(),_this.comment_loading=!1}))["catch"](function(_this){return function(){return _this.comment_loading=!1}}(this))},TaskTake}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuizStats=function(superClass){function QuizStats(){return QuizStats.__super__.constructor.apply(this,arguments)}return extend(QuizStats,superClass),QuizStats.include(pi.controllers.Paginated,pi.controllers.LabelsFilter,pi.controllers.SessionsFilter),QuizStats.list_resource(pi.resources.QuizStat),QuizStats.prototype.id="quiz_stats",QuizStats.prototype.initialize=function(){var hash_data,ref,ref1;return QuizStats.__super__.initialize.apply(this,arguments),this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1),pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.scope().set({course_session_id:hash_data.session_id}),this.view.ensure_session(0|hash_data.session_id)),this.labels_filter_initialize(),this.next_page()},QuizStats.prototype.reload=function(context){var _this;return!0===context.data.reload&&this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))})),this.labels_filter_reload(context)},QuizStats.prototype.filter=function(type){var params;return params="checked"===type?{checked:!1}:null,QuizStats.__super__.filter.call(this,params)},QuizStats.prototype.show=function(id){var quiz_stat;if(null!=(quiz_stat=$r.QuizStat.get(id)))return this["switch"]("quiz_stat_show",quiz_stat)},QuizStats.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},QuizStats}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizStatShow=function(superClass){function QuizStatShow(){return QuizStatShow.__super__.constructor.apply(this,arguments)}return extend(QuizStatShow,superClass),QuizStatShow.prototype.id="quiz_stat_show",QuizStatShow.prototype.filter=function(type){var params;return params="checked"===type?{stat:{checked:!1}}:null,this.view.filter(params)},QuizStatShow.prototype.search=function(q){return this.view.search(q)},QuizStatShow.prototype.load=function(context_data){if(QuizStatShow.__super__.load.apply(this,arguments),null!=context_data.data)return this.load_stat(context_data.data.id)},QuizStatShow.prototype.unload=function(){return QuizStatShow.__super__.unload.apply(this,arguments),this.quiz_stat=null},QuizStatShow.prototype.check_answer=function(id,data){var stat,_this;if(stat=$r.AnswerStat.get(id))return this.confirm((_this=this,function(){return _this.with_loader(stat.check(data)).then(function(){return _this.view.ensure_updated({stat:{id:id}}),_this.quiz_stat.trigger("update",{correct_data:!0})})}))["with"](stat,"quizzes/check_answer_confirm")},QuizStatShow.prototype.load_stat=function(id){var stat,_this;if((stat=$r.QuizStat.get(id))&&(!this.quiz_stat||this.quiz_stat.id!==id))return this.quiz_stat=stat,this.view.load_stat(this.quiz_stat),(!0===this.quiz_stat.answer_stats_loaded?utils.resolved_promise():this.with_loader(this.quiz_stat.load_answer_stats()).then((_this=this,function(){return _this.quiz_stat.trigger("update",{correct_data:!0})}))).then(function(_this){return function(){return _this.view.reload(_this._build_question_stats())}}(this))},QuizStatShow.prototype._build_question_stats=function(){var data,i,len,ques,ref,st;for(data=[],i=0,len=(ref=this.quiz_stat.answer_stats().all()).length;i<len;i++)st=ref[i],null!=(ques=$r.Question.get(st.question_id))&&data.push({pos:ques.position,question:ques,stat:st});return utils.sort_by(data,"pos")},QuizStatShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.QuizStatListenerShow=function(superClass){function QuizStatListenerShow(){return QuizStatListenerShow.__super__.constructor.apply(this,arguments)}return extend(QuizStatListenerShow,superClass),QuizStatListenerShow.prototype.id="quiz_stat_listener_show",QuizStatListenerShow.prototype.load=function(context_data){var ref,stat;return pi.controllers.Popup.prototype.load.call(this,context_data),this.quiz_stats=null!=(ref=context_data.data)?ref.quiz_stats:void 0,this.quiz_stats?(this.quiz=$r.Quiz.get(this.quiz_stats[0].quiz_id),this.quiz?(stat=this.quiz.stat(),this.load_stat(stat.id)):utils.rejected_promise()):utils.rejected_promise()},QuizStatListenerShow.prototype.unload=function(){return QuizStatListenerShow.__super__.unload.apply(this,arguments),this.quiz=null,this.quiz_stats=null},QuizStatListenerShow}(pi.controllers.QuizStatShow)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.ReportBase=function(superClass){function ReportBase(){return ReportBase.__super__.constructor.apply(this,arguments)}return extend(ReportBase,superClass),ReportBase.include(pi.controllers.Scoped,pi.controllers.LabelsFilter,pi.controllers.SessionsFilter),ReportBase.prototype.id="report_base",ReportBase.prototype.initialize=function(){var hash_data,ref,ref1;return ReportBase.__super__.initialize.apply(this,arguments),this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1),hash_data=hash.get(),null!=pi.app.course_session_id?(null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1),this.scope().set({course_session_id:pi.app.course_session_id})):null!=hash_data.session_id&&(this.scope().set({course_session_id:hash_data.session_id}),this.view.ensure_session(0|hash_data.session_id)),null!=hash_data.quiz_id&&(this.scope().set({quiz_id:hash_data.quiz_id}),this.view.ensure_quiz(0|hash_data.quiz_id)),this.labels_filter_initialize()},ReportBase.prototype.query=function(params,scope_params){return null==params&&(params={}),null==scope_params&&(scope_params={}),null==this._promise&&(this._promise=utils.resolved_promise()),this._promise=this._promise.then((_this=this,function(){return _this.scope().set(scope_params),_this.scope().is_full?utils.resolved_promise():(params=utils.merge(_this.scope().params,params),_this._resource_query(params))}),function(_this){return function(){return _this._promise=null}}(this));var _this},ReportBase.prototype._resource_query=function(){return utils.rejected_promise()},ReportBase.prototype._parse_response=function(){return null},ReportBase.prototype.reload=function(context){var _this;return!0===context.data.reload&&this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))})),this.labels_filter_reload(context)},ReportBase.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},ReportBase}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _range_to_chart_range,pi;(pi=context.pi).utils,_range_to_chart_range={today:"hour",yesterday:"hour",year:"month"},pi.controllers.ReportVisitsBase=function(superClass){function ReportVisitsBase(){return ReportVisitsBase.__super__.constructor.apply(this,arguments)}return extend(ReportVisitsBase,superClass),ReportVisitsBase.prototype.id="report_visits_base",ReportVisitsBase.set_report=function(resources){return this.prototype.reports=resources},ReportVisitsBase.prototype.initialize=function(){return ReportVisitsBase.__super__.initialize.apply(this,arguments),this.range="today",this.query()},ReportVisitsBase.prototype._resource_query=function(params){return this.with_loader(this.reports.query(params).then((_this=this,function(data){return _this.view.draw_data(data,_range_to_chart_range[_this.range])})));var _this},ReportVisitsBase.prototype.load_range=function(range){if(range!==this.range)return this.scope().set({range:range}),this.range=range,this.query()},ReportVisitsBase}(pi.controllers.ReportBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportsAccountVisits=function(superClass){function ReportsAccountVisits(){return ReportsAccountVisits.__super__.constructor.apply(this,arguments)}return extend(ReportsAccountVisits,superClass),ReportsAccountVisits.prototype.id="report_account_visits",ReportsAccountVisits.set_report($r.AccountVisitsReport),ReportsAccountVisits}(pi.controllers.ReportVisitsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportsActivity=function(superClass){function ReportsActivity(){return ReportsActivity.__super__.constructor.apply(this,arguments)}return extend(ReportsActivity,superClass),ReportsActivity.include(pi.controllers.Paginated),ReportsActivity.list_resource(pi.resources.UserActivity),ReportsActivity.prototype.id="reports_activity",ReportsActivity.prototype.initialize=function(){return ReportsActivity.__super__.initialize.apply(this,arguments),this.next_page()},ReportsActivity}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportQuizBase=function(superClass){function ReportQuizBase(){return ReportQuizBase.__super__.constructor.apply(this,arguments)}return extend(ReportQuizBase,superClass),ReportQuizBase.prototype.id="report_quiz_base",ReportQuizBase.prototype.initialize=function(){var _ref,hash_data,qid;if(ReportQuizBase.__super__.initialize.apply(this,arguments),null!=(hash_data=hash.get()).quiz_id?qid=hash_data.quiz_id:null!=(_ref=$r.Quiz.all()).length&&(qid=_ref[0].id),qid)return this.load_quiz(qid)},ReportQuizBase.prototype.load_quiz=function(id){return this.with_loader(this.query({},{quiz_id:id}).then((_this=this,function(){return hash.add({quiz_id:id}),_this.view.ensure_quiz(id)})));var _this},ReportQuizBase}(pi.controllers.ReportBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportCourse=function(superClass){function ReportCourse(){
return ReportCourse.__super__.constructor.apply(this,arguments)}return extend(ReportCourse,superClass),ReportCourse.prototype.id="report_course",ReportCourse.has_resource($r.CourseReport),ReportCourse.prototype.initialize=function(){return ReportCourse.__super__.initialize.apply(this,arguments),this.with_loader(this.query())},ReportCourse.prototype._resource_query=function(params){return this.course_reports.show(params).then(function(course_report){return course_report||(course_report=$r.CourseReport.build()),course_report.set({query:params}),$r.CourseReport.add(course_report),course_report.trigger("create")})},ReportCourse.prototype.destroy_report=function(id){return $r.CourseReport.remove_by_id(id)},ReportCourse}(pi.controllers.ReportBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportCourseVisits=function(superClass){function ReportCourseVisits(){return ReportCourseVisits.__super__.constructor.apply(this,arguments)}return extend(ReportCourseVisits,superClass),ReportCourseVisits.prototype.id="report_course_visits",ReportCourseVisits.set_report($r.CourseVisitsReport),ReportCourseVisits}(pi.controllers.ReportVisitsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.ReportQuestions=function(superClass){function ReportQuestions(){return ReportQuestions.__super__.constructor.apply(this,arguments)}return extend(ReportQuestions,superClass),ReportQuestions.prototype.id="report_questions",ReportQuestions.has_resource($r.QuestionReport),ReportQuestions.prototype.initialize=function(){return this._fields=["question_name","time_spent","success_count","success_percent","unsuccess_count","unsuccess_percent","score_avg","score_percent_avg"],ReportQuestions.__super__.initialize.apply(this,arguments)},ReportQuestions.prototype.load_quiz=function(id){var _promise,_this;if(this.quiz=$r.Quiz.get(id),this.quiz)return _promise=this.quiz.questions_loaded?utils.resolved_promise():this.quiz.load_questions(),this.with_loader(_promise.then((_this=this,function(){return ReportQuestions.__super__.load_quiz.call(_this,id)})))},ReportQuestions.prototype["export"]=function(){var data,field,headers,i,item,item_data,j,len,len1,ref,rows,wb_binary,workbook,worksheet;if(pi.tools.LocalDownload.available()){for(data=this.view.list.records(),headers=this._fields.map(function(field){return I18n.t("reports.questions."+field)}),(rows=[]).push(headers),i=0,len=data.length;i<len;i++){for(item=data[i],item_data=[],j=0,len1=(ref=this._fields).length;j<len1;j++)field=ref[j],item_data.push(null!=item[field]?item[field]:"");rows.push(item_data)}return(workbook=XLSX.utils.book_new()).SheetNames.push("SheetName"),worksheet=XLSX.utils.aoa_to_sheet(rows),workbook.Sheets.SheetName=worksheet,wb_binary=XLSX.write(workbook,{bookType:"xlsx",type:"binary"}),data=pi.tools.LocalDownload.binary_to_octet(wb_binary),pi.tools.LocalDownload.serve(data,this.quiz.name+"_report_"+utils.time.now("%Y%m%d_%H%I%M%S")+".xlsx","text/xlsx;charset=utf-8")}},ReportQuestions.prototype._resource_query=function(params){return this.with_loader(this.question_reports.query(params)).then((_this=this,function(data){return _this.view.load_data(data.question_reports)}));var _this},ReportQuestions}(pi.controllers.ReportQuizBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportQuiz=function(superClass){function ReportQuiz(){return ReportQuiz.__super__.constructor.apply(this,arguments)}return extend(ReportQuiz,superClass),ReportQuiz.prototype.id="report_quiz",ReportQuiz.has_resource($r.QuizReport),ReportQuiz.prototype._resource_query=function(params){return this.quiz_reports.show(params).then(function(quiz_report){return quiz_report||(quiz_report=$r.QuizReport.build()),quiz_report.set({query:params}),$r.QuizReport.add(quiz_report),quiz_report.trigger("create")})},ReportQuiz.prototype.destroy_report=function(id){return $r.QuizReport.remove_by_id(id)},ReportQuiz}(pi.controllers.ReportQuizBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportQuizVisits=function(superClass){function ReportQuizVisits(){return ReportQuizVisits.__super__.constructor.apply(this,arguments)}return extend(ReportQuizVisits,superClass),ReportQuizVisits.prototype.id="report_quiz_visits",ReportQuizVisits.set_report($r.QuizVisitsReport),ReportQuizVisits.prototype.initialize=function(){var _ref,hash_data,qid;return null!=(hash_data=hash.get()).quiz_id?qid=hash_data.quiz_id:null!=(_ref=$r.Quiz.all()).length&&(qid=_ref[0].id),null!=qid?(this.scope().set({quiz_id:qid}),this.view.ensure_quiz(qid),ReportQuizVisits.__super__.initialize.apply(this,arguments)):pi.controllers.TBController.prototype.initialize.call(this)},ReportQuizVisits.prototype.load_quiz=function(id){return this.scope().set({quiz_id:id}),this.with_loader(this.query().then((_this=this,function(){return hash.add({quiz_id:id}),_this.view.ensure_quiz(id)})));var _this},ReportQuizVisits}(pi.controllers.ReportVisitsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportsUsers=function(superClass){function ReportsUsers(){return ReportsUsers.__super__.constructor.apply(this,arguments)}return extend(ReportsUsers,superClass),ReportsUsers.prototype.id="reports_users",ReportsUsers.prototype.send_report=function(data){return console.log(data),this.with_loader($r.User.coach_summary_report(data)).then(response((_this=this,function(){if(null!=("undefined"!=typeof response&&null!==response?response.message:void 0))return _this.view.success(response.message)})));var _this},ReportsUsers}(pi.controllers.Users)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ReportsUsersShow=function(superClass){function ReportsUsersShow(){return ReportsUsersShow.__super__.constructor.apply(this,arguments)}return extend(ReportsUsersShow,superClass),ReportsUsersShow.include(pi.controllers.CourseTypesFilter),ReportsUsersShow.prototype.id="reports_users_show",ReportsUsersShow.prototype.types=["meetings","current_courses","finished_courses","clickmeeting_meetings"],ReportsUsersShow.prototype.initialize=function(){var i,len,ref,type;for(ReportsUsersShow.__super__.initialize.apply(this,arguments),i=0,len=(ref=this.types).length;i<len;i++)type=ref[i],this._contexts[type]&&this._contexts[type].initialize();return this.user=pi.app.report_user,this.load_range("all")},ReportsUsersShow.prototype._parse_response=function(data){return data},ReportsUsersShow.prototype.query=function(params,course_types){return null==params&&(params={}),null==course_types&&(course_types={}),params.per_page=10,params.user_id=this.user.id,params.course_content_types=course_types.course_content_type,params.course_types=course_types.course_type_id,this.with_loader($r.UserAccountReport.query(params).then((_this=this,function(data){var i,len,ref,results,type;for(results=[],i=0,len=(ref=_this.types).length;i<len;i++)type=ref[i],_this._contexts[type]&&results.push(_this._contexts[type].reload_initial(data));return results})));var _this},ReportsUsersShow.prototype.load_more=function(type){var ref;return null!=(ref=this._contexts[type])?ref.next_page():void 0},ReportsUsersShow.prototype.load_range=function(range){var i,len,ref,type;if(range!==this.range){for(i=0,len=(ref=this.types).length;i<len;i++)type=ref[i],this._contexts[type]&&this._contexts[type].scope().set({range:range});return this.range=range,this.query({range:range})}},ReportsUsersShow.prototype.show_course_stat=function(id){var stat,_this;if(null!=(stat=$r.CourseListenerStat.get(id)))return $r.Course.get(stat.course_id)?this["switch"]("course_stat_show",stat):this.with_loader($r.Course.show({id:stat.course_id,load:"quizzes"}).then((_this=this,function(){return _this["switch"]("course_stat_show",stat)})))},ReportsUsersShow.prototype.send_email=function(){return this["switch"]("users_message",[this.user])},ReportsUsersShow.prototype["delete"]=function(course_stat){return this.confirm((_this=this,function(){return _this.with_loader(pi.Net["delete"]("/api/course_sessions/"+course_stat.course_session_id+"/participants/"+course_stat.user_id,{id:course_stat.user_id})).then(window.location.reload())}))["with"](course_stat,"course_sessions/remove_participant_confirm");var _this},ReportsUsersShow}(pi.controllers.TBListController),pi.controllers.ReportsUsersShowList=function(superClass){function ReportsUsersShowList(){return ReportsUsersShowList.__super__.constructor.apply(this,arguments)}return extend(ReportsUsersShowList,superClass),ReportsUsersShowList.include(pi.controllers.Paginated),ReportsUsersShowList.prototype.per_page=10,ReportsUsersShowList.list_resource($r.UserAccountReport),ReportsUsersShowList.prototype.setup=function(id){return this.id=id,this.pagination_field=id+"_pagination",this.scope().set({type:id,user_id:pi.app.report_user.id})},ReportsUsersShowList.prototype._parse_response=function(data){return data[this.id]||[]},ReportsUsersShowList.prototype.reload_initial=function(data){var items;return null==data&&(data={}),items=this._parse_response(data),this._page=1,this.page_resolver(data),this.view.reload(items)},ReportsUsersShowList}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AccountsForCustomization=function(superClass){function AccountsForCustomization(){return AccountsForCustomization.__super__.constructor.apply(this,arguments)}return extend(AccountsForCustomization,superClass),AccountsForCustomization.include(pi.controllers.Popuped),AccountsForCustomization.include(pi.controllers.Paginated),AccountsForCustomization.list_resource(pi.resources.AdminAccount),AccountsForCustomization.prototype.id="accounts_for_customization",AccountsForCustomization.prototype.initialize=function(){return AccountsForCustomization.__super__.initialize.apply(this,arguments),this.next_page()},AccountsForCustomization.prototype.load=function(context){return AccountsForCustomization.__super__.load.apply(this,arguments),this.theme=context.data,console.log(this.theme)},AccountsForCustomization.prototype.apply=function(account){return this.with_loader(account.apply_color_theme({theme_id:this.theme.id}).then(this.close()))},AccountsForCustomization.prototype.unload=function(){return this.theme=null,AccountsForCustomization.__super__.unload.apply(this,arguments)},AccountsForCustomization}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminCopyCourses=function(superClass){function AdminCopyCourses(){return AdminCopyCourses.__super__.constructor.apply(this,arguments)}return extend(AdminCopyCourses,superClass),AdminCopyCourses.prototype.id="admin_copy_courses",AdminCopyCourses.prototype.load=function(context){return AdminCopyCourses.__super__.load.apply(this,arguments),this.account=context.data},AdminCopyCourses.prototype.copy=function(data){return null!=this.account?this.with_loader(this.account.copy_courses({account:data}).then((_this=this,function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}))):this.close();var _this},AdminCopyCourses.prototype.unload=function(){return this.account=null,AdminCopyCourses.__super__.unload.apply(this,arguments)},AdminCopyCourses}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.AdminAccountEdit=function(superClass){function AdminAccountEdit(){return AdminAccountEdit.__super__.constructor.apply(this,arguments)}return extend(AdminAccountEdit,superClass),AdminAccountEdit.prototype.id="admin_account_edit",AdminAccountEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminAccount?(this.account=context.data,this.view.loaded(this.account)):(this.account=$r.AdminAccount.build(),this.view.loaded(this.account))},AdminAccountEdit.prototype.upload_contract=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},AdminAccountEdit.prototype.reload=function(context){var file_obj;if(null!=context.data.file)return utils.debug(context.data.file),file_obj=context.data.file,this.view.contract_loaded(this.cover_target,file_obj)},AdminAccountEdit.prototype.change_system_version=function(){return this.account.system_version=this.account.system_version%2+1,this.account.save(this.view.form.value()).then((_this=this,function(response){return _this.view.handle_system_version(response.system_version)}));var _this},AdminAccountEdit.prototype.save=function(data){return null!=this.account?this.account.save(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.close({reload:!0}),response}}(this)):this.exit();var _this},AdminAccountEdit.prototype.test_ad_connection=function(data){return this.view.show_result_connection("Establishing connection..."),this.with_loader(this.account.test_ad_connection(data).then((_this=this,function(response){return null!=(null!=response?response.result_connection:void 0)&&_this.view.show_result_connection(response.result_connection),response})));var _this},AdminAccountEdit.prototype.convert_to_master=function(){return this.confirm((_this=this,function(){return _this.with_loader(_this.account.convert_to_master().then(function(response){if(null!=(null!=response?response.message:void 0))return _this.view.success(response.message)}))}))["with"](this.rule,"admin/accounts/convert_to_master_confirm");var _this},AdminAccountEdit.prototype.unload=function(){return this.account=null,AdminAccountEdit.__super__.unload.apply(this,arguments)},AdminAccountEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminAccounts=function(superClass){function AdminAccounts(){return AdminAccounts.__super__.constructor.apply(this,arguments)}return extend(AdminAccounts,superClass),AdminAccounts.include(pi.controllers.Paginated),AdminAccounts.list_resource(pi.resources.AdminAccount),AdminAccounts.prototype.id="admin_accounts",AdminAccounts.prototype.initialize=function(){return AdminAccounts.__super__.initialize.apply(this,arguments),this.next_page()},AdminAccounts.prototype.show=function(id){return this["switch"]("admin_account_show",id)},AdminAccounts.prototype["new"]=function(){return this["switch"]("admin_account_edit")},AdminAccounts.prototype.edit=function(data){return this["switch"]("admin_account_edit",data)},AdminAccounts.prototype.add_netology_course=function(data){return this["switch"]("admin_netology_courses",data)},AdminAccounts.prototype.copy_courses=function(data){return this["switch"]("admin_copy_courses",data)},AdminAccounts.prototype.send_accounts_report=function(){return this["switch"]("admin_send_accounts_report")},AdminAccounts.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},AdminAccounts.prototype.send_docs=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.save({docs_sent:1}))}))["with"](data,"admin/orders/send_confirm");var _this},AdminAccounts.prototype.destroy=function(account){return this.confirm((_this=this,function(){return _this.with_loader(account.initialize_destroy())}))["with"](account,"admin/accounts/destroy_confirm");var _this},AdminAccounts.prototype.login=function(account){if(null!=account&&null!=account.id)return window.open("/admin/accounts/"+account.id+"/login","_blank")},AdminAccounts.prototype.choose=function(account){return this.view.find(".choose-account").attrs({href:"/accounts/"+account.id+"/choose"}).node.click()},AdminAccounts}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminNetologyCourses=function(superClass){function AdminNetologyCourses(){return AdminNetologyCourses.__super__.constructor.apply(this,arguments)}return extend(AdminNetologyCourses,superClass),AdminNetologyCourses.prototype.id="admin_netology_courses",AdminNetologyCourses.prototype.load=function(context){return AdminNetologyCourses.__super__.load.apply(this,arguments),this.account=context.data,this.with_loader($r.NetologyCourse.fetch().then((_this=this,function(data){return _this.view.load(data.courses),data})));var _this},AdminNetologyCourses.prototype.copy=function(data){return null!=this.account?(this.course_id=data.id,this.with_loader(this.account.copy_netology_course({account:{course_id:this.course_id}}).then(this.close()))):this.close()},AdminNetologyCourses.prototype.unload=function(){return this.courses=null,this.course_id=null,this.account=null,AdminNetologyCourses.__super__.unload.apply(this,arguments)},AdminNetologyCourses}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminAccountSelect=function(superClass){function AdminAccountSelect(){return AdminAccountSelect.__super__.constructor.apply(this,arguments)}return extend(AdminAccountSelect,superClass),AdminAccountSelect.include(pi.controllers.Paginated,pi.controllers.Popuped),AdminAccountSelect.list_resource(pi.resources.AdminAccount),AdminAccountSelect.prototype.id="admin_account_select",AdminAccountSelect.prototype.data_wrap="account",AdminAccountSelect.prototype.initialize=function(){return AdminAccountSelect.__super__.initialize.apply(this,arguments),this.next_page()},AdminAccountSelect}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).controllers.AdminSendAccountsReport=function(superClass){function AdminSendAccountsReport(){return AdminSendAccountsReport.__super__.constructor.apply(this,arguments)}return extend(AdminSendAccountsReport,superClass),AdminSendAccountsReport.prototype.id="admin_send_accounts_report",AdminSendAccountsReport.prototype.send=function(data){return this.email=data.email,this.with_loader($r.AdminAccount.report_tariffs({email:this.email})["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this)));var _this},AdminSendAccountsReport}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminAccountShow=function(superClass){function AdminAccountShow(){return AdminAccountShow.__super__.constructor.apply(this,arguments)}return extend(AdminAccountShow,superClass),AdminAccountShow.prototype.id="admin_account_show",AdminAccountShow.prototype.load=function(context){var _this;if(null!=context.data)return pi.resources.AdminAccount.show({id:context.data})["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){return _this.account=response.account,null!=_this.account&&_this.view.loaded(_this.account),_this.view.load_lists(response.managers,response.orders,response.subscriptions)}}(this))},AdminAccountShow.prototype.toggle_status=function(){var _this;if(this.account.status!==$r.AdminAccount.STATUSES().pending)return this.account.toggle_status()["catch"]((_this=this,function(err){return _this.view.error(err.message)})).then(function(_this){return function(){return _this.view.content.enable_btn.visible?(_this.view.content.enable_btn.hide(),_this.view.content.disable_btn.show()):(_this.view.content.enable_btn.show(),_this.view.content.disable_btn.hide())}}(this))},AdminAccountShow.prototype.unload=function(){return this.account=null,this.orders=null,this.managers=null,AdminAccountShow.__super__.unload.apply(this,arguments)},AdminAccountShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminCourseShare=function(superClass){function AdminCourseShare(){return AdminCourseShare.__super__.constructor.apply(this,arguments)}return extend(AdminCourseShare,superClass),AdminCourseShare.prototype.id="admin_course_share",AdminCourseShare.prototype.load=function(context){return AdminCourseShare.__super__.load.apply(this,arguments),this.course=context.data},AdminCourseShare.prototype.share=function(data){var target_account_ids,_this;return null!=this.course?(target_account_ids=String(data.target_account_ids).split(","),this.with_loader(this.course.share({target_account_ids:target_account_ids}).then((_this=this,function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response})))):this.close()},AdminCourseShare.prototype.unload=function(){return this.course=null,AdminCourseShare.__super__.unload.apply(this,arguments)},AdminCourseShare}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminOrderConfirm=function(superClass){function AdminOrderConfirm(){return AdminOrderConfirm.__super__.constructor.apply(this,arguments)}return extend(AdminOrderConfirm,superClass),AdminOrderConfirm.prototype.id="admin_order_confirm",AdminOrderConfirm.prototype.load=function(context){if(this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminOrder)return this.order=context.data,this.view.loaded(this.order)},AdminOrderConfirm.prototype.unload=function(){return this.order=null,AdminOrderConfirm.__super__.unload.apply(this,arguments)},AdminOrderConfirm.prototype.save=function(data){return null!=this.order?this.order.confirm(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.close(),response}}(this)):this.close();var _this},AdminOrderConfirm}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminOrderCreate=function(superClass){function AdminOrderCreate(){return AdminOrderCreate.__super__.constructor.apply(this,arguments)}return extend(AdminOrderCreate,superClass),AdminOrderCreate.prototype.id="admin_order_create",AdminOrderCreate.prototype.load=function(){return this._initialized||this.initialize(),this.order=$r.AdminOrder.build(),this.view.loaded(this.order)},AdminOrderCreate.prototype.reload=function(context){var account,selected_payment_type;if(null!=context.data.account&&(account=context.data.account,this.order.set({account_id:account.id,account_name:account.name}),this.view.form.value(this.order),selected_payment_type=this.view.form.payment_type_select.value()))return this.view.handle_type_changed(selected_payment_type)},AdminOrderCreate.prototype.select_account=function(){return this["switch"]("admin_account_select")},AdminOrderCreate.prototype.save=function(data){return null!=this.order?this.with_loader(this.order.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},AdminOrderCreate.prototype.unload=function(){return this.order=null,AdminOrderCreate.__super__.unload.apply(this,arguments)},AdminOrderCreate}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.AdminOrderEdit=function(superClass){function AdminOrderEdit(){return AdminOrderEdit.__super__.constructor.apply(this,arguments)}return extend(AdminOrderEdit,superClass),AdminOrderEdit.prototype.id="admin_order_edit",AdminOrderEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminOrder?this.order=context.data:this.order=$r.AdminOrder.build(),this.view.loaded(this.order)},AdminOrderEdit.prototype.reload=function(context){var file_obj;if(null!=context.data.files&&context.data.files.length)return utils.debug(context.data.files),file_obj=context.data.files[0],this.view.form.value(this.order.update_files_value(this.doc_type,file_obj.id)),this.order.update_file_info(this.doc_type,file_obj),this.view.form.docs_info.render(this.order)},AdminOrderEdit.prototype.save=function(data){return null!=this.order?this.order.save(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.close(),response}}(this)):this.close();var _this},AdminOrderEdit.prototype.upload_document=function(type){return this.doc_type=type,this["switch"]("file_upload")},AdminOrderEdit.prototype.delete_document=function(type){return this.order["has_"+type]=!1,this.view.form.value(this.order.update_files_value(type,0)),this.view.form.docs_info.render(this.order)},AdminOrderEdit.prototype.unload=function(){return this.order=null,AdminOrderEdit.__super__.unload.apply(this,arguments)},AdminOrderEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminOrders=function(superClass){function AdminOrders(){return AdminOrders.__super__.constructor.apply(this,arguments)}return extend(AdminOrders,superClass),AdminOrders.include(pi.controllers.Paginated),AdminOrders.list_resource(pi.resources.AdminOrder),AdminOrders.prototype.id="admin_orders",AdminOrders.prototype.initialize=function(){return AdminOrders.__super__.initialize.apply(this,arguments),this.next_page()},AdminOrders.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},AdminOrders.prototype.confirmation=function(data){return this["switch"]("admin_order_confirm",data)},AdminOrders.prototype.show=function(data){return this["switch"]("admin_order_show",data)},AdminOrders.prototype["new"]=function(){return this["switch"]("admin_order_create")},AdminOrders.prototype.edit=function(data){return this["switch"]("admin_order_edit",data)},AdminOrders.prototype.send_docs=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.save({docs_sent:1}))}))["with"](data,"admin/orders/send_confirm");var _this},AdminOrders.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/orders/destroy_confirm");var _this},AdminOrders}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminOrderShow=function(superClass){function AdminOrderShow(){return AdminOrderShow.__super__.constructor.apply(this,arguments)}return extend(AdminOrderShow,superClass),AdminOrderShow.prototype.id="admin_order_show",AdminOrderShow.prototype.load=function(context){var _this
;if(null!=context.data)return pi.resources.AdminOrder.show({id:context.data})["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){if(_this.order=response,null!=_this.order)return _this.view.loaded(_this.order)}}(this))},AdminOrderShow.prototype.unload=function(){return this.order=null,AdminOrderShow.__super__.unload.apply(this,arguments)},AdminOrderShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminProductsOrderEdit=function(superClass){function AdminProductsOrderEdit(){return AdminProductsOrderEdit.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrderEdit,superClass),AdminProductsOrderEdit.prototype.id="admin_products_order_edit",AdminProductsOrderEdit.prototype.load=function(context){if(this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminProductsOrder)return this.order=context.data,this.view.loaded(this.order)},AdminProductsOrderEdit.prototype.save=function(data){return null!=this.order?this.with_loader(this.order.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},AdminProductsOrderEdit.prototype.unload=function(){return this.order=null,AdminProductsOrderEdit.__super__.unload.apply(this,arguments)},AdminProductsOrderEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminProductsOrders=function(superClass){function AdminProductsOrders(){return AdminProductsOrders.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrders,superClass),AdminProductsOrders.include(pi.controllers.Paginated),AdminProductsOrders.list_resource(pi.resources.AdminProductsOrder),AdminProductsOrders.prototype.id="admin_products_orders",AdminProductsOrders.prototype.initialize=function(){return AdminProductsOrders.__super__.initialize.apply(this,arguments),this.next_page()},AdminProductsOrders.prototype.edit=function(data){return this["switch"]("admin_products_order_edit",data)},AdminProductsOrders.prototype.show=function(id){return this["switch"]("admin_products_order_show",id)},AdminProductsOrders.prototype.confirmation=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.confirm({id:data.id}))}))["with"](data,"admin/products/orders/confirm");var _this},AdminProductsOrders.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/orders/destroy_confirm");var _this},AdminProductsOrders}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminProductsOrderShow=function(superClass){function AdminProductsOrderShow(){return AdminProductsOrderShow.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrderShow,superClass),AdminProductsOrderShow.prototype.id="admin_products_order_show",AdminProductsOrderShow.prototype.load=function(context){var _this;if(null!=context.data)return $r.AdminProductsOrder.find(context.data)["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){if(_this.order=response,null!=_this.order)return _this.view.loaded(_this.order)}}(this))},AdminProductsOrderShow.prototype.unload=function(){return this.order=null,AdminProductsOrderShow.__super__.unload.apply(this,arguments)},AdminProductsOrderShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminProductsStoreEdit=function(superClass){function AdminProductsStoreEdit(){return AdminProductsStoreEdit.__super__.constructor.apply(this,arguments)}return extend(AdminProductsStoreEdit,superClass),AdminProductsStoreEdit.prototype.id="admin_products_store_edit",AdminProductsStoreEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminProductsStore?this.store=context.data:this.store=$r.AdminProductsStore.build(),this.view.loaded(this.store)},AdminProductsStoreEdit.prototype.reload=function(context){var account;if(null!=context.data.account)return account=context.data.account,this.store.set({account_id:account.id,account_name:account.name}),this.view.form.value(this.store)},AdminProductsStoreEdit.prototype.select_account=function(){return this["switch"]("admin_account_select")},AdminProductsStoreEdit.prototype.save=function(data){return null!=this.store?this.with_loader(this.store.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},AdminProductsStoreEdit.prototype.unload=function(){return this.store=null,AdminProductsStoreEdit.__super__.unload.apply(this,arguments)},AdminProductsStoreEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminProductsStores=function(superClass){function AdminProductsStores(){return AdminProductsStores.__super__.constructor.apply(this,arguments)}return extend(AdminProductsStores,superClass),AdminProductsStores.include(pi.controllers.Paginated),AdminProductsStores.list_resource(pi.resources.AdminProductsStore),AdminProductsStores.prototype.id="admin_products_stores",AdminProductsStores.prototype.initialize=function(){return AdminProductsStores.__super__.initialize.apply(this,arguments),this.next_page()},AdminProductsStores.prototype["new"]=function(){return this["switch"]("admin_products_store_edit")},AdminProductsStores.prototype.edit=function(data){return this["switch"]("admin_products_store_edit",data)},AdminProductsStores.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/products/stores/destroy_confirm");var _this},AdminProductsStores}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminPromoCodeEdit=function(superClass){function AdminPromoCodeEdit(){return AdminPromoCodeEdit.__super__.constructor.apply(this,arguments)}return extend(AdminPromoCodeEdit,superClass),AdminPromoCodeEdit.prototype.id="admin_promo_code_edit",AdminPromoCodeEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminPromoCode?this.promo_code=context.data:this.promo_code=$r.AdminPromoCode.build(),this.view.loaded(this.promo_code)},AdminPromoCodeEdit.prototype.save=function(data){return null!=this.promo_code?this.with_loader(this.promo_code.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},AdminPromoCodeEdit.prototype.unload=function(){return this.promo_code=null,AdminPromoCodeEdit.__super__.unload.apply(this,arguments)},AdminPromoCodeEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminPromoCodes=function(superClass){function AdminPromoCodes(){return AdminPromoCodes.__super__.constructor.apply(this,arguments)}return extend(AdminPromoCodes,superClass),AdminPromoCodes.list_resource(pi.resources.AdminPromoCode),AdminPromoCodes.prototype.id="admin_promo_codes",AdminPromoCodes.prototype.initialize=function(){return AdminPromoCodes.__super__.initialize.apply(this,arguments),this.scope()},AdminPromoCodes.prototype.load=function(){return AdminPromoCodes.__super__.load.apply(this,arguments),this.index()},AdminPromoCodes.prototype["new"]=function(){return this["switch"]("admin_promo_code_edit")},AdminPromoCodes.prototype.edit=function(data){return this["switch"]("admin_promo_code_edit",data)},AdminPromoCodes.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/promo_codes/destroy_confirm");var _this},AdminPromoCodes}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _range_to_chart_range,pi;(pi=context.pi).utils,_range_to_chart_range={today:"hour",yesterday:"hour",year:"month"},pi.controllers.AdminReportsBase=function(superClass){function AdminReportsBase(){return AdminReportsBase.__super__.constructor.apply(this,arguments)}return extend(AdminReportsBase,superClass),AdminReportsBase.prototype.id="admin_reports_base",AdminReportsBase.set_resource=function(resources){return this.prototype.resources=resources},AdminReportsBase.prototype.selected_range=function(){return pi.app.page.context.context.view.range_filter.selected_record().id},AdminReportsBase.prototype.load=function(){return AdminReportsBase.__super__.load.apply(this,arguments),this.load_range(this.selected_range())},AdminReportsBase.prototype.query=function(){return this.with_loader(this.resources.query({range:this.range}).then((_this=this,function(data){return _this.view.draw_data(data,_range_to_chart_range[_this.range])})));var _this},AdminReportsBase.prototype.load_range=function(range){if(range!==this.range)return this.range=range,this.query()},AdminReportsBase}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminReports=function(superClass){function AdminReports(){return AdminReports.__super__.constructor.apply(this,arguments)}return extend(AdminReports,superClass),AdminReports.include(pi.controllers.Paginated),AdminReports.list_resource(pi.resources.AdminReportsSubscription),AdminReports.prototype.id="admin_reports",AdminReports.prototype.initialize=function(){var first_context_id;return null!=(first_context_id=this.view.nav.items[0].options.id)&&null!=this._contexts[first_context_id]&&(this._main_context_id=first_context_id),AdminReports.__super__.initialize.apply(this,arguments),this.next_page()},AdminReports.prototype.switch_context=function(from,to){return AdminReports.__super__.switch_context.apply(this,arguments).then((_this=this,function(){return hash.add({type:to}),_this.view.switched_to(to,_this.context.view)}));var _this},AdminReports.prototype.load_range=function(id){var ref;return null!=(ref=this.context)?ref.load_range(id):void 0},AdminReports}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminReportsNorthStar=function(superClass){function AdminReportsNorthStar(){return AdminReportsNorthStar.__super__.constructor.apply(this,arguments)}return extend(AdminReportsNorthStar,superClass),AdminReportsNorthStar.prototype.id="admin_reports_north_star",AdminReportsNorthStar.set_resource($r.NorthStarReport),AdminReportsNorthStar.prototype.load=function(){return AdminReportsNorthStar.__super__.load.apply(this,arguments)},AdminReportsNorthStar.prototype.load_range=function(){return AdminReportsNorthStar.__super__.load_range.apply(this,arguments)},AdminReportsNorthStar.prototype.load_subscriptions=function(range){return $r.AdminSubscription.north_star({range:range}).then((_this=this,function(data){return _this.view.load_subscriptions(data)}));var _this},AdminReportsNorthStar}(pi.controllers.AdminReportsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminReportsPageLoad=function(superClass){function AdminReportsPageLoad(){return AdminReportsPageLoad.__super__.constructor.apply(this,arguments)}return extend(AdminReportsPageLoad,superClass),AdminReportsPageLoad.prototype.id="admin_reports_page_load",AdminReportsPageLoad.set_resource($r.PerfReports),AdminReportsPageLoad}(pi.controllers.AdminReportsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminReportsVisits=function(superClass){function AdminReportsVisits(){return AdminReportsVisits.__super__.constructor.apply(this,arguments)}return extend(AdminReportsVisits,superClass),AdminReportsVisits.prototype.id="admin_reports_visits",AdminReportsVisits.set_resource($r.VisitsReport),AdminReportsVisits}(pi.controllers.AdminReportsBase)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminSubscriptionEdit=function(superClass){function AdminSubscriptionEdit(){return AdminSubscriptionEdit.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptionEdit,superClass),AdminSubscriptionEdit.prototype.id="admin_subscription_edit",AdminSubscriptionEdit.prototype.load=function(context){var _this;return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminSubscription?(this.subscription=context.data,$r.AdminAccount.find(this.subscription.account_id).then((_this=this,function(response){return _this.account=response.account,_this.change_agreement_form(_this.subscription.payment_type)}))):this.subscription=$r.AdminSubscription.build(),this.view.loaded(this.subscription)},AdminSubscriptionEdit.prototype.reload=function(context){var selected_payment_type,tariff;if(null!=context.data.account&&(this.account=context.data.account,this.subscription.set({account_id:this.account.id,account_name:this.account.name,payment_type:this.account.preferred_payment_method}),this.view.form.value(this.subscription),(selected_payment_type=this.view.form.payment_type_select.value())&&this.change_agreement_form(selected_payment_type)),null!=context.data.tariff_plan)return tariff=context.data.tariff_plan,this.subscription.set({tariff_plan_id:tariff.id,tariff_plan:tariff.name}),this.view.form.value(this.subscription)},AdminSubscriptionEdit.prototype.save=function(data){return null!=this.subscription?this.with_loader(this.subscription.save(data)).then((_this=this,function(){return _this.close()})):this.close();var _this},AdminSubscriptionEdit.prototype.select_account=function(){return this["switch"]("admin_account_select")},AdminSubscriptionEdit.prototype.select_tariff_plan=function(){return this["switch"]("admin_tariff_plan_select")},AdminSubscriptionEdit.prototype.unload=function(){return this.subscription=null,AdminSubscriptionEdit.__super__.unload.apply(this,arguments)},AdminSubscriptionEdit.prototype.change_agreement_form=function(type){if(this.account=this.account||$r.AdminAccount.get(this.subscription.account_id),this.account)return this.view.form.agreement.renderable.render({type:type,account:this.account})},AdminSubscriptionEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminSubscriptions=function(superClass){function AdminSubscriptions(){return AdminSubscriptions.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptions,superClass),AdminSubscriptions.include(pi.controllers.Paginated),AdminSubscriptions.list_resource(pi.resources.AdminSubscription),AdminSubscriptions.prototype.id="admin_orders",AdminSubscriptions.prototype.initialize=function(){return AdminSubscriptions.__super__.initialize.apply(this,arguments),this.next_page()},AdminSubscriptions.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},AdminSubscriptions.prototype.show=function(data){return this["switch"]("admin_subscription_show",data)},AdminSubscriptions.prototype["new"]=function(){return this["switch"]("admin_subscription_edit")},AdminSubscriptions.prototype.edit=function(data){return this["switch"]("admin_subscription_edit",data)},AdminSubscriptions.prototype.freeze=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.freeze())}))["with"](data,"admin/subscriptions/freeze_confirm");var _this},AdminSubscriptions}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminSubscriptionShow=function(superClass){function AdminSubscriptionShow(){return AdminSubscriptionShow.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptionShow,superClass),AdminSubscriptionShow.prototype.id="admin_subscription_show",AdminSubscriptionShow.prototype.load=function(context){var _this;if(null!=context.data)return pi.resources.AdminSubscription.show({id:context.data})["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){if(_this.subscription=response,null!=_this.subscription)return _this.view.loaded(_this.subscription)}}(this))},AdminSubscriptionShow.prototype.unload=function(){return this.subscription=null,AdminSubscriptionShow.__super__.unload.apply(this,arguments)},AdminSubscriptionShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SystemColorThemesEditController=function(superClass){function SystemColorThemesEditController(){return SystemColorThemesEditController.__super__.constructor.apply(this,arguments)}return extend(SystemColorThemesEditController,superClass),SystemColorThemesEditController.prototype.id="system_color_themes_edit",SystemColorThemesEditController.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.SystemColorTheme?(this.scheme=context.data,this.view.loaded(this.scheme)):(this.scheme=$r.SystemColorTheme.build(),this.view.loaded(this.scheme))},SystemColorThemesEditController.prototype.save=function(data){return this.scheme.save(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return _this.close({reload:!0}),response}}(this));var _this},SystemColorThemesEditController.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},SystemColorThemesEditController.prototype.reload=function(context){var file_obj;if(null!=context.data.file)return file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)},SystemColorThemesEditController}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SystemColorThemesController=function(superClass){function SystemColorThemesController(){return SystemColorThemesController.__super__.constructor.apply(this,arguments)}return extend(SystemColorThemesController,superClass),SystemColorThemesController.include(pi.controllers.Paginated),SystemColorThemesController.list_resource(pi.resources.SystemColorTheme),SystemColorThemesController.prototype.id="system_color_themes_index",SystemColorThemesController.prototype.initialize=function(){return SystemColorThemesController.__super__.initialize.apply(this,arguments),this.next_page()},SystemColorThemesController.prototype.edit=function(data){return this["switch"]("system_color_themes_edit",data)},SystemColorThemesController.prototype["new"]=function(){return this["switch"]("system_color_themes_edit")},SystemColorThemesController.prototype.apply=function(data){return this["switch"]("accounts_for_customization",data)},SystemColorThemesController.prototype.destroy=function(data){return data.destroy()},SystemColorThemesController}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTariffPlanEdit=function(superClass){function AdminTariffPlanEdit(){return AdminTariffPlanEdit.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlanEdit,superClass),AdminTariffPlanEdit.prototype.id="admin_tariff_plan_edit",AdminTariffPlanEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminTariffPlan?this.tariff=context.data:this.tariff=$r.AdminTariffPlan.build(),this.view.loaded(this.tariff)},AdminTariffPlanEdit.prototype.save=function(data){return null!=this.tariff?this.tariff.save(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(message),_this.close(),response}}(this)):this.close();var _this},AdminTariffPlanEdit.prototype.unload=function(){return this.tariff=null,AdminTariffPlanEdit.__super__.unload.apply(this,arguments)},AdminTariffPlanEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTariffPlans=function(superClass){function AdminTariffPlans(){return AdminTariffPlans.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlans,superClass),AdminTariffPlans.list_resource(pi.resources.AdminTariffPlan),AdminTariffPlans.prototype.id="admin_tariff_plans",AdminTariffPlans.prototype.initialize=function(){return AdminTariffPlans.__super__.initialize.apply(this,arguments),this.scope()},AdminTariffPlans.prototype.load=function(){return AdminTariffPlans.__super__.load.apply(this,arguments),this.index()},AdminTariffPlans.prototype["new"]=function(){return this["switch"]("admin_tariff_plan_edit")},AdminTariffPlans.prototype.edit=function(data){return this["switch"]("admin_tariff_plan_edit",data)},AdminTariffPlans.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/tariff_plans/destroy_confirm");var _this},AdminTariffPlans}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTariffPlanSelect=function(superClass){function AdminTariffPlanSelect(){return AdminTariffPlanSelect.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlanSelect,superClass),AdminTariffPlanSelect.include(pi.controllers.Paginated,pi.controllers.Popuped),AdminTariffPlanSelect.list_resource(pi.resources.AdminTariffPlan),AdminTariffPlanSelect.prototype.id="admin_tariff_plan_select",AdminTariffPlanSelect.prototype.data_wrap="tariff_plan",AdminTariffPlanSelect.prototype.initialize=function(){return AdminTariffPlanSelect.__super__.initialize.apply(this,arguments),this.next_page()},AdminTariffPlanSelect}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTourEdit=function(superClass){function AdminTourEdit(){return AdminTourEdit.__super__.constructor.apply(this,arguments)}return extend(AdminTourEdit,superClass),AdminTourEdit.prototype.id="admin_tour_edit",AdminTourEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.AdminTour?this.tour=context.data:this.tour=$r.AdminTour.build(),this.view.loaded(this.tour)},AdminTourEdit.prototype.save=function(data){var i,len,ref,step,_this;if(null!=this.tour){for(i=0,len=(ref=this.tour.steps().all()).length;i<len;i++)(step=ref[i]).__to_remove__=!0;return this.with_loader(this.tour.save(data).then((_this=this,function(){var j,len1,ref1;for(j=0,len1=(ref1=_this.tour.steps().all()).length;j<len1;j++)(step=ref1[j]).__to_remove__||delete step.__temp__;return _this.close()})))}return this.close()},AdminTourEdit.prototype.destroy=function(step){return null!=step?step.remove():void 0},AdminTourEdit.prototype.add_step=function(){var position;return position=this.tour.steps().all().length+1,this.tour.steps().build({tour_id:this.tour.id,position:position})},AdminTourEdit.prototype.move_step=function(step,to){return this.tour.move_element(step,to)},AdminTourEdit.prototype.unload=function(){var i,len,ref,step;for(i=0,len=(ref=this.tour.steps().all()).length;i<len;i++)((step=ref[i]).__temp__||step.__to_remove__)&&step.remove();return this.tour=null,AdminTourEdit.__super__.unload.apply(this,arguments)},AdminTourEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTourImport=function(superClass){function AdminTourImport(){return AdminTourImport.__super__.constructor.apply(this,arguments)}return extend(AdminTourImport,superClass),AdminTourImport.prototype.id="admin_tour_import",AdminTourImport.prototype.upload_file=function(file){return this.with_loader($r.AdminTour["import"](this.view.form,{file:file})).then((_this=this,function(){return _this.close()}));var _this},AdminTourImport.prototype.unload=function(){var ref;return this._uploading&&null!=(ref=this.xhr)&&ref.abort(),this.xhr=null,AdminTourImport.__super__.unload.apply(this,arguments)},AdminTourImport}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminTours=function(superClass){function AdminTours(){return AdminTours.__super__.constructor.apply(this,arguments)}return extend(AdminTours,superClass),AdminTours.include(pi.controllers.Paginated),AdminTours.list_resource(pi.resources.AdminTour),AdminTours.prototype.id="admin_tours",AdminTours.prototype.initialize=function(){return AdminTours.__super__.initialize.apply(this,arguments),this.next_page()},AdminTours.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},AdminTours.prototype["import"]=function(){return this["switch"]("admin_tour_import")},AdminTours.prototype["export"]=function(tours){var ids;if(null==tours&&(tours=[]),(ids=tours.map(function(t){return t.id})).length)return this.location("/api/admin/tours/export?"+pi.net._data_to_query({id:ids}),"_blank")},AdminTours.prototype.show=function(id){var tour;if(tour=this.resources.get(id))return this["switch"]("admin_tour_show",tour)},AdminTours.prototype.edit=function(item){return this["switch"]("admin_tour_edit",item)},AdminTours.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"admin/tours/destroy_confirm");var _this},AdminTours}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty
;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.AdminUserEdit=function(superClass){function AdminUserEdit(){return AdminUserEdit.__super__.constructor.apply(this,arguments)}return extend(AdminUserEdit,superClass),AdminUserEdit.prototype.id="admin_user_edit",AdminUserEdit.prototype.load=function(context_data){return context_data.data instanceof $r.AdminUser&&(this.user=context_data.data),AdminUserEdit.__super__.load.apply(this,arguments)},AdminUserEdit.prototype.unload=function(){return this.user=null,AdminUserEdit.__super__.unload.apply(this,arguments)},AdminUserEdit.prototype.save=function(data){return utils.debug(data),this.view.loading(!0),this.user.save(data)["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this));var _this},AdminUserEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminUsers=function(superClass){function AdminUsers(){return AdminUsers.__super__.constructor.apply(this,arguments)}return extend(AdminUsers,superClass),AdminUsers.include(pi.controllers.Paginated,pi.controllers.LabelsFilter),AdminUsers.list_resource(pi.resources.AdminUser),AdminUsers.prototype.id="admin_users",AdminUsers.prototype.initialize=function(){return AdminUsers.__super__.initialize.apply(this,arguments),this.next_page()},AdminUsers.prototype.reload=function(context_data){if(!0===context_data.data.reload)return this.view.clear(),this.scope().reload(),this.index()},AdminUsers.prototype["new"]=function(){return this["switch"]("admin_users_invite")},AdminUsers.prototype.show=function(id){return this["switch"]("admin_user_show",id)},AdminUsers.prototype.edit=function(user){return this["switch"]("admin_user_edit",user)},AdminUsers.prototype.authorize=function(user){return this.view.loading(!0),user.authorize_admin()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.loading(!1),_this.confirm()["with"]({url:response.url},"admin/users/url_confirm"),null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this));var _this},AdminUsers}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminUsersInvite=function(superClass){function AdminUsersInvite(){return AdminUsersInvite.__super__.constructor.apply(this,arguments)}return extend(AdminUsersInvite,superClass),AdminUsersInvite.prototype.id="admin_users_invite",AdminUsersInvite.prototype.user_params=["login","role_id","labels","account_id"],AdminUsersInvite.prototype.route_resource=$r.AdminUser,AdminUsersInvite}(pi.controllers.UsersInvite)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AdminUserShow=function(superClass){function AdminUserShow(){return AdminUserShow.__super__.constructor.apply(this,arguments)}return extend(AdminUserShow,superClass),AdminUserShow.prototype.id="admin_user_show",AdminUserShow.prototype.load=function(context){var _this;if(null!=context.data)return pi.resources.AdminUser.show({id:context.data})["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){return _this.user=response.user,null!=_this.user&&_this.view.loaded(_this.user),_this.view.load_lists(response.accounts)}}(this))},AdminUserShow.prototype.unload=function(){return this.user=null,this.accounts=null,AdminUserShow.__super__.unload.apply(this,arguments)},AdminUserShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AccountReg=function(superClass){function AccountReg(){return AccountReg.__super__.constructor.apply(this,arguments)}return extend(AccountReg,superClass),AccountReg.prototype.id="account_reg",AccountReg.prototype.save=function(data){return this.with_loader($r.AccountForm.create(data)).then((_this=this,function(){return _this.close()}));var _this},AccountReg}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AnswerStatsExportEdit=function(superClass){function AnswerStatsExportEdit(){return AnswerStatsExportEdit.__super__.constructor.apply(this,arguments)}return extend(AnswerStatsExportEdit,superClass),AnswerStatsExportEdit.prototype.id="answer_stats_export_edit",AnswerStatsExportEdit.prototype.load=function(context){return this.query_string=context.data.query_string,this.program=$r.Program.get(pi.app.program_id),this.session_id=context.data.session_id,$r.AccountSettings.find().then((_this=this,function(data){if(data instanceof $r.AccountSettings)return _this.setting=data,_this.view.loaded(_this.setting)}));var _this},AnswerStatsExportEdit.prototype["export"]=function(){return pi.Net.get(this.query_string)["catch"]((_this=this,function(error){throw _this.view.error(error.message),error})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close()}}(this));var _this},AnswerStatsExportEdit.prototype.save=function(){return this.with_loader(this.setting.save())},AnswerStatsExportEdit.prototype.choose_labels=function(){return this["switch"]("choose_labels",{setting:this.setting,report:"answer_stats_export"})},AnswerStatsExportEdit.prototype.unload=function(){return AnswerStatsExportEdit.__super__.unload.apply(this,arguments),this.query_string=null,this.setting=null},AnswerStatsExportEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ChooseLabels=function(superClass){function ChooseLabels(){return ChooseLabels.__super__.constructor.apply(this,arguments)}return extend(ChooseLabels,superClass),ChooseLabels.prototype.id="choose_labels",ChooseLabels}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseStatsExportEdit=function(superClass){function CourseStatsExportEdit(){return CourseStatsExportEdit.__super__.constructor.apply(this,arguments)}return extend(CourseStatsExportEdit,superClass),CourseStatsExportEdit.prototype.id="course_stats_export_edit",CourseStatsExportEdit.prototype.load=function(context){return this.query_string=context.data.query_string,this.program=$r.Program.get(pi.app.program_id),this.session_id=context.data.session_id,$r.AccountSettings.find().then((_this=this,function(data){if(data instanceof $r.AccountSettings)return _this.setting=data,_this.view.loaded(_this.setting)}));var _this},CourseStatsExportEdit.prototype["export"]=function(){return pi.Net.get(this.query_string)["catch"]((_this=this,function(error){throw _this.view.error(error.message),error})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close()}}(this));var _this},CourseStatsExportEdit.prototype.save=function(){return this.with_loader(this.setting.save())},CourseStatsExportEdit.prototype.choose_labels=function(){return this["switch"]("choose_labels",{setting:this.setting,report:"course_stats_export"})},CourseStatsExportEdit.prototype.unload=function(){return CourseStatsExportEdit.__super__.unload.apply(this,arguments),this.query_string=null,this.setting=null},CourseStatsExportEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ExportEdit=function(superClass){function ExportEdit(){return ExportEdit.__super__.constructor.apply(this,arguments)}return extend(ExportEdit,superClass),ExportEdit.prototype.id="export_edit",ExportEdit.prototype.load=function(context){return this.query_string=context.data.query_string,this.program=$r.Program.get(pi.app.program_id),this.session_id=context.data.session_id,$r.AccountSettings.find().then((_this=this,function(data){if(data instanceof $r.AccountSettings)return _this.setting=data,_this.view.loaded(_this.setting)}));var _this},ExportEdit.prototype["export"]=function(){return pi.Net.get(this.query_string)["catch"]((_this=this,function(error){throw _this.view.error(error.message),error})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close()}}(this));var _this},ExportEdit.prototype.save=function(){return this.with_loader(this.setting.save())},ExportEdit.prototype.choose_labels=function(){return this["switch"]("choose_labels",{setting:this.setting,report:"course_stats_export"})},ExportEdit.prototype.unload=function(){return ExportEdit.__super__.unload.apply(this,arguments),this.query_string=null,this.setting=null},ExportEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SurveyEdit=function(superClass){function SurveyEdit(){return SurveyEdit.__super__.constructor.apply(this,arguments)}return extend(SurveyEdit,superClass),SurveyEdit.prototype.id="survey_edit",SurveyEdit.prototype.load=function(context){var ref,_this;if(this._initialized||this.initialize(),null!=(null!=(ref=context.data)?ref.survey:void 0))return this.survey=context.data.survey,this.view.loaded(this.survey),this.survey.fields_loaded?(this.view.enable_preview(),this.view.ensure_sorted()):this.with_loader(this.survey.load_fields()).then((_this=this,function(){return _this.view.enable_preview(),_this.view.load_fields(_this.survey)}));if(this.target=context.data.target,!this.target)throw Error("survey requires target!");return this.survey=this.target.build_survey(),this.survey.fields_loaded=!0,this.view.loaded(this.survey),this.view.disable_preview()},SurveyEdit.prototype.add_field=function(){var position;return position=this.survey.fields().all().length+1,this.survey.fields().build({type:$r.SurveyField.TEXT,position:position}),this.view.activate_item(position-1)},SurveyEdit.prototype.update_field=function(id,data){var field,_this;if(null!=(field=this.survey.fields().get(id)))return this.survey._persisted?(data.survey_id=this.survey.id,this.with_loader(field.save(data))):this.with_loader(this.survey.save()).then((_this=this,function(){return data.survey_id=_this.survey.id,_this.view.enable_preview(),_this.with_loader(field.save(data))}))},SurveyEdit.prototype.preview=function(){return this.location("/surveys/"+this.survey.id,"_blank_"+this.survey.id)},SurveyEdit.prototype.move_item=function(item,to){if(item._persisted)return this.survey.move_element(item,to)},SurveyEdit.prototype.destroy=function(field){return field._persisted?this.confirm((_this=this,function(){return _this.with_loader(field.destroy())}))["with"](field,"surveys/field_destroy_confirm"):field.destroy();var _this},SurveyEdit.prototype.save=function(data){if(null!=this.survey)return this.with_loader(this.survey.save(data)).then((_this=this,function(){var ref;return _this.view.enable_preview(),null!=(ref=_this.survey.surveyable())?ref.trigger("update"):void 0}));var _this},SurveyEdit.prototype.unload=function(){return this.survey=null,SurveyEdit.__super__.unload.apply(this,arguments)},SurveyEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SurveyFill=function(superClass){function SurveyFill(){return SurveyFill.__super__.constructor.apply(this,arguments)}return extend(SurveyFill,superClass),SurveyFill.prototype.id="survey_fill",SurveyFill.prototype.submit=function(form,data){var path;return path=form.attr("action"),this.with_loader(pi.net.post(path,data))},SurveyFill}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductBuy=function(superClass){function ProductBuy(){return ProductBuy.__super__.constructor.apply(this,arguments)}return extend(ProductBuy,superClass),ProductBuy.prototype.id="product_buy",ProductBuy.prototype.initialize=function(){var onload;if(ProductBuy.__super__.initialize.apply(this,arguments),this.product=pi.app.product,this.order=pi.app.order,onload=this.qs_params().onload)return this[onload]()},ProductBuy.prototype.pay=function(){var _this;if(this.order)return pi.tools.CloudPayments.pay(this.order).then((_this=this,function(){return _this.location()}))},ProductBuy.prototype.buy=function(){return pi.app.user?this.product.buy().then((_this=this,function(data){return data.redirect?_this.location(data.redirect):(_this.order=data.order,_this.order?_this.pay():void 0)})):this.auth();var _this},ProductBuy}(pi.controllers.Apply)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.ProductEdit=function(superClass){function ProductEdit(){return ProductEdit.__super__.constructor.apply(this,arguments)}return extend(ProductEdit,superClass),ProductEdit.include(pi.controllers.Scoped),ProductEdit.prototype.id="product_edit",ProductEdit.prototype.load=function(context){var i,j,len,len1,ref,ref1,user;if(this._initialized||this.initialize(),this._participants_updated=!1,this.product=context.data,this.product._persisted)for(i=0,len=(ref=this.product.authors).length;i<len;i++)user=ref[i],this.product.participants().build(user,!0,{role_id:$r.Product.AUTHOR});else for(this.product.copy_from_event=!0,j=0,len1=(ref1=this.product.event.authors).length;j<len1;j++)user=ref1[j],this.product.participants().build(user,!0,{role_id:$r.Product.AUTHOR});return this.view.loaded(this.product)},ProductEdit.prototype.reload=function(context){var file_obj,i,len,ref,results,user;if(context.data.file&&(utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)),null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.product.participants().build(user,!1,{changed:!0,role_id:this.role_to_add}));return results}},ProductEdit.prototype.update_slug=function(value){return this.with_loader(this.product.save({slug:value})).then((_this=this,function(){return _this.view.slug_updated()}));var _this},ProductEdit.prototype.edit_survey=function(){return this.product._persisted?this["switch"]("survey_edit",{target:this.product,survey:this.product.survey}):this.view.form.validate()?this.save(this.view.form.read_values()).then((_this=this,function(){return _this["switch"]("survey_edit",{target:_this.product,survey:_this.product.survey})})):pi.Nod.win.scrollToNod(this.view.form);var _this},ProductEdit.prototype.remove_survey=function(){var ref,_this;if(null!=(ref=this.product.survey)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.product.survey.destroy().then(function(){return _this.product.trigger("update")}))}))["with"](this.product,"surveys/destroy_confirm")},ProductEdit.prototype.add_users=function(users){return this.role_to_add=$r.Product.AUTHOR,this["switch"]("select_users",{users:users})},ProductEdit.prototype.remove_participants=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.product.participants().remove(user));return results},ProductEdit.prototype.preview=function(){if(null!=this.product.url)return window.open(this.product.url,"_blank")},ProductEdit.prototype.save=function(data){if(!this._xhr_loading)return null!=this.product?this.with_loader(this.product.save(data)):this.exit()},ProductEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},ProductEdit.prototype.unload=function(){return this.product=null,ProductEdit.__super__.unload.apply(this,arguments)},ProductEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.ProductsStoreEdit=function(superClass){function ProductsStoreEdit(){return ProductsStoreEdit.__super__.constructor.apply(this,arguments)}return extend(ProductsStoreEdit,superClass),ProductsStoreEdit.prototype.id="products_store_edit",ProductsStoreEdit.prototype.load=function(){if(this._initialized||this.initialize(),this.store=pi.app.store,null!=this.store)return this.view.loaded(this.store)},ProductsStoreEdit.prototype.reload=function(context){var file_obj;if(context.data.file)return utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)},ProductsStoreEdit.prototype.save=function(data){var _this;if(!this._xhr_loading)return null!=this.store?this.with_loader(this.store.save(data)).then((_this=this,function(){return _this.close()})):this.exit()},ProductsStoreEdit.prototype.update_slug=function(value){return this.with_loader(this.store.save({slug:value})).then((_this=this,function(){return _this.view.slug_updated()}));var _this},ProductsStoreEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},ProductsStoreEdit.prototype.unload=function(){return this.store=null,ProductsStoreEdit.__super__.unload.apply(this,arguments)},ProductsStoreEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Products=function(superClass){function Products(){return Products.__super__.constructor.apply(this,arguments)}return extend(Products,superClass),Products.include(pi.controllers.Paginated),Products.list_resource(pi.resources.Product),Products.prototype.id="products",Products.prototype.initialize=function(){return Products.__super__.initialize.apply(this,arguments),this.next_page()},Products.prototype["new"]=function(){return pi.app.tour.stop(),this["switch"]("product_select_type")},Products.prototype.edit=function(id){return pi.app.tour.stop(),this.with_loader($r.Product.show({id:id}).then((_this=this,function(product){return _this["switch"]("product_edit",product)})));var _this},Products.prototype.edit_store=function(){return this["switch"]("products_store_edit")},Products.prototype.destroy=function(id){var product,_this;if(product=this.products.get(id))return this.confirm((_this=this,function(){return _this.with_loader(product.destroy())}))["with"](product,"products/destroy_confirm")},Products}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductsOrders=function(superClass){function ProductsOrders(){return ProductsOrders.__super__.constructor.apply(this,arguments)}return extend(ProductsOrders,superClass),ProductsOrders.include(pi.controllers.Paginated),ProductsOrders.list_resource(pi.resources.ProductsOrder),ProductsOrders.prototype.id="products_orders",ProductsOrders.prototype.initialize=function(){return ProductsOrders.__super__.initialize.apply(this,arguments),null!=pi.app.product_id&&this.scope().set({product_id:pi.app.product_id}),this.next_page()},ProductsOrders.prototype.edit_product=function(){return this["switch"]("product_edit",pi.app.product)},ProductsOrders.prototype.edit_store=function(){return this["switch"]("products_store_edit")},ProductsOrders.prototype.show=function(id){return this["switch"]("products_order_show",id)},ProductsOrders.prototype.pay=function(id){return $r.ProductsOrder.get_order_with_cp_key(id).then(function(order){if(order)return pi.tools.CloudPayments.pay(order).then(function(){return order.set({status:2})})})},ProductsOrders.prototype.cancel=function(data,state){return this.confirm((_this=this,function(){return _this.with_loader(data.cancel()).then(function(){return data.set({status:"abort",state:state})})}))["with"](data,"profile/orders/cancel_confirm");var _this},ProductsOrders}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductsOrderShow=function(superClass){function ProductsOrderShow(){return ProductsOrderShow.__super__.constructor.apply(this,arguments)}return extend(ProductsOrderShow,superClass),ProductsOrderShow.prototype.id="products_order_show",ProductsOrderShow.prototype.load=function(context){var _this;if(null!=context.data)return $r.ProductsOrder.find(context.data)["catch"]((_this=this,function(){return _this.view.error(error.message)})).then(function(_this){return function(response){return _this.view.loaded(response)}}(this))},ProductsOrderShow.prototype.unload=function(){return ProductsOrderShow.__super__.unload.apply(this,arguments)},ProductsOrderShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductRes=function(superClass){function ProductRes(){return ProductRes.__super__.constructor.apply(this,arguments)}return extend(ProductRes,superClass),ProductRes.prototype.id="product_res_view",ProductRes.prototype.book=function(data){return data.product_id=pi.app.product.id,$r.Booking.create(data).then((_this=this,function(){return _this.view.product_res_form.hide(),_this.view.product_res_ok.show()}));var _this},ProductRes}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductsPromoCodeEdit=function(superClass){function ProductsPromoCodeEdit(){return ProductsPromoCodeEdit.__super__.constructor.apply(this,arguments)}return extend(ProductsPromoCodeEdit,superClass),ProductsPromoCodeEdit.prototype.id="products_promo_code_edit",ProductsPromoCodeEdit.prototype.load=function(context){return this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.ProductsPromoCode?this.promo_code=context.data:(this.promo_code=$r.ProductsPromoCode.build(),null!=pi.app.product&&(this.promo_code.product_id=pi.app.product.id)),this.view.loaded(this.promo_code)},ProductsPromoCodeEdit.prototype.save=function(data){var _this;if(!this._xhr_loading)return null!=this.promo_code?this.with_loader(this.promo_code.save(data).then((_this=this,function(){return _this.close()}))):this.exit()},ProductsPromoCodeEdit.prototype.generate_code=function(){var code;return code=pi.tools.CodeGenerator.generate(8),this.view.form.value({code:code})},ProductsPromoCodeEdit.prototype.unload=function(){return this.promo_code=null,ProductsPromoCodeEdit.__super__.unload.apply(this,arguments)},ProductsPromoCodeEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductsPromoCodes=function(superClass){function ProductsPromoCodes(){return ProductsPromoCodes.__super__.constructor.apply(this,arguments)}return extend(ProductsPromoCodes,superClass),ProductsPromoCodes.include(pi.controllers.Paginated),ProductsPromoCodes.list_resource(pi.resources.ProductsPromoCode),ProductsPromoCodes.prototype.id="products_promo_codes",ProductsPromoCodes.prototype.initialize=function(){return ProductsPromoCodes.__super__.initialize.apply(this,arguments),null!=pi.app.product_id&&this.scope().set({product_id:pi.app.product_id}),this.next_page()},ProductsPromoCodes.prototype["new"]=function(){return this["switch"]("products_promo_code_edit")},ProductsPromoCodes.prototype.edit=function(data){return this["switch"]("products_promo_code_edit",data)},ProductsPromoCodes.prototype.edit_store=function(){return this["switch"]("products_store_edit")},ProductsPromoCodes.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy())}))["with"](data,"products/promo_codes/destroy_confirm");var _this},ProductsPromoCodes.prototype.edit_product=function(){return this["switch"]("product_edit",pi.app.product)},ProductsPromoCodes}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductSelectType=function(superClass){function ProductSelectType(){return ProductSelectType.__super__.constructor.apply(this,arguments)}return extend(ProductSelectType,superClass),ProductSelectType.prototype.id="product_select_type",ProductSelectType.prototype.reload=function(context){var event,product;return context.data instanceof $r.Base?(event=context.data,product=$r.Product.from_event(event),this["switch"]("product_edit",product)):"product_edit"===context.context?this.close():void 0},ProductSelectType.prototype.select_meeting=function(){return this["switch"]("meeting_select")},ProductSelectType.prototype.select_meetbase=function(){return this["switch"]("meet_base_select")},ProductSelectType.prototype.select_session=function(){return this["switch"]("session_select")},ProductSelectType.prototype.select_clickmeeting=function(){return this["switch"]("clickmeeting_meeting_select")},ProductSelectType}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductsSimpleBuy=function(superClass){function ProductsSimpleBuy(){return ProductsSimpleBuy.__super__.constructor.apply(this,arguments)}return extend(ProductsSimpleBuy,superClass),ProductsSimpleBuy.include(pi.controllers.Login),ProductsSimpleBuy.prototype.id="products_simple_buy",ProductsSimpleBuy.prototype.initialize=function(){return ProductsSimpleBuy.__super__.initialize.apply(this,arguments),this.product=pi.app.product},ProductsSimpleBuy.prototype.create_order=function(){return null!=pi.app.order?new Promise(function(resolve){return resolve(pi.app.order)}):this.product.buy().then((_this=this,function(data){return data.redirect?_this.location(data.redirect):pi.app.order=data.order}));var _this},ProductsSimpleBuy.prototype.submit_survey=function(form,data){var path;return path=form.attr("action"),this.with_loader(pi.net.post(path,data))},ProductsSimpleBuy.prototype.register=function(data){var params,product,ref,ref1,_this;if(product=pi.app.product,this.view.clear_errors(),this.code=data.code,this.view.loading(!0),!pi.app.user)return params={email:data.email,labels:null!=(ref=data.app)?ref.labels:void 0,answers_attributes:null!=(ref1=data.app)?ref1.answers_attributes:void 0},product.register_user(params)["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(){return _this.location(pi.app.product.pay_path)}}(this))},ProductsSimpleBuy.prototype.promo_code=function(data){var v,_this;return this.view.hide_promo_messages(),this.view.loading(!0),v=this.view.form?this.view.form:this.view,this.create_order().then(function(order){
return order.apply_promo(data)}).then((_this=this,function(response){var r,s;return _this.view.loading(!1),v.success_promo.show(),v.promo_form.code_txt.value(""),r=v.node.querySelector(".order-amount"),s=document.createElement("span"),r.className="pi order-amount red",s.className="stroke",s.innerHTML=r.innerHTML,r.innerHTML=response.order.amount_rubles,r.parentNode.appendChild(s),pi.app.order=response.order,window.location.reload(),response}))["catch"](function(_this){return function(e){throw _this.view.loading(!1),v.invalid_code_error.show(),e}}(this))},ProductsSimpleBuy.prototype.pay=function(){var c,cn,form,i,j,ref;if(pi.app.order){if(0===pi.app.order.amount_int)return this.with_loader(pi.app.order.stub_payment().then((_this=this,function(){return _this.location()})));if("cp"===pi.app.account.sales_provider)return pi.tools.CloudPayments.pay(pi.app.order).then(function(_this){return function(){return _this.location("success_payment")}}(this));if("api"===pi.app.account.yandex_connection_method)return this.with_loader(pi.app.order.make().then(function(_this){return function(data){if(data.confirmation_url)return _this.location(data.confirmation_url)}}(this)));for(i=j=0,ref=(cn=(form=document.getElementById("yandex_form")).childNodes).length;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j)switch((c=cn[i]).name){case"sum":c.value=pi.app.order.amount_int;break;case"customerNumber":c.value=pi.app.user.id;break;case"cps_email":c.value=pi.app.user.notification_email;break;case"cps_phone":c.value=pi.app.user.phone;break;case"orderNumber":c.value=pi.app.order.id;break;case"user_fullname":c.value=pi.app.user.fullname;break;case"product_id":c.value=pi.app.product.id;break;case"product_name":c.value=pi.app.product.name}return form.submit();var _this}},ProductsSimpleBuy.prototype.buy=function(){return null!=pi.app.order?this.pay():this.create_order().then((_this=this,function(){return _this.pay()}));var _this},ProductsSimpleBuy.prototype.enable_promo=function(){return this.view.hasOwnProperty("has_promo_link")?(this.view.has_promo_link.hide(),this.view.promo_form.show()):(this.view.form.has_promo_link.hide(),this.view.form.promo_form.show())},ProductsSimpleBuy.prototype.switch_to_login=function(){return this.view.form.hide(),this.view.login_form.show()},ProductsSimpleBuy.prototype.switch_to_register=function(){return this.view.form.show(),this.view.login_form.hide()},ProductsSimpleBuy}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Store=function(superClass){function Store(){return Store.__super__.constructor.apply(this,arguments)}return extend(Store,superClass),Store.include(pi.controllers.Paginated),Store.list_resource(pi.resources.Product),Store.prototype.id="store_products",Store.prototype.initialize=function(){return Store.__super__.initialize.apply(this,arguments),this.scope().set({store_id:pi.app.store.id}),this.next_page()},Store}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ClickmeetingMeetingApplications=function(superClass){function ClickmeetingMeetingApplications(){return ClickmeetingMeetingApplications.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingApplications,superClass),ClickmeetingMeetingApplications.include(pi.controllers.Paginated),ClickmeetingMeetingApplications.prototype.id="clickmeeting_meeting_applications",ClickmeetingMeetingApplications.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},ClickmeetingMeetingApplications.list_resource($r.Application),ClickmeetingMeetingApplications.prototype.initialize=function(){return ClickmeetingMeetingApplications.__super__.initialize.apply(this,arguments),this.meeting=pi.app.clickmeeting_meeting,this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.scope().set({clickmeeting_meeting_id:pi.app.clickmeeting_meeting_id}),this.base_resource=this.resources,this.next_page()},ClickmeetingMeetingApplications.prototype.apply=function(data){return this.with_loader(data.confirm({id:data.id}))},ClickmeetingMeetingApplications.prototype.decline=function(data){return this.with_loader(data.decline({id:data.id}))},ClickmeetingMeetingApplications.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy({id:data}))}))["with"](data,"applications/destroy_confirm");var _this},ClickmeetingMeetingApplications.prototype.show=function(data){return this["switch"]("application_show",data)},ClickmeetingMeetingApplications.prototype.edit_meeting=function(){return this["switch"]("clickmeeting_meeting_edit",this.meeting)},ClickmeetingMeetingApplications.prototype._parse_response=function(data){return data[this.resources.resources_name]},ClickmeetingMeetingApplications}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CourseApplications=function(superClass){function CourseApplications(){return CourseApplications.__super__.constructor.apply(this,arguments)}return extend(CourseApplications,superClass),CourseApplications.include(pi.controllers.Paginated),CourseApplications.prototype.id="applications",CourseApplications.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},CourseApplications.list_resource($r.Application),CourseApplications.prototype.initialize=function(){var hash_data,ref,ref1;return CourseApplications.__super__.initialize.apply(this,arguments),this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1),null!=pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.session_id=0|hash_data.session_id,this.scope().set({course_session_id:this.session_id}),this.view.ensure_session(this.session_id)),this.base_resource=this.resources,this.next_page()},CourseApplications.prototype.load=function(){var ref;return null!=(null!=(ref=this.host_context)?ref.args:void 0)&&(this.scope().set(this.host_context.args),this._initialized=!1),CourseApplications.__super__.load.apply(this,arguments)},CourseApplications.prototype.apply=function(data){return this.with_loader(data.confirm({id:data.id}))},CourseApplications.prototype.decline=function(data){return this.with_loader(data.decline({id:data.id}))},CourseApplications.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy({id:data}))}))["with"](data,"applications/destroy_confirm");var _this},CourseApplications.prototype.show=function(data){return this["switch"]("application_show",data)},CourseApplications.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},CourseApplications.prototype._parse_response=function(data){return data[this.resources.resources_name]},CourseApplications}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetBaseMeetingApplications=function(superClass){function MeetBaseMeetingApplications(){return MeetBaseMeetingApplications.__super__.constructor.apply(this,arguments)}return extend(MeetBaseMeetingApplications,superClass),MeetBaseMeetingApplications.include(pi.controllers.Paginated),MeetBaseMeetingApplications.prototype.id="meetbase_meeting_applications",MeetBaseMeetingApplications.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},MeetBaseMeetingApplications.list_resource($r.Application),MeetBaseMeetingApplications.prototype.initialize=function(){return MeetBaseMeetingApplications.__super__.initialize.apply(this,arguments),this.meeting=pi.app.meetbase_meeting,this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.scope().set({meetbase_meeting_id:pi.app.meeting_id}),this.base_resource=this.resources,this.next_page()},MeetBaseMeetingApplications.prototype.apply=function(data){return this.with_loader(data.confirm({id:data.id}))},MeetBaseMeetingApplications.prototype.decline=function(data){return this.with_loader(data.decline({id:data.id}))},MeetBaseMeetingApplications.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy({id:data}))}))["with"](data,"applications/destroy_confirm");var _this},MeetBaseMeetingApplications.prototype.show=function(data){return this["switch"]("application_show",data)},MeetBaseMeetingApplications.prototype._parse_response=function(data){return data[this.resources.resources_name]},MeetBaseMeetingApplications}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetingApplications=function(superClass){function MeetingApplications(){return MeetingApplications.__super__.constructor.apply(this,arguments)}return extend(MeetingApplications,superClass),MeetingApplications.include(pi.controllers.Paginated),MeetingApplications.prototype.id="meeting_applications",MeetingApplications.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},MeetingApplications.list_resource($r.Application),MeetingApplications.prototype.initialize=function(){return MeetingApplications.__super__.initialize.apply(this,arguments),this.meeting=pi.app.meeting,this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.scope().set({meeting_id:pi.app.meeting_id}),this.base_resource=this.resources,this.next_page()},MeetingApplications.prototype.apply=function(data){return this.with_loader(data.confirm({id:data.id}))},MeetingApplications.prototype.decline=function(data){return this.with_loader(data.decline({id:data.id}))},MeetingApplications.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy({id:data}))}))["with"](data,"applications/destroy_confirm");var _this},MeetingApplications.prototype.show=function(data){return this["switch"]("application_show",data)},MeetingApplications.prototype.edit_meeting=function(){return this["switch"]("meeting_edit",this.meeting)},MeetingApplications.prototype._parse_response=function(data){return data[this.resources.resources_name]},MeetingApplications}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProductApplications=function(superClass){function ProductApplications(){return ProductApplications.__super__.constructor.apply(this,arguments)}return extend(ProductApplications,superClass),ProductApplications.include(pi.controllers.Paginated),ProductApplications.prototype.id="product_applications",ProductApplications.list_resource=function(resource){return this.prototype.resources=resource,this.has_resource(resource)},ProductApplications.list_resource($r.Application),ProductApplications.prototype.initialize=function(){return ProductApplications.__super__.initialize.apply(this,arguments),this.product=pi.app.product,this.view.options.per_page&&(this.per_page=this.view.options.per_page),this.scope().set({product_id:pi.app.product_id}),this.base_resource=this.resources,this.next_page()},ProductApplications.prototype.edit_product=function(){return this["switch"]("product_edit",this.product)},ProductApplications.prototype.apply=function(data){return this.with_loader(data.confirm({id:data.id}))},ProductApplications.prototype.decline=function(data){return this.with_loader(data.decline({id:data.id}))},ProductApplications.prototype.destroy=function(data){return this.confirm((_this=this,function(){return _this.with_loader(data.destroy({id:data}))}))["with"](data,"applications/destroy_confirm");var _this},ProductApplications.prototype.show=function(data){return this["switch"]("application_show",data)},ProductApplications.prototype.edit_meeting=function(){return this["switch"]("product_edit",this.product)},ProductApplications.prototype._parse_response=function(data){return data[this.resources.resources_name]},ProductApplications}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ApplicationShow=function(superClass){function ApplicationShow(){return ApplicationShow.__super__.constructor.apply(this,arguments)}return extend(ApplicationShow,superClass),ApplicationShow.prototype.id="application_show",ApplicationShow.prototype.load=function(context){var _this;if(null!=context.data&&(this.app=$r.Application.get(context.data),this.app))return this.app.answers_loaded?(this.view.loaded(this.app),this.view.load_lists(this.app.answers().all())):this.with_loader($r.Application.show({id:this.app.id}).then((_this=this,function(){return _this.view.loaded(_this.app),_this.view.load_lists(_this.app.answers().all())})))},ApplicationShow.prototype.apply=function(){return null!=this.app?this.with_loader(this.app.confirm({id:this.app.id}).then((_this=this,function(){return _this.close()}))):this.close();var _this},ApplicationShow.prototype.decline=function(){return null!=this.app?this.with_loader(this.app.decline({id:this.app.id}).then((_this=this,function(){return _this.close()}))):this.close();var _this},ApplicationShow.prototype.unload=function(){return this.app=null,ApplicationShow.__super__.unload.apply(this,arguments)},ApplicationShow}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ScormPackageEdit=function(superClass){function ScormPackageEdit(){return ScormPackageEdit.__super__.constructor.apply(this,arguments)}return extend(ScormPackageEdit,superClass),ScormPackageEdit.prototype.id="scorm_package_edit",ScormPackageEdit.prototype.load=function(context){if(this._initialized||this.initialize(),null!=context.data&&context.data instanceof $r.ScormPackage)return this.scorm_package=context.data,this.view.loaded(this.scorm_package),$r.ScormAttachment.fetch({scorm_package_id:this.scorm_package.id}).then((_this=this,function(data){return _this.view.add_attachment(data)}));if(this.section_id=context.data.section_id,!this.section_id)throw Error("scorm_package need section!");return this.scorm_package=$r.ScormPackage.build({section_id:this.section_id,course_id:pi.app.course.id,weight:1}),this.view.loaded(this.scorm_package);var _this},ScormPackageEdit.prototype.save=function(data){if(null!=this.scorm_package)return this.with_loader(this.scorm_package.save(data).then((_this=this,function(scorm_package){return $r.SectionContent.build(scorm_package.section_content),_this.close()})));var _this},ScormPackageEdit.prototype.reload=function(context){if(null!=context.data.files)return this.view.add_attachment({file_file_name:context.data.files,status:"created"})},ScormPackageEdit.prototype.upload=function(){var _this;if(null!=this.scorm_package)return this.scorm_package._persisted?this["switch"]("scorm_upload",{scorm_package_id:this.scorm_package.id}):this.view.form.validate()?this.scorm_package.save(this.view.form.value()).then((_this=this,function(scorm_package){return _this["switch"]("scorm_upload",{scorm_package_id:scorm_package.id})})):void 0},ScormPackageEdit.prototype.stop=function(){return $r.ScormAttachment.destroy({scorm_package_id:this.scorm_package.id}),this.view.show_upload_button()},ScormPackageEdit.prototype.unload=function(){return this.scorm_package=null,ScormPackageEdit.__super__.unload.apply(this,arguments)},ScormPackageEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ScormPackageShow=function(superClass){function ScormPackageShow(){return ScormPackageShow.__super__.constructor.apply(this,arguments)}return extend(ScormPackageShow,superClass),ScormPackageShow.prototype.id="scorm_package_show",ScormPackageShow.prototype.initialize=function(){return ScormPackageShow.__super__.initialize.apply(this,arguments),this["package"]=pi.app.scorm_package,scormRTE.init(this.view.wrapper_id,this["package"].resource_url,{dataUrl:pi.app.scorm_api_path,postHeaders:{"X-CSRF-Token":window.AUTH_TOKEN},initModel:{learnerId:pi.app.user.id,learnerName:pi.app.user.name}}).then((_this=this,function(){var body,doc,frame_height,html,iFrame;if(scormRTE.hasPrevious()||scormRTE.hasContinue()||(_this.view.scorm_next_btn.hide(),_this.view.scorm_prev_btn.hide()),_this.disable_buttons(),null!=(iFrame=_this.view.scorm_player.find("iframe")))return body=(doc=iFrame.node.contentWindow.document).body,html=doc.documentElement,frame_height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight),iFrame.on("load",function(){return _this.view.adapt_player_height(frame_height)})}));var _this},ScormPackageShow.prototype.disable_buttons=function(){return scormRTE.hasPrevious()?this.view.scorm_prev_btn.enable():this.view.scorm_prev_btn.disable(),scormRTE.hasContinue()?this.view.scorm_next_btn.enable():this.view.scorm_next_btn.disable()},ScormPackageShow.prototype.prev=function(){return scormRTE.previous(),this.disable_buttons()},ScormPackageShow.prototype.next=function(){return scormRTE["continue"](),this.disable_buttons()},ScormPackageShow}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers.ScormPackageTake=function(superClass){function ScormPackageTake(){return ScormPackageTake.__super__.constructor.apply(this,arguments)}return extend(ScormPackageTake,superClass),ScormPackageTake.prototype.id="scorm_package_take",ScormPackageTake.prototype.initialize=function(){var iFrame,ref,ref1,_this;return this["package"]=pi.app.scorm_package,this.stat=pi.app.scorm_stat,null!=(ref=pi.app.visitor)&&ref.studying(),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_id:this["package"].course_id,course_session_id:this.stat.course_session_id},!1),ScormPackageTake.__super__.initialize.apply(this,arguments),iFrame=this.view.scorm_player.find("iframe"),utils.after(5e3,(_this=this,function(){return _this.nested_set_event_listeners(iFrame.node)}))},ScormPackageTake.prototype.nested_set_event_listeners=function(frame){var _this;if(null!=frame)return frame.contentWindow.addEventListener("mousemove",function(){return pi.app.activity_watcher.wakeup({type:"scorm"})}),frame.contentWindow.addEventListener("keydown",function(){return pi.app.activity_watcher.wakeup({type:"scorm"})}),["frame","iframe"].forEach((_this=this,function(tag){return Array.from(frame.contentDocument.getElementsByTagName(tag)).forEach(function(elem){return _this.nested_set_event_listeners(elem)})}))},ScormPackageTake}(pi.controllers.ScormPackageShow)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ScormUpload=function(superClass){function ScormUpload(){return ScormUpload.__super__.constructor.apply(this,arguments)}return extend(ScormUpload,superClass),ScormUpload.prototype.id="scorm_upload",ScormUpload.upload_resource($r.ScormAttachment,"file","scorm_package_id"),ScormUpload.prototype.load=function(context){if(ScormUpload.__super__.load.apply(this,arguments),null!=context.data.scorm_package_id)return this.scorm_package_id=context.data.scorm_package_id},ScormUpload.prototype.submit=function(){return this.close(this.current_item.file.name)},ScormUpload.prototype.build_resource=function(){var el;return(el=ScormUpload.__super__.build_resource.apply(this,arguments)).set({scorm_package_id:this.scorm_package_id},!0),el},ScormUpload.prototype.file_uploaded=function(){return ScormUpload.__super__.file_uploaded.apply(this,arguments)},ScormUpload}(pi.controllers.FileUpload)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Ratings=function(superClass){function Ratings(){return Ratings.__super__.constructor.apply(this,arguments)}return extend(Ratings,superClass),Ratings.include(pi.controllers.Paginated,pi.controllers.SessionsFilter),Ratings.list_resource(pi.resources.RatingListeners),Ratings.prototype.id="ratings",Ratings.prototype.initialize=function(){var hash_data,ref,ref1;return Ratings.__super__.initialize.apply(this,arguments),this.scope().set({course_id:pi.app.course_id}),null!=(ref=pi.app.visitor)&&ref.update_context({course_id:pi.app.course_id},!1),hash_data=hash.get(),pi.app.course_session_id?(this.scope().set({course_session_id:pi.app.course_session_id}),null!=(ref1=pi.app.visitor)&&ref1.update_context({course_session_id:pi.app.course_session_id},!1)):null!=(hash_data=hash.get()).session_id&&(this.session_id=0|hash_data.session_id,this.scope().set({course_session_id:this.session_id}),this.view.ensure_session(this.session_id)),this.next_page()},Ratings.prototype.edit_course=function(){return this["switch"]("course_edit",pi.app.course)},Ratings}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.controllers||(pi.controllers={}),pi.controllers.ProgramEdit=function(superClass){function ProgramEdit(){return ProgramEdit.__super__.constructor.apply(this,arguments)}return extend(ProgramEdit,superClass),ProgramEdit.prototype.id="program_edit",ProgramEdit.prototype.load=function(context){return this._initialized||this.initialize(),this._courses_updated=!1,null!=context.data&&context.data instanceof $r.Program?this.load_program(context.data):this.new_program()},ProgramEdit.prototype.new_program=function(){var _finish_date,_start_date,d,ts;return _start_date=utils.time.now("%Y-%m-%d"),(d=new Date).setMonth(d.getMonth()+1),_finish_date=utils.time.format(d,"%Y-%m-%d"),ts="en"===("undefined"!=typeof I18n&&null!==I18n?I18n.locale:void 0)?utils.time.now("%I:%M %p"):utils.time.now("%H:%M"),this.program=$r.Program.build({name:"",infinitely:!1,navigation:0,program_navigation:0,started_at_date:_start_date,finished_at_date:_finish_date,started_at_time:ts,finished_at_time:ts}),this.program.participants().build(pi.app.user,!0,{role_id:$r.Program.MODERATOR}),this.program.courses_loaded=!0,this.view.loaded(this.program)},ProgramEdit.prototype.load_program=function(program){var _this;if(null!=program)return this.program=program,this.program.courses_loaded&&this.program.participants_loaded?this.view.loaded(this.program):this.with_loader($r.Program.show({id:this.program.id}).then((_this=this,function(){return _this.view.loaded(_this.program)})))},ProgramEdit.prototype.reload=function(context){var course,file_obj,i,len,ref;if(null!=context.data.courses)for(this._courses_updated=!0,i=0,len=(ref=context.data.courses).length;i<len;i++)course=ref[i],this.program.courses().build(course,!1);if(null!=context.data.file)return utils.debug(context.data.file),file_obj=context.data.file,this.view.cover_loaded(this.cover_target,file_obj)},ProgramEdit.prototype.save=function(data){var _persisted,_this;return this.view.list.records().length?null!=this.program?(_persisted=this.program._persisted,this.with_loader(this.program.save(data).then((_this=this,function(){return _persisted?_this.close():_this.location("/programs/"+_this.program.id)})))):this.exit():this.view.empty_list_error()},ProgramEdit.prototype.finish=function(){var ref,_this;if(null!=(ref=this.program)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.program.finish().then(function(){return _this.close()}))}))["with"](this.program,"programs/finish_confirm")},ProgramEdit.prototype.close=function(){if(ProgramEdit.__super__.close.apply(this,arguments),this.courses_changed)return window.location.reload()},ProgramEdit.prototype.add_courses=function(courses){return this.program&&(this.courses_changed=!0),this["switch"]("select_courses",{courses:courses})},ProgramEdit.prototype.remove_courses=function(courses){var course,i,len,results;for(this._courses_updated=!0,results=[],i=0,len=courses.length;i<len;i++)course=courses[i],results.push(this.program.courses().remove(course));return results},ProgramEdit.prototype.upload_cover=function(cover_target){return this.cover_target=cover_target,this["switch"]("cover_upload")},ProgramEdit.prototype.unload=function(){return this._courses_updated&&this.program.courses().clear_all(),this.program=null,ProgramEdit.__super__.unload.apply(this,arguments)},ProgramEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProgramEditParticipants=function(superClass){function ProgramEditParticipants(){return ProgramEditParticipants.__super__.constructor.apply(this,arguments)}return extend(ProgramEditParticipants,superClass),ProgramEditParticipants.prototype.id="program_edit_participants",ProgramEditParticipants.prototype.load=function(context){if(ProgramEditParticipants.__super__.load.apply(this,arguments),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.Program&&this.load_program(context.data),this.program.program_navigation&&0===this.program.participants().where({role_id:$r.Program.LISTENER}).length)return pi.app.view.attention_modal.init(JST["templates/programs/add_listeners_attention"]()),pi.app.view.popup.open(pi.app.view.attention_modal)},ProgramEditParticipants.prototype.load_program=function(program){return this.program=program,this.program.courses_loaded&&this.program.participants_loaded?this.view.load_program(this.program):this.with_loader($r.Program.show({id:this.program.id}).then((_this=this,function(){return _this.view.load_program(_this.program)})));var _this},ProgramEditParticipants.prototype.reload=function(context){var i,len,ref,results,user;if(null!=context.data.users){for(this._participants_updated=!0,results=[],i=0,len=(ref=context.data.users).length;i<len;i++)user=ref[i],results.push(this.program.participants().build(user,!1,{changed:!0,role_id:this.role_to_add}));return results}},ProgramEditParticipants.prototype.save=function(){return null!=this.program?this.with_loader(this.program.save().then((_this=this,function(){var i,len,ref;for(i=0,len=(ref=_this.program.participants().all()).length;i<len;i++)delete ref[i].changed;return _this.close()}))):this.exit();var _this},ProgramEditParticipants.prototype.add_listeners=function(users){return this.role_to_add=$r.Program.LISTENER,this["switch"]("select_users",{users:users})},ProgramEditParticipants.prototype.add_moderators=function(users){return this.role_to_add=$r.Program.MODERATOR,this["switch"]("select_users",{users:users,role_ids:[$r.User.SPECIALIST,$r.User.MANAGER]})},ProgramEditParticipants.prototype.update_role=function(users){return this["switch"]("update_role",{users:users})},ProgramEditParticipants.prototype.remove_participants=function(users){var i,len,results,user;for(this._participants_updated=!0,results=[],i=0,len=users.length;i<len;i++)user=users[i],results.push(this.program.participants().remove(user));return results},ProgramEditParticipants}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.Programs=function(superClass){function Programs(){return Programs.__super__.constructor.apply(this,arguments)}return extend(Programs,superClass),Programs.include(pi.controllers.Paginated),Programs.list_resource(pi.resources.Program),Programs.prototype.id="programs",Programs.prototype.initialize=function(){if(Programs.__super__.initialize.apply(this,arguments),this.next_page(),"new"===hash.get().goto)return this["new"]()},Programs.prototype["new"]=function(){return this["switch"]("program_edit")},Programs.prototype.edit=function(program){return this["switch"]("program_edit",program)},Programs.prototype.destroy=function(program){return this.confirm((_this=this,function(){return _this.with_loader(program.destroy())}))["with"](program,"courses/destroy_confirm");var _this},Programs}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,
pi.controllers.ModeratedPrograms=function(superClass){function ModeratedPrograms(){return ModeratedPrograms.__super__.constructor.apply(this,arguments)}return extend(ModeratedPrograms,superClass),ModeratedPrograms.include(pi.controllers.Paginated),ModeratedPrograms.list_resource(pi.resources.ModeratedProgram),ModeratedPrograms.prototype.id="moderated_programs",ModeratedPrograms.prototype.initialize=function(){return ModeratedPrograms.__super__.initialize.apply(this,arguments),this.view.options.filter&&this.scope().set({filter:this.view.options.filter}),this.next_page()},ModeratedPrograms.prototype["new"]=function(){return this["switch"]("program_edit")},ModeratedPrograms.prototype.edit=function(program){return this["switch"]("program_edit",program)},ModeratedPrograms.prototype.destroy=function(program){return this.confirm((_this=this,function(){return _this.with_loader(program.destroy())}))["with"](program,"courses/destroy_confirm");var _this},ModeratedPrograms}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.SelectCourses=function(superClass){function SelectCourses(){return SelectCourses.__super__.constructor.apply(this,arguments)}return extend(SelectCourses,superClass),SelectCourses.include(pi.controllers.Paginated,pi.controllers.LabelsFilter,pi.controllers.Popuped),SelectCourses.list_resource(pi.resources.Course),SelectCourses.prototype.id="select_courses",SelectCourses.prototype.data_wrap="courses",SelectCourses.prototype.initialize=function(){return SelectCourses.__super__.initialize.apply(this,arguments),this.view.options.filter&&this.scope().set({filter:this.view.options.filter}),this.next_page()},SelectCourses.prototype.load=function(context){return"radio"===context.data.select_type&&(this.view.list.selectable.is_radio=!0),SelectCourses.__super__.load.apply(this,arguments)},SelectCourses.prototype.select=function(data){return this.close(data)},SelectCourses}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProgramSelect=function(superClass){function ProgramSelect(){return ProgramSelect.__super__.constructor.apply(this,arguments)}return extend(ProgramSelect,superClass),ProgramSelect.include(pi.controllers.Paginated,pi.controllers.Popuped),ProgramSelect.prototype.id="program_select",ProgramSelect.list_resource(pi.resources.Program),ProgramSelect.prototype.initialize=function(){return ProgramSelect.__super__.initialize.apply(this,arguments),this.next_page()},ProgramSelect.prototype.select=function(data){return this.close(data)},ProgramSelect}(pi.controllers.CourseSessions)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.ProgramShow=function(superClass){function ProgramShow(){return ProgramShow.__super__.constructor.apply(this,arguments)}return extend(ProgramShow,superClass),ProgramShow.include(pi.controllers.Scoped),ProgramShow.include(pi.controllers.Paginated),ProgramShow.list_resource(pi.resources.ProgramSession),ProgramShow.prototype.id="program_show",ProgramShow.prototype.initialize=function(){if(ProgramShow.__super__.initialize.apply(this,arguments),this.program=pi.app.program,this.scope().set({program_id:this.program.id}),this.next_page(),"edit"===hash.get().goto)return this.edit_program()},ProgramShow.prototype.reload=function(){return this.view.check_arrows(this.program),this.scope().reload(),this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))}));var _this},ProgramShow.prototype.edit=function(program_session){return this["switch"]("program_session_edit",program_session)},ProgramShow.prototype.edit_program=function(){return this["switch"]("program_edit",this.program)},ProgramShow.prototype.show_participants=function(){return this["switch"]("program_edit_participants",this.program)},ProgramShow.prototype.move_item=function(session,to){if(session instanceof $r.ProgramSession)return this.program.move_element(session,to)},ProgramShow}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AssignmentRuleEdit=function(superClass){function AssignmentRuleEdit(){return AssignmentRuleEdit.__super__.constructor.apply(this,arguments)}return extend(AssignmentRuleEdit,superClass),AssignmentRuleEdit.prototype.id="assignment_rule_edit",AssignmentRuleEdit.prototype.load=function(context){return this._initialized||this.initialize(),this._participants_updated=!1,null!=context.data&&context.data instanceof $r.AssignmentRule?(this.rule=context.data,this.rule._persisted||(this._copy=!0),this.view.loaded(this.rule),this.view.load_labels_list(this.view.labels_list,this.rule.labels),this.view.load_events_list(this.view.sessions_list,this.course_sessions()),this.view.load_events_list(this.view.programs_list,this.rule.programs)):(this.rule=$r.AssignmentRule.build(),this.view.loaded(this.rule))},AssignmentRuleEdit.prototype.reload=function(context){var list;return null!=context.data.labels?this.view.load_labels_list(this.view.labels_list,context.data.labels):null!=context.data&&Object.keys(context.data).length>0?(list=this.view.sessions_list,"program_select"===context.context&&(list=this.view.programs_list),this.view.load_events_list(list,context.data)):void 0},AssignmentRuleEdit.prototype.apply=function(){if(this.rule._persisted)return this.confirm((_this=this,function(){return _this.with_loader(_this.rule.apply().then(function(response){if(null!=(null!=response?response.message:void 0))return _this.view.success(response.message)}))}))["with"](this.rule,"assignment_rules/apply_confirm");var _this},AssignmentRuleEdit.prototype.select_labels=function(){var checked;return checked=this.view.labels_list.records().map(function(r){return r.id}),this["switch"]("labels_filter",{clear:!0,checked_subgroups:checked})},AssignmentRuleEdit.prototype.select_sessions=function(){return this["switch"]("session_select")},AssignmentRuleEdit.prototype.select_programs=function(){return this["switch"]("program_select")},AssignmentRuleEdit.prototype.save=function(data){return null!=this.rule?(data.label_ids=this.prepare_list("labels_list"),data.course_session_ids=this.prepare_list("sessions_list"),data.program_ids=this.prepare_list("programs_list"),data.group_ids=this.prepare_list_by_group("labels_list"),data.empty_course_sessions=!1,0===data.course_session_ids.length&&0===data.program_ids.length?this.view.error(I18n.t("activemodel.attributes.assignment_rule_form.rule")+" "+I18n.t("assignment_rules.errors.blank_sessions")):(0===data.course_session_ids.length&&(data.empty_course_sessions=!0),this.with_loader(this.rule.save(data).then((_this=this,function(){return _this.close({reload_list:_this._copy})}))))):this.exit();var _this},AssignmentRuleEdit.prototype.course_sessions=function(){var program_session_ids;return program_session_ids=[],this.rule.programs.forEach(function(program){var ids;return ids=program.program_sessions.map(function(p){return p.id}),program_session_ids=program_session_ids.concat(ids)}),this.rule.course_sessions.filter(function(cs){return!program_session_ids.includes(cs.id)})},AssignmentRuleEdit.prototype.prepare_list=function(component){return this.view[component].items.map(function(e){return e.record.id})},AssignmentRuleEdit.prototype.prepare_list_by_group=function(component){return this.view[component].items.map(function(e){return e.record.group_id}).filter(function(value,index,self){return self.indexOf(value)===index})},AssignmentRuleEdit.prototype.delete_label=function(item){return this.view.labels_list.remove_item(item)},AssignmentRuleEdit.prototype.delete_session=function(item){return this.view.sessions_list.remove_item(item)},AssignmentRuleEdit.prototype.delete_program=function(item){return this.view.programs_list.remove_item(item)},AssignmentRuleEdit.prototype.unload=function(){return this.rule=null,AssignmentRuleEdit.__super__.unload.apply(this,arguments)},AssignmentRuleEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.AssignmentRules=function(superClass){function AssignmentRules(){return AssignmentRules.__super__.constructor.apply(this,arguments)}return extend(AssignmentRules,superClass),AssignmentRules.include(pi.controllers.Paginated),AssignmentRules.list_resource(pi.resources.AssignmentRule),AssignmentRules.prototype.id="assignment_rules",AssignmentRules.prototype.initialize=function(){return AssignmentRules.__super__.initialize.apply(this,arguments),this.next_page()},AssignmentRules.prototype.reload=function(context){if(context.data.reload_list)return this.scope().reload(),this.query().then((_this=this,function(data){return _this.view.reload(_this._parse_response(data))}));var _this},AssignmentRules.prototype["new"]=function(){return this["switch"]("assignment_rule_edit")},AssignmentRules.prototype.edit=function(data){return this["switch"]("assignment_rule_edit",data)},AssignmentRules.prototype.copy=function(data){return delete data.id,delete data.name,data._persisted=!1,this["switch"]("assignment_rule_edit",data)},AssignmentRules.prototype.destroy=function(item){return this.confirm((_this=this,function(){return _this.with_loader(item.destroy())}))["with"](item,"assignment_rules/destroy_confirm");var _this},AssignmentRules}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers||(pi.controllers={}),pi.controllers.ProgramSessionEdit=function(superClass){function ProgramSessionEdit(){return ProgramSessionEdit.__super__.constructor.apply(this,arguments)}return extend(ProgramSessionEdit,superClass),ProgramSessionEdit.include(pi.controllers.Scoped),ProgramSessionEdit.prototype.id="program_session_edit",ProgramSessionEdit.prototype.load=function(context){if(ProgramSessionEdit.__super__.load.apply(this,arguments),null!=context.data&&context.data instanceof $r.ProgramSession)return this.program_session=context.data,this.view.load_session(this.program_session)},ProgramSessionEdit.prototype.finish=function(){var ref,_this;if(null!=(ref=this.program_session)?ref._persisted:void 0)return this.confirm((_this=this,function(){return _this.with_loader(_this.program_session.finish().then(function(){return _this.close()}))}))["with"](this.program_session,"course_sessions/finish_confirm")},ProgramSessionEdit.prototype.save=function(data){if(null!=this.program_session)return this.program_session.program_id=pi.app.program_id,this.program_session.save(data).then((_this=this,function(){return _this.close()}))["catch"](function(_this){return function(e){throw _this.view.error(e.message),e}}(this));var _this},ProgramSessionEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CompetencesEdit=function(superClass){function CompetencesEdit(){return CompetencesEdit.__super__.constructor.apply(this,arguments)}return extend(CompetencesEdit,superClass),CompetencesEdit.prototype.id="competences",CompetencesEdit.prototype.load=function(context_data){return this.selected_course=context_data.data.course,CompetencesEdit.__super__.load.apply(this,arguments)},CompetencesEdit.prototype.unload=function(){return this.selected_course=null,CompetencesEdit.__super__.unload.apply(this,arguments)},CompetencesEdit.prototype.create=function(params){return this.view.loading(!0),this.with_loader($r.Competence.create(params))},CompetencesEdit.prototype.update=function(id,data){var competence,_this;if(null!=(competence=$r.Competence.get(id)))return this.with_loader(competence.save(data)).then((_this=this,function(){return _this.view.competence_updated(competence)}))},CompetencesEdit.prototype.destroy=function(competence){return this.confirm((_this=this,function(){return _this.with_loader(competence.destroy())}))["with"](competence,"labels/destroy_confirm");var _this},CompetencesEdit.prototype.select=function(competences){var competence,competences_data,i,len,_this;if(null==this.selected_course)return this.close(competences);for(competences_data=[],i=0,len=competences.length;i<len;i++)competence=competences[i],competences_data.push(competence.id);return this.view.loading(!0),this.selected_course.update_competences({competences:competences_data})["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(){return _this.view.loading(!1),_this.close()}}(this))},CompetencesEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.QuestionCategoriesEdit=function(superClass){function QuestionCategoriesEdit(){return QuestionCategoriesEdit.__super__.constructor.apply(this,arguments)}return extend(QuestionCategoriesEdit,superClass),QuestionCategoriesEdit.prototype.id="question_categories_edit",QuestionCategoriesEdit.has_resource($r.Question),QuestionCategoriesEdit.prototype.load=function(context_data){return this.selected_questions=context_data.data.questions,this.quiz=context_data.data.quiz,QuestionCategoriesEdit.__super__.load.apply(this,arguments)},QuestionCategoriesEdit.prototype.save=function(category){var data,_this;if(this.selected_questions)return data={questions:this.selected_questions.map(function(u){return u.id}),question_category:category.id,quiz_id:this.quiz.id},this.questions.update_category(data)["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){var i,len,ref;for(i=0,len=(ref=_this.selected_questions).length;i<len;i++)ref[i].trigger("update");return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),_this.view.reload_question=!0,response}}(this))},QuestionCategoriesEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CongregationAddIntersection=function(superClass){function CongregationAddIntersection(){return CongregationAddIntersection.__super__.constructor.apply(this,arguments)}return extend(CongregationAddIntersection,superClass),CongregationAddIntersection.include(pi.controllers.Popuped),CongregationAddIntersection.prototype.id="congregation_add_intersection",CongregationAddIntersection.prototype.select=function(){var data;return data=this.view.list.selected_records(),this.close(data)},CongregationAddIntersection}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.CongregationEdit=function(superClass){function CongregationEdit(){return CongregationEdit.__super__.constructor.apply(this,arguments)}return extend(CongregationEdit,superClass),CongregationEdit.prototype.id="congregation_edit",CongregationEdit.prototype.load=function(context){return this.user=context.data.user,this.rules=context.data.rules||[],this._initialized||this.initialize(),this.view.loaded(this.rules)},CongregationEdit.prototype.save=function(){var result,_this;return result=this.view.result(),$r.CoachRule.bulk_refresh({user_id:this.user.id,rules:result})["catch"]((_this=this,function(e){throw _this.view.error(e.message),e})).then(function(_this){return function(response){return null!=(null!=response?response.message:void 0)&&_this.view.success(response.message),_this.close(),response}}(this))},CongregationEdit}(pi.controllers.Popup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.MeetBaseSelect=function(superClass){function MeetBaseSelect(){return MeetBaseSelect.__super__.constructor.apply(this,arguments)}return extend(MeetBaseSelect,superClass),MeetBaseSelect.include(pi.controllers.Popuped),MeetBaseSelect.include(pi.controllers.Paginated),MeetBaseSelect.list_resource(pi.resources.MeetBaseMeeting),MeetBaseSelect.prototype.id="meet_base_select",MeetBaseSelect.prototype.initialize=function(){return this.scope().set({filter:"active"}),this.next_page(),MeetBaseSelect.__super__.initialize.apply(this,arguments)},MeetBaseSelect.prototype.select=function(data){return this.close(data)},MeetBaseSelect}(pi.controllers.TBListController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.WebinarApplyController=function(superClass){function WebinarApplyController(){return WebinarApplyController.__super__.constructor.apply(this,arguments)}return extend(WebinarApplyController,superClass),WebinarApplyController.prototype.id="webinar_apply",WebinarApplyController.prototype.auth=function(){return this["switch"]("authorize")},WebinarApplyController.prototype.register=function(meeting_id,access_type){return access_type&&"authorized"===access_type.trim()?this["switch"]("authorize"):this.send_request({id:meeting_id})},WebinarApplyController.prototype.register_with_password=function(data){var params;return params={id:data.meeting_id,password:data.password},this.send_request(params)},WebinarApplyController.prototype.send_request=function(params){return $r.MeetBaseMeeting.register(params).then((_this=this,function(response){return _this.location(response.redirect_url||_this.view.data().redirect)}))["catch"](function(_this){return function(error){return _this.view.error(error.message)}}(this));var _this},WebinarApplyController}(pi.controllers.TBController)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.controllers.RestoreCourseStatsController=function(superClass){function RestoreCourseStatsController(){return RestoreCourseStatsController.__super__.constructor.apply(this,arguments)}return extend(RestoreCourseStatsController,superClass),RestoreCourseStatsController.include(pi.controllers.Paginated),RestoreCourseStatsController.list_resource(pi.resources.RestoreCourseStat),RestoreCourseStatsController.prototype.id="restore_course_stats",RestoreCourseStatsController.prototype.initialize=function(){return RestoreCourseStatsController.__super__.initialize.apply(this,arguments),this.next_page()},RestoreCourseStatsController.prototype.recover=function(record){return this.with_loader(record.restore()["catch"]((_this=this,function(e){throw _this.view.loading(!1),_this.view.error(e.message),e})).then(function(_this){return function(response){return _this.view.success(response.message),_this.view.list.selected_item().remove()}}(this)));var _this},RestoreCourseStatsController}(pi.controllers.TBListController)}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CompetencesFilterView=function(){function CompetencesFilterView(){}return CompetencesFilterView.included=function(){return!0},CompetencesFilterView.prototype.ensure_competence=function(competences){var competence,group_list,i,id,item,len,list,results;if(list=$("[data-pid=competences_list]"),!competences||!Object.keys(competences).length)return list.clear_selection(!0);for(results=[],i=0,len=competences.length;i<len;i++)id=competences[i],competence=$r.Competence.get(Number(id)),(group_list=list.where({record:{id:competence.group_id}})).length&&(item=(group_list=group_list[0].list).where({record:{id:competence.id}})).length?results.push(group_list.select_item(item[0],!0)):results.push(void 0);return results},CompetencesFilterView}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseTypesFilterView=function(){function CourseTypesFilterView(){}return CourseTypesFilterView.included=function(){return!0},CourseTypesFilterView.prototype.ensure_course_type=function(ids){var i,id,len,list,ref,results;if(list=$("@types_list"),!ids||!ids.length)return list.clear_selection(!0);for(results=[],i=0,len=ids.length;i<len;i++)id=ids[i],(ref=list.where({record:{id:id}})).length?results.push(list.select_item(ref[0],!0)):results.push(void 0);return results},CourseTypesFilterView.prototype.ensure_course_content_type=function(ids){var i,id,len,list,ref,results;if(list=$("@content_types_list"),!ids||!ids.length)return list.clear_selection(!0);for(results=[],i=0,len=ids.length;i<len;i++)id=ids[i],(ref=list.where({record:{id:id}})).length?results.push(list.select_item(ref[0],!0)):results.push(void 0);return results},CourseTypesFilterView}()}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.BaseView.Coverable=function(){function Coverable(){}return Coverable.included=function(){return!0},Coverable.prototype.cover_loaded=function(target,file_obj){return file_obj.external?(this.form.value(utils.wrap(target.name()+"_remote_url",file_obj.external)),target.load(file_obj.external)):(this.form.value(utils.wrap(target.name()+"_temp_file_id",file_obj.id)),LocalFileReader.isSupported?LocalFileReader.read(file_obj.file).then(function(url){return target.load(url)},function(e){return utils.local_error(e)}):void 0)},Coverable.prototype.delete_cover=function(target){return this.form.value(utils.wrap(target.name()+"_temp_file_id",0)),this.form.value(utils.wrap(target.name()+"_remote_url",null)),target.load(null)},Coverable}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TaskAttachmentForm=function(){function TaskAttachmentForm(){}return TaskAttachmentForm.included=function(){return!0},TaskAttachmentForm.prototype.loaded_attachments=function(attachments){var i,item,len,results;for(results=[],i=0,len=attachments.length;i<len;i++)(item=attachments[i]).loaded=!0,results.push(this.add_file(item));return results},TaskAttachmentForm.prototype.reload_files=function(files){var file,i,len,ref;for(i=0,len=files.length;i<len;i++)file=files[i],this.add_file({name:file.name,file:file});return null!=(ref=this.form.upload_btn)?ref.clear():void 0},TaskAttachmentForm.prototype.add_file=function(file){var ref;return this.form.list.add_item($r.Attachment.build(file)),null!=(ref=this._check_enabled)?ref.call(this):void 0},TaskAttachmentForm.prototype.file_attributes=function(){var i,item,len,obj,ref,result;for(result=[],i=0,len=(ref=this.form.list.items).length;i<len;i++)(obj={file:(item=ref[i]).record.file||"",_destroy:item.record._destroy||!1}).id=item.record._persisted?item.record.id:"",item.record._persisted&&!obj._destroy||result.push(obj);return result},TaskAttachmentForm.prototype.remove_file=function(item){var ref;return item.record.loaded?(item.record._destroy=!0,item.hide()):this.form.list.remove_item(item),null!=(ref=this._check_enabled)?ref.call(this):void 0},TaskAttachmentForm}()}(this)}.call(this),function(){!function(context){"use strict";var _pad,_parse_time_spent,pi;(pi=context.pi).utils,_pad=function(val){return val<10?"0"+val:""+val},_parse_time_spent=function(val){var h,m,s;return h=(m=(val=val/1e3|0)/60|0)/60|0,m%=60,s=val%60,_pad(h)+":"+_pad(m)+":"+_pad(s)},pi.BaseView.VisitsReports=function(){function VisitsReports(){}return VisitsReports.included=function(klass){return klass.requires("charts"),klass.after_create(function(){return this.init_time_charts()})},VisitsReports.prototype.init_time_charts=function(){var chart,i,j,len,len1,ref,results,time_chart,time_charts;for(time_charts=[],i=0,len=(ref=this.charts).length;i<len;i++)!0===(chart=ref[i]).options.time&&time_charts.push(chart);for(results=[],j=0,len1=time_charts.length;j<len1;j++)time_chart=time_charts[j],results.push(time_chart.options.axis={y:{tick:{format:_parse_time_spent}}});return results},VisitsReports.prototype.draw_data=function(data,range){var chart,i,len,ref,results;for(null==data&&(data={}),null==range&&(range="day"),(data=this._fetch_reports_data(data))&&data.length?this.activate():this.deactivate(),results=[],i=0,len=(ref=this.charts).length;i<len;i++)chart=ref[i],results.push(function(chart){var _key;if(_key=chart.options.keys,chart.clear(),null!=data)return chart.load_data(data,_key,{range:range})}(chart));return results},VisitsReports.prototype._fetch_reports_data=function(data){return data[this.reports_name||"visits_reports"]},VisitsReports}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var app,pi;(pi=context.pi).utils,app=pi.app,pi.PopupView=function(superClass){function PopupView(){return PopupView.__super__.constructor.apply(this,arguments)}return extend(PopupView,superClass),PopupView.prototype.default_controller=pi.controllers.Popup,PopupView.prototype.handle_close=function(){return this.controller.close()},PopupView.prototype.loaded=function(){var _this;app.view.popup.open(this,{close:(_this=this,function(){return _this.handle_close()})}),this._loaded_id=after(600+app.view.popup.show_delay,function(_this){return function(){return _this.trigger("loaded")}}(this))},PopupView.prototype.close=function(){return clearTimeout(this._loaded_id),app.view.popup.close()},PopupView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var app,pi;(pi=context.pi).utils,app=pi.app,pi.LeftbarView=function(superClass){function LeftbarView(){return LeftbarView.__super__.constructor.apply(this,arguments)}return extend(LeftbarView,superClass),LeftbarView.prototype.default_controller=pi.controllers.Popup,LeftbarView.prototype.handle_close=function(){return this.controller.close()},LeftbarView.prototype.loaded=function(){var _this;app.view.leftbar.open(this,{close:(_this=this,function(){return _this.handle_close()})}),this._loaded_id=after(600+app.view.leftbar.show_delay,function(_this){return function(){return _this.trigger("loaded")}}(this))},LeftbarView.prototype.close=function(){return clearTimeout(this._loaded_id),app.view.leftbar.close()},LeftbarView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var app,pi;(pi=context.pi).utils,app=pi.app,pi.RightbarView=function(superClass){function RightbarView(){return RightbarView.__super__.constructor.apply(this,arguments)}return extend(RightbarView,superClass),RightbarView.prototype.default_controller=pi.controllers.Popup,RightbarView.prototype.handle_close=function(){return this.controller.close()},RightbarView.prototype.loaded=function(){var _this;app.view.rightbar.open(this,{close:(_this=this,function(){return _this.handle_close()})}),this._loaded_id=after(600+app.view.rightbar.show_delay,function(_this){return function(){return _this.trigger("loaded")}}(this))},RightbarView.prototype.close=function(){return clearTimeout(this._loaded_id),app.view.rightbar.close()},RightbarView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.InfoPopupView=function(superClass){function InfoPopupView(){return InfoPopupView.__super__.constructor.apply(this,arguments)}return extend(InfoPopupView,superClass),InfoPopupView.requires("content"),InfoPopupView.prototype.loaded=function(data){return null!=data&&this.content.render(data),InfoPopupView.__super__.loaded.apply(this,arguments)},InfoPopupView.prototype.unloaded=function(){return this.content.render(null),InfoPopupView.__super__.unloaded.apply(this,arguments)},InfoPopupView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UploadView=function(superClass){function UploadView(){return UploadView.__super__.constructor.apply(this,arguments)}return extend(UploadView,superClass),UploadView.requires("list","form"),UploadView.prototype.default_controller=pi.controllers.FileUpload,UploadView.prototype.bind_resources=function(resources){return this.list.restful.bind(resources)},UploadView.prototype.activate=function(){return UploadView.__super__.activate.apply(this,arguments),this.submit_btn.enable()},UploadView.prototype.deactivate=function(){
return UploadView.__super__.deactivate.apply(this,arguments),this.submit_btn.disable()},UploadView.prototype.update_progress=function(item,value){var el,ref;return null!=(el=this.list.find_by_id(item.id))&&null!=(ref=el.loader)?ref.set(value):void 0},UploadView.prototype.unloaded=function(){return this.deactivate(),this.list.restful.resources=null,this.list.clear(),this.form.clear(),UploadView.__super__.unloaded.apply(this,arguments)},UploadView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ApplyView=function(superClass){function ApplyView(){return ApplyView.__super__.constructor.apply(this,arguments)}return extend(ApplyView,superClass),ApplyView.prototype.default_controller=pi.controllers.Apply,ApplyView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.GuestLoginView=function(superClass){function GuestLoginView(){return GuestLoginView.__super__.constructor.apply(this,arguments)}return extend(GuestLoginView,superClass),GuestLoginView.include(pi.BaseView.Loadable),GuestLoginView.prototype.default_controller=pi.controllers.GuestLogin,GuestLoginView.prototype.loaded=function(){return this.show()},GuestLoginView.prototype.unloaded=function(){return this.hide()},GuestLoginView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.LoginView=function(superClass){function LoginView(){return LoginView.__super__.constructor.apply(this,arguments)}return extend(LoginView,superClass),LoginView.include(pi.BaseView.Loadable),LoginView.prototype.default_controller=pi.controllers.Login,LoginView.prototype.loaded=function(){return this.show()},LoginView.prototype.unloaded=function(){return this.hide()},LoginView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.RegistrationView=function(superClass){function RegistrationView(){return RegistrationView.__super__.constructor.apply(this,arguments)}return extend(RegistrationView,superClass),RegistrationView.include(pi.BaseView.Loadable),RegistrationView.prototype.default_controller=pi.controllers.Registration,RegistrationView.prototype.loaded=function(){return this.show()},RegistrationView.prototype.unloaded=function(){return this.hide()},RegistrationView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AuthorizeView=function(superClass){function AuthorizeView(){return AuthorizeView.__super__.constructor.apply(this,arguments)}return extend(AuthorizeView,superClass),AuthorizeView.prototype.default_controller=pi.controllers.Authorize,AuthorizeView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CommentEditView=function(superClass){function CommentEditView(){return CommentEditView.__super__.constructor.apply(this,arguments)}return extend(CommentEditView,superClass),CommentEditView.requires("form"),CommentEditView.include(pi.BaseView.Loadable),CommentEditView.prototype.default_controller=pi.controllers.CommentEdit,CommentEditView.prototype.loaded=function(comment){if(CommentEditView.__super__.loaded.apply(this,arguments),null!=comment)return this.form.value(comment)},CommentEditView.prototype.unloaded=function(){return CommentEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},CommentEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DiscussionEditView=function(superClass){function DiscussionEditView(){return DiscussionEditView.__super__.constructor.apply(this,arguments)}return extend(DiscussionEditView,superClass),DiscussionEditView.requires("form"),DiscussionEditView.include(pi.BaseView.Loadable),DiscussionEditView.prototype.default_controller=pi.controllers.DiscussionEdit,DiscussionEditView.prototype.loaded=function(discussion){if(DiscussionEditView.__super__.loaded.apply(this,arguments),null!=discussion)return this.form.value(discussion),this.form.material_selector.restful.bind(discussion,!0)},DiscussionEditView.prototype.unloaded=function(){return DiscussionEditView.__super__.unloaded.apply(this,arguments),this.form.material_selector.restful.bind(null),this.form.clear()},DiscussionEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.DiscussionsView=function(superClass){function DiscussionsView(){return DiscussionsView.__super__.constructor.apply(this,arguments)}return extend(DiscussionsView,superClass),DiscussionsView.prototype.default_controller=pi.controllers.Discussions,DiscussionsView.prototype.postinitialize=function(){return DiscussionsView.__super__.postinitialize.apply(this,arguments),this.base_renderer=this.list._renderer,this.search_renderer=new pi.Renderers.Jst(this.options.search_renderer)},DiscussionsView.prototype.load=function(data){return null!=data&&null!=pi.app.program_id&&data.forEach(function(discussion){return discussion.program_id=pi.app.program_id}),DiscussionsView.__super__.load.apply(this,arguments)},DiscussionsView.prototype.reload=function(data){return null!=data&&null!=pi.app.program_id&&data.forEach(function(discussion){return discussion.program_id=pi.app.program_id}),DiscussionsView.__super__.reload.apply(this,arguments)},DiscussionsView.prototype.filtered=function(){return utils.debug("filter data")},DiscussionsView.prototype.searched=function(){},DiscussionsView.prototype.ensure_session=function(id){return this.session_select.value(id)},DiscussionsView.prototype.searching=function(val){return val?(this.list._renderer=this.search_renderer,this.addClass("is-searching")):(this.list._renderer=this.base_renderer,this.removeClass("is-searching"))},DiscussionsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SelectMaterialView=function(superClass){function SelectMaterialView(){return SelectMaterialView.__super__.constructor.apply(this,arguments)}return extend(SelectMaterialView,superClass),SelectMaterialView.include(pi.BaseView.Loadable,pi.BaseView.Listable),SelectMaterialView.prototype.default_controller=pi.controllers.SelectMaterial,SelectMaterialView.prototype.unloaded=function(){return SelectMaterialView.__super__.unloaded.apply(this,arguments),this.list.clear_selection()},SelectMaterialView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DiscussionShowView=function(superClass){function DiscussionShowView(){return DiscussionShowView.__super__.constructor.apply(this,arguments)}var HIGHLIGHT_TIME;return extend(DiscussionShowView,superClass),DiscussionShowView.prototype.default_controller=pi.controllers.CourseDiscussionShow,HIGHLIGHT_TIME=3e3,DiscussionShowView.prototype.postinitialize=function(){if(DiscussionShowView.__super__.postinitialize.apply(this,arguments),this.page_shift=0,null!=pi.app.discussion)return pi.app.discussion.on("update",(_this=this,function(){return _this.render_discussion(pi.app.discussion)}));var _this},DiscussionShowView.prototype.handle_pagination=function(data){var ref,ref1;if(this.page_data&&this.page_data.total_entries!==data.total_entries&&(this.page_shift+=this.page_data.total_entries-data.total_entries),this.page_data=data,null!=data)return data.next_page?null!=(ref=this.list)?ref.addClass("has-pages"):void 0:null!=(ref1=this.list)?ref1.removeClass("has-pages"):void 0},DiscussionShowView.prototype.render_discussion=function(d){var title_txt;return title_txt="",d.meta.section_pos&&(title_txt+=pi.utils.capitalize(I18n.t("discussions.selector.section"))+" "+d.meta.section_pos+". "),d.meta.material_pos&&(title_txt+=pi.utils.capitalize(I18n.t("discussions.selector.material"))+" "+d.meta.material_pos+". "),d.meta.quiz_pos&&(title_txt+=pi.utils.capitalize(I18n.t("discussions.selector.quiz"))+" "+d.meta.quiz_pos+". "),title_txt+=d.title,this.discussion.find(".discus-title").text(title_txt),this.discussion.find(".comment-body").html(JST.parseLinks(JST.sanitize(d.text)))},DiscussionShowView.prototype.load=function(data){var i,item,len,pdata,remain;for(i=0,len=data.length;i<len;i++)item=data[i],this.list.add_item_at(item,0,!0);return this.list.update(),this.page_data&&this.page_data.next_page&&(remain=this.page_data.total_entries-this.list.size()+this.page_shift,pdata={per_page:Math.min(remain,this.controller.per_page),total_remained:remain}),this.list.paginator.render(pdata)},DiscussionShowView.prototype.reload=function(data){return this.list.clear(!0),this.load(data)},DiscussionShowView.prototype.show_form=function(data){var txt;return data?this.form.value({meta:data}):(txt=this.form.txt.value(),this.form.clear(),this.form.value({text:txt})),pi.Nod.win.scrollToNod(this.form),this.form.txt.focus()},DiscussionShowView.prototype.show_comment=function(id){var item,items;if(items=this.list.where({record:{id:id}}),item=items[0])return pi.Nod.win.scrollToNod(item),item.addClass("is-highlighted"),after(HIGHLIGHT_TIME,function(){return item.removeClass("is-highlighted")})},DiscussionShowView.prototype.show_first_comment=function(){return pi.Nod.win.scrollToNod(this)},DiscussionShowView.prototype.show_last_comment=function(){return pi.Nod.win.scrollToNod(this.form)},DiscussionShowView.prototype.subscribed=function(){return this.addClass("has-subscription")},DiscussionShowView.prototype.unsubscribed=function(){return this.removeClass("has-subscription")},DiscussionShowView.prototype.pinned=function(){return this.addClass("is-pinned")},DiscussionShowView.prototype.unpinned=function(){return this.removeClass("is-pinned")},DiscussionShowView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CoverUploadView=function(superClass){function CoverUploadView(){return CoverUploadView.__super__.constructor.apply(this,arguments)}return extend(CoverUploadView,superClass),CoverUploadView.prototype.default_controller=pi.controllers.CoverUpload,CoverUploadView.requires("nav"),CoverUploadView.prototype.switched_to=function(new_context_id){var ref;if(this.clear_active_item(),null!=(ref=this.nav.where({record:{id:new_context_id}})).length)return this._active_item=ref[0],this._active_item.activate()},CoverUploadView.prototype.clear_active_item=function(){return this._active_item&&this._active_item.deactivate(),this._active_item=null},CoverUploadView.prototype.unloaded=function(){return this.clear_active_item(),CoverUploadView.__super__.unloaded.apply(this,arguments)},CoverUploadView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UpdateRoleView=function(superClass){function UpdateRoleView(){return UpdateRoleView.__super__.constructor.apply(this,arguments)}return extend(UpdateRoleView,superClass),UpdateRoleView.include(pi.BaseView.Loadable),UpdateRoleView.prototype.default_controller=pi.controllers.UpdateRole,UpdateRoleView.requires("select_field"),UpdateRoleView.prototype.loaded=function(params){return null==params&&(params={}),this.mode=params.mode||"select",UpdateRoleView.__super__.loaded.apply(this,arguments)},UpdateRoleView.prototype.unloaded=function(){return this.select_field.clear()},UpdateRoleView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MeetingEditView=function(superClass){function MeetingEditView(){return MeetingEditView.__super__.constructor.apply(this,arguments)}return extend(MeetingEditView,superClass),MeetingEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable,pi.BaseView.Coverable),MeetingEditView.requires("form"),MeetingEditView.prototype.default_controller=pi.controllers.MeetingEdit,MeetingEditView.prototype.postinitialize=function(){return MeetingEditView.__super__.postinitialize.apply(this,arguments),this.survey_field=this.find(".survey-field")},MeetingEditView.prototype.loaded=function(meeting1){var access_type,ref;if(this.meeting=meeting1,MeetingEditView.__super__.loaded.apply(this,arguments),null!=this.meeting)return this.form.value(this.meeting),this.form.cover.load(this.meeting.cover_url),this.form.bg.load(this.meeting.bg_url),this.load_participants(this.meeting),null!=(ref=this.form.survey)&&ref.restful.bind(this.meeting,!0),access_type=this.form.type_select.value(),this.handle_type_changed(access_type)},MeetingEditView.prototype.default_type=function(){return this.form.type_select.value(1)},MeetingEditView.prototype.handle_type_changed=function(type){var ref,ref1;if(type=parseInt(type),null!=(ref=this.survey_field)&&ref.hide(),this.form.link.hide(),this.form.show_link.hide(),this.form.create_link.hide(),this.form.widget_link.hide(),this.form.widget_orientation.hide(),this.form.widget_code.hide(),this.form.link.copy_txt.text(""),2!==type)return null!=(ref1=this.survey_field)&&ref1.show(),1===type&&this.form.widget_link.show(),this.meeting._persisted?(this.form.create_link.hide(),this.form.link.copy_txt.text(this.meeting.apply_url),this.form.link.show(),this.form.show_link.show()):(this.form.link.copy_txt.text(""),this.form.create_link.show())},MeetingEditView.prototype.participants_handler=function(){return this._participants_handler||(this._participants_handler=(_this=this,function(){var ref,ref1;return _this.meeting.participants().all().length?null!=(ref=_this.search_txt)?ref.show():void 0:null!=(ref1=_this.search_txt)?ref1.hide():void 0}));var _this},MeetingEditView.prototype.slug_updated=function(){return this.form.link.value(this.meeting.apply_url,this.meeting.slug),this.form.link.cancel()},MeetingEditView.prototype.load_participants=function(meeting){return this.list.restful.bind(meeting.participants(),!0),this.meeting.participants().on("update",this.participants_handler()),this.participants_handler()()},MeetingEditView.prototype.unloaded=function(){var ref;return MeetingEditView.__super__.unloaded.apply(this,arguments),this.meeting.participants().off("update",this.participants_handler()),this.form.clear(),this.form.enable(),null!=(ref=this.form.survey)&&ref.restful.bind(null),this.form.deactivate(),this.total_entries(0),this.list.restful.bind(null),this.list.clear()},MeetingEditView.prototype.show_widget_code=function(account_id,meeting_id){var code;return this.widget_params={host:this.form.widget_code.data().host,version:3,type:"meeting",account_id:account_id,resource_id:meeting_id,orientation:this.form.widget_orientation.value()},code=JST["templates/widget"]({params:this.widget_params}),this.form.widget_code.copy_txt.text(code),this.form.widget_link.hide(),this.form.widget_code.show(),this.form.widget_orientation.show()},MeetingEditView.prototype.update_orientation=function(data){var code;return this.widget_params.orientation=data,code=JST["templates/widget"]({params:this.widget_params}),this.form.widget_code.copy_txt.text(code)},MeetingEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MeetingsView=function(superClass){function MeetingsView(){return MeetingsView.__super__.constructor.apply(this,arguments)}return extend(MeetingsView,superClass),MeetingsView.prototype.default_controller=pi.controllers.Meetings,MeetingsView.prototype.filtered=function(){return utils.debug("filter data")},MeetingsView.alias("filter","filtered"),MeetingsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MeetingRecordingsView=function(superClass){function MeetingRecordingsView(){return MeetingRecordingsView.__super__.constructor.apply(this,arguments)}return extend(MeetingRecordingsView,superClass),MeetingRecordingsView.prototype.default_controller=pi.controllers.MeetingRecordings,MeetingRecordingsView.prototype.filtered=function(){return utils.debug("filter data")},MeetingRecordingsView.alias("filter","filtered"),MeetingRecordingsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MeetingSelectView=function(superClass){function MeetingSelectView(){return MeetingSelectView.__super__.constructor.apply(this,arguments)}return extend(MeetingSelectView,superClass),MeetingSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),MeetingSelectView.prototype.default_controller=pi.controllers.MeetingSelect,MeetingSelectView.prototype.loaded=function(){return MeetingSelectView.__super__.loaded.apply(this,arguments),this.list.scroll_end.enable()},MeetingSelectView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.scroll_end.disable(),MeetingSelectView.__super__.unloaded.apply(this,arguments)},MeetingSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MeetingShowView=function(superClass){function MeetingShowView(){return MeetingShowView.__super__.constructor.apply(this,arguments)}return extend(MeetingShowView,superClass),MeetingShowView.prototype.default_controller=pi.controllers.MeetingShow,MeetingShowView.prototype.filtered=function(){return utils.debug("filter data")},MeetingShowView.alias("filter","filtered"),MeetingShowView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickmeetingGuestLoginView=function(superClass){function ClickmeetingGuestLoginView(){return ClickmeetingGuestLoginView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingGuestLoginView,superClass),ClickmeetingGuestLoginView.include(pi.BaseView.Loadable),ClickmeetingGuestLoginView.prototype.default_controller=pi.controllers.ClickmeetingGuestLogin,ClickmeetingGuestLoginView.prototype.loaded=function(){return this.show()},ClickmeetingGuestLoginView.prototype.unloaded=function(){return this.hide()},ClickmeetingGuestLoginView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickmeetingRegisterView=function(superClass){function ClickmeetingRegisterView(){return ClickmeetingRegisterView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingRegisterView,superClass),ClickmeetingRegisterView.include(pi.BaseView.Loadable),ClickmeetingRegisterView.prototype.default_controller=pi.controllers.ClickmeetingRegister,ClickmeetingRegisterView.prototype.loaded=function(){return this.show()},ClickmeetingRegisterView.prototype.unloaded=function(){return this.hide()},ClickmeetingRegisterView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickmeetingApplyView=function(superClass){function ClickmeetingApplyView(){return ClickmeetingApplyView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingApplyView,superClass),ClickmeetingApplyView.prototype.default_controller=pi.controllers.ClickmeetingApply,ClickmeetingApplyView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickmeetingMeetingEditView=function(superClass){function ClickmeetingMeetingEditView(){return ClickmeetingMeetingEditView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingEditView,superClass),ClickmeetingMeetingEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable,pi.BaseView.Coverable),ClickmeetingMeetingEditView.requires("form"),ClickmeetingMeetingEditView.prototype.default_controller=pi.controllers.ClickmeetingMeetingEdit,ClickmeetingMeetingEditView.prototype.postinitialize=function(){return ClickmeetingMeetingEditView.__super__.postinitialize.apply(this,arguments),this.survey_field=this.find(".survey-field")},ClickmeetingMeetingEditView.prototype.loaded=function(meeting1){var ref;if(this.meeting=meeting1,ClickmeetingMeetingEditView.__super__.loaded.apply(this,arguments),null!=this.meeting)return this.form.value(this.meeting),this.form.cover.load(this.meeting.cover_url),this.form.bg.load(this.meeting.bg_url),this.load_participants(this.meeting),null!=(ref=this.form.survey)&&ref.restful.bind(this.meeting,!0),this.handle_type_changed(this.meeting.access_type),this.toggle_permanent(this.meeting.permanent_room),this.meeting.is_started()&&(this.form.date_time.disable(),this.form.duration.disable(),this.form.permanent_room.disable()),this.meeting.permanent_room?this.form.permanent_room.disable():void 0},ClickmeetingMeetingEditView.prototype.default_type=function(){return this.form.type_select.value(1)},ClickmeetingMeetingEditView.prototype.handle_type_changed=function(type){var ref,ref1;if(type=parseInt(type),null!=(ref=this.survey_field)&&ref.hide(),this.form.link.hide(),this.form.show_link.hide(),this.form.create_link.hide(),this.form.password.hide(),this.form.link.copy_txt.text(""),2===type&&this.form.password.show(),3!==type)return null!=(ref1=this.survey_field)&&ref1.show(),this.meeting._persisted?(this.form.create_link.hide(),this.form.link.copy_txt.text(this.meeting.apply_url),this.form.link.show(),this.form.show_link.show()):(this.form.link.copy_txt.text(""),this.form.create_link.show())},ClickmeetingMeetingEditView.prototype.participants_handler=function(){return this._participants_handler||(this._participants_handler=(_this=this,function(){var ref,ref1;return _this.meeting.participants().all().length?null!=(ref=_this.search_txt)?ref.show():void 0:null!=(ref1=_this.search_txt)?ref1.hide():void 0}));var _this},ClickmeetingMeetingEditView.prototype.toggle_permanent=function(permanent){return permanent?(this.form.date_time.disable(),this.form.duration.disable()):(this.form.date_time.enable(),this.form.duration.enable())},ClickmeetingMeetingEditView.prototype.slug_updated=function(){return this.form.link.value(this.meeting.apply_url,this.meeting.slug),this.form.link.cancel()},ClickmeetingMeetingEditView.prototype.load_participants=function(meeting){return this.list.restful.bind(meeting.participants(),!0),this.meeting.participants().on("update",this.participants_handler()),this.participants_handler()()},ClickmeetingMeetingEditView.prototype.unloaded=function(){return ClickmeetingMeetingEditView.__super__.unloaded.apply(this,arguments),this.meeting.participants().off("update",this.participants_handler()),this.form.clear(),this.form.enable(),this.form.deactivate(),this.total_entries(0),this.list.restful.bind(null),this.list.clear()},ClickmeetingMeetingEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ClickmeetingMeetingsView=function(superClass){function ClickmeetingMeetingsView(){return ClickmeetingMeetingsView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingsView,superClass),ClickmeetingMeetingsView.prototype.default_controller=pi.controllers.ClickmeetingMeetings,ClickmeetingMeetingsView.prototype.filtered=function(){return utils.debug("filter data")},ClickmeetingMeetingsView.alias("filter","filtered"),ClickmeetingMeetingsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickmeetingMeetingSelectView=function(superClass){function ClickmeetingMeetingSelectView(){return ClickmeetingMeetingSelectView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingSelectView,superClass),ClickmeetingMeetingSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ClickmeetingMeetingSelectView.prototype.default_controller=pi.controllers.ClickmeetingMeetingSelect,ClickmeetingMeetingSelectView.prototype.loaded=function(){return ClickmeetingMeetingSelectView.__super__.loaded.apply(this,arguments),this.list.scroll_end.enable()},ClickmeetingMeetingSelectView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.scroll_end.disable(),ClickmeetingMeetingSelectView.__super__.unloaded.apply(this,arguments)},ClickmeetingMeetingSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AgreementFormView=function(superClass){function AgreementFormView(){return AgreementFormView.__super__.constructor.apply(this,arguments)}return extend(AgreementFormView,superClass),AgreementFormView.include(pi.BaseView.Loadable),AgreementFormView.requires("list","personal_form","company_form"),AgreementFormView.prototype.default_controller=pi.controllers.AgreementForm,AgreementFormView.prototype.fill_form=function(){var item;if((item=this.list.selected_record())&&(this.form=this[item.type+"_form"],null!=this.form))return this.list.hide(),this.form.show()},AgreementFormView.prototype.choose_type=function(){var ref;return null!=(ref=this.form)&&ref.hide(),this.list.show()},AgreementFormView.prototype.unloaded=function(){var ref;return AgreementFormView.__super__.unloaded.apply(this,arguments),null!=(ref=this.form)&&ref.hide(),this.list.show(),this.list.clear_selection(),this.list.next_btn.disable()},AgreementFormView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.OrdersView=function(superClass){function OrdersView(){return OrdersView.__super__.constructor.apply(this,arguments)}return extend(OrdersView,superClass),OrdersView.include(pi.BaseView.Loadable),OrdersView.prototype.default_controller=pi.controllers.Orders,OrdersView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.PaymentFormView=function(superClass){function PaymentFormView(){return PaymentFormView.__super__.constructor.apply(this,arguments)}
return extend(PaymentFormView,superClass),PaymentFormView.requires("list"),PaymentFormView.prototype.default_controller=pi.controllers.PaymentForm,PaymentFormView.prototype.unloaded=function(){return PaymentFormView.__super__.unloaded.apply(this,arguments),this.list.clear_selection(),this.pay_btn.disable()},PaymentFormView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.OrderShowView=function(superClass){function OrderShowView(){return OrderShowView.__super__.constructor.apply(this,arguments)}return extend(OrderShowView,superClass),OrderShowView.prototype.default_controller=pi.controllers.OrderShow,OrderShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.SubscriptionBuyView=function(superClass){function SubscriptionBuyView(){return SubscriptionBuyView.__super__.constructor.apply(this,arguments)}return extend(SubscriptionBuyView,superClass),SubscriptionBuyView.include(pi.BaseView.Loadable),SubscriptionBuyView.requires("sub_info","nav","tariff_plan_list","active_users_list","memory_list","months_list","payment_types_list","promo"),SubscriptionBuyView.prototype.steps=["tariff_plan","active_users","memory","months","payment_types"],SubscriptionBuyView.prototype.default_controller=pi.controllers.SubscriptionBuy,SubscriptionBuyView.prototype.init=function(account,subscription,free_available){var _this;return this.account=account,this.subscription=subscription,this.free_available=null==free_available||free_available,this.sub_info.restful.bind(this.subscription,!0),this.subscription.tarrif_plan_id?this.step=this.steps.length-1:this.step=0,this.subscription.on("update",(_this=this,function(){return _this.subscription.tariff_plan()&&_this.subscription.active_users&&_this.subscription.memory&&_this.subscription.months&&_this.subscription.payment_type&&"payment_types"===_this.steps[_this.step]||_this.subscription.free?_this.addClass("is-payable"):_this.removeClass("is-payable"),_this.subscription.promo_code?_this.addClass("has-promo"):_this.removeClass("has-promo")})),this.draw_step()},SubscriptionBuyView.prototype.next_step=function(){if(this.step!==this.steps.length-1)return this.step++,this.draw_step()},SubscriptionBuyView.prototype.prev_step=function(){if(0!==this.step)return this.step--,this.draw_step()},SubscriptionBuyView.prototype.draw_step=function(){var list,name,ref,ref1,ref2,type;if(null!=(list=this[(type=this.steps[this.step])+"_list"]))return null!=(ref=this.active_list)&&ref.hide(),null!=(ref1=this.active_list)&&ref1.clear_selection(),null!=(ref2=this.active_list)&&ref2.off("selected",this.selected_handler()),this.active_list=list,"function"==typeof this[name="redraw_"+type+"_list"]&&this[name](),list.show(),this.update_nav()},SubscriptionBuyView.prototype.redraw_tariff_plan_list=function(){var _ref,i,item,len,ref,tariff,val;for(i=0,len=(ref=this.tariff_plan_list.items).length;i<len;i++)(tariff=(item=ref[i]).record).users_limit&&this.account.users_num>tariff.users_limit&&item.disable(),this.account.memory_gb>tariff.memory[tariff.memory.length-1]&&item.disable();if(val=this.subscription.tariff_plan_id)return(_ref=this.tariff_plan_list.where({record:{id:val}})).length?this.tariff_plan_list.select_item(_ref[0]):void 0},SubscriptionBuyView.prototype.redraw_active_users_list=function(){var _ref,data,i,len,num,ref,val;for(data=[],i=0,len=(ref=this.subscription.tariff_plan().active_users).length;i<len;i++)num=ref[i],data.push({value:num});if(this.active_users_list.data_provider(data),(val=this.subscription.active_users)&&(_ref=this.active_users_list.where({record:{value:val}})).length)return this.active_users_list.select_item(_ref[0])},SubscriptionBuyView.prototype.redraw_memory_list=function(){var _ref,data,i,item,j,len,len1,num,ref,ref1,results,val;for(data=[],i=0,len=(ref=this.subscription.tariff_plan().memory).length;i<len;i++)num=ref[i],data.push({value:num});for(this.memory_list.data_provider(data),(val=this.subscription.memory)&&(_ref=this.memory_list.where({record:{value:val}})).length&&this.memory_list.select_item(_ref[0]),results=[],j=0,len1=(ref1=this.memory_list.items).length;j<len1;j++)(item=ref1[j]).record.value<this.account.memory_gb&&results.push(item.disable());return results},SubscriptionBuyView.prototype.redraw_months_list=function(){var _ref,start_date,ts,val;return(val=this.subscription.months)&&(_ref=this.months_list.where({record:{value:val}})).length&&this.months_list.select_item(_ref[0]),ts=new Date(this.subscription.started_at_utc),start_date=utils.time.format(ts,"%Y-%m-%d"),this.months_list.form.value({started_at_date:start_date}),this.months_list.form.started_at.enable(),this.months_list.form.started_at.datepicker.setDate(ts)},SubscriptionBuyView.prototype.redraw_payment_types_list=function(){var _ref,val;return(val=this.subscription.payment_type)&&(_ref=this.payment_types_list.where({record:{value:val}})).length&&this.payment_types_list.select_item(_ref[0]),this.subscription.trigger("update")},SubscriptionBuyView.prototype.draw_agreement_form=function(){var item;if(item=this.payment_types_list.selected_record())return this.payment_types_list.agreement.renderable.render({type:item.value,account:this.account.settings})},SubscriptionBuyView.prototype.selected_form=function(){var item;if(item=this.payment_types_list.selected_record())return this.payment_types_list.agreement[item.value+"_form"]},SubscriptionBuyView.prototype.update_nav=function(){var ref;return this.step>0?this.nav.removeClass("no-back"):this.nav.addClass("no-back"),this.step===this.steps.length-1||!0===(null!=(ref=this.subscription.tariff_plan())?ref.free:void 0)?this.nav.addClass("no-next"):this.nav.removeClass("no-next"),0===this.active_list.selected_size()?(this.nav.next_btn.disable(),this.active_list.one("selected",this.selected_handler())):this.nav.next_btn.enable()},SubscriptionBuyView.prototype.selected_handler=function(){return this._selected_handler||(this._selected_handler=(_this=this,function(){return _this.nav.next_btn.enable()}));var _this},SubscriptionBuyView.prototype.unloaded=function(){var ref,ref1;return SubscriptionBuyView.__super__.unloaded.apply(this,arguments),null!=(ref=this.active_list)&&ref.hide(),null!=(ref1=this.active_list)&&ref1.clear_selection(),this.sub_info.restful.bind(null),this.promo.deactivate(),this.promo.form.clear(),this.subscription=null,this.payment_types_list.agreement.render(null),this.removeClass("is-payable")},SubscriptionBuyView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseTypesView=function(superClass){function CourseTypesView(){return CourseTypesView.__super__.constructor.apply(this,arguments)}return extend(CourseTypesView,superClass),CourseTypesView.prototype.default_controller=pi.controllers.CourseTypes,CourseTypesView.include(pi.BaseView.Loadable,pi.BaseView.Listable),CourseTypesView.prototype.loaded=function(params){var i,items,len,ref,ref1,type;if(null==params&&(params={}),CourseTypesView.__super__.loaded.apply(this,arguments),this.removeClass("is-readonly","is-selecting","is-updating"),this.mode=params.mode||"select","update"===this.mode)return this.list.selectable.type("check radio"),this.addClass("is-readonly","is-updating");if("select"===this.mode){if(this.list.selectable.type("check"),null!=(null!=(ref=params.course)?ref.types:void 0))for(i=0,len=(ref1=params.course.types).length;i<len;i++)type=ref1[i],(items=this.list.where({record:{id:type}})).length&&this.list.select_item(items[0]);return this.addClass("is-readonly","is-selecting")}},CourseTypesView.prototype.item_updated=function(){return this.list.finish_edit()},CourseTypesView.prototype.unloaded=function(){var i,len,ref;for(CourseTypesView.__super__.unloaded.apply(this,arguments),i=0,len=(ref=this.list.items).length;i<len;i++)ref[i].deactivate();return this.list.finish_edit(),this.list.clear_selection()},CourseTypesView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseSessionEditView=function(superClass){function CourseSessionEditView(){return CourseSessionEditView.__super__.constructor.apply(this,arguments)}return extend(CourseSessionEditView,superClass),CourseSessionEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable),CourseSessionEditView.requires("form"),CourseSessionEditView.prototype.default_controller=pi.controllers.CourseSessionEdit,CourseSessionEditView.prototype.postinitialize=function(){return CourseSessionEditView.__super__.postinitialize.apply(this,arguments),this.survey_field=this.find(".survey-field")},CourseSessionEditView.prototype.load_session=function(session1){var ref;if(this.session=session1,null!=this.session)return this.session._persisted&&this.disable_period_params(),this.form.value(this.session),this.list.restful.bind(null),this.form.demo_cb&&(this.session.demo_size>0?this.form.demo_cb.select():(this.form.demo.clear(),this.form.demo.disable())),this.session._persisted?this.removeClass("is-new"):this.addClass("is-new"),this.session.infinitely||this.session.finished?this.form.finished_at_field.disable():this.form.finished_at_field.enable(),this.load_participants(this.session),null!=(ref=this.form.survey)&&ref.restful.bind(this.session,!0),this.handle_type_changed(this.session.access_type),this.handle_nav_changed(this.session.navigation),this.form.options_field.interval.interval_st.value(this.session.section_opening_interval||1),this.form.period_days.disable()},CourseSessionEditView.prototype.handle_type_changed=function(type){var ref,ref1;if(null!=(ref=this.survey_field)&&ref.hide(),this.form.link.hide(),this.form.create_link.hide(),this.form.widget_link.hide(),this.form.widget_orientation.hide(),this.form.widget_code.hide(),this.form.landing_options_field.hide(),this.form.link.copy_txt.text(""),2!==type)return null!=(ref1=this.survey_field)&&ref1.show(),1===type&&this.form.widget_link.show(),this.session._persisted?(this.form.create_link.hide(),this.form.link.copy_txt.text(this.session.apply_url),this.form.link.show(),this.form.landing_options_field.show()):(this.form.link.copy_txt.text(""),this.form.create_link.show())},CourseSessionEditView.prototype.handle_infinite_changed=function(infinitely){if(!this.session.finished)return infinitely?this.form.finished_at_field.disable():this.form.finished_at_field.enable()},CourseSessionEditView.prototype.handle_nav_changed=function(nav){return nav===$r.CourseSession.INTERVAL_NAV?this.form.options_field.interval.show():this.form.options_field.interval.hide()},CourseSessionEditView.prototype.slug_updated=function(){return this.form.link.value(this.session.apply_url,this.session.slug),this.form.link.cancel()},CourseSessionEditView.prototype.unloaded=function(){var ref;return CourseSessionEditView.__super__.unloaded.apply(this,arguments),this.session.participants().off("update",this.participants_handler()),this.form.clear(),this.form.enable(),this.form.finished_at_field.enable(),this.form.started_at_field.enable(),this.form.infinite_cb.enable(),this.form.period_cb.enable(),this.form.period_days.enable(),this.form.options_field.deactivate(),null!=(ref=this.form.survey)&&ref.restful.bind(null),this.total_entries(0),this.list.restful.bind(null),this.list.clear()},CourseSessionEditView.prototype.participants_handler=function(){return this._participants_handler||(this._participants_handler=(_this=this,function(){var ref,ref1;return _this.session.participants().all().length?null!=(ref=_this.search_txt)?ref.show():void 0:null!=(ref1=_this.search_txt)?ref1.hide():void 0}));var _this},CourseSessionEditView.prototype.load_participants=function(session){return this.list.restful.bind(session.participants(),!0),session.participants().on("update",this.participants_handler()),this.participants_handler()()},CourseSessionEditView.prototype.show_widget_code=function(account_id,session_id){var code;return this.widget_params={host:this.form.widget_code.data().host,version:3,type:"course",account_id:account_id,resource_id:session_id,orientation:this.form.widget_orientation.value()},code=JST["templates/widget"]({params:this.widget_params}),this.form.widget_code.copy_txt.text(code),this.form.widget_link.hide(),this.form.widget_code.show(),this.form.widget_orientation.show()},CourseSessionEditView.prototype.update_orientation=function(data){var code;return this.widget_params.orientation=data,code=JST["templates/widget"]({params:this.widget_params}),this.form.widget_code.copy_txt.text(code)},CourseSessionEditView.prototype.enable_demo=function(data){return data?this.form.demo.enable():(this.form.demo.clear(),this.form.demo.disable())},CourseSessionEditView.prototype.enable_period=function(with_period){return with_period?(this.form.period_days.enable(),this.form.infinite_cb.disable(),this.form.started_at_field.disable(),this.form.finished_at_field.disable()):(this.form.period_days.disable(),this.form.infinite_cb.enable(),this.form.started_at_field.enable(),this.form.finished_at_field.enable(),this.form.period_days.clear())},CourseSessionEditView.prototype.disable_period_params=function(){return this.session.period&&(this.form.period_cb.select(),this.form.infinite_cb.disable(),this.form.started_at_field.disable(),this.form.finished_at_field.disable()),this.form.period_cb.disable(),this.form.period_days.disable()},CourseSessionEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseSessionsView=function(superClass){function CourseSessionsView(){return CourseSessionsView.__super__.constructor.apply(this,arguments)}return extend(CourseSessionsView,superClass),CourseSessionsView.prototype.default_controller=pi.controllers.CourseSessions,CourseSessionsView.include(pi.CourseTypesFilterView),CourseSessionsView.prototype.postinitialize=function(){return CourseSessionsView.__super__.postinitialize.apply(this,arguments),this.list_filter=this.find(".list-filter")},CourseSessionsView.prototype.filtered=function(data){var ref;if(data?hash.add({filter:data}):hash.remove("filter"),data)return(ref=this.list_filter.where({record:{type:data}})).length?this.list_filter.select_item(ref[0],!0):void 0},CourseSessionsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SessionSelectView=function(superClass){function SessionSelectView(){return SessionSelectView.__super__.constructor.apply(this,arguments)}return extend(SessionSelectView,superClass),SessionSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),SessionSelectView.prototype.default_controller=pi.controllers.SessionSelect,SessionSelectView.prototype.loaded=function(){return SessionSelectView.__super__.loaded.apply(this,arguments),this.list.scroll_end.enable()},SessionSelectView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.scroll_end.disable(),SessionSelectView.__super__.unloaded.apply(this,arguments)},SessionSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseSessionsSelectView=function(superClass){function CourseSessionsSelectView(){return CourseSessionsSelectView.__super__.constructor.apply(this,arguments)}return extend(CourseSessionsSelectView,superClass),CourseSessionsSelectView.include(pi.BaseView.Listable),CourseSessionsSelectView.prototype.default_controller=pi.controllers.CourseSessionsSelect,CourseSessionsSelectView.prototype.unloaded=function(){return CourseSessionsSelectView.__super__.unloaded.apply(this,arguments),this.list.clear_selection(),this.list.search("")},CourseSessionsSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseSessionPopupView=function(superClass){function CourseSessionPopupView(){return CourseSessionPopupView.__super__.constructor.apply(this,arguments)}return extend(CourseSessionPopupView,superClass),CourseSessionPopupView.include(pi.BaseView.Loadable,pi.BaseView.Listable),CourseSessionPopupView.prototype.default_controller=pi.controllers.CourseSessionShow,CourseSessionPopupView.prototype.unloaded=function(){return CourseSessionPopupView.__super__.unloaded.apply(this,arguments),this.list.clear(),this.search_txt.reset()},CourseSessionPopupView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AboutCourseView=function(superClass){function AboutCourseView(){return AboutCourseView.__super__.constructor.apply(this,arguments)}return extend(AboutCourseView,superClass),AboutCourseView.prototype.default_controller=pi.controllers.AboutCourse,AboutCourseView.prototype.load_participants=function(course){return this.list.restful.bind(course.participants(),!0)},AboutCourseView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseChatDiscussionAddView=function(superClass){function CourseChatDiscussionAddView(){return CourseChatDiscussionAddView.__super__.constructor.apply(this,arguments)}return extend(CourseChatDiscussionAddView,superClass),CourseChatDiscussionAddView.prototype.default_controller=pi.controllers.DiscussionChatEdit,CourseChatDiscussionAddView.requires("form"),CourseChatDiscussionAddView.include(pi.BaseView.Loadable),CourseChatDiscussionAddView.prototype.loaded=function(discussion){if(this.show(),CourseChatDiscussionAddView.__super__.loaded.apply(this,arguments),null!=discussion)return this.form.value(discussion)},CourseChatDiscussionAddView.prototype.unloaded=function(){return CourseChatDiscussionAddView.__super__.unloaded.apply(this,arguments),this.hide(),this.form.clear()},CourseChatDiscussionAddView.prototype.switched=function(){return this.hide()},CourseChatDiscussionAddView.prototype.reloaded=function(){return this.show()},CourseChatDiscussionAddView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseChatCommentsView=function(superClass){function CourseChatCommentsView(){return CourseChatCommentsView.__super__.constructor.apply(this,arguments)}return extend(CourseChatCommentsView,superClass),CourseChatCommentsView.prototype.default_controller=pi.controllers.DiscussionShow,CourseChatCommentsView.prototype.postinitialize=function(){return CourseChatCommentsView.__super__.postinitialize.apply(this,arguments),this.discussion=this.list.discussion,this.list=this.list.list},CourseChatCommentsView.prototype.loaded=function(discussion){return this.discussion.restful.bind(discussion,!0),this.show(),CourseChatCommentsView.__super__.loaded.apply(this,arguments)},CourseChatCommentsView.prototype.unloaded=function(){return CourseChatCommentsView.__super__.unloaded.apply(this,arguments),this.hide(),delete this.page_data,this.page_shift=0,this.discussion.restful.bind(null),this.list.clear()},CourseChatCommentsView.prototype.switched=function(){return this.hide(),this.discussion.restful.bind(null)},CourseChatCommentsView.prototype.reloaded=function(){return this.show()},CourseChatCommentsView}(pi.DiscussionShowView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseChatDiscussionsView=function(superClass){function CourseChatDiscussionsView(){return CourseChatDiscussionsView.__super__.constructor.apply(this,arguments)}return extend(CourseChatDiscussionsView,superClass),CourseChatDiscussionsView.prototype.default_controller=pi.controllers.Discussions,CourseChatDiscussionsView.prototype.postinitialize=function(){return CourseChatDiscussionsView.__super__.postinitialize.apply(this,arguments),this.list=this.list.list},CourseChatDiscussionsView.prototype.loaded=function(){return this.show(),CourseChatDiscussionsView.__super__.loaded.apply(this,arguments)},CourseChatDiscussionsView.prototype.unloaded=function(){return CourseChatDiscussionsView.__super__.unloaded.apply(this,arguments),this.hide(),this.list.clear()},CourseChatDiscussionsView.prototype.switched=function(){return this.hide()},CourseChatDiscussionsView.prototype.reloaded=function(){return this.show()},CourseChatDiscussionsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseChatView=function(superClass){function CourseChatView(){return CourseChatView.__super__.constructor.apply(this,arguments)}return extend(CourseChatView,superClass),CourseChatView.prototype.default_controller=pi.controllers.PopupDiscussions,CourseChatView}(pi.RightbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseCopyView=function(superClass){function CourseCopyView(){return CourseCopyView.__super__.constructor.apply(this,arguments)}return extend(CourseCopyView,superClass),CourseCopyView.prototype.default_controller=pi.controllers.CourseCopy,CourseCopyView.prototype.loaded=function(data){return this.form.value(data),CourseCopyView.__super__.loaded.apply(this,arguments)},CourseCopyView.prototype.unloaded=function(){return this.form.clear(),CourseCopyView.__super__.unloaded.apply(this,arguments)},CourseCopyView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseEditView=function(superClass){function CourseEditView(){return CourseEditView.__super__.constructor.apply(this,arguments)}return extend(CourseEditView,superClass),CourseEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable,pi.BaseView.Coverable),CourseEditView.requires("form"),CourseEditView.prototype.default_controller=pi.controllers.CourseEdit,CourseEditView.prototype.loaded=function(course){var duration;if(CourseEditView.__super__.loaded.apply(this,arguments),null!=course)return this.form.value(course),this.form.options_field.cover.load(course.cover_url),this.form.options_field.bg.load(course.bg_url),this.form.\u0441ertificates_field.cert_template.load(course.cert_template_url),this.form.authors.value(course.custom_author_names),this.load_participants(course),(duration=course.duration)&&(this.form.duration_st.value(duration),this.fill_string_duration(duration)),course.editorjs?this.block_description_editing():void 0},CourseEditView.prototype.load_participants=function(course){return this.list.restful.bind(course.participants(),!0)},CourseEditView.prototype.block_description_editing=function(){return this.form.not_editable.show(),this.form.disable()},CourseEditView.prototype.fill_duration_field=function(e){var i,j,key,len,len1,ref,ten_years,time,time_map,val,values;if(this.form.validate(),!this.form.duration_filter_st.hasClass("is-invalid")){for(time_map={d:86400,h:3600,m:60},time=0,i=0,len=(values=e.match(/([0-9]+(d|h|m))/gm)).length;i<len;i++)for(val=values[i],j=0,len1=(ref=Object.keys(time_map)).length;j<len1;j++)key=ref[j],val.includes(key)&&(time+=val.match(/[0-9]+/)[0]*time_map[key],delete time_map[key]);return time<=(ten_years=31536e4)?this.form.duration_st.value(time):this.form.duration_st.value(ten_years)}},CourseEditView.prototype.convert_time=function(seconds){var i,key,key_time,len,ref,time_format_map,time_map;for(time_map={d:86400,h:3600,m:60},time_format_map={},i=0,len=(ref=Object.keys(time_map)).length;i<len;i++)key=ref[i],0!==(key_time=Math.floor(seconds/time_map[key]))&&(time_format_map[key]=key_time),time_format_map[key]&&(seconds-=time_format_map[key]*time_map[key]);return time_format_map},CourseEditView.prototype.fill_string_duration=function(seconds){var i,key,len,ref,result,time_map;for(time_map=this.convert_time(seconds),result="",i=0,len=(ref=Object.keys(time_map)).length;i<len;i++)result+=""+time_map[key=ref[i]]+key+" ";return this.form.duration_filter_st.value(result.trim())},CourseEditView.prototype.unloaded=function(){return CourseEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.total_entries(0),this.form.options_field.deactivate(),this.form.\u0441ertificates_field.deactivate(),this.list.restful.bind(null),this.list.clear(),this.form.not_editable.hide(),this.form.enable()},CourseEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CoursesView=function(superClass){function CoursesView(){return CoursesView.__super__.constructor.apply(this,arguments)}return extend(CoursesView,superClass),CoursesView.prototype.default_controller=pi.controllers.Courses,CoursesView.include(pi.CourseTypesFilterView,pi.CompetencesFilterView),CoursesView.prototype.filtered=function(){return utils.debug("filter data")},CoursesView.alias("filter","filtered"),CoursesView.prototype.load_at=function(data){return null!=data&&this.list.add_item_at(data,0),this.list.update()},CoursesView.prototype.toggle_action_group=function(record){return!record.unchangeable&&!record.copyright_protected||pi.app.user.admin?this.action_group.show(record):this.action_group.hide()},CoursesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.OpenCoursesView=function(superClass){function OpenCoursesView(){return OpenCoursesView.__super__.constructor.apply(this,arguments)}return extend(OpenCoursesView,superClass),OpenCoursesView.prototype.default_controller=pi.controllers.OpenCourses,OpenCoursesView}(pi.CoursesView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CourseCourseSessionsView=function(superClass){function CourseCourseSessionsView(){return CourseCourseSessionsView.__super__.constructor.apply(this,arguments)}return extend(CourseCourseSessionsView,superClass),CourseCourseSessionsView.prototype.default_controller=pi.controllers.CourseCourseSessions,CourseCourseSessionsView.prototype.filtered=function(){return utils.debug("filter data")},CourseCourseSessionsView.alias("filter","filtered"),CourseCourseSessionsView}(pi.ListView)}(this)}.call(this),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SimpleMDE=e()}}(function(){var e;return function t(e,n,r){function i(a,l){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return i(n||t)},u,u.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";function r(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;n>t;++t)s[t]=e[t],c[e.charCodeAt(t)]=t;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63}function i(e){var t,n,r,i,o,a,l=e.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[l-2]?2:"="===e[l-1]?1:0,a=new u(3*l/4-o),r=o>0?l-4:l;var s=0;for(t=0,n=0;r>t;t+=4,n+=3)i=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],a[s++]=i>>16&255,a[s++]=i>>8&255,a[s++]=255&i;return 2===o?(i=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,a[s++]=255&i):1===o&&(i=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,a[s++]=i>>8&255,a[s++]=255&i),a}function o(e){return s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e]}function a(e,t,n){for(var r,i=[],a=t;n>a;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(r));return i.join("")}function l(e){for(var t,n=e.length,r=n%3,i="",o=[],l=16383,c=0,u=n-r;u>c;c+=l)o.push(a(e,c,c+l>u?u:c+l));return 1===r?(t=e[n-1],i+=s[t>>2],i+=s[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],
i+=s[t>>10],i+=s[t>>4&63],i+=s[t<<2&63],i+="="),o.push(i),o.join("")}n.toByteArray=i,n.fromByteArray=l;var s=[],c=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array;r()},{}],2:[function(){},{}],3:[function(e,t,n){(function(t){"use strict";function r(){try{var e=new Uint8Array(1);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}function i(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(i()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=a.prototype:(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?f(e,t,n):p(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number')}function c(e,t,n,r){return s(t),0>=t?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function u(e,t){if(s(t),e=o(e,0>t?0:0|m(t)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;t>n;n++)e[n]=0;return e}function f(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');return(e=o(e,0|v(t,n))).write(t,n),e}function h(e,t){var n=0|m(t.length);e=o(e,n);for(var r=0;n>r;r+=1)e[r]=255&t[r];return e}function d(e,t,n,r){if(t.byteLength,0>n||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),a.TYPED_ARRAY_SUPPORT?(e=t).__proto__=a.prototype:e=h(e,t),e}function p(e,t){if(a.isBuffer(t)){var n=0|m(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||K(t.length)?o(e,0):h(e,t);if("Buffer"===t.type&&J(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function m(e){if(e>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),a.alloc(+e)}function v(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(r)return q(e).length;t=(""+t).toLowerCase(),r=!0}}function y(e,t,n){var r=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),0>=n)return"";if((t>>>=0)>=(n>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return N(this,t,n);case"ascii":return E(this,t,n);case"binary":return O(this,t,n);case"base64":return M(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function x(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r){function i(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}var o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,n/=2}for(var s=-1,c=0;a>n+c;c++)if(i(e,n+c)===i(t,-1===s?0:c-s)){if(-1===s&&(s=c),c-s+1===l)return(n+s)*o}else-1!==s&&(c-=c-s),s=-1;return-1}function w(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;r>a;a++){var l=parseInt(t.substr(2*a,2),16);if(isNaN(l))return a;e[n+a]=l}return a}function k(e,t,n,r){return V(q(t,e.length-n),e,n,r)}function S(e,t,n,r){return V(G(t),e,n,r)}function C(e,t,n,r){return S(e,t,n,r)}function L(e,t,n,r){return V($(t),e,n,r)}function T(e,t,n,r){return V(Y(t,e.length-n),e,n,r)}function M(e,t,n){return 0===t&&n===e.length?X.fromByteArray(e):X.fromByteArray(e.slice(t,n))}function N(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;n>i;){var s,c,u,f,o=e[i],a=null,l=o>239?4:o>223?3:o>191?2:1;if(n>=i+l)switch(l){case 1:128>o&&(a=o);break;case 2:128==(192&(s=e[i+1]))&&((f=(31&o)<<6|63&s)>127&&(a=f));break;case 3:s=e[i+1],c=e[i+2],128==(192&s)&&128==(192&c)&&((f=(15&o)<<12|(63&s)<<6|63&c)>2047&&(55296>f||f>57343)&&(a=f));break;case 4:s=e[i+1],c=e[i+2],u=e[i+3],128==(192&s)&&128==(192&c)&&128==(192&u)&&((f=(15&o)<<18|(63&s)<<12|(63&c)<<6|63&u)>65535&&1114112>f&&(a=f))}null===a?(a=65533,l=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),i+=l}return A(r)}function A(e){var t=e.length;if(Q>=t)return String.fromCharCode.apply(String,e);for(var n="",r=0;t>r;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Q));return n}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(127&e[i]);return r}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;n>i;i++)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||0>t)&&(t=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=t;n>o;o++)i+=U(e[o]);return i}function P(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||0>e)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||o>t)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function H(e,t,n,r){0>t&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);o>i;i++)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function W(e,t,n,r){0>t&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);o>i;i++)e[n+i]=t>>>8*(r?i:3-i)&255}function B(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function _(e,t,n,r,i){return i||B(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,i){return i||B(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,n,r,52,8),n+8}function z(e){if((e=j(e).replace(ee,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function j(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function U(e){return 16>e?"0"+e.toString(16):e.toString(16)}function q(e,t){t=t||1/0;for(var n,r=e.length,i=null,o=[],a=0;r>a;a++){if((n=e.charCodeAt(a))>55295&&57344>n){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(56320>n){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,128>n){if((t-=1)<0)break;o.push(n)}else if(2048>n){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function Y(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);a++)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}function $(e){return X.toByteArray(z(e))}function V(e,t,n,r){for(var i=0;r>i&&!(i+n>=t.length||i>=e.length);i++)t[i+n]=e[i];return i}function K(e){return e!=e}var X=e("base64-js"),Z=e("ieee754"),J=e("isarray");n.Buffer=a,n.SlowBuffer=g,n.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),n.kMaxLength=i(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,n){return l(null,e,t,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,n){return c(null,e,t,n)},a.allocUnsafe=function(e){return u(null,e)},a.allocUnsafeSlow=function(e){return u(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);o>i;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return r>n?-1:n>r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!J(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;n++)t+=e[n].length;var r=a.allocUnsafe(t),i=0;for(n=0;n<e.length;n++){var o=e[n];if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;e>t;t+=2)x(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;e>t;t+=4)x(this,t,t+3),x(this,t+1,t+2);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?N(this,0,e):y.apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,n,r,i){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),0>t||n>e.length||0>r||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),l=(n>>>=0)-(t>>>=0),s=Math.min(o,l),c=this.slice(r,i),u=e.slice(t,n),f=0;s>f;++f)if(c[f]!==u[f]){o=c[f],l=u[f];break}return l>o?-1:o>l?1:0},a.prototype.indexOf=function(e,t,n){if("string"==typeof t?(n=t,t=0):t>2147483647?t=2147483647:-2147483648>t&&(t=-2147483648),t>>=0,0===this.length)return-1;if(t>=this.length)return-1;if(0>t&&(t=Math.max(this.length+t,0)),"string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:b(this,e,t,n);if("number"==typeof e)return a.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,t):b(this,[e],t,n);throw new TypeError("val must be string, number or Buffer")},a.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},a.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(0>n||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return k(this,e,t,n);case"ascii":return S(this,e,t,n);case"binary":return C(this,e,t,n);case"base64":return L(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;a.prototype.slice=function(e,t){var r,n=this.length;if(0>(e=~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),0>(t=void 0===t?n:~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),e>t&&(t=e),a.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=a.prototype;else{var i=t-e;r=new a(i,void 0);for(var o=0;i>o;o++)r[o]=this[o+e]}return r},a.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},a.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},a.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},a.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),Z.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),Z.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),Z.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),Z.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,a=0;for(this[t]=255&e;++a<n&&(o*=256);)this[t+a]=e/o&255;return t+n},a.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,a=1;for(this[t+o]=255&e;--o>=0&&(a*=256);)this[t+o]=e/a&255;return t+n},a.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):H(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):H(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):W(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):W(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=0,a=1,l=0;for(this[t]=255&e;++o<n&&(a*=256);)0>e&&0===l&&0!==this[t+o-1]&&(l=1),this[t+o]=(e/a>>0)-l&255;return t+n},a.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);D(this,e,t,n,i-1,-i)}var o=n-1,a=1,l=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)0>e&&0===l&&0!==this[t+o+1]&&(l=1),this[t+o]=(e/a>>0)-l&255;return t+n},a.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):H(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):H(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):W(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):W(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,n){return _(this,e,t,!0,n)},a.prototype.writeFloatBE=function(e,t,n){return _(this,e,t,!1,n)},a.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},a.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},a.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&n>r&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>r)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&t>n&&r>t)for(i=o-1;i>=0;i--)e[i+t]=this[i+n];else if(1e3>o||!a.TYPED_ARRAY_SUPPORT)for(i=0;o>i;i++)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},a.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);256>i&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<n)throw new RangeError("Out of range index");if(t>=n)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;n>o;o++)this[o]=e;else{var l=a.isBuffer(e)?e:q(new a(e,r).toString()),s=l.length;for(o=0;n-t>o;o++)this[o+t]=l[o%s]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:15,isarray:16}],4:[function(e,t){"use strict";function r(e){return"function"!=typeof(e=e||{}).codeMirrorInstance||"function"!=typeof e.codeMirrorInstance.defineMode?void console.log("CodeMirror Spell Checker: You must provide an instance of CodeMirror via the option `codeMirrorInstance`"):(String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),void e.codeMirrorInstance.defineMode("spell-checker",function(t){if(!r.aff_loading){r.aff_loading=!0;var n=new XMLHttpRequest;n.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.aff",!0),n.onload=function(){4===n.readyState&&200===n.status&&(r.aff_data=n.responseText,r.num_loaded++,2==r.num_loaded&&(r.typo=new i("en_US",r.aff_data,r.dic_data,{platform:"any"})))},n.send(null)}if(!r.dic_loading){r.dic_loading=!0;var o=new XMLHttpRequest;o.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.dic",!0),o.onload=function(){4===o.readyState&&200===o.status&&(r.dic_data=o.responseText,r.num_loaded++,2==r.num_loaded&&(r.typo=new i("en_US",r.aff_data,r.dic_data,{platform:"any"})))},o.send(null)}var a='!"#$%&()*+,-./:;<=>?@[\\]^_`{|}~ ',l={token:function(e){var t=e.peek(),n="";if(a.includes(t))return e.next(),null;for(;null!=(t=e.peek())&&!a.includes(t);)n+=t,e.next();return r.typo&&!r.typo.check(n)?"spell-error":null}},s=e.codeMirrorInstance.getMode(t,t.backdrop||"text/plain");return e.codeMirrorInstance.overlayMode(s,l,!0)}))}var i=e("typo-js");r.num_loaded=0,r.aff_loading=!1,r.dic_loading=!1,r.aff_data="",r.dic_data="",r.typo,t.exports=r},{"typo-js":18}],5:[function(t,n,r){var i;i=function(e){"use strict";function t(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}function n(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var n=e.state.fullScreenRestore;t.style.width=n.width,t.style.height=n.height,window.scrollTo(n.scrollLeft,n.scrollTop),e.refresh()}e.defineOption("fullScreen",!1,function(r,i,o){o==e.Init&&(o=!1),!o!=!i&&(i?t(r):n(r))})},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],6:[function(t,n,r){var i;i=function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.className="CodeMirror-placeholder";var r=e.getOption("placeholder");"string"==typeof r&&(r=document.createTextNode(r)),n.appendChild(r),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function r(e){o(e)&&n(e)}function i(e){var r=e.getWrapperElement(),i=o(e);r.className=r.className.replace(" CodeMirror-empty","")+(i?" CodeMirror-empty":""),i?n(e):t(e)}function o(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(n,o,a){var l=a&&a!=e.Init;if(o&&!l)n.on("blur",r),n.on("change",i),n.on("swapDoc",i),i(n);else if(!o&&l){n.off("blur",r),n.off("change",i),n.off("swapDoc",i),t(n);var s=n.getWrapperElement();s.className=s.className.replace(" CodeMirror-empty","")}o&&!n.hasFocus()&&r(n)})},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],7:[function(t,n,r){var i;i=function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,r=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(i){if(i.getOption("disableInput"))return e.Pass;for(var o=i.listSelections(),a=[],l=0;l<o.length;l++){var s=o[l].head,c=i.getStateAfter(s.line),u=!1!==c.list,f=0!==c.quote,h=i.getLine(s.line),d=t.exec(h);if(!o[l].empty()||!u&&!f||!d)return void i.execCommand("newlineAndIndent");if(n.test(h))i.replaceRange("",{line:s.line,ch:0},{line:s.line,ch:s.ch+1}),a[l]="\n";else{var p=d[1],m=d[5],g=r.test(d[2])||d[2].indexOf(">")>=0?d[2]:parseInt(d[3],10)+1+d[4];a[l]="\n"+p+g+m}}i.replaceSelections(a)}},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],8:[function(t,n,r){var i;i=function(e){"use strict";e.overlayMode=function(t,n,r){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(r){return{base:e.copyState(t,r.base),overlay:e.copyState(n,r.overlay),basePos:r.basePos,baseCur:null,overlayPos:r.overlayPos,overlayCur:null}},token:function(e,i){return(e!=i.streamSeen||Math.min(i.basePos,i.overlayPos)<e.start)&&(i.streamSeen=e,i.basePos=i.overlayPos=e.start),e.start==i.basePos&&(i.baseCur=t.token(e,i.base),i.basePos=e.pos),e.start==i.overlayPos&&(e.pos=e.start,i.overlayCur=n.token(e,i.overlay),i.overlayPos=e.pos),e.pos=Math.min(i.basePos,i.overlayPos),null==i.overlayCur?i.baseCur:null!=i.baseCur&&i.overlay.combineTokens||r&&null==i.overlay.combineTokens?i.baseCur+" "+i.overlayCur:i.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],9:[function(t,n,r){var i;i=function(e){"use strict";function t(e){e.operation(function(){a(e)})}function n(e){e.state.markedSelection.length&&e.operation(function(){i(e)})}function r(e,t,n,r){if(0!=c(t,n))for(var i=e.state.markedSelection,o=e.state.markedSelectionStyle,a=t.line;;){var u=a==t.line?t:s(a,0),f=a+l,h=f>=n.line,d=h?n:s(f,0),p=e.markText(u,d,{className:o});if(null==r?i.push(p):i.splice(r++,0,p),h)break;a=f}}function i(e){for(var t=e.state.markedSelection,n=0;n<t.length;++n)t[n].clear();t.length=0}function o(e){i(e);for(var t=e.listSelections(),n=0;n<t.length;n++)r(e,t[n].from(),t[n].to())}function a(e){if(!e.somethingSelected())return i(e);if(e.listSelections().length>1)return o(e);var t=e.getCursor("start"),n=e.getCursor("end"),a=e.state.markedSelection;if(!a.length)return r(e,t,n);var s=a[0].find(),u=a[a.length-1].find();if(!s||!u||n.line-t.line<l||c(t,u.to)>=0||c(n,s.from)<=0)return o(e);for(;c(t,s.from)>0;)a.shift().clear(),s=a[0].find();for(c(t,s.from)<0&&(s.to.line-t.line<l?(a.shift().clear(),r(e,t,s.to,0)):r(e,t,s.from,0));c(n,u.to)<0;)a.pop().clear(),u=a[a.length-1].find();c(n,u.to)>0&&(n.line-u.from.line<l?(a.pop().clear(),r(e,u.from,n)):r(e,u.to,n))}e.defineOption("styleSelectedText",!1,function(r,a,l){var s=l&&l!=e.Init;a&&!s?(r.state.markedSelection=[],r.state.markedSelectionStyle="string"==typeof a?a:"CodeMirror-selectedtext",o(r),r.on("cursorActivity",t),r.on("change",n)):!a&&s&&(r.off("cursorActivity",t),r.off("change",n),i(r),r.state.markedSelection=r.state.markedSelectionStyle=null)});var l=8,s=e.Pos,c=e.cmpPos},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],10:[function(t,n,r){!function(t){if("object"==typeof r&&"object"==typeof n)n.exports=t();else{if("function"==typeof e&&e.amd)return e([],t);(this||window).CodeMirror=t()}}(function(){"use strict";function e(n,r){if(!(this instanceof e))return new e(n,r);this.options=r=r?Wi(r):{},Wi(ea,r,!1),d(r);var i=r.value;"string"==typeof i&&(i=new Ca(i,r.mode,null,r.lineSeparator)),this.doc=i;var o=new e.inputStyles[r.inputStyle](this),a=this.display=new t(n,i,o);a.wrapper.CodeMirror=this,c(this),l(this),r.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),r.autofocus&&!Ao&&a.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Ei,keySeq:null,specialChars:null};var s=this;for(var u in xo&&11>bo&&setTimeout(function(){s.display.input.reset(!0)},20),jt(this),Ki(),bt(this),this.curOp.forceUpdate=!0,Xr(this,i),r.autofocus&&!Ao||s.hasFocus()?setTimeout(Bi(vn,this),20):yn(this),ta)ta.hasOwnProperty(u)&&ta[u](this,r[u],na);k(this),r.finishInit&&r.finishInit(this);for(var f=0;f<aa.length;++f)aa[f](this);kt(this),wo&&r.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function t(e,t,n){var r=this;this.input=n,r.scrollbarFiller=ji("div",null,"CodeMirror-scrollbar-filler"),r.scrollbarFiller.setAttribute("cm-not-content","true"),r.gutterFiller=ji("div",null,"CodeMirror-gutter-filler"),r.gutterFiller.setAttribute("cm-not-content","true"),r.lineDiv=ji("div",null,"CodeMirror-code"),r.selectionDiv=ji("div",null,null,"position: relative; z-index: 1"),r.cursorDiv=ji("div",null,"CodeMirror-cursors"),r.measure=ji("div",null,"CodeMirror-measure"),r.lineMeasure=ji("div",null,"CodeMirror-measure"),r.lineSpace=ji("div",[r.measure,r.lineMeasure,r.selectionDiv,r.cursorDiv,r.lineDiv],null,"position: relative; outline: none"),r.mover=ji("div",[ji("div",[r.lineSpace],"CodeMirror-lines")],null,"position: relative"),r.sizer=ji("div",[r.mover],"CodeMirror-sizer"),r.sizerWidth=null,r.heightForcer=ji("div",null,null,"position: absolute; height: "+Da+"px; width: 1px;"),r.gutters=ji("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=ji("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=ji("div",[r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),xo&&8>bo&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0),wo||go&&Ao||(r.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(r.wrapper):e(r.wrapper)),r.viewFrom=r.viewTo=t.first,r.reportedViewFrom=r.reportedViewTo=t.first,r.view=[],r.renderedView=null,r.externalMeasured=null,r.viewOffset=0,r.lastWrapHeight=r.lastWrapWidth=0,r.updateLineNumbers=null,r.nativeBarWidth=r.barHeight=r.barWidth=0,r.scrollbarsClipped=!1,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.alignWidgets=!1,r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r.shift=!1,r.selForContextMenu=null,r.activeTouch=null,n.init(r)}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),r(t)}function r(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,_e(e,100),e.state.modeGen++,e.curOp&&Dt(e)}function i(e){e.options.lineWrapping?(Ja(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Za(e.display.wrapper,"CodeMirror-wrap"),h(e)),a(e),Dt(e),lt(e),setTimeout(function(){y(e)},100)}function o(e){var t=yt(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/xt(e.display)-3);return function(i){if(kr(e.doc,i))return 0;var o=0;if(i.widgets)for(var a=0;a<i.widgets.length;a++)i.widgets[a].height&&(o+=i.widgets[a].height);return n?o+(Math.ceil(i.text.length/r)||1)*t:o+t}}function a(e){var t=e.doc,n=o(e);t.iter(function(e){var t=n(e);t!=e.height&&ei(e,t)})}function l(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),lt(e)}function s(e){c(e),Dt(e),setTimeout(function(){w(e)},20)}function c(e){var t=e.display.gutters,n=e.options.gutters;Ui(t);for(var r=0;r<n.length;++r){var i=n[r],o=t.appendChild(ji("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none",u(e)}function u(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function f(e){if(0==e.height)return 0;for(var t,n=e.text.length,r=e;t=mr(r);){r=(i=t.find(0,!0)).from.line,n+=i.from.ch-i.to.ch}for(r=e;t=gr(r);){var i=t.find(0,!0);n-=r.text.length-i.from.ch,n+=(r=i.to.line).text.length-i.to.ch}return n}function h(e){var t=e.display,n=e.doc;t.maxLine=Zr(n,n.first),t.maxLineLength=f(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=f(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function d(e){var t=Pi(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function p(e){var t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+qe(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+Ye(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function m(e,t,n){this.cm=n
;var r=this.vert=ji("div",[ji("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),i=this.horiz=ji("div",[ji("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(r),e(i),Ea(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),Ea(i,"scroll",function(){i.clientWidth&&t(i.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,xo&&8>bo&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Za(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Ea(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,n){"horizontal"==n?on(t,e):rn(t,e)},t),t.display.scrollbars.addClass&&Ja(t.display.wrapper,t.display.scrollbars.addClass)}function y(e,t){t||(t=p(e));var n=e.display.barWidth,r=e.display.barHeight;x(e,t);for(var i=0;4>i&&n!=e.display.barWidth||r!=e.display.barHeight;i++)n!=e.display.barWidth&&e.options.lineWrapping&&O(e),x(e,p(e)),n=e.display.barWidth,r=e.display.barHeight}function x(e,t){var n=e.display,r=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=r.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=r.bottom)+"px",n.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=r.bottom+"px",n.scrollbarFiller.style.width=r.right+"px"):n.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=r.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function b(e,t,n){var r=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;r=Math.floor(r-Ue(e));var i=n&&null!=n.bottom?n.bottom:r+e.wrapper.clientHeight,o=ni(t,r),a=ni(t,i);if(n&&n.ensure){var l=n.ensure.from.line,s=n.ensure.to.line;o>l?(o=l,a=ni(t,ri(Zr(t,l))+e.wrapper.clientHeight)):Math.min(s,t.lastLine())>=a&&(o=ni(t,ri(Zr(t,s))-e.wrapper.clientHeight),a=s)}return{from:o,to:Math.max(a,o+1)}}function w(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var r=C(t)-t.scroller.scrollLeft+e.doc.scrollLeft,i=t.gutters.offsetWidth,o=r+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=o);var l=n[a].alignable;if(l)for(var s=0;s<l.length;s++)l[s].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=r+i+"px")}}function k(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=S(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(ji("div",[ji("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=i.firstChild.offsetWidth,a=i.offsetWidth-o;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(o,r.lineGutter.offsetWidth-a)+1,r.lineNumWidth=r.lineNumInnerWidth+a,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",u(e),!0}return!1}function S(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function C(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function L(e,t,n){var r=e.display;this.viewport=t,this.visible=b(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=$e(e),this.force=n,this.dims=P(e),this.events=[]}function T(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ye(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ye(e)+"px",t.scrollbarsClipped=!0)}function M(e,t){var n=e.display,r=e.doc;if(t.editorIsHidden)return Wt(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==zt(e))return!1;k(e)&&(Wt(e),t.dims=P(e));var i=r.first+r.size,o=Math.max(t.visible.from-e.options.viewportMargin,r.first),a=Math.min(i,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(r.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(i,n.viewTo)),Wo&&(o=br(e.doc,o),a=wr(e.doc,a));var l=o!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Ft(e,o,a),n.viewOffset=ri(Zr(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var s=zt(e);if(!l&&0==s&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=Gi();return s>4&&(n.lineDiv.style.display="none"),R(e,n.updateLineNumbers,t.dims),s>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,c&&Gi()!=c&&c.offsetHeight&&c.focus(),Ui(n.cursorDiv),Ui(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,l&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,_e(e,400)),n.updateLineNumbers=null,!0}function N(e,t){for(var n=t.viewport,r=!0;(r&&e.options.lineWrapping&&t.oldDisplayWidth!=$e(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+qe(e.display)-Ve(e),n.top)}),t.visible=b(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&M(e,t);r=!1){O(e);var i=p(e);Re(e),y(e,i),E(e,i)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function A(e,t){var n=new L(e,t);if(M(e,n)){O(e),N(e,n);var r=p(e);Re(e),y(e,r),E(e,r),n.finish()}}function E(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ye(e)+"px"}function O(e){for(var t=e.display,n=t.lineDiv.offsetTop,r=0;r<t.view.length;r++){var i,o=t.view[r];if(!o.hidden){if(xo&&8>bo){var a=o.node.offsetTop+o.node.offsetHeight;i=a-n,n=a}else{var l=o.node.getBoundingClientRect();i=l.bottom-l.top}var s=o.line.height-i;if(2>i&&(i=yt(t)),(s>.001||-.001>s)&&(ei(o.line,i),I(o.line),o.rest))for(var c=0;c<o.rest.length;c++)I(o.rest[c])}}}function I(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function P(e){for(var t=e.display,n={},r={},i=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+i,r[e.options.gutters[a]]=o.clientWidth;return{fixedPos:C(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function R(e,t,n){function r(t){var n=t.nextSibling;return wo&&Eo&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var i=e.display,o=e.options.lineNumbers,a=i.lineDiv,l=a.firstChild,s=i.view,c=i.viewFrom,u=0;u<s.length;u++){var f=s[u];if(f.hidden);else if(f.node&&f.node.parentNode==a){for(;l!=f.node;)l=r(l);var h=o&&null!=t&&c>=t&&f.lineNumber;f.changes&&(Pi(f.changes,"gutter")>-1&&(h=!1),D(e,f,c,n)),h&&(Ui(f.lineNumber),f.lineNumber.appendChild(document.createTextNode(S(e.options,c)))),l=f.node.nextSibling}else{var d=U(e,f,c,n);a.insertBefore(d,l)}c+=f.size}for(;l;)l=r(l)}function D(e,t,n,r){for(var i=0;i<t.changes.length;i++){var o=t.changes[i];"text"==o?_(e,t):"gutter"==o?z(e,t,n,r):"class"==o?F(t):"widget"==o&&j(e,t,r)}t.changes=null}function H(e){return e.node==e.text&&(e.node=ji("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),xo&&8>bo&&(e.node.style.zIndex=2)),e.node}function W(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=H(e);e.background=n.insertBefore(ji("div",null,t),n.firstChild)}}function B(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Br(e,t)}function _(e,t){var n=t.text.className,r=B(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,F(t)):n&&(t.text.className=n)}function F(e){W(e),e.line.wrapClass?H(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function z(e,t,n,r){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var i=H(t);t.gutterBackground=ji("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),i.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){i=H(t);var a=t.gutter=ji("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(e.display.input.setUneditable(a),i.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(ji("div",S(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<e.options.gutters.length;++l){var s=e.options.gutters[l],c=o.hasOwnProperty(s)&&o[s];c&&a.appendChild(ji("div",[c],"CodeMirror-gutter-elt","left: "+r.gutterLeft[s]+"px; width: "+r.gutterWidth[s]+"px"))}}}function j(e,t,n){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild;i;i=r){var r=i.nextSibling;"CodeMirror-linewidget"==i.className&&t.node.removeChild(i)}q(e,t,n)}function U(e,t,n,r){var i=B(e,t);return t.text=t.node=i.pre,i.bgClass&&(t.bgClass=i.bgClass),i.textClass&&(t.textClass=i.textClass),F(t),z(e,t,n,r),q(e,t,r),t.node}function q(e,t,n){if(G(e,t.line,t,n,!0),t.rest)for(var r=0;r<t.rest.length;r++)G(e,t.rest[r],t,n,!1)}function G(e,t,n,r,i){if(t.widgets)for(var o=H(n),a=0,l=t.widgets;a<l.length;++a){var s=l[a],c=ji("div",[s.node],"CodeMirror-linewidget");s.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),Y(s,c,n,r),e.display.input.setUneditable(c),i&&s.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),Ci(s,"redraw")}}function Y(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function $(e){return Bo(e.line,e.ch)}function V(e,t){return _o(e,t)<0?t:e}function K(e,t){return _o(e,t)<0?e:t}function X(e){e.state.focused||(e.display.input.focus(),vn(e))}function Z(e,t,n,r,i){var o=e.doc;e.display.shift=!1,r||(r=o.sel);var a=e.state.pasteIncoming||"paste"==i,l=o.splitLines(t),s=null;if(a&&r.ranges.length>1)if(Fo&&Fo.text.join("\n")==t){if(r.ranges.length%Fo.text.length==0){s=[];for(var c=0;c<Fo.text.length;c++)s.push(o.splitLines(Fo.text[c]))}}else l.length==r.ranges.length&&(s=Ri(l,function(e){return[e]}));for(c=r.ranges.length-1;c>=0;c--){var u=r.ranges[c],f=u.from(),h=u.to();u.empty()&&(n&&n>0?f=Bo(f.line,f.ch-n):e.state.overwrite&&!a?h=Bo(h.line,Math.min(Zr(o,h.line).text.length,h.ch+Ii(l).length)):Fo&&Fo.lineWise&&Fo.text.join("\n")==t&&(f=h=Bo(f.line,0)));var d=e.curOp.updateInput,p={from:f,to:h,text:s?s[c%s.length]:l,origin:i||(a?"paste":e.state.cutIncoming?"cut":"+input")};Tn(e.doc,p),Ci(e,"inputRead",e,p)}t&&!a&&Q(e,t),Bn(e),e.curOp.updateInput=d,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function J(e,t){var n=e.clipboardData&&e.clipboardData.getData("text/plain");return n?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||At(t,function(){Z(t,n,0,null,"paste")}),!0):void 0}function Q(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,r=n.ranges.length-1;r>=0;r--){var i=n.ranges[r];if(!(i.head.ch>100||r&&n.ranges[r-1].head.line==i.head.line)){var o=e.getModeAt(i.head),a=!1;if(o.electricChars){for(var l=0;l<o.electricChars.length;l++)if(t.indexOf(o.electricChars.charAt(l))>-1){a=Fn(e,i.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Zr(e.doc,i.head.line).text.slice(0,i.head.ch))&&(a=Fn(e,i.head.line,"smart"));a&&Ci(e,"electricInput",e,i.head.line)}}}function ee(e){for(var t=[],n=[],r=0;r<e.doc.sel.ranges.length;r++){var i=e.doc.sel.ranges[r].head.line,o={anchor:Bo(i,0),head:Bo(i+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function te(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function ne(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Ei,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function re(){var e=ji("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=ji("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return wo?e.style.width="1000px":e.setAttribute("wrap","off"),No&&(e.style.border="1px solid black"),te(e),t}function ie(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Ei,this.gracePeriod=!1}function oe(e,t){var n=Qe(e,t.line);if(!n||n.hidden)return null;var r=Zr(e.doc,t.line),i=Xe(n,r,t.line),o=ii(r),a="left";o&&(a=co(o,t.ch)%2?"right":"left");var s=nt(i.map,t.ch,a);return s.offset="right"==s.collapse?s.end:s.start,s}function ae(e,t){return t&&(e.bad=!0),e}function le(e,t,n){var r;if(t==e.display.lineDiv){if(!(r=e.display.lineDiv.childNodes[n]))return ae(e.clipPos(Bo(e.display.viewTo-1)),!0);t=null,n=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var i=0;i<e.display.view.length;i++){var o=e.display.view[i];if(o.node==r)return se(o,t,n)}}function se(e,t,n){function r(t,n,r){for(var i=-1;i<(u?u.length:0);i++)for(var o=0>i?c.map:u[i],a=0;a<o.length;a+=3){var l=o[a+2];if(l==t||l==n){var s=ti(0>i?e.line:e.rest[i]),f=o[a]+r;return(0>r||l!=t)&&(f=o[a+(r?1:0)]),Bo(s,f)}}}var i=e.text.firstChild,o=!1;if(!t||!Va(i,t))return ae(Bo(ti(e.line),0),!0);if(t==i&&(o=!0,t=i.childNodes[n],n=0,!t)){var a=e.rest?Ii(e.rest):e.line;return ae(Bo(ti(a),a.text.length),o)}var l=3==t.nodeType?t:null,s=t;for(l||1!=t.childNodes.length||3!=t.firstChild.nodeType||(l=t.firstChild,n&&(n=l.nodeValue.length));s.parentNode!=i;)s=s.parentNode;var c=e.measure,u=c.maps,f=r(l,s,n);if(f)return ae(f,o);for(var h=s.nextSibling,d=l?l.nodeValue.length-n:0;h;h=h.nextSibling){if(f=r(h,h.firstChild,0))return ae(Bo(f.line,f.ch-d),o);d+=h.textContent.length}var p=s.previousSibling;for(d=n;p;p=p.previousSibling){if(f=r(p,p.firstChild,-1))return ae(Bo(f.line,f.ch+d),o);d+=h.textContent.length}}function ce(e,t,n,r,i){function o(e){return function(t){return t.id==e}}function a(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return""==n&&(n=t.textContent.replace(/\u200b/g,"")),void(l+=n);var u,f=t.getAttribute("cm-marker");if(f){var h=e.findMarks(Bo(r,0),Bo(i+1,0),o(+f));return void(h.length&&(u=h[0].find())&&(l+=Jr(e.doc,u.from,u.to).join(c)))}if("false"==t.getAttribute("contenteditable"))return;for(var d=0;d<t.childNodes.length;d++)a(t.childNodes[d]);/^(pre|div|p)$/i.test(t.nodeName)&&(s=!0)}else if(3==t.nodeType){var p=t.nodeValue;if(!p)return;s&&(l+=c,s=!1),l+=p}}for(var l="",s=!1,c=e.doc.lineSeparator();a(t),t!=n;)t=t.nextSibling;return l}function ue(e,t){this.ranges=e,this.primIndex=t}function fe(e,t){this.anchor=e,this.head=t}function he(e,t){var n=e[t];e.sort(function(e,t){return _o(e.from(),t.from())}),t=Pi(e,n);for(var r=1;r<e.length;r++){var i=e[r],o=e[r-1];if(_o(o.to(),i.from())>=0){var a=K(o.from(),i.from()),l=V(o.to(),i.to()),s=o.empty()?i.from()==i.head:o.from()==o.head;t>=r&&--t,e.splice(--r,2,new fe(s?l:a,s?a:l))}}return new ue(e,t)}function de(e,t){return new ue([new fe(e,t||e)],0)}function pe(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function me(e,t){if(t.line<e.first)return Bo(e.first,0);var n=e.first+e.size-1;return t.line>n?Bo(n,Zr(e,n).text.length):ge(t,Zr(e,t.line).text.length)}function ge(e,t){var n=e.ch;return null==n||n>t?Bo(e.line,t):0>n?Bo(e.line,0):e}function ve(e,t){return t>=e.first&&t<e.first+e.size}function ye(e,t){for(var n=[],r=0;r<t.length;r++)n[r]=me(e,t[r]);return n}function xe(e,t,n,r){if(e.cm&&e.cm.display.shift||e.extend){var i=t.anchor;if(r){var o=_o(n,i)<0;o!=_o(r,i)<0?(i=n,n=r):o!=_o(n,r)<0&&(n=r)}return new fe(i,n)}return new fe(r||n,n)}function be(e,t,n,r){Te(e,new ue([xe(e,e.sel.primary(),t,n)],0),r)}function we(e,t,n){for(var r=[],i=0;i<e.sel.ranges.length;i++)r[i]=xe(e,e.sel.ranges[i],t[i],null);Te(e,he(r,e.sel.primIndex),n)}function ke(e,t,n,r){var i=e.sel.ranges.slice(0);i[t]=n,Te(e,he(i,e.sel.primIndex),r)}function Se(e,t,n,r){Te(e,de(t,n),r)}function Ce(e,t,n){var r={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new fe(me(e,t[n].anchor),me(e,t[n].head))},origin:n&&n.origin};return Pa(e,"beforeSelectionChange",e,r),e.cm&&Pa(e.cm,"beforeSelectionChange",e.cm,r),r.ranges!=t.ranges?he(r.ranges,r.ranges.length-1):t}function Le(e,t,n){var r=e.history.done,i=Ii(r);i&&i.ranges?(r[r.length-1]=t,Me(e,t,n)):Te(e,t,n)}function Te(e,t,n){Me(e,t,n),fi(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Me(e,t,n){(Ni(e,"beforeSelectionChange")||e.cm&&Ni(e.cm,"beforeSelectionChange"))&&(t=Ce(e,t,n)),Ne(e,Ee(e,t,n&&n.bias||(_o(t.primary().head,e.sel.primary().head)<0?-1:1),!0)),n&&!1===n.scroll||!e.cm||Bn(e.cm)}function Ne(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Mi(e.cm)),Ci(e,"cursorActivity",e))}function Ae(e){Ne(e,Ee(e,e.sel,null,!1),Wa)}function Ee(e,t,n,r){for(var i,o=0;o<t.ranges.length;o++){var a=t.ranges[o],l=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],s=Ie(e,a.anchor,l&&l.anchor,n,r),c=Ie(e,a.head,l&&l.head,n,r);(i||s!=a.anchor||c!=a.head)&&(i||(i=t.ranges.slice(0,o)),i[o]=new fe(s,c))}return i?he(i,t.primIndex):t}function Oe(e,t,n,r,i){var o=Zr(e,t.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var l=o.markedSpans[a],s=l.marker;if((null==l.from||(s.inclusiveLeft?l.from<=t.ch:l.from<t.ch))&&(null==l.to||(s.inclusiveRight?l.to>=t.ch:l.to>t.ch))){if(i&&(Pa(s,"beforeCursorEnter"),s.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!s.atomic)continue;if(n){var c,u=s.find(0>r?1:-1);if((0>r?s.inclusiveRight:s.inclusiveLeft)&&(u=Pe(e,u,-r,u&&u.line==t.line?o:null)),u&&u.line==t.line&&(c=_o(u,n))&&(0>r?0>c:c>0))return Oe(e,u,t,r,i)}var f=s.find(0>r?-1:1);return(0>r?s.inclusiveLeft:s.inclusiveRight)&&(f=Pe(e,f,r,f.line==t.line?o:null)),f?Oe(e,f,t,r,i):null}}return t}function Ie(e,t,n,r,i){var o=r||1,a=Oe(e,t,n,o,i)||!i&&Oe(e,t,n,o,!0)||Oe(e,t,n,-o,i)||!i&&Oe(e,t,n,-o,!0);return a||(e.cantEdit=!0,Bo(e.first,0))}function Pe(e,t,n,r){return 0>n&&0==t.ch?t.line>e.first?me(e,Bo(t.line-1)):null:n>0&&t.ch==(r||Zr(e,t.line)).text.length?t.line<e.first+e.size-1?Bo(t.line+1,0):null:new Bo(t.line,t.ch+n)}function Re(e){e.display.input.showSelection(e.display.input.prepareSelection())}function De(e,t){for(var n=e.doc,r={},i=r.cursors=document.createDocumentFragment(),o=r.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(!1!==t||a!=n.sel.primIndex){var l=n.sel.ranges[a];if(!(l.from().line>=e.display.viewTo||l.to().line<e.display.viewFrom)){var s=l.empty();(s||e.options.showCursorWhenSelecting)&&He(e,l.head,i),s||We(e,l,o)}}return r}function He(e,t,n){var r=dt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),i=n.appendChild(ji("div"," ","CodeMirror-cursor"));if(i.style.left=r.left+"px",i.style.top=r.top+"px",i.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){var o=n.appendChild(ji("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=r.other.left+"px",o.style.top=r.other.top+"px",o.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function We(e,t,n){function r(e,t,n,r){0>t&&(t=0),t=Math.round(t),r=Math.round(r),l.appendChild(ji("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function i(t,n,i){function o(n,r){return ht(e,Bo(t,n),"div",f,r)}var l,s,f=Zr(a,t),h=f.text.length;return eo(ii(f),n||0,null==i?h:i,function(e,t,a){var f,d,p,m=o(e,"left");if(e==t)f=m,d=p=m.left;else{if(f=o(t-1,"right"),"rtl"==a){var g=m;m=f,f=g}d=m.left,p=f.right}null==n&&0==e&&(d=c),f.top-m.top>3&&(r(d,m.top,null,m.bottom),d=c,m.bottom<f.top&&r(d,m.bottom,null,f.top)),null==i&&t==h&&(p=u),(!l||m.top<l.top||m.top==l.top&&m.left<l.left)&&(l=m),(!s||f.bottom>s.bottom||f.bottom==s.bottom&&f.right>s.right)&&(s=f),c+1>d&&(d=c),r(d,f.top,p-d,f.bottom)}),{start:l,end:s}}var o=e.display,a=e.doc,l=document.createDocumentFragment(),s=Ge(e.display),c=s.left,u=Math.max(o.sizerWidth,$e(e)-o.sizer.offsetLeft)-s.right,f=t.from(),h=t.to();if(f.line==h.line)i(f.line,f.ch,h.ch);else{var d=Zr(a,f.line),p=Zr(a,h.line),m=yr(d)==yr(p),g=i(f.line,f.ch,m?d.text.length+1:null).end,v=i(h.line,m?0:null,h.ch).start;m&&(g.top<v.top-2?(r(g.right,g.top,null,g.bottom),r(c,v.top,v.left,v.bottom)):r(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&r(c,g.bottom,null,v.top)}n.appendChild(l)}function Be(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function _e(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,Bi(Fe,e))}function Fe(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,r=sa(t.mode,je(e,t.frontier)),i=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var a=o.styles,l=o.text.length>e.options.maxHighlightLength,s=Rr(e,o,l?sa(t.mode,r):r,!0);o.styles=s.styles;var c=o.styleClasses,u=s.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var f=!a||a.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),h=0;!f&&h<a.length;++h)f=a[h]!=o.styles[h];f&&i.push(t.frontier),o.stateAfter=l?r:sa(t.mode,r)}else o.text.length<=e.options.maxHighlightLength&&Hr(e,o.text,r),o.stateAfter=t.frontier%5==0?sa(t.mode,r):null;return++t.frontier,+new Date>n?(_e(e,e.options.workDelay),!0):void 0}),i.length&&At(e,function(){for(var t=0;t<i.length;t++)Ht(e,i[t],"text")})}}function ze(e,t,n){for(var r,i,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),l=t;l>a;--l){if(l<=o.first)return o.first;var s=Zr(o,l-1);if(s.stateAfter&&(!n||l<=o.frontier))return l;var c=Fa(s.text,null,e.options.tabSize);(null==i||r>c)&&(i=l-1,r=c)}return i}function je(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var o=ze(e,t,n),a=o>r.first&&Zr(r,o-1).stateAfter;return a=a?sa(r.mode,a):ca(r.mode),r.iter(o,t,function(n){Hr(e,n.text,a);var l=o==t-1||o%5==0||o>=i.viewFrom&&o<i.viewTo;n.stateAfter=l?sa(r.mode,a):null,++o}),n&&(r.frontier=o),a}function Ue(e){return e.lineSpace.offsetTop}function qe(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ge(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=qi(e.measure,ji("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(r.left)||isNaN(r.right)||(e.cachedPaddingH=r),r}function Ye(e){return Da-e.display.nativeBarWidth}function $e(e){return e.display.scroller.clientWidth-Ye(e)-e.display.barWidth}function Ve(e){return e.display.scroller.clientHeight-Ye(e)-e.display.barHeight}function Ke(e,t,n){var r=e.options.lineWrapping,i=r&&$e(e);if(!t.measure.heights||r&&t.measure.width!=i){var o=t.measure.heights=[];if(r){t.measure.width=i;for(var a=t.text.firstChild.getClientRects(),l=0;l<a.length-1;l++){var s=a[l],c=a[l+1];Math.abs(s.bottom-c.bottom)>2&&o.push((s.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Xe(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(r=0;r<e.rest.length;r++)if(ti(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function Ze(e,t){var n=ti(t=yr(t)),r=e.display.externalMeasured=new Pt(e.doc,t,n);r.lineN=n;var i=r.built=Br(e,r);return r.text=i.pre,qi(e.display.lineMeasure,i.pre),r}function Je(e,t,n,r){return tt(e,et(e,t),n,r)}function Qe(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Bt(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function et(e,t){var n=ti(t),r=Qe(e,n);r&&!r.text?r=null:r&&r.changes&&(D(e,r,n,P(e)),e.curOp.forceUpdate=!0),r||(r=Ze(e,t));var i=Xe(r,t,n);return{line:t,view:r,rect:null,map:i.map,cache:i.cache,before:i.before,hasHeights:!1}}function tt(e,t,n,r,i){t.before&&(n=-1);var o,a=n+(r||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Ke(e,t.view,t.rect),t.hasHeights=!0),(o=rt(e,t,n,r)).bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:i?o.rtop:o.top,bottom:i?o.rbottom:o.bottom}}function nt(e,t,n){for(var r,i,o,a,l=0;l<e.length;l+=3){var s=e[l],c=e[l+1];if(s>t?(i=0,o=1,a="left"):c>t?o=(i=t-s)+1:(l==e.length-3||t==c&&e[l+3]>t)&&(i=(o=c-s)-1,t>=c&&(a="right")),null!=i){if(r=e[l+2],s==c&&n==(r.insertLeft?"left":"right")&&(a=n),"left"==n&&0==i)for(;l&&e[l-2]==e[l-3]&&e[l-1].insertLeft;)r=e[2+(l-=3)],a="left";if("right"==n&&i==c-s)for(;l<e.length-3&&e[l+3]==e[l+4]&&!e[l+5].insertLeft;)r=e[(l+=3)+2],a="right";break}}return{node:r,start:i,end:o,collapse:a,coverStart:s,coverEnd:c}}function rt(e,t,n,r){var i,o=nt(t.map,n,r),a=o.node,l=o.start,s=o.end,c=o.collapse;if(3==a.nodeType){for(var u=0;4>u;u++){for(;l&&zi(t.line.text.charAt(o.coverStart+l));)--l;for(;o.coverStart+s<o.coverEnd&&zi(t.line.text.charAt(o.coverStart+s));)++s;if(xo&&9>bo&&0==l&&s==o.coverEnd-o.coverStart)i=a.parentNode.getBoundingClientRect();else if(xo&&e.options.lineWrapping){i=(f=qa(a,l,s).getClientRects()).length?f["right"==r?f.length-1:0]:qo}else i=qa(a,l,s).getBoundingClientRect()||qo;if(i.left||i.right||0==l)break;s=l,l-=1,c="right"}xo&&11>bo&&(i=it(e.display.measure,i))}else{var f;l>0&&(c=r="right"),i=e.options.lineWrapping&&(f=a.getClientRects()).length>1?f["right"==r?f.length-1:0]:a.getBoundingClientRect()}if(xo&&9>bo&&!l&&(!i||!i.left&&!i.right)){var h=a.parentNode.getClientRects()[0];i=h?{left:h.left,right:h.left+xt(e.display),top:h.top,bottom:h.bottom}:qo}var d=i.top-t.rect.top,p=i.bottom-t.rect.top,m=(d+p)/2,g=t.view.measure.heights;for(u=0;u<g.length-1&&!(m<g[u]);u++);var v=u?g[u-1]:0,y=g[u],x={left:("right"==c?i.right:i.left)-t.rect.left,right:("left"==c?i.left:i.right)-t.rect.left,top:v,bottom:y};return i.left||i.right||(x.bogus=!0),e.options.singleCursorHeightPerLine||(x.rtop=d,x.rbottom=p),x}function it(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Qi(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*r,bottom:t.bottom*r}}function ot(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function at(e){e.display.externalMeasure=null,Ui(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ot(e.display.view[t])}function lt(e){at(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function st(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ct(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function ut(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var o=Lr(t.widgets[i]);n.top+=o,n.bottom+=o}if("line"==r)return n;r||(r="local");var a=ri(t);if("local"==r?a+=Ue(e.display):a-=e.display.viewOffset,"page"==r||"window"==r){var l=e.display.lineSpace.getBoundingClientRect();a+=l.top+("window"==r?0:ct());var s=l.left+("window"==r?0:st());n.left+=s,n.right+=s}return n.top+=a,n.bottom+=a,n}function ft(e,t,n){if("div"==n)return t;var r=t.left,i=t.top;if("page"==n)r-=st(),i-=ct();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();r+=o.left,i+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:r-a.left,top:i-a.top}}function ht(e,t,n,r,i){return r||(r=Zr(e.doc,t.line)),ut(e,r,Je(e,r,t.ch,i),n)}function dt(e,t,n,r,i,o){function a(t,a){var l=tt(e,i,t,a?"right":"left",o);return a?l.left=l.right:l.right=l.left,ut(e,r,l,n)}function l(e,t){var n=s[t],r=n.level%2;return e==to(n)&&t&&n.level<s[t-1].level?(e=no(n=s[--t])-(n.level%2?0:1),r=!0):e==no(n)&&t<s.length-1&&n.level<s[t+1].level&&(e=to(n=s[++t])-n.level%2,r=!1),r&&e==n.to&&e>n.from?a(e-1):a(e,r)}r=r||Zr(e.doc,t.line),i||(i=et(e,r));var s=ii(r),c=t.ch;if(!s)return a(c);var f=l(c,co(s,c));return null!=al&&(f.other=l(c,al)),f}function pt(e,t){var n=0;t=me(e.doc,t);e.options.lineWrapping||(n=xt(e.display)*t.ch);var r=Zr(e.doc,t.line),i=ri(r)+Ue(e.display);return{left:n,right:n,top:i,bottom:i+r.height}}function mt(e,t,n,r){var i=Bo(e,t);return i.xRel=r,n&&(i.outside=!0),i}function gt(e,t,n){var r=e.doc;if(0>(n+=e.display.viewOffset))return mt(r.first,0,!0,-1);var i=ni(r,n),o=r.first+r.size-1;if(i>o)return mt(r.first+r.size-1,Zr(r,o).text.length,!0,1);0>t&&(t=0);for(var a=Zr(r,i);;){var l=vt(e,a,i,t,n),s=gr(a),c=s&&s.find(0,!0);if(!s||!(l.ch>c.from.ch||l.ch==c.from.ch&&l.xRel>0))return l;i=ti(a=c.to.line)}}function vt(e,t,n,r,i){function o(r){var i=dt(e,Bo(n,r),"line",t,c);return l=!0,a>i.bottom?i.left-s:a<i.top?i.left+s:(l=!1,i.left)}var a=i-ri(t),l=!1,s=2*e.display.wrapper.clientWidth,c=et(e,t),u=ii(t),f=t.text.length,h=ro(t),d=io(t),p=o(h),m=l,g=o(d),v=l;if(r>g)return mt(n,d,v,1);for(;;){if(u?d==h||d==fo(t,h,1):1>=d-h){for(var y=p>r||g-r>=r-p?h:d,x=r-(y==h?p:g);zi(t.text.charAt(y));)++y;return mt(n,y,y==h?m:v,-1>x?-1:x>1?1:0)}var w=Math.ceil(f/2),k=h+w;if(u){k=h;for(var S=0;w>S;++S)k=fo(t,k,1)}var C=o(k);C>r?(d=k,g=C,(v=l)&&(g+=1e3),f=w):(h=k,p=C,m=l,f-=w)}}function yt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==zo){zo=ji("pre");for(var t=0;49>t;++t)zo.appendChild(document.createTextNode("x")),zo.appendChild(ji("br"));zo.appendChild(document.createTextNode("x"))}qi(e.measure,zo);var n=zo.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Ui(e.measure),n||1}function xt(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=ji("span","xxxxxxxxxx"),n=ji("pre",[t]);qi(e.measure,n);var r=t.getBoundingClientRect(),i=(r.right-r.left)/10;return i>2&&(e.cachedCharWidth=i),i||10}function bt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Yo},Go?Go.ops.push(e.curOp):e.curOp.ownsGroup=Go={ops:[e.curOp],delayedCallbacks:[]}}function wt(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var r=0;r<e.ops.length;r++){var i=e.ops[r];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(n<t.length)}function kt(e){var n=e.curOp.ownsGroup;if(n)try{wt(n)}finally{Go=null;for(var r=0;r<n.ops.length;r++)n.ops[r].cm.curOp=null;St(n)}}function St(e){for(var t=e.ops,n=0;n<t.length;n++)Ct(t[n]);for(n=0;n<t.length;n++)Lt(t[n]);for(n=0;n<t.length;n++)Tt(t[n]);for(n=0;n<t.length;n++)Mt(t[n]);for(n=0;n<t.length;n++)Nt(t[n])}function Ct(e){var t=e.cm,n=t.display;T(t),e.updateMaxLine&&h(t),
e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new L(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Lt(e){e.updatedDisplay=e.mustUpdate&&M(e.cm,e.update)}function Tt(e){var t=e.cm,n=t.display;e.updatedDisplay&&O(t),e.barMeasure=p(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Je(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Ye(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-$e(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection(e.focus))}function Mt(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&on(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==Gi()&&(!document.hasFocus||document.hasFocus());e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n),(e.updatedDisplay||e.startHeight!=t.doc.height)&&y(t,e.barMeasure),e.updatedDisplay&&E(t,e.barMeasure),e.selectionChanged&&Be(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),n&&X(e.cm)}function Nt(e){var t=e.cm,n=t.display,r=t.doc;if(e.updatedDisplay&&N(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(r.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(r.scrollTop),n.scroller.scrollTop=r.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(r.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft)),n.scrollbars.setScrollLeft(r.scrollLeft),n.scroller.scrollLeft=r.scrollLeft,w(t)),e.scrollToPos){var i=Rn(t,me(r,e.scrollToPos.from),me(r,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Pn(t,i)}var o=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(o)for(var l=0;l<o.length;++l)o[l].lines.length||Pa(o[l],"hide");if(a)for(l=0;l<a.length;++l)a[l].lines.length&&Pa(a[l],"unhide");n.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Pa(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function At(e,t){if(e.curOp)return t();bt(e);try{return t()}finally{kt(e)}}function Et(e,t){return function(){if(e.curOp)return t.apply(e,arguments);bt(e);try{return t.apply(e,arguments)}finally{kt(e)}}}function Ot(e){return function(){if(this.curOp)return e.apply(this,arguments);bt(this);try{return e.apply(this,arguments)}finally{kt(this)}}}function It(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);bt(t);try{return e.apply(this,arguments)}finally{kt(t)}}}function Pt(e,t,n){this.line=t,this.rest=xr(t),this.size=this.rest?ti(Ii(this.rest))-n+1:1,this.node=this.text=null,this.hidden=kr(e,t)}function Rt(e,t,n){for(var r,i=[],o=t;n>o;o=r){var a=new Pt(e.doc,Zr(e.doc,o),o);r=o+a.size,i.push(a)}return i}function Dt(e,t,n,r){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),r||(r=0);var i=e.display;if(r&&n<i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>t)&&(i.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=i.viewTo)Wo&&br(e.doc,t)<i.viewTo&&Wt(e);else if(n<=i.viewFrom)Wo&&wr(e.doc,n+r)>i.viewFrom?Wt(e):(i.viewFrom+=r,i.viewTo+=r);else if(t<=i.viewFrom&&n>=i.viewTo)Wt(e);else if(t<=i.viewFrom){(o=_t(e,n,n+r,1))?(i.view=i.view.slice(o.index),i.viewFrom=o.lineN,i.viewTo+=r):Wt(e)}else if(n>=i.viewTo){var o;(o=_t(e,t,t,-1))?(i.view=i.view.slice(0,o.index),i.viewTo=o.lineN):Wt(e)}else{var a=_t(e,t,t,-1),l=_t(e,n,n+r,1);a&&l?(i.view=i.view.slice(0,a.index).concat(Rt(e,a.lineN,l.lineN)).concat(i.view.slice(l.index)),i.viewTo+=r):Wt(e)}var s=i.externalMeasured;s&&(n<s.lineN?s.lineN+=r:t<s.lineN+s.size&&(i.externalMeasured=null))}function Ht(e,t,n){e.curOp.viewChanged=!0;var r=e.display,i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var o=r.view[Bt(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==Pi(a,n)&&a.push(n)}}}function Wt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Bt(e,t){if(t>=e.display.viewTo)return null;if(0>(t-=e.display.viewFrom))return null;for(var n=e.display.view,r=0;r<n.length;r++)if(0>(t-=n[r].size))return r}function _t(e,t,n,r){var i,o=Bt(e,t),a=e.display.view;if(!Wo||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var l=0,s=e.display.viewFrom;o>l;l++)s+=a[l].size;if(s!=t){if(r>0){if(o==a.length-1)return null;i=s+a[o].size-t,o++}else i=s-t;t+=i,n+=i}for(;br(e.doc,n)!=n;){if(o==(0>r?0:a.length-1))return null;n+=r*a[o-(0>r?1:0)].size,o+=r}return{index:o,lineN:n}}function Ft(e,t,n){var r=e.display;0==r.view.length||t>=r.viewTo||n<=r.viewFrom?(r.view=Rt(e,t,n),r.viewFrom=t):(r.viewFrom>t?r.view=Rt(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(Bt(e,t))),r.viewFrom=t,r.viewTo<n?r.view=r.view.concat(Rt(e,r.viewTo,n)):r.viewTo>n&&(r.view=r.view.slice(0,Bt(e,n)))),r.viewTo=n}function zt(e){for(var t=e.display.view,n=0,r=0;r<t.length;r++){var i=t[r];i.hidden||i.node&&!i.changes||++n}return n}function jt(e){function t(){i.activeTouch&&(o=setTimeout(function(){i.activeTouch=null},1e3),(a=i.activeTouch).end=+new Date)}function n(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function r(e,t){if(null==t.left)return!0;var n=t.left-e.left,r=t.top-e.top;return n*n+r*r>400}var i=e.display;Ea(i.scroller,"mousedown",Et(e,$t)),Ea(i.scroller,"dblclick",xo&&11>bo?Et(e,function(t){if(!Ti(e,t)){var n=Yt(e,t);if(n&&!Jt(e,t)&&!Gt(e.display,t)){Ma(t);var r=e.findWordAt(n);be(e.doc,r.anchor,r.head)}}}):function(t){Ti(e,t)||Ma(t)}),Do||Ea(i.scroller,"contextmenu",function(t){xn(e,t)});var o,a={end:0};Ea(i.scroller,"touchstart",function(t){if(!Ti(e,t)&&!n(t)){clearTimeout(o);var r=+new Date;i.activeTouch={start:r,moved:!1,prev:r-a.end<=300?a:null},1==t.touches.length&&(i.activeTouch.left=t.touches[0].pageX,i.activeTouch.top=t.touches[0].pageY)}}),Ea(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)}),Ea(i.scroller,"touchend",function(n){var o=i.activeTouch;if(o&&!Gt(i,n)&&null!=o.left&&!o.moved&&new Date-o.start<300){var a,l=e.coordsChar(i.activeTouch,"page");a=!o.prev||r(o,o.prev)?new fe(l,l):!o.prev.prev||r(o,o.prev.prev)?e.findWordAt(l):new fe(Bo(l.line,0),me(e.doc,Bo(l.line+1,0))),e.setSelection(a.anchor,a.head),e.focus(),Ma(n)}t()}),Ea(i.scroller,"touchcancel",t),Ea(i.scroller,"scroll",function(){i.scroller.clientHeight&&(rn(e,i.scroller.scrollTop),on(e,i.scroller.scrollLeft,!0),Pa(e,"scroll",e))}),Ea(i.scroller,"mousewheel",function(t){an(e,t)}),Ea(i.scroller,"DOMMouseScroll",function(t){an(e,t)}),Ea(i.wrapper,"scroll",function(){i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),i.dragFunctions={enter:function(t){Ti(e,t)||Aa(t)},over:function(t){Ti(e,t)||(tn(e,t),Aa(t))},start:function(t){en(e,t)},drop:Et(e,Qt),leave:function(t){Ti(e,t)||nn(e)}};var l=i.input.getField();Ea(l,"keyup",function(t){pn.call(e,t)}),Ea(l,"keydown",Et(e,hn)),Ea(l,"keypress",Et(e,mn)),Ea(l,"focus",Bi(vn,e)),Ea(l,"blur",Bi(yn,e))}function Ut(t,n,r){if(!n!=!(r&&r!=e.Init)){var o=t.display.dragFunctions,a=n?Ea:Ia;a(t.display.scroller,"dragstart",o.start),a(t.display.scroller,"dragenter",o.enter),a(t.display.scroller,"dragover",o.over),a(t.display.scroller,"dragleave",o.leave),a(t.display.scroller,"drop",o.drop)}}function qt(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Gt(e,t){for(var n=wi(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Yt(e,t,n,r){var i=e.display;if(!n&&"true"==wi(t).getAttribute("cm-not-content"))return null;var o,a,l=i.lineSpace.getBoundingClientRect();try{o=t.clientX-l.left,a=t.clientY-l.top}catch(t){return null}var s,c=gt(e,o,a);if(r&&1==c.xRel&&(s=Zr(e.doc,c.line).text).length==c.ch){var u=Fa(s,s.length,e.options.tabSize)-s.length;c=Bo(c.line,Math.max(0,Math.round((o-Ge(e.display).left)/xt(e.display))-u))}return c}function $t(e){var t=this,n=t.display;if(!(Ti(t,e)||n.activeTouch&&n.input.supportsTouch())){if(n.shift=e.shiftKey,Gt(n,e))return void(wo||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Jt(t,e)){var r=Yt(t,e);switch(window.focus(),ki(e)){case 1:t.state.selectingText?t.state.selectingText(e):r?Vt(t,e,r):wi(e)==n.scroller&&Ma(e);break;case 2:wo&&(t.state.lastMiddleDown=+new Date),r&&be(t.doc,r),setTimeout(function(){n.input.focus()},20),Ma(e);break;case 3:Do?xn(t,e):gn(t)}}}}function Vt(e,t,n){xo?setTimeout(Bi(X,e),0):e.curOp.focus=Gi();var r,i=+new Date;Uo&&Uo.time>i-400&&0==_o(Uo.pos,n)?r="triple":jo&&jo.time>i-400&&0==_o(jo.pos,n)?(r="double",Uo={time:i,pos:n}):(r="single",jo={time:i,pos:n});var o,a=e.doc.sel,l=Eo?t.metaKey:t.ctrlKey;e.options.dragDrop&&el&&!e.isReadOnly()&&"single"==r&&(o=a.contains(n))>-1&&(_o((o=a.ranges[o]).from(),n)<0||n.xRel>0)&&(_o(o.to(),n)>0||n.xRel<0)?Kt(e,t,n,l):Xt(e,t,n,r,l)}function Kt(e,t,n,r){var i=e.display,o=+new Date,a=Et(e,function(l){wo&&(i.scroller.draggable=!1),e.state.draggingText=!1,Ia(document,"mouseup",a),Ia(i.scroller,"drop",a),Math.abs(t.clientX-l.clientX)+Math.abs(t.clientY-l.clientY)<10&&(Ma(l),!r&&+new Date-200<o&&be(e.doc,n),wo||xo&&9==bo?setTimeout(function(){document.body.focus(),i.input.focus()},20):i.input.focus())});wo&&(i.scroller.draggable=!0),e.state.draggingText=a,i.scroller.dragDrop&&i.scroller.dragDrop(),Ea(document,"mouseup",a),Ea(i.scroller,"drop",a)}function Xt(e,t,n,r,i){function o(t){if(0!=_o(g,t))if(g=t,"rect"==r){for(var i=[],o=e.options.tabSize,a=Fa(Zr(c,n.line).text,n.ch,o),l=Fa(Zr(c,t.line).text,t.ch,o),s=Math.min(a,l),d=Math.max(a,l),p=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=p;p++){var v=Zr(c,p).text,y=za(v,s,o);s==d?i.push(new fe(Bo(p,y),Bo(p,y))):v.length>y&&i.push(new fe(Bo(p,y),Bo(p,za(v,d,o))))}i.length||i.push(new fe(n,n)),Te(c,he(h.ranges.slice(0,f).concat(i),f),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var x=u,b=x.anchor,w=t;if("single"!=r){if("double"==r)var k=e.findWordAt(t);else k=new fe(Bo(t.line,0),me(c,Bo(t.line+1,0)));_o(k.anchor,b)>0?(w=k.head,b=K(x.from(),k.anchor)):(w=k.anchor,b=V(x.to(),k.head))}(i=h.ranges.slice(0))[f]=new fe(me(c,b),w),Te(c,he(i,f),Ba)}}function a(t){var n=++y,i=Yt(e,t,!0,"rect"==r);if(i)if(0!=_o(i,g)){e.curOp.focus=Gi(),o(i);var l=b(s,c);(i.line>=l.to||i.line<l.from)&&setTimeout(Et(e,function(){y==n&&a(t)}),150)}else{var u=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;u&&setTimeout(Et(e,function(){y==n&&(s.scroller.scrollTop+=u,a(t))}),50)}}function l(t){e.state.selectingText=!1,y=1/0,Ma(t),s.input.focus(),Ia(document,"mousemove",x),Ia(document,"mouseup",w),c.history.lastSelOrigin=null}var s=e.display,c=e.doc;Ma(t);var u,f,h=c.sel,d=h.ranges;if(i&&!t.shiftKey?(f=c.sel.contains(n),u=f>-1?d[f]:new fe(n,n)):(u=c.sel.primary(),f=c.sel.primIndex),Oo?t.shiftKey&&t.metaKey:t.altKey)r="rect",i||(u=new fe(n,n)),n=Yt(e,t,!0,!0),f=-1;else if("double"==r){var p=e.findWordAt(n);u=e.display.shift||c.extend?xe(c,u,p.anchor,p.head):p}else if("triple"==r){var m=new fe(Bo(n.line,0),me(c,Bo(n.line+1,0)));u=e.display.shift||c.extend?xe(c,u,m.anchor,m.head):m}else u=xe(c,u,n);i?-1==f?(f=d.length,Te(c,he(d.concat([u]),f),{scroll:!1,origin:"*mouse"})):d.length>1&&d[f].empty()&&"single"==r&&!t.shiftKey?(Te(c,he(d.slice(0,f).concat(d.slice(f+1)),0),{scroll:!1,origin:"*mouse"}),h=c.sel):ke(c,f,u,Ba):(f=0,Te(c,new ue([u],0),Ba),h=c.sel);var g=n,v=s.wrapper.getBoundingClientRect(),y=0,x=Et(e,function(e){ki(e)?a(e):l(e)}),w=Et(e,l);e.state.selectingText=w,Ea(document,"mousemove",x),Ea(document,"mouseup",w)}function Zt(e,t,n,r){try{var i=t.clientX,o=t.clientY}catch(t){return!1}if(i>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&Ma(t);var a=e.display,l=a.lineDiv.getBoundingClientRect();if(o>l.bottom||!Ni(e,n))return bi(t);o-=l.top-a.viewOffset;for(var s=0;s<e.options.gutters.length;++s){var c=a.gutters.childNodes[s];if(c&&c.getBoundingClientRect().right>=i){var u=ni(e.doc,o),f=e.options.gutters[s];return Pa(e,n,e,u,f,t),bi(t)}}}function Jt(e,t){return Zt(e,t,"gutterClick",!0)}function Qt(e){var t=this;if(nn(t),!Ti(t,e)&&!Gt(t.display,e)){Ma(e),xo&&($o=+new Date);var n=Yt(t,e,!0),r=e.dataTransfer.files;if(n&&!t.isReadOnly())if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,o=Array(i),a=0,l=function(e,r){if(!t.options.allowDropFileTypes||-1!=Pi(t.options.allowDropFileTypes,e.type)){var l=new FileReader;l.onload=Et(t,function(){var e=l.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[r]=e,++a==i){var s={from:n=me(t.doc,n),to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};Tn(t.doc,s),Le(t.doc,de(n,Qo(s)))}}),l.readAsText(e)}},s=0;i>s;++s)l(r[s],s);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{if(o=e.dataTransfer.getData("Text")){if(t.state.draggingText&&!(Eo?e.altKey:e.ctrlKey))var c=t.listSelections();if(Me(t.doc,de(n,n)),c)for(s=0;s<c.length;++s)In(t.doc,"",c[s].anchor,c[s].head,"drag");t.replaceSelection(o,"around","paste"),t.display.input.focus()}}catch(e){}}}}function en(e,t){if(xo&&(!e.state.draggingText||+new Date-$o<100))Aa(t);else if(!Ti(e,t)&&!Gt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!Lo)){var n=ji("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Co&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),Co&&n.parentNode.removeChild(n)}}function tn(e,t){var n=Yt(e,t);if(n){var r=document.createDocumentFragment();He(e,n,r),e.display.dragCursor||(e.display.dragCursor=ji("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),qi(e.display.dragCursor,r)}}function nn(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function rn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,go||A(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),go&&A(e),_e(e,100))}function on(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,w(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function an(e,t){var n=Xo(t),r=n.x,i=n.y,o=e.display,a=o.scroller,l=a.scrollWidth>a.clientWidth,s=a.scrollHeight>a.clientHeight;if(r&&l||i&&s){if(i&&Eo&&wo)e:for(var c=t.target,u=o.view;c!=a;c=c.parentNode)for(var f=0;f<u.length;f++)if(u[f].node==c){e.display.currentWheelTarget=c;break e}if(r&&!go&&!Co&&null!=Ko)return i&&s&&rn(e,Math.max(0,Math.min(a.scrollTop+i*Ko,a.scrollHeight-a.clientHeight))),on(e,Math.max(0,Math.min(a.scrollLeft+r*Ko,a.scrollWidth-a.clientWidth))),(!i||i&&s)&&Ma(t),void(o.wheelStartX=null);if(i&&null!=Ko){var h=i*Ko,d=e.doc.scrollTop,p=d+o.wrapper.clientHeight;0>h?d=Math.max(0,d+h-50):p=Math.min(e.doc.height,p+h+50),A(e,{top:d,bottom:p})}20>Vo&&(null==o.wheelStartX?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=r,o.wheelDY=i,setTimeout(function(){if(null!=o.wheelStartX){var e=a.scrollLeft-o.wheelStartX,t=a.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(Ko=(Ko*Vo+n)/(Vo+1),++Vo)}},200)):(o.wheelDX+=r,o.wheelDY+=i))}}function ln(e,t,n){if("string"==typeof t&&!(t=ua[t]))return!1;e.display.input.ensurePolled();var r=e.display.shift,i=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),i=t(e)!=Ha}finally{e.display.shift=r,e.state.suppressEdits=!1}return i}function sn(e,t,n){for(var r=0;r<e.state.keyMaps.length;r++){var i=ha(t,e.state.keyMaps[r],n,e);if(i)return i}return e.options.extraKeys&&ha(t,e.options.extraKeys,n,e)||ha(t,e.options.keyMap,n,e)}function cn(e,t,n,r){var i=e.state.keySeq;if(i){if(da(t))return"handled";Zo.set(50,function(){e.state.keySeq==i&&(e.state.keySeq=null,e.display.input.reset())}),t=i+" "+t}var o=sn(e,t,r);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&Ci(e,"keyHandled",e,t,n),"handled"!=o&&"multi"!=o||(Ma(n),Be(e)),i&&!o&&/\'$/.test(t)?(Ma(n),!0):!!o}function un(e,t){var n=pa(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?cn(e,"Shift-"+n,t,function(t){return ln(e,t,!0)})||cn(e,n,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?ln(e,t):void 0}):cn(e,n,t,function(t){return ln(e,t)}))}function fn(e,t,n){return cn(e,"'"+n+"'",t,function(t){return ln(e,t,!0)})}function hn(e){var t=this;if(t.curOp.focus=Gi(),!Ti(t,e)){xo&&11>bo&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var r=un(t,e);Co&&(Jo=r?n:null,!r&&88==n&&!rl&&(Eo?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||dn(t)}}function dn(e){function t(e){18!=e.keyCode&&e.altKey||(Za(n,"CodeMirror-crosshair"),Ia(document,"keyup",t),Ia(document,"mouseover",t))}var n=e.display.lineDiv;Ja(n,"CodeMirror-crosshair"),Ea(document,"keyup",t),Ea(document,"mouseover",t)}function pn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Ti(this,e)}function mn(e){var t=this;if(!(Gt(t.display,e)||Ti(t,e)||e.ctrlKey&&!e.altKey||Eo&&e.metaKey)){var n=e.keyCode,r=e.charCode;if(Co&&n==Jo)return Jo=null,void Ma(e);if(!Co||e.which&&!(e.which<10)||!un(t,e))fn(t,e,String.fromCharCode(null==r?n:r))||t.display.input.onKeyPress(e)}}function gn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,yn(e))},100)}function vn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Pa(e,"focus",e),e.state.focused=!0,Ja(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),wo&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Be(e))}function yn(e){e.state.delayingBlurEvent||(e.state.focused&&(Pa(e,"blur",e),e.state.focused=!1,Za(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function xn(e,t){Gt(e.display,t)||bn(e,t)||Ti(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function bn(e,t){return!!Ni(e,"gutterContextMenu")&&Zt(e,t,"gutterContextMenu",!1)}function wn(e,t){if(_o(e,t.from)<0)return e;if(_o(e,t.to)<=0)return Qo(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=Qo(t).ch-t.to.ch),Bo(n,r)}function kn(e,t){for(var n=[],r=0;r<e.sel.ranges.length;r++){var i=e.sel.ranges[r];n.push(new fe(wn(i.anchor,t),wn(i.head,t)))}return he(n,e.sel.primIndex)}function Sn(e,t,n){return e.line==t.line?Bo(n.line,e.ch-t.ch+n.ch):Bo(n.line+(e.line-t.line),e.ch)}function Cn(e,t,n){for(var r=[],i=Bo(e.first,0),o=i,a=0;a<t.length;a++){var l=t[a],s=Sn(l.from,i,o),c=Sn(Qo(l),i,o);if(i=l.to,o=c,"around"==n){var u=e.sel.ranges[a],f=_o(u.head,u.anchor)<0;r[a]=new fe(f?c:s,f?s:c)}else r[a]=new fe(s,s)}return new ue(r,e.sel.primIndex)}function Ln(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=me(e,t)),n&&(this.to=me(e,n)),r&&(this.text=r),void 0!==i&&(this.origin=i)}),Pa(e,"beforeChange",e,r),e.cm&&Pa(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Tn(e,t,n){if(e.cm){if(!e.cm.curOp)return Et(e.cm,Tn)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Ni(e,"beforeChange")||e.cm&&Ni(e.cm,"beforeChange"))||(t=Ln(e,t,!0))){var r=Ho&&!n&&sr(e,t.from,t.to);if(r)for(var i=r.length-1;i>=0;--i)Mn(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text});else Mn(e,t)}}function Mn(e,t){if(1!=t.text.length||""!=t.text[0]||0!=_o(t.from,t.to)){var n=kn(e,t);ci(e,t,n,e.cm?e.cm.curOp.id:NaN),En(e,t,n,or(e,t));var r=[];Kr(e,function(e,n){n||-1!=Pi(r,e.history)||(xi(e.history,t),r.push(e.history)),En(e,t,null,or(e,t))})}}function Nn(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var r,i=e.history,o=e.sel,a="undo"==t?i.done:i.undone,l="undo"==t?i.undone:i.done,s=0;s<a.length&&(r=a[s],n?!r.ranges||r.equals(e.sel):r.ranges);s++);if(s!=a.length){for(i.lastOrigin=i.lastSelOrigin=null;(r=a.pop()).ranges;){if(hi(r,l),n&&!r.equals(e.sel))return void Te(e,r,{clearRedo:!1});o=r}var c=[];hi(o,l),l.push({changes:c,generation:i.generation}),i.generation=r.generation||++i.maxGeneration;var u=Ni(e,"beforeChange")||e.cm&&Ni(e.cm,"beforeChange");for(s=r.changes.length-1;s>=0;--s){var f=r.changes[s];if(f.origin=t,u&&!Ln(e,f,!1))return void(a.length=0);c.push(ai(e,f));var h=s?kn(e,f):Ii(a);En(e,f,h,lr(e,f)),!s&&e.cm&&e.cm.scrollIntoView({from:f.from,to:Qo(f)});var d=[];Kr(e,function(e,t){t||-1!=Pi(d,e.history)||(xi(e.history,f),d.push(e.history)),En(e,f,null,lr(e,f))})}}}}function An(e,t){if(0!=t&&(e.first+=t,e.sel=new ue(Ri(e.sel.ranges,function(e){return new fe(Bo(e.anchor.line+t,e.anchor.ch),Bo(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Dt(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,r=n.viewFrom;r<n.viewTo;r++)Ht(e.cm,r,"gutter")}}function En(e,t,n,r){if(e.cm&&!e.cm.curOp)return Et(e.cm,En)(e,t,n,r);if(t.to.line<e.first)An(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);An(e,i),t={from:Bo(e.first,0),to:Bo(t.to.line+i,t.to.ch),text:[Ii(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Bo(o,Zr(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Jr(e,t.from,t.to),n||(n=kn(e,t)),e.cm?On(e.cm,t,r):Yr(e,t,r),Me(e,n,Wa)}}function On(e,t,n){var r=e.doc,i=e.display,a=t.from,l=t.to,s=!1,c=a.line;e.options.lineWrapping||(c=ti(yr(Zr(r,a.line))),r.iter(c,l.line+1,function(e){return e==i.maxLine?(s=!0,!0):void 0})),r.sel.contains(t.from,t.to)>-1&&Mi(e),Yr(r,t,n,o(e)),e.options.lineWrapping||(r.iter(c,a.line+t.text.length,function(e){var t=f(e);t>i.maxLineLength&&(i.maxLine=e,i.maxLineLength=t,i.maxLineChanged=!0,s=!1)}),s&&(e.curOp.updateMaxLine=!0)),r.frontier=Math.min(r.frontier,a.line),_e(e,400);var u=t.text.length-(l.line-a.line)-1;t.full?Dt(e):a.line!=l.line||1!=t.text.length||Gr(e.doc,t)?Dt(e,a.line,l.line+1,u):Ht(e,a.line,"text");var h=Ni(e,"changes"),d=Ni(e,"change");if(d||h){var p={from:a,to:l,text:t.text,removed:t.removed,origin:t.origin};d&&Ci(e,"change",e,p),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}function In(e,t,n,r,i){if(r||(r=n),_o(r,n)<0){var o=r;r=n,n=o}"string"==typeof t&&(t=e.splitLines(t)),Tn(e,{from:n,to:r,text:t,origin:i})}function Pn(e,t){if(!Ti(e,"scrollCursorIntoView")){var n=e.display,r=n.sizer.getBoundingClientRect(),i=null;if(t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1),null!=i&&!Mo){var o=ji("div","\u200b",null,"position: absolute; top: "+(t.top-n.viewOffset-Ue(e.display))+"px; height: "+(t.bottom-t.top+Ye(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(i),e.display.lineSpace.removeChild(o)}}}function Rn(e,t,n,r){null==r&&(r=0);for(var i=0;5>i;i++){var o=!1,a=dt(e,t),l=n&&n!=t?dt(e,n):a,s=Hn(e,Math.min(a.left,l.left),Math.min(a.top,l.top)-r,Math.max(a.left,l.left),Math.max(a.bottom,l.bottom)+r),c=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=s.scrollTop&&(rn(e,s.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(o=!0)),null!=s.scrollLeft&&(on(e,s.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(o=!0)),!o)break}return a}function Dn(e,t,n,r,i){var o=Hn(e,t,n,r,i);null!=o.scrollTop&&rn(e,o.scrollTop),null!=o.scrollLeft&&on(e,o.scrollLeft)}function Hn(e,t,n,r,i){var o=e.display,a=yt(e.display);0>n&&(n=0);var l=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,s=Ve(e),c={};i-n>s&&(i=n+s);var u=e.doc.height+qe(o),f=a>n,h=i>u-a;if(l>n)c.scrollTop=f?0:n;else if(i>l+s){var d=Math.min(n,(h?u:i)-s);d!=l&&(c.scrollTop=d)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,m=$e(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),g=r-t>m;return g&&(r=t+m),10>t?c.scrollLeft=0:p>t?c.scrollLeft=Math.max(0,t-(g?0:10)):r>m+p-3&&(c.scrollLeft=r+(g?0:10)-m),c}function Wn(e,t,n){null==t&&null==n||_n(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Bn(e){_n(e);var t=e.getCursor(),n=t,r=t;e.options.lineWrapping||(n=t.ch?Bo(t.line,t.ch-1):t,r=Bo(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:r,margin:e.options.cursorScrollMargin,isCursor:!0}}function _n(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=pt(e,t.from),r=pt(e,t.to),i=Hn(e,Math.min(n.left,r.left),Math.min(n.top,r.top)-t.margin,Math.max(n.right,r.right),Math.max(n.bottom,r.bottom)+t.margin);e.scrollTo(i.scrollLeft,i.scrollTop)}}function Fn(e,t,n,r){var i,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?i=je(e,t):n="prev");var a=e.options.tabSize,l=Zr(o,t),s=Fa(l.text,null,a);l.stateAfter&&(l.stateAfter=null);var c,u=l.text.match(/^\s*/)[0];if(r||/\S/.test(l.text)){if("smart"==n&&((c=o.mode.indent(i,l.text.slice(u.length),l.text))==Ha||c>150)){if(!r)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?Fa(Zr(o,t-1).text,null,a):0:"add"==n?c=s+e.options.indentUnit:"subtract"==n?c=s-e.options.indentUnit:"number"==typeof n&&(c=s+n),c=Math.max(0,c);var f="",h=0;if(e.options.indentWithTabs)for(var d=Math.floor(c/a);d;--d)h+=a,f+="  ";if(c>h&&(f+=Oi(c-h)),f!=u)return In(o,f,Bo(t,0),Bo(t,u.length),"+input"),l.stateAfter=null,!0;for(d=0;d<o.sel.ranges.length;d++){var p=o.sel.ranges[d];if(p.head.line==t&&p.head.ch<u.length){ke(o,d,new fe(h=Bo(t,u.length),h));break}}}function zn(e,t,n,r){var i=t,o=t;return"number"==typeof t?o=Zr(e,pe(e,t)):i=ti(t),null==i?null:(r(o,i)&&e.cm&&Ht(e.cm,i,n),o)}function jn(e,t){for(var n=e.doc.sel.ranges,r=[],i=0;i<n.length;i++){for(var o=t(n[i]);r.length&&_o(o.from,Ii(r).to)<=0;){var a=r.pop();if(_o(a.from,o.from)<0){o.from=a.from;break}}r.push(o)}At(e,function(){for(var t=r.length-1;t>=0;t--)In(e.doc,"",r[t].from,r[t].to,"+delete");Bn(e)})}function Un(e,t,n,r,i){function o(){var t=l+n;return!(t<e.first||t>=e.first+e.size)&&(l=t,u=Zr(e,t))}function a(e){var t=(i?fo:ho)(u,s,n,!0);if(null==t){if(e||!o())return!1;s=i?(0>n?io:ro)(u):0>n?u.text.length:0}else s=t;return!0}var l=t.line,s=t.ch,c=n,u=Zr(e,l);if("char"==r)a();else if("column"==r)a(!0);else if("word"==r||"group"==r)for(var f=null,h="group"==r,d=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(0>n)||a(!p);p=!1){var m=u.text.charAt(s)||"\n",g=_i(m,d)?"w":h&&"\n"==m?"n":!h||/\s/.test(m)?null:"p";if(!h||p||g||(g="s"),f&&f!=g){0>n&&(n=1,a());break}if(g&&(f=g),n>0&&!a(!p))break}var v=Ie(e,Bo(l,s),t,c,!0);return _o(t,v)||(v.hitSide=!0),v}function qn(e,t,n,r){var i,o=e.doc,a=t.left;if("page"==r){var l=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);i=t.top+n*(l-(0>n?1.5:.5)*yt(e.display))}else"line"==r&&(i=n>0?t.bottom+3:t.top-3);for(;;){var s=gt(e,a,i);if(!s.outside)break;if(0>n?0>=i:i>=o.height){s.hitSide=!0;break}i+=5*n}return s}function Gn(t,n,r,i){e.defaults[t]=n,r&&(ta[t]=i?function(e,t,n){n!=na&&r(e,t,n)}:r)}function Yn(e){for(var t,n,r,i,o=e.split(/-(?!$)/),a=(e=o[o.length-1],0);a<o.length-1;a++){var l=o[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))t=!0;else if(/^(c|ctrl|control)$/i.test(l))n=!0;else{if(!/^s(hift)$/i.test(l))throw new Error("Unrecognized modifier name: "+l);r=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),i&&(e="Cmd-"+e),r&&(e="Shift-"+e),e}function $n(e){return"string"==typeof e?fa[e]:e}function Vn(e,t,n,r,i){if(r&&r.shared)return Kn(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return Et(e.cm,Vn)(e,t,n,r,i);var o=new va(e,i),a=_o(t,n);if(r&&Wi(r,o,!1),a>0||0==a&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=ji("span",[o.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(vr(e,t.line,t,n,o)||t.line!=n.line&&vr(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Wo=!0}o.addToHistory&&ci(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var l,s=t.line,c=e.cm;if(e.iter(s,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&yr(e)==c.display.maxLine&&(l=!0),o.collapsed&&s!=t.line&&ei(e,0),nr(e,new Qn(o,s==t.line?t.ch:null,s==n.line?n.ch:null)),++s}),o.collapsed&&e.iter(t.line,n.line+1,function(t){kr(e,t)&&ei(t,0)}),o.clearOnEnter&&Ea(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(Ho=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ga,o.atomic=!0),c){if(l&&(c.curOp.updateMaxLine=!0),o.collapsed)Dt(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var u=t.line;u<=n.line;u++)Ht(c,u,"text");o.atomic&&Ae(c.doc),Ci(c,"markerAdded",c,o)}return o}function Kn(e,t,n,r,i){(r=Wi(r)).shared=!1;var o=[Vn(e,t,n,r,i)],a=o[0],l=r.widgetNode;return Kr(e,function(e){l&&(r.widgetNode=l.cloneNode(!0)),o.push(Vn(e,me(e,t),me(e,n),r,i));for(var s=0;s<e.linked.length;++s)if(e.linked[s].isParent)return;a=Ii(o)}),new ya(o,a)}function Xn(e){return e.findMarks(Bo(e.first,0),e.clipPos(Bo(e.lastLine())),function(e){return e.parent})}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.find(),o=e.clipPos(i.from),a=e.clipPos(i.to);if(_o(o,a)){var l=Vn(e,o,a,r.primary,r.primary.type);r.markers.push(l),l.parent=r}}}function Jn(e){for(var t=0;t<e.length;t++){var n=e[t],r=[n.primary.doc];Kr(n.primary.doc,function(e){r.push(e)});for(var i=0;i<n.markers.length;i++){var o=n.markers[i];-1==Pi(r,o.doc)&&(o.parent=null,n.markers.splice(i--,1))}}}function Qn(e,t,n){this.marker=e,this.from=t,this.to=n}function er(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function tr(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function nr(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function rr(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],a=o.marker;if(null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(r||(r=[])).push(new Qn(a,o.from,s?null:o.to))}}return r}function ir(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var o=e[i],a=o.marker;if(null==o.to||(a.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(r||(r=[])).push(new Qn(a,s?null:o.from-t,null==o.to?null:o.to-t))}}return r}function or(e,t){if(t.full)return null;var n=ve(e,t.from.line)&&Zr(e,t.from.line).markedSpans,r=ve(e,t.to.line)&&Zr(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,o=t.to.ch,a=0==_o(t.from,t.to),l=rr(n,i,a),s=ir(r,o,a),c=1==t.text.length,u=Ii(t.text).length+(c?i:0);if(l)for(var f=0;f<l.length;++f){if(null==(h=l[f]).to)(d=er(s,h.marker))?c&&(h.to=null==d.to?null:d.to+u):h.to=i}if(s)for(f=0;f<s.length;++f){var h,d;if(null!=(h=s[f]).to&&(h.to+=u),null==h.from)(d=er(l,h.marker))||(h.from=u,c&&(l||(l=[])).push(h));else h.from+=u,c&&(l||(l=[])).push(h)}l&&(l=ar(l)),s&&s!=l&&(s=ar(s));var p=[l];if(!c){var m,g=t.text.length-2;if(g>0&&l)for(f=0;f<l.length;++f)null==l[f].to&&(m||(m=[])).push(new Qn(l[f].marker,null,null));for(f=0;g>f;++f)p.push(m);p.push(s)}return p}function ar(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function lr(e,t){var n=mi(e,t),r=or(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var o=n[i],a=r[i]
;if(o&&a)e:for(var l=0;l<a.length;++l){for(var s=a[l],c=0;c<o.length;++c)if(o[c].marker==s.marker)continue e;o.push(s)}else a&&(n[i]=a)}return n}function sr(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=Pi(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],o=0;o<r.length;++o)for(var a=r[o],l=a.find(0),s=0;s<i.length;++s){var c=i[s];if(!(_o(c.to,l.from)<0||_o(c.from,l.to)>0)){var u=[s,1],f=_o(c.from,l.from),h=_o(c.to,l.to);(0>f||!a.inclusiveLeft&&!f)&&u.push({from:c.from,to:l.from}),(h>0||!a.inclusiveRight&&!h)&&u.push({from:l.to,to:c.to}),i.splice.apply(i,u),s+=u.length-1}}return i}function cr(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function ur(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function fr(e){return e.inclusiveLeft?-1:0}function hr(e){return e.inclusiveRight?1:0}function dr(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var r=e.find(),i=t.find(),o=_o(r.from,i.from)||fr(e)-fr(t);if(o)return-o;var a=_o(r.to,i.to)||hr(e)-hr(t);return a||t.id-e.id}function pr(e,t){var n,r=Wo&&e.markedSpans;if(r)for(var i,o=0;o<r.length;++o)(i=r[o]).marker.collapsed&&null==(t?i.from:i.to)&&(!n||dr(n,i.marker)<0)&&(n=i.marker);return n}function mr(e){return pr(e,!0)}function gr(e){return pr(e,!1)}function vr(e,t,n,r,i){var o=Zr(e,t),a=Wo&&o.markedSpans;if(a)for(var l=0;l<a.length;++l){var s=a[l];if(s.marker.collapsed){var c=s.marker.find(0),u=_o(c.from,n)||fr(s.marker)-fr(i),f=_o(c.to,r)||hr(s.marker)-hr(i);if(!(u>=0&&0>=f||0>=u&&f>=0)&&(0>=u&&(s.marker.inclusiveRight&&i.inclusiveLeft?_o(c.to,n)>=0:_o(c.to,n)>0)||u>=0&&(s.marker.inclusiveRight&&i.inclusiveLeft?_o(c.from,r)<=0:_o(c.from,r)<0)))return!0}}}function yr(e){for(var t;t=mr(e);)e=t.find(-1,!0).line;return e}function xr(e){for(var t,n;t=gr(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function br(e,t){var n=Zr(e,t),r=yr(n);return n==r?t:ti(r)}function wr(e,t){if(t>e.lastLine())return t;var n,r=Zr(e,t);if(!kr(e,r))return t;for(;n=gr(r);)r=n.find(1,!0).line;return ti(r)+1}function kr(e,t){var n=Wo&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i)if((r=n[i]).marker.collapsed){if(null==r.from)return!0;if(!r.marker.widgetNode&&0==r.from&&r.marker.inclusiveLeft&&Sr(e,t,r))return!0}}function Sr(e,t,n){if(null==n.to){var r=n.marker.find(1,!0);return Sr(e,r.line,er(r.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var i,o=0;o<t.markedSpans.length;++o)if((i=t.markedSpans[o]).marker.collapsed&&!i.marker.widgetNode&&i.from==n.to&&(null==i.to||i.to!=n.from)&&(i.marker.inclusiveLeft||n.marker.inclusiveRight)&&Sr(e,t,i))return!0}function Cr(e,t,n){ri(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Wn(e,null,n)}function Lr(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Va(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),qi(t.display.measure,ji("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Tr(e,t,n,r){var i=new xa(e,n,r),o=e.cm;return o&&i.noHScroll&&(o.display.alignWidgets=!0),zn(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==i.insertAt?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t,o&&!kr(e,t)){var r=ri(t)<e.scrollTop;ei(t,t.height+Lr(i)),r&&Wn(o,null,i.height),o.curOp.forceUpdate=!0}return!0}),i}function Mr(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),cr(e),ur(e,n);var i=r?r(e):1;i!=e.height&&ei(e,i)}function Nr(e){e.parent=null,cr(e)}function Ar(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var r=n[1]?"bgClass":"textClass";null==t[r]?t[r]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+n[2])}return e}function Er(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var r=e.innerMode(t,n);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function Or(t,n,r,i){for(var o=0;10>o;o++){i&&(i[0]=e.innerMode(t,r).mode);var a=t.token(n,r);if(n.pos>n.start)return a}throw new Error("Mode "+t.name+" failed to advance stream.")}function Ir(e,t,n,r){function i(e){return{start:f.start,end:f.pos,string:f.current(),type:o||null,state:e?sa(a.mode,u):u}}var o,a=e.doc,l=a.mode;t=me(a,t);var s,c=Zr(a,t.line),u=je(e,t.line,n),f=new ma(c.text,e.options.tabSize);for(r&&(s=[]);(r||f.pos<t.ch)&&!f.eol();)f.start=f.pos,o=Or(l,f,u),r&&s.push(i(!0));return r?s:i()}function Pr(e,t,n,r,i,o,a){var l=n.flattenSpans;null==l&&(l=e.options.flattenSpans);var s,c=0,u=null,f=new ma(t,e.options.tabSize),h=e.options.addModeClass&&[null];for(""==t&&Ar(Er(n,r),o);!f.eol();){if(f.pos>e.options.maxHighlightLength?(l=!1,a&&Hr(e,t,r,f.pos),f.pos=t.length,s=null):s=Ar(Or(n,f,r,h),o),h){var d=h[0].name;d&&(s="m-"+(s?d+" "+s:d))}if(!l||u!=s){for(;c<f.start;)i(c=Math.min(f.start,c+5e4),u);u=s}f.start=f.pos}for(;c<f.pos;){var p=Math.min(f.pos,c+5e4);i(p,u),c=p}}function Rr(e,t,n,r){var i=[e.state.modeGen],o={};Pr(e,t.text,e.doc.mode,n,function(e,t){i.push(e,t)},o,r);for(var a=0;a<e.state.overlays.length;++a){var l=e.state.overlays[a],s=1,c=0;Pr(e,t.text,l.mode,!0,function(e,t){for(var n=s;e>c;){var r=i[s];r>e&&i.splice(s,1,e,i[s+1],r),s+=2,c=Math.min(e,r)}if(t)if(l.opaque)i.splice(n,s-n,e,"cm-overlay "+t),s=n+2;else for(;s>n;n+=2){var o=i[n+1];i[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:i,classes:o.bgClass||o.textClass?o:null}}function Dr(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=je(e,ti(t)),i=Rr(e,t,t.text.length>e.options.maxHighlightLength?sa(e.doc.mode,r):r);t.stateAfter=r,t.styles=i.styles,i.classes?t.styleClasses=i.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Hr(e,t,n,r){var i=e.doc.mode,o=new ma(t,e.options.tabSize);for(o.start=o.pos=r||0,""==t&&Er(i,n);!o.eol();)Or(i,o,n),o.start=o.pos}function Wr(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?ka:wa;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function Br(e,t){var n=ji("span",null,null,wo?"padding-right: .1px":null),r={pre:ji("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,splitSpaces:(xo||wo)&&e.getOption("lineWrapping")};t.measure={};for(var i=0;i<=(t.rest?t.rest.length:0);i++){var o,a=i?t.rest[i-1]:t.line;r.pos=0,r.addToken=Fr,Ji(e.display.measure)&&(o=ii(a))&&(r.addToken=jr(r.addToken,o)),r.map=[],qr(a,r,Dr(e,a,t!=e.display.externalMeasured&&ti(a))),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=$i(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass&&(r.textClass=$i(a.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(Zi(e.display.measure))),0==i?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(wo){var s=r.content.lastChild;(/\bcm-tab\b/.test(s.className)||s.querySelector&&s.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return Pa(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=$i(r.pre.className,r.textClass||"")),r}function _r(e){var t=ji("span","\u2022","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Fr(e,t,n,r,i,o,a){if(t){var l=e.splitSpaces?t.replace(/ {3,}/g,zr):t,s=e.cm.state.specialChars,c=!1;if(s.test(t))for(var u=document.createDocumentFragment(),f=0;;){s.lastIndex=f;var h=s.exec(t),d=h?h.index-f:t.length-f;if(d){var p=document.createTextNode(l.slice(f,f+d));xo&&9>bo?u.appendChild(ji("span",[p])):u.appendChild(p),e.map.push(e.pos,e.pos+d,p),e.col+=d,e.pos+=d}if(!h)break;if(f+=d+1," "==h[0]){var m=e.cm.options.tabSize,g=m-e.col%m;(p=u.appendChild(ji("span",Oi(g),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text"," "),e.col+=g}else if("\r"==h[0]||"\n"==h[0]){(p=u.appendChild(ji("span","\r"==h[0]?"\u240d":"\u2424","cm-invalidchar"))).setAttribute("cm-text",h[0]),e.col+=1}else{(p=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),xo&&9>bo?u.appendChild(ji("span",[p])):u.appendChild(p),e.col+=1}e.map.push(e.pos,e.pos+1,p),e.pos++}else{e.col+=t.length;u=document.createTextNode(l);e.map.push(e.pos,e.pos+t.length,u),xo&&9>bo&&(c=!0),e.pos+=t.length}if(n||r||i||c||a){var v=n||"";r&&(v+=r),i&&(v+=i);var y=ji("span",[u],v,a);return o&&(y.title=o),e.content.appendChild(y)}e.content.appendChild(u)}}function zr(e){for(var t=" ",n=0;n<e.length-2;++n)t+=" ";return t+" "}function jr(e,t){return function(n,r,i,o,a,l,s){i=i?i+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+r.length;;){for(var f=0;f<t.length;f++){var h=t[f];if(h.to>c&&h.from<=c)break}if(h.to>=u)return e(n,r,i,o,a,l,s);e(n,r.slice(0,h.to-c),i,o,null,l,s),o=null,r=r.slice(h.to-c),c=h.to}}}function Ur(e,t,n,r){var i=!r&&n.widgetNode;i&&e.map.push(e.pos,e.pos+t,i),!r&&e.cm.display.input.needsContentAttribute&&(i||(i=e.content.appendChild(document.createElement("span"))),i.setAttribute("cm-marker",n.id)),i&&(e.cm.display.input.setUneditable(i),e.content.appendChild(i)),e.pos+=t}function qr(e,t,n){var r=e.markedSpans,i=e.text,o=0;if(r)for(var a,l,s,c,u,f,h,d=i.length,p=0,m=1,g="",v=0;;){if(v==p){s=c=u=f=l="",h=null,v=1/0;for(var y,x=[],b=0;b<r.length;++b){var w=r[b],k=w.marker;"bookmark"==k.type&&w.from==p&&k.widgetNode?x.push(k):w.from<=p&&(null==w.to||w.to>p||k.collapsed&&w.to==p&&w.from==p)?(null!=w.to&&w.to!=p&&v>w.to&&(v=w.to,c=""),k.className&&(s+=" "+k.className),k.css&&(l=(l?l+";":"")+k.css),k.startStyle&&w.from==p&&(u+=" "+k.startStyle),k.endStyle&&w.to==v&&(y||(y=[])).push(k.endStyle,w.to),k.title&&!f&&(f=k.title),k.collapsed&&(!h||dr(h.marker,k)<0)&&(h=w)):w.from>p&&v>w.from&&(v=w.from)}if(y)for(b=0;b<y.length;b+=2)y[b+1]==v&&(c+=" "+y[b]);if(!h||h.from==p)for(b=0;b<x.length;++b)Ur(t,0,x[b]);if(h&&(h.from||0)==p){if(Ur(t,(null==h.to?d+1:h.to)-p,h.marker,null==h.from),null==h.to)return;h.to==p&&(h=!1)}}if(p>=d)break;for(var S=Math.min(d,v);;){if(g){var C=p+g.length;if(!h){var L=C>S?g.slice(0,S-p):g;t.addToken(t,L,a?a+s:s,u,p+L.length==v?c:"",f,l)}if(C>=S){g=g.slice(S-p),p=S;break}p=C,u=""}g=i.slice(o,o=n[m++]),a=Wr(n[m++],t.cm.options)}}else for(m=1;m<n.length;m+=2)t.addToken(t,i.slice(o,o=n[m]),Wr(n[m+1],t.cm.options))}function Gr(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Ii(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Yr(e,t,n,r){function i(e){return n?n[e]:null}function o(e,n,i){Mr(e,n,i,r),Ci(e,"change",e,t)}function a(e,t){for(var n=e,o=[];t>n;++n)o.push(new ba(c[n],i(n),r));return o}var l=t.from,s=t.to,c=t.text,u=Zr(e,l.line),f=Zr(e,s.line),h=Ii(c),d=i(c.length-1),p=s.line-l.line;if(t.full)e.insert(0,a(0,c.length)),e.remove(c.length,e.size-c.length);else if(Gr(e,t)){var m=a(0,c.length-1);o(f,f.text,d),p&&e.remove(l.line,p),m.length&&e.insert(l.line,m)}else if(u==f)if(1==c.length)o(u,u.text.slice(0,l.ch)+h+u.text.slice(s.ch),d);else{(m=a(1,c.length-1)).push(new ba(h+u.text.slice(s.ch),d,r)),o(u,u.text.slice(0,l.ch)+c[0],i(0)),e.insert(l.line+1,m)}else if(1==c.length)o(u,u.text.slice(0,l.ch)+c[0]+f.text.slice(s.ch),i(0)),e.remove(l.line+1,p);else{o(u,u.text.slice(0,l.ch)+c[0],i(0)),o(f,h+f.text.slice(s.ch),d);m=a(1,c.length-1);p>1&&e.remove(l.line+1,p-1),e.insert(l.line+1,m)}Ci(e,"change",e,t)}function $r(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Vr(e){this.children=e;for(var t=0,n=0,r=0;r<e.length;++r){var i=e[r];t+=i.chunkSize(),n+=i.height,i.parent=this}this.size=t,this.height=n,this.parent=null}function Kr(e,t,n){function r(e,i,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var l=e.linked[a];if(l.doc!=i){var s=o&&l.sharedHist;n&&!s||(t(l.doc,s),r(l.doc,e,s))}}}r(e,null,!0)}function Xr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),n(e),e.options.lineWrapping||h(e),e.options.mode=t.modeOption,Dt(e)}function Zr(e,t){if(0>(t-=e.first)||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var r=0;;++r){var i=n.children[r],o=i.chunkSize();if(o>t){n=i;break}t-=o}return n.lines[t]}function Jr(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;i==n.line&&(o=o.slice(0,n.ch)),i==t.line&&(o=o.slice(t.ch)),r.push(o),++i}),r}function Qr(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function ei(e,t){var n=t-e.height;if(n)for(var r=e;r;r=r.parent)r.height+=n}function ti(e){if(null==e.parent)return null;for(var t=e.parent,n=Pi(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n+t.first}function ni(e,t){var n=e.first;e:do{for(var r=0;r<e.children.length;++r){var i=e.children[r],o=i.height;if(o>t){e=i;continue e}t-=o,n+=i.chunkSize()}return n}while(!e.lines);for(r=0;r<e.lines.length;++r){var l=e.lines[r].height;if(l>t)break;t-=l}return n+r}function ri(e){for(var t=0,n=(e=yr(e)).parent,r=0;r<n.lines.length;++r){var i=n.lines[r];if(i==e)break;t+=i.height}for(var o=n.parent;o;o=(n=o).parent)for(r=0;r<o.children.length;++r){var a=o.children[r];if(a==n)break;t+=a.height}return t}function ii(e){var t=e.order;return null==t&&(t=e.order=ll(e.text)),t}function oi(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function ai(e,t){var n={from:$(t.from),to:Qo(t),text:Jr(e,t.from,t.to)};return di(e,n,t.from.line,t.to.line+1),Kr(e,function(e){di(e,n,t.from.line,t.to.line+1)},!0),n}function li(e){for(;e.length;){if(!Ii(e).ranges)break;e.pop()}}function si(e,t){return t?(li(e.done),Ii(e.done)):e.done.length&&!Ii(e.done).ranges?Ii(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Ii(e.done)):void 0}function ci(e,t,n,r){var i=e.history;i.undone.length=0;var o,a=+new Date;if((i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&i.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=si(i,i.lastOp==r))){var l=Ii(o.changes);0==_o(t.from,t.to)&&0==_o(t.from,l.to)?l.to=Qo(t):o.changes.push(ai(e,t))}else{var s=Ii(i.done);for(s&&s.ranges||hi(e.sel,i.done),o={changes:[ai(e,t)],generation:i.generation},i.done.push(o);i.done.length>i.undoDepth;)i.done.shift(),i.done[0].ranges||i.done.shift()}i.done.push(n),i.generation=++i.maxGeneration,i.lastModTime=i.lastSelTime=a,i.lastOp=i.lastSelOp=r,i.lastOrigin=i.lastSelOrigin=t.origin,l||Pa(e,"historyAdded")}function ui(e,t,n,r){var i=t.charAt(0);return"*"==i||"+"==i&&n.ranges.length==r.ranges.length&&n.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function fi(e,t,n,r){var i=e.history,o=r&&r.origin;n==i.lastSelOp||o&&i.lastSelOrigin==o&&(i.lastModTime==i.lastSelTime&&i.lastOrigin==o||ui(e,o,Ii(i.done),t))?i.done[i.done.length-1]=t:hi(t,i.done),i.lastSelTime=+new Date,i.lastSelOrigin=o,i.lastSelOp=n,r&&!1!==r.clearRedo&&li(i.undone)}function hi(e,t){var n=Ii(t);n&&n.ranges&&n.equals(e)||t.push(e)}function di(e,t,n,r){var i=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function pi(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function mi(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(pi(n[r]));return i}function gi(e,t,n){for(var r=0,i=[];r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?ue.prototype.deepCopy.call(o):o);else{var a=o.changes,l=[];i.push({changes:l});for(var s=0;s<a.length;++s){var c,u=a[s];if(l.push({from:u.from,to:u.to,text:u.text}),t)for(var f in u)(c=f.match(/^spans_(\d+)$/))&&Pi(t,Number(c[1]))>-1&&(Ii(l)[f]=u[f],delete u[f])}}}return i}function vi(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function yi(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i],a=!0;if(o.ranges){o.copied||((o=e[i]=o.deepCopy()).copied=!0);for(var l=0;l<o.ranges.length;l++)vi(o.ranges[l].anchor,t,n,r),vi(o.ranges[l].head,t,n,r)}else{for(l=0;l<o.changes.length;++l){var s=o.changes[l];if(n<s.from.line)s.from=Bo(s.from.line+r,s.from.ch),s.to=Bo(s.to.line+r,s.to.ch);else if(t<=s.to.line){a=!1;break}}a||(e.splice(0,i+1),i=0)}}}function xi(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;yi(e.done,n,r,i),yi(e.undone,n,r,i)}function bi(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function wi(e){return e.target||e.srcElement}function ki(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Eo&&e.ctrlKey&&1==t&&(t=3),t}function Si(e,t,n){var r=e._handlers&&e._handlers[t];return n?r&&r.length>0?r.slice():Oa:r||Oa}function Ci(e,t){function n(e){return function(){e.apply(null,o)}}var r=Si(e,t,!1);if(r.length){var i,o=Array.prototype.slice.call(arguments,2);Go?i=Go.delayedCallbacks:Ra?i=Ra:(i=Ra=[],setTimeout(Li,0));for(var a=0;a<r.length;++a)i.push(n(r[a]))}}function Li(){var e=Ra;Ra=null;for(var t=0;t<e.length;++t)e[t]()}function Ti(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Pa(e,n||t.type,e,t),bi(t)||t.codemirrorIgnore}function Mi(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)-1==Pi(n,t[r])&&n.push(t[r])}function Ni(e,t){return Si(e,t).length>0}function Ai(e){e.prototype.on=function(e,t){Ea(this,e,t)},e.prototype.off=function(e,t){Ia(this,e,t)}}function Ei(){this.id=null}function Oi(e){for(;ja.length<=e;)ja.push(Ii(ja)+" ");return ja[e]}function Ii(e){return e[e.length-1]}function Pi(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function Ri(e,t){for(var n=[],r=0;r<e.length;r++)n[r]=t(e[r],r);return n}function Di(){}function Hi(e,t){var n;return Object.create?n=Object.create(e):(Di.prototype=e,n=new Di),t&&Wi(t,n),n}function Wi(e,t,n){for(var r in t||(t={}),e)!e.hasOwnProperty(r)||!1===n&&t.hasOwnProperty(r)||(t[r]=e[r]);return t}function Bi(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function _i(e,t){return t?!!(t.source.indexOf("\\w")>-1&&Ya(e))||t.test(e):Ya(e)}function Fi(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function zi(e){return e.charCodeAt(0)>=768&&$a.test(e)}function ji(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)i.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)i.appendChild(t[o]);return i}function Ui(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function qi(e,t){return Ui(e).appendChild(t)}function Gi(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function Yi(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function $i(e,t){for(var n=e.split(" "),r=0;r<n.length;r++)n[r]&&!Yi(n[r]).test(t)&&(t+=" "+n[r]);return t}function Vi(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var r=t[n].CodeMirror;r&&e(r)}}function Ki(){Qa||(Xi(),Qa=!0)}function Xi(){var e;Ea(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Vi(qt)},100))}),Ea(window,"blur",function(){Vi(yn)})}function Zi(e){if(null==Ka){var t=ji("span","\u200b");qi(e,ji("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ka=t.offsetWidth<=1&&t.offsetHeight>2&&!(xo&&8>bo))}var n=Ka?ji("span","\u200b"):ji("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Ji(e){if(null!=Xa)return Xa;var t=qi(e,document.createTextNode("A\u062eA")),n=qa(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var r=qa(t,1,2).getBoundingClientRect();return Xa=r.right-n.right<3}function Qi(e){if(null!=il)return il;var t=qi(e,ji("span","x")),n=t.getBoundingClientRect(),r=qa(t,0,1).getBoundingClientRect();return il=Math.abs(n.left-r.left)>1}function eo(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(r(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),i=!0)}i||r(t,n,"ltr")}function to(e){return e.level%2?e.to:e.from}function no(e){return e.level%2?e.from:e.to}function ro(e){var t=ii(e);return t?to(t[0]):0}function io(e){var t=ii(e);return t?no(Ii(t)):e.text.length}function oo(e,t){var n=Zr(e.doc,t),r=yr(n);r!=n&&(t=ti(r));var i=ii(r),o=i?i[0].level%2?io(r):ro(r):0;return Bo(t,o)}function ao(e,t){for(var n,r=Zr(e.doc,t);n=gr(r);)r=n.find(1,!0).line,t=null;var i=ii(r),o=i?i[0].level%2?ro(r):io(r):r.text.length;return Bo(null==t?ti(r):t,o)}function lo(e,t){var n=oo(e,t.line),r=Zr(e.doc,n.line),i=ii(r);if(!i||0==i[0].level){var o=Math.max(0,r.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return Bo(n.line,a?0:o)}return n}function so(e,t,n){var r=e[0].level;return t==r||n!=r&&n>t}function co(e,t){al=null;for(var n,r=0;r<e.length;++r){var i=e[r];if(i.from<t&&i.to>t)return r;if(i.from==t||i.to==t){if(null!=n)return so(e,i.level,e[n].level)?(i.from!=i.to&&(al=n),r):(i.from!=i.to&&(al=r),n);n=r}}return n}function uo(e,t,n,r){if(!r)return t+n;do{t+=n}while(t>0&&zi(e.text.charAt(t)));return t}function fo(e,t,n,r){var i=ii(e);if(!i)return ho(e,t,n,r);for(var o=co(i,t),a=i[o],l=uo(e,t,a.level%2?-n:n,r);;){if(l>a.from&&l<a.to)return l;if(l==a.from||l==a.to)return co(i,l)==o?l:n>0==(a=i[o+=n]).level%2?a.to:a.from;if(!(a=i[o+=n]))return null;l=n>0==a.level%2?uo(e,a.to,-1,r):uo(e,a.from,1,r)}}function ho(e,t,n,r){var i=t+n;if(r)for(;i>0&&zi(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var po=navigator.userAgent,mo=navigator.platform,go=/gecko\/\d/i.test(po),vo=/MSIE \d/.test(po),yo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(po),xo=vo||yo,bo=xo&&(vo?document.documentMode||6:yo[1]),wo=/WebKit\//.test(po),ko=wo&&/Qt\/\d+\.\d+/.test(po),So=/Chrome\//.test(po),Co=/Opera\//.test(po),Lo=/Apple Computer/.test(navigator.vendor),To=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(po),Mo=/PhantomJS/.test(po),No=/AppleWebKit/.test(po)&&/Mobile\/\w+/.test(po),Ao=No||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(po),Eo=No||/Mac/.test(mo),Oo=/\bCrOS\b/.test(po),Io=/win/i.test(mo),Po=Co&&po.match(/Version\/(\d*\.\d*)/);Po&&(Po=Number(Po[1])),Po&&Po>=15&&(Co=!1,wo=!0);var Ro=Eo&&(ko||Co&&(null==Po||12.11>Po)),Do=go||xo&&bo>=9,Ho=!1,Wo=!1;m.prototype=Wi({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var i=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?r:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?r:0,bottom:t?r:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=Eo&&!To?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Ei,this.disableVert=new Ei},enableZeroWidthBar:function(e,t){function n(){var r=e.getBoundingClientRect();document.elementFromPoint(r.left+1,r.bottom-1)!=e?e.style.pointerEvents="none":t.set(1e3,n)}e.style.pointerEvents="auto",t.set(1e3,n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},m.prototype),g.prototype=Wi({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),e.scrollbarModel={native:m,"null":g},L.prototype.signal=function(e,t){Ni(e,t)&&this.events.push(arguments)},L.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Pa.apply(null,this.events[e])};var Bo=e.Pos=function(e,t){return this instanceof Bo?(this.line=e,void(this.ch=t)):new Bo(e,t)},_o=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Fo=null;ne.prototype=Wi({init:function(e){function t(e){if(!Ti(r,e)){if(r.somethingSelected())Fo={lineWise:!1,text:r.getSelections()},n.inaccurateSelection&&(n.prevInput="",n.inaccurateSelection=!1,o.value=Fo.text.join("\n"),Ua(o));else{if(!r.options.lineWiseCopyCut)return;var t=ee(r);Fo={lineWise:!0,text:t.text},"cut"==e.type?r.setSelections(t.ranges,null,Wa):(n.prevInput="",o.value=t.text.join("\n"),Ua(o))}"cut"==e.type&&(r.state.cutIncoming=!0)}}var n=this,r=this.cm,i=this.wrapper=re(),o=this.textarea=i.firstChild;e.wrapper.insertBefore(i,e.wrapper.firstChild),No&&(o.style.width="0px"),Ea(o,"input",function(){xo&&bo>=9&&n.hasSelection&&(n.hasSelection=null),n.poll()}),Ea(o,"paste",function(e){Ti(r,e)||J(e,r)||(r.state.pasteIncoming=!0,n.fastPoll())}),Ea(o,"cut",t),Ea(o,"copy",t),Ea(e.scroller,"paste",function(t){Gt(e,t)||Ti(r,t)||(r.state.pasteIncoming=!0,n.focus())}),Ea(e.lineSpace,"selectstart",function(t){Gt(e,t)||Ma(t)}),Ea(o,"compositionstart",function(){var e=r.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:r.markText(e,r.getCursor("to"),{className:"CodeMirror-composing"})}}),Ea(o,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,r=De(e);if(e.options.moveInputWithCursor){var i=dt(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,i.top+a.top-o.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,i.left+a.left-o.left))}return r},showSelection:function(e){var n=this.cm.display;qi(n.cursorDiv,e.cursors),qi(n.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,n,r=this.cm,i=r.doc;if(r.somethingSelected()){this.prevInput="";var o=i.sel.primary(),a=(t=rl&&(o.to().line-o.from().line>100||(n=r.getSelection()).length>1e3))?"-":n||r.getSelection();this.textarea.value=a,r.state.focused&&Ua(this.textarea),xo&&bo>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",xo&&bo>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Ao||Gi()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){n.poll()||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))}var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,e)},poll:function(){var e=this.cm,t=this.textarea,n=this.prevInput;if(this.contextMenuPending||!e.state.focused||nl(t)&&!n&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var r=t.value;if(r==n&&!e.somethingSelected())return!1;if(xo&&bo>=9&&this.hasSelection===r||Eo&&/[\uf700-\uf7ff]/.test(r))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var i=r.charCodeAt(0);if(8203!=i||n||(n="\u200b"),8666==i)return this.reset(),this.cm.execCommand("undo")}for(var o=0,a=Math.min(n.length,r.length);a>o&&n.charCodeAt(o)==r.charCodeAt(o);)++o;var l=this;return At(e,function(){Z(e,r.slice(o),n.length-o,null,l.composing?"*compose":null),r.length>1e3||r.indexOf("\n")>-1?t.value=l.prevInput="":l.prevInput=r,l.composing&&(l.composing.range.clear(),l.composing.range=e.markText(l.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){xo&&bo>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=a.selectionStart){var e=i.somethingSelected(),t="\u200b"+(e?a.value:"");a.value="\u21da",a.value=t,r.prevInput=e?"":"\u200b",a.selectionStart=1,a.selectionEnd=t.length,o.selForContextMenu=i.doc.sel}}function n(){if(r.contextMenuPending=!1,r.wrapper.style.cssText=f,a.style.cssText=u,xo&&9>bo&&o.scrollbars.setScrollTop(o.scroller.scrollTop=s),null!=a.selectionStart){(!xo||xo&&9>bo)&&t();var e=0,n=function(){o.selForContextMenu==i.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&"\u200b"==r.prevInput?Et(i,ua.selectAll)(i):e++<10?o.detectingSelectAll=setTimeout(n,500):o.input.reset()};o.detectingSelectAll=setTimeout(n,200)}}var r=this,i=r.cm,o=i.display,a=r.textarea,l=Yt(i,e),s=o.scroller.scrollTop;if(l&&!Co){i.options.resetSelectionOnContextMenu&&-1==i.doc.sel.contains(l)&&Et(i,Te)(i.doc,de(l),Wa);var u=a.style.cssText,f=r.wrapper.style.cssText;r.wrapper.style.cssText="position: absolute";var h=r.wrapper.getBoundingClientRect();if(a.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(e.clientY-h.top-5)+"px; left: "+(e.clientX-h.left-5)+"px; z-index: 1000; background: "+(xo?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",wo)var d=window.scrollY;if(o.input.focus(),wo&&window.scrollTo(null,d),o.input.reset(),i.somethingSelected()||(a.value=r.prevInput=" "),r.contextMenuPending=!0,o.selForContextMenu=i.doc.sel,clearTimeout(o.detectingSelectAll),xo&&bo>=9&&t(),Do){Aa(e);var p=function(){Ia(window,"mouseup",p),setTimeout(n,20)};Ea(window,"mouseup",p)}else setTimeout(n,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:Di,needsContentAttribute:!1},ne.prototype),ie.prototype=Wi({init:function(e){function t(e){if(!Ti(r,e)){if(r.somethingSelected())Fo={lineWise:!1,text:r.getSelections()},"cut"==e.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;var t=ee(r);Fo={lineWise:!0,text:t.text},"cut"==e.type&&r.operation(function(){r.setSelections(t.ranges,0,Wa),r.replaceSelection("",null,"cut")})}if(e.clipboardData&&!No)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Fo.text.join("\n"));else{var n=re(),i=n.firstChild;r.display.lineSpace.insertBefore(n,r.display.lineSpace.firstChild),i.value=Fo.text.join("\n");var o=document.activeElement;Ua(i),setTimeout(function(){r.display.lineSpace.removeChild(n),o.focus()},50)}}}var n=this,r=n.cm,i=n.div=e.lineDiv;te(i),Ea(i,"paste",function(e){Ti(r,e)||J(e,r)}),Ea(i,"compositionstart",function(e){var t=e.data;if(n.composing={sel:r.doc.sel,data:t,startData:t},t){var i=r.doc.sel.primary(),a=r.getLine(i.head.line).indexOf(t,Math.max(0,i.head.ch-t.length));a>-1&&a<=i.head.ch&&(n.composing.sel=de(Bo(i.head.line,a),Bo(i.head.line,a+t.length)))}}),Ea(i,"compositionupdate",function(e){n.composing.data=e.data}),Ea(i,"compositionend",function(e){var t=n.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||n.applyComposition(t),n.composing==t&&(n.composing=null)},50))}),Ea(i,"touchstart",function(){n.forceCompositionEnd()}),Ea(i,"input",function(){n.composing||!r.isReadOnly()&&n.pollContent()||At(n.cm,function(){Dt(r)})}),Ea(i,"copy",t),Ea(i,"cut",t)},prepareSelection:function(){var e=De(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),n=le(this.cm,e.anchorNode,e.anchorOffset),r=le(this.cm,e.focusNode,e.focusOffset)
;if(!n||n.bad||!r||r.bad||0!=_o(K(n,r),t.from())||0!=_o(V(n,r),t.to())){var i=oe(this.cm,t.from()),o=oe(this.cm,t.to());if(i||o){var a=this.cm.display.view,l=e.rangeCount&&e.getRangeAt(0);if(i){if(!o){var s=a[a.length-1].measure,c=s.maps?s.maps[s.maps.length-1]:s.map;o={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else i={node:a[0].measure.map[2],offset:0};try{var u=qa(i.node,i.offset,o.offset,o.node)}catch(f){}u&&(!go&&this.cm.state.focused?(e.collapse(i.node,i.offset),u.collapsed||e.addRange(u)):(e.removeAllRanges(),e.addRange(u)),l&&null==e.anchorNode?e.addRange(l):go&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){qi(this.cm.display.cursorDiv,e.cursors),qi(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Va(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():At(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=le(t,e.anchorNode,e.anchorOffset),r=le(t,e.focusNode,e.focusOffset);n&&r&&At(t,function(){Te(t.doc,de(n,r),Wa),(n.bad||r.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var o,e=this.cm,t=e.display,n=e.doc.sel.primary(),r=n.from(),i=n.to();if(r.line<t.viewFrom||i.line>t.viewTo-1)return!1;if(r.line==t.viewFrom||0==(o=Bt(e,r.line)))var a=ti(t.view[0].line),l=t.view[0].node;else a=ti(t.view[o].line),l=t.view[o-1].node.nextSibling;var s=Bt(e,i.line);if(s==t.view.length-1)var c=t.viewTo-1,u=t.lineDiv.lastChild;else c=ti(t.view[s+1].line)-1,u=t.view[s+1].node.previousSibling;for(var f=e.doc.splitLines(ce(e,l,u,a,c)),h=Jr(e.doc,Bo(a,0),Bo(c,Zr(e.doc,c).text.length));f.length>1&&h.length>1;)if(Ii(f)==Ii(h))f.pop(),h.pop(),c--;else{if(f[0]!=h[0])break;f.shift(),h.shift(),a++}for(var d=0,p=0,m=f[0],g=h[0],v=Math.min(m.length,g.length);v>d&&m.charCodeAt(d)==g.charCodeAt(d);)++d;for(var y=Ii(f),x=Ii(h),b=Math.min(y.length-(1==f.length?d:0),x.length-(1==h.length?d:0));b>p&&y.charCodeAt(y.length-p-1)==x.charCodeAt(x.length-p-1);)++p;f[f.length-1]=y.slice(0,y.length-p),f[0]=f[0].slice(d);var w=Bo(a,d),k=Bo(c,h.length?Ii(h).length-p:0);return f.length>1||f[0]||_o(w,k)?(In(e.doc,f,w,k,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?Et(this.cm,Dt)(this.cm):e.data&&e.data!=e.startData&&Et(this.cm,Z)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||Et(this.cm,Z)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:Di,resetPosition:Di,needsContentAttribute:!0},ie.prototype),e.inputStyles={textarea:ne,contenteditable:ie},ue.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],r=e.ranges[t];if(0!=_o(n.anchor,r.anchor)||0!=_o(n.head,r.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new fe($(this.ranges[t].anchor),$(this.ranges[t].head));return new ue(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var r=this.ranges[n];if(_o(t,r.from())>=0&&_o(e,r.to())<=0)return n}return-1}},fe.prototype={from:function(){return K(this.anchor,this.head)},to:function(){return V(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var zo,jo,Uo,qo={left:0,right:0,top:0,bottom:0},Go=null,Yo=0,$o=0,Vo=0,Ko=null;xo?Ko=-.53:go?Ko=15:So?Ko=-.7:Lo&&(Ko=-1/3);var Xo=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}};e.wheelEventPixels=function(e){var t=Xo(e);return t.x*=Ko,t.y*=Ko,t};var Zo=new Ei,Jo=null,Qo=e.changeEnd=function(e){return e.text?Bo(e.from.line+e.text.length-1,Ii(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,r=n[e];n[e]==t&&"mode"!=e||(n[e]=t,ta.hasOwnProperty(e)&&Et(this,ta[e])(this,t,r))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"]($n(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Ot(function(t,n){var r=t.token?t:e.getMode(this.options,t);if(r.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:r,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,Dt(this)}),removeOverlay:Ot(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||"string"==typeof e&&r.name==e)return t.splice(n,1),this.state.modeGen++,void Dt(this)}}),indentLine:Ot(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),ve(this.doc,e)&&Fn(this,e,t,n)}),indentSelection:Ot(function(e){for(var t=this.doc.sel.ranges,n=-1,r=0;r<t.length;r++){var i=t[r];if(i.empty())i.head.line>n&&(Fn(this,i.head.line,e,!0),n=i.head.line,r==this.doc.sel.primIndex&&Bn(this));else{var o=i.from(),a=i.to(),l=Math.max(n,o.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var s=l;n>s;++s)Fn(this,s,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[r].from().ch>0&&ke(this.doc,r,new fe(o,c[r].to()),Wa)}}}),getTokenAt:function(e,t){return Ir(this,e,t)},getLineTokens:function(e,t){return Ir(this,Bo(e),t,!0)},getTokenTypeAt:function(e){e=me(this.doc,e);var t,n=Dr(this,Zr(this.doc,e.line)),r=0,i=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=r+i>>1;if((a?n[2*a-1]:0)>=o)i=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}r=a+1}}var l=t?t.indexOf("cm-overlay "):-1;return 0>l?t:0==l?null:t.slice(0,l-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!la.hasOwnProperty(t))return n;var r=la[t],i=this.getModeAt(e);if("string"==typeof i[t])r[i[t]]&&n.push(r[i[t]]);else if(i[t])for(var o=0;o<i[t].length;o++){var a=r[i[t][o]];a&&n.push(a)}else i.helperType&&r[i.helperType]?n.push(r[i.helperType]):r[i.name]&&n.push(r[i.name]);for(o=0;o<r._global.length;o++){var l=r._global[o];l.pred(i,this)&&-1==Pi(n,l.val)&&n.push(l.val)}return n},getStateAfter:function(e,t){var n=this.doc;return je(this,(e=pe(n,null==e?n.first+n.size-1:e))+1,t)},cursorCoords:function(e,t){var r=this.doc.sel.primary();return dt(this,null==e?r.head:"object"==typeof e?me(this.doc,e):e?r.from():r.to(),t||"page")},charCoords:function(e,t){return ht(this,me(this.doc,e),t||"page")},coordsChar:function(e,t){return gt(this,(e=ft(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=ft(this,{top:e,left:0},t||"page").top,ni(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n,r=!1;if("number"==typeof e){var i=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>i&&(e=i,r=!0),n=Zr(this.doc,e)}else n=e;return ut(this,n,{top:0,left:0},t||"page").top+(r?this.doc.height-ri(n):0)},defaultTextHeight:function(){return yt(this.display)},defaultCharWidth:function(){return xt(this.display)},setGutterMarker:Ot(function(e,t,n){return zn(this.doc,e,"gutter",function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&Fi(r)&&(e.gutterMarkers=null),!0})}),clearGutter:Ot(function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,Ht(t,r,"gutter"),Fi(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),lineInfo:function(e){if("number"==typeof e){if(!ve(this.doc,e))return null;var t=e;if(!(e=Zr(this.doc,e)))return null}else{if(null==(t=ti(e)))return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,r,i){var o=this.display,a=(e=dt(this,me(this.doc,e))).bottom,l=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==r)a=e.top;else if("above"==r||"near"==r){var s=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==r||e.bottom+t.offsetHeight>s)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=s&&(a=e.bottom),l+t.offsetWidth>c&&(l=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==i?(l=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?l=0:"middle"==i&&(l=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=l+"px"),n&&Dn(this,l,a,l+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:Ot(hn),triggerOnKeyPress:Ot(mn),triggerOnKeyUp:pn,execCommand:function(e){return ua.hasOwnProperty(e)?ua[e].call(null,this):void 0},triggerElectric:Ot(function(e){Q(this,e)}),findPosH:function(e,t,n,r){var i=1;0>t&&(i=-1,t=-t);for(var o=0,a=me(this.doc,e);t>o&&!(a=Un(this.doc,a,i,n,r)).hitSide;++o);return a},moveH:Ot(function(e,t){var n=this;n.extendSelectionsBy(function(r){return n.display.shift||n.doc.extend||r.empty()?Un(n.doc,r.head,e,t,n.options.rtlMoveVisually):0>e?r.from():r.to()},_a)}),deleteH:Ot(function(e,t){var n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):jn(this,function(n){var i=Un(r,n.head,e,t,!1);return 0>e?{from:i,to:n.head}:{from:n.head,to:i}})}),findPosV:function(e,t,n,r){var i=1,o=r;0>t&&(i=-1,t=-t);for(var a=0,l=me(this.doc,e);t>a;++a){var s=dt(this,l,"div");if(null==o?o=s.left:s.left=o,(l=qn(this,s,i,n)).hitSide)break}return l},moveV:Ot(function(e,t){var n=this,r=this.doc,i=[],o=!n.display.shift&&!r.extend&&r.sel.somethingSelected();if(r.extendSelectionsBy(function(a){if(o)return 0>e?a.from():a.to();var l=dt(n,a.head,"div");null!=a.goalColumn&&(l.left=a.goalColumn),i.push(l.left);var s=qn(n,l,e,t);return"page"==t&&a==r.sel.primary()&&Wn(n,null,ht(n,s,"div").top-l.top),s},_a),i.length)for(var a=0;a<r.sel.ranges.length;a++)r.sel.ranges[a].goalColumn=i[a]}),findWordAt:function(e){var n=Zr(this.doc,e.line).text,r=e.ch,i=e.ch;if(n){var o=this.getHelper(e,"wordChars");(e.xRel<0||i==n.length)&&r?--r:++i;for(var a=n.charAt(r),l=_i(a,o)?function(e){return _i(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!_i(e)};r>0&&l(n.charAt(r-1));)--r;for(;i<n.length&&l(n.charAt(i));)++i}return new fe(Bo(e.line,r),Bo(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ja(this.display.cursorDiv,"CodeMirror-overwrite"):Za(this.display.cursorDiv,"CodeMirror-overwrite"),Pa(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Gi()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ot(function(e,t){null==e&&null==t||_n(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Ye(this)-this.display.barHeight,width:e.scrollWidth-Ye(this)-this.display.barWidth,clientHeight:Ve(this),clientWidth:$e(this)}},scrollIntoView:Ot(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Bo(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)_n(this),this.curOp.scrollToPos=e;else{var n=Hn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:Ot(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var r=this;null!=e&&(r.display.wrapper.style.width=n(e)),null!=t&&(r.display.wrapper.style.height=n(t)),r.options.lineWrapping&&at(this);var i=r.display.viewFrom;r.doc.iter(i,r.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Ht(r,i,"widget");break}++i}),r.curOp.forceUpdate=!0,Pa(r,"refresh",this)}),operation:function(e){return At(this,e)},refresh:Ot(function(){var e=this.display.cachedTextHeight;Dt(this),this.curOp.forceUpdate=!0,lt(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),u(this),(null==e||Math.abs(e-yt(this.display))>.5)&&a(this),Pa(this,"refresh",this)}),swapDoc:Ot(function(e){var t=this.doc;return t.cm=null,Xr(this,e),lt(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Ci(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ai(e);var ea=e.defaults={},ta=e.optionHandlers={},na=e.Init={toString:function(){return"CodeMirror.Init"}};Gn("value","",function(e,t){e.setValue(t)},!0),Gn("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Gn("indentUnit",2,n,!0),Gn("indentWithTabs",!1),Gn("smartIndent",!0),Gn("tabSize",4,function(e){r(e),lt(e),Dt(e)},!0),Gn("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],r=e.doc.first;e.doc.iter(function(e){for(var i=0;;){var o=e.text.indexOf(t,i);if(-1==o)break;i=o+t.length,n.push(Bo(r,o))}r++});for(var i=n.length-1;i>=0;i--)In(e.doc,t,n[i],Bo(n[i].line,n[i].ch+t.length))}}),Gn("specialChars",/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,n,r){t.state.specialChars=new RegExp(n.source+(n.test(" ")?"":"|  "),"g"),r!=e.Init&&t.refresh()}),Gn("specialCharPlaceholder",_r,function(e){e.refresh()},!0),Gn("electricChars",!0),Gn("inputStyle",Ao?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Gn("rtlMoveVisually",!Io),Gn("wholeLineUpdateBefore",!0),Gn("theme","default",function(e){l(e),s(e)},!0),Gn("keyMap","default",function(t,n,r){var i=$n(n),o=r!=e.Init&&$n(r);o&&o.detach&&o.detach(t,i),i.attach&&i.attach(t,o||null)}),Gn("extraKeys",null),Gn("lineWrapping",!1,i,!0),Gn("gutters",[],function(e){d(e.options),s(e)},!0),Gn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?C(e.display)+"px":"0",e.refresh()},!0),Gn("coverGutterNextToScrollbar",!1,function(e){y(e)},!0),Gn("scrollbarStyle","native",function(e){v(e),y(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Gn("lineNumbers",!1,function(e){d(e.options),s(e)},!0),Gn("firstLineNumber",1,s,!0),Gn("lineNumberFormatter",function(e){return e},s,!0),Gn("showCursorWhenSelecting",!1,Re,!0),Gn("resetSelectionOnContextMenu",!0),Gn("lineWiseCopyCut",!0),Gn("readOnly",!1,function(e,t){"nocursor"==t?(yn(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),Gn("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Gn("dragDrop",!0,Ut),Gn("allowDropFileTypes",null),Gn("cursorBlinkRate",530),Gn("cursorScrollMargin",0),Gn("cursorHeight",1,Re,!0),Gn("singleCursorHeightPerLine",!0,Re,!0),Gn("workTime",100),Gn("workDelay",100),Gn("flattenSpans",!0,r,!0),Gn("addModeClass",!1,r,!0),Gn("pollInterval",100),Gn("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Gn("historyEventDelay",1250),Gn("viewportMargin",10,function(e){e.refresh()},!0),Gn("maxHighlightLength",1e4,r,!0),Gn("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Gn("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Gn("autofocus",null);var ra=e.modes={},ia=e.mimeModes={};e.defineMode=function(t,n){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),ra[t]=n},e.defineMIME=function(e,t){ia[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ia.hasOwnProperty(t))t=ia[t];else if(t&&"string"==typeof t.name&&ia.hasOwnProperty(t.name)){var n=ia[t.name];"string"==typeof n&&(n={name:n}),(t=Hi(n,t)).name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){n=e.resolveMode(n);var r=ra[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(oa.hasOwnProperty(n.name)){var o=oa[n.name];for(var a in o)o.hasOwnProperty(a)&&(i.hasOwnProperty(a)&&(i["_"+a]=i[a]),i[a]=o[a])}if(i.name=n.name,n.helperType&&(i.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)i[a]=n.modeProps[a];return i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var oa=e.modeExtensions={};e.extendMode=function(e,t){Wi(t,oa.hasOwnProperty(e)?oa[e]:oa[e]={})},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){Ca.prototype[e]=t},e.defineOption=Gn;var aa=[];e.defineInitHook=function(e){aa.push(e)};var la=e.helpers={};e.registerHelper=function(t,n,r){la.hasOwnProperty(t)||(la[t]=e[t]={_global:[]}),la[t][n]=r},e.registerGlobalHelper=function(t,n,r,i){e.registerHelper(t,n,i),la[t]._global.push({pred:r,val:i})};var sa=e.copyState=function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n},ca=e.startState=function(e,t,n){return!e.startState||e.startState(t,n)};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var ua=e.commands={selectAll:function(e){e.setSelection(Bo(e.firstLine(),0),Bo(e.lastLine()),Wa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Wa)},killLine:function(e){jn(e,function(t){if(t.empty()){var n=Zr(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:Bo(t.head.line+1,0)}:{from:t.head,to:Bo(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){jn(e,function(t){return{from:Bo(t.from().line,0),to:me(e.doc,Bo(t.to().line+1,0))}})},delLineLeft:function(e){jn(e,function(e){return{from:Bo(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){jn(e,function(t){var n=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:n},"div"),to:t.from()}})},delWrappedLineRight:function(e){jn(e,function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:r}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Bo(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Bo(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return oo(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return lo(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return ao(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},_a)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},_a)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:n},"div");return r.ch<e.getLine(r.line).search(/\S/)?lo(e,t.head):r},_a)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection(" ")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),r=e.options.tabSize,i=0;i<n.length;i++){var o=n[i].from(),a=Fa(e.getLine(o.line),o.ch,r);t.push(Oi(r-a%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){At(e,function(){for(var t=e.listSelections(),n=[],r=0;r<t.length;r++){var i=t[r].head,o=Zr(e.doc,i.line).text;if(o)if(i.ch==o.length&&(i=new Bo(i.line,i.ch-1)),i.ch>0)i=new Bo(i.line,i.ch+1),e.replaceRange(o.charAt(i.ch-1)+o.charAt(i.ch-2),Bo(i.line,i.ch-2),i,"+transpose");else if(i.line>e.doc.first){var a=Zr(e.doc,i.line-1).text;a&&e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),Bo(i.line-1,a.length-1),Bo(i.line,1),"+transpose")}n.push(new fe(i,i))}e.setSelections(n)})},newlineAndIndent:function(e){At(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var r=e.listSelections()[n];e.replaceRange(e.doc.lineSeparator(),r.anchor,r.head,"+input"),e.indentLine(r.from().line+1,null,!0)}Bn(e)})},openLine:function(e){e.replaceSelection("\n","start")},toggleOverwrite:function(e){e.toggleOverwrite()}},fa=e.keyMap={};fa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},fa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},fa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},fa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},fa["default"]=Eo?fa.macDefault:fa.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==r){delete e[n];continue}for(var i=Ri(n.split(" "),Yn),o=0;o<i.length;o++){var a,l;o==i.length-1?(l=i.join(" "),a=r):(l=i.slice(0,o+1).join(" "),a="...");var s=t[l];if(s){if(s!=a)throw new Error("Inconsistent bindings for "+l)}else t[l]=a}delete e[n]}for(var c in t)e[c]=t[c];return e};var ha=e.lookupKey=function(e,t,n,r){var i=(t=$n(t)).call?t.call(e,r):t[e];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&n(i))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ha(e,t.fallthrough,n,r);for(var o=0;o<t.fallthrough.length;o++){var a=ha(e,t.fallthrough[o],n,r);if(a)return a}}},da=e.isModifierKey=function(e){var t="string"==typeof e?e:ol[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},pa=e.keyName=function(e,t){if(Co&&34==e.keyCode&&e.char)return!1;var n=ol[e.keyCode],r=n;return null!=r&&!e.altGraphKey&&(e.altKey&&"Alt"!=n&&(r="Alt-"+r),(Ro?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(r="Ctrl-"+r),(Ro?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(r="Cmd-"+r),!t&&e.shiftKey&&"Shift"!=n&&(r="Shift-"+r),r)};e.fromTextArea=function(t,n){function r(){t.value=c.getValue()}if((n=n?Wi(n):{}).value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var i=Gi();n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form&&(Ea(t.form,"submit",r),!n.leaveSubmitMethodAlone)){var o=t.form,a=o.submit;try{var l=o.submit=function(){r(),o.submit=a,o.submit(),o.submit=l}}catch(s){}}n.finishInit=function(e){e.save=r,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,r(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Ia(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=a))}},t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c};var ma=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ma.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Fa(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Fa(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Fa(this.string,null,this.tabSize)-(this.lineStart?Fa(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e};return i(this.string.substr(this.pos,e.length))==i(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ga=0,va=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ga};Ai(va),va.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&bt(e),Ni(this,"clear")){var n=this.find();n&&Ci(this,"clear",n.from,n.to)}for(var r=null,i=null,o=0;o<this.lines.length;++o){var a=this.lines[o],l=er(a.markedSpans,this);e&&!this.collapsed?Ht(e,ti(a),"text"):e&&(null!=l.to&&(i=ti(a)),null!=l.from&&(r=ti(a))),a.markedSpans=tr(a.markedSpans,l),null==l.from&&this.collapsed&&!kr(this.doc,a)&&e&&ei(a,yt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(o=0;o<this.lines.length;++o){var s=yr(this.lines[o]),c=f(s);c>e.display.maxLineLength&&(e.display.maxLine=s,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=r&&e&&this.collapsed&&Dt(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Ae(e.doc)),e&&Ci(e,"markerCleared",e,this),t&&kt(e),this.parent&&this.parent.clear()}},va.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,r,i=0;i<this.lines.length;++i){var o=this.lines[i],a=er(o.markedSpans,this);if(null!=a.from&&(n=Bo(t?o:ti(o),a.from),-1==e))return n;if(null!=a.to&&(r=Bo(t?o:ti(o),a.to),1==e))return r}return n&&{from:n,to:r}},va.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&At(n,function(){var r=e.line,i=ti(e.line),o=Qe(n,i);if(o&&(ot(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!kr(t.doc,r)&&null!=t.height){var a=t.height;t.height=null;var l=Lr(t)-a;l&&ei(r,r.height+l)}})},va.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Pi(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},va.prototype.detachLine=function(e){if(this.lines.splice(Pi(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};ga=0;var ya=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};Ai(ya),ya.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Ci(this,"clear")}},ya.prototype.find=function(e,t){return this.primary.find(e,t)};var xa=e.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.doc=e,this.node=t};Ai(xa),xa.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,r=ti(n);if(null!=r&&t){for(var i=0;i<t.length;++i)t[i]==this&&t.splice(i--,1);t.length||(n.widgets=null);var o=Lr(this);ei(n,Math.max(0,n.height-o)),e&&At(e,function(){Cr(e,n,-o),Ht(e,r,"widget")})}},xa.prototype.changed=function(){
var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var r=Lr(this)-e;r&&(ei(n,n.height+r),t&&At(t,function(){t.curOp.forceUpdate=!0,Cr(t,n,r)}))};var ba=e.Line=function(e,t,n){this.text=e,ur(this,t),this.height=n?n(this):1};Ai(ba),ba.prototype.lineNo=function(){return ti(this)};var wa={},ka={};$r.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;r>n;++n){var i=this.lines[n];this.height-=i.height,Nr(i),Ci(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},Vr.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(i>e){var o=Math.min(t,i-e),a=r.height;if(r.removeInner(e,o),this.height-=a-r.height,i==o&&(this.children.splice(n--,1),r.parent=null),0==(t-=o))break;e=0}else e-=i}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof $r))){var l=[];this.collapse(l),this.children=[new $r(l)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>=e){if(i.insertInner(e,t,n),i.lines&&i.lines.length>50){for(var a=i.lines.length%25+25,l=a;l<i.lines.length;){var s=new $r(i.lines.slice(l,l+=25));i.height-=s.height,this.children.splice(++r,0,s),s.parent=this}i.lines=i.lines.slice(0,a),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var n=new Vr(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=n.size,e.height-=n.height;var r=Pi(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new Vr(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var r=0;r<this.children.length;++r){var i=this.children[r],o=i.chunkSize();if(o>e){var a=Math.min(t,o-e);if(i.iterN(e,a,n))return!0;if(0==(t-=a))break;e=0}else e-=o}}};var Sa=0,Ca=e.Doc=function(e,t,n,r){if(!(this instanceof Ca))return new Ca(e,t,n,r);null==n&&(n=0),Vr.call(this,[new $r([new ba("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var i=Bo(n,0);this.sel=de(i),this.history=new oi(null),this.id=++Sa,this.modeOption=t,this.lineSep=r,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Yr(this,{from:i,to:i,text:e}),Te(this,de(i),Wa)};Ca.prototype=Hi(Vr.prototype,{constructor:Ca,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,r=0;r<t.length;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Qr(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:It(function(e){var t=Bo(this.first,0),n=this.first+this.size-1;Tn(this,{from:t,to:Bo(n,Zr(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Te(this,de(t))}),replaceRange:function(e,t,n,r){In(this,e,t=me(this,t),n=n?me(this,n):t,r)},getRange:function(e,t,n){var r=Jr(this,me(this,e),me(this,t));return!1===n?r:r.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return ve(this,e)?Zr(this,e):void 0},getLineNumber:function(e){return ti(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Zr(this,e)),yr(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return me(this,e)},getCursor:function(e){var n=this.sel.primary();return null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||!1===e?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:It(function(e,t,n){Se(this,me(this,"number"==typeof e?Bo(e,t||0):e),null,n)}),setSelection:It(function(e,t,n){Se(this,me(this,e),me(this,t||e),n)}),extendSelection:It(function(e,t,n){be(this,me(this,e),t&&me(this,t),n)}),extendSelections:It(function(e,t){we(this,ye(this,e),t)}),extendSelectionsBy:It(function(e,t){we(this,ye(this,Ri(this.sel.ranges,e)),t)}),setSelections:It(function(e,t,n){if(e.length){for(var r=0,i=[];r<e.length;r++)i[r]=new fe(me(this,e[r].anchor),me(this,e[r].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Te(this,he(i,t),n)}}),addSelection:It(function(e,t,n){var r=this.sel.ranges.slice(0);r.push(new fe(me(this,e),me(this,t||e))),Te(this,he(r,r.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,r=0;r<n.length;r++){var i=Jr(this,n[r].from(),n[r].to());t=t?t.concat(i):i}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,r=0;r<n.length;r++){var i=Jr(this,n[r].from(),n[r].to());!1!==e&&(i=i.join(e||this.lineSeparator())),t[r]=i}return t},replaceSelection:function(e,t,n){for(var r=[],i=0;i<this.sel.ranges.length;i++)r[i]=e;this.replaceSelections(r,t,n||"+input")},replaceSelections:It(function(e,t,n){for(var r=[],i=this.sel,o=0;o<i.ranges.length;o++){var a=i.ranges[o];r[o]={from:a.from(),to:a.to(),text:this.splitLines(e[o]),origin:n}}var l=t&&"end"!=t&&Cn(this,r,t);for(o=r.length-1;o>=0;o--)Tn(this,r[o]);l?Le(this,l):this.cm&&Bn(this.cm)}),undo:It(function(){Nn(this,"undo")}),redo:It(function(){Nn(this,"redo")}),undoSelection:It(function(){Nn(this,"undo",!0)}),redoSelection:It(function(){Nn(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new oi(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:gi(this.history.done),undone:gi(this.history.undone)}},setHistory:function(e){var t=this.history=new oi(this.history.maxGeneration);t.done=gi(e.done.slice(0),null,!0),t.undone=gi(e.undone.slice(0),null,!0)},addLineClass:It(function(e,t,n){return zn(this,e,"gutter"==t?"gutter":"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[r]){if(Yi(n).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:It(function(e,t,n){return zn(this,e,"gutter"==t?"gutter":"class",function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var o=i.match(Yi(n));if(!o)return!1;var a=o.index+o[0].length;e[r]=i.slice(0,o.index)+(o.index&&a!=i.length?" ":"")+i.slice(a)||null}return!0})}),addLineWidget:It(function(e,t,n){return Tr(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return Vn(this,me(this,e),me(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return Vn(this,e=me(this,e),e,n,"bookmark")},findMarksAt:function(e){var t=[],n=Zr(this,(e=me(this,e)).line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(null==i.from||i.from<=e.ch)&&(null==i.to||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},findMarks:function(e,t,n){e=me(this,e),t=me(this,t);var r=[],i=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var l=0;l<a.length;l++){var s=a[l];null!=s.to&&i==e.line&&e.ch>=s.to||null==s.from&&i!=e.line||null!=s.from&&i==t.line&&s.from>=t.ch||n&&!n(s.marker)||r.push(s.marker.parent||s.marker)}++i}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)null!=n[r].from&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first,r=this.lineSeparator().length;return this.iter(function(i){var o=i.text.length+r;return o>e?(t=e,!0):(e-=o,void++n)}),me(this,Bo(n,t))},indexFromPos:function(e){var t=(e=me(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new Ca(Qr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var r=new Ca(Qr(this,t,n),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Zn(r,Xn(this)),r},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){if(this.linked[n].doc==t){this.linked.splice(n,1),t.unlinkDoc(this),Jn(Xn(this));break}}if(t.history==this.history){var i=[t.id];Kr(t,function(e){i.push(e.id)},!0),t.history=new oi(null),t.history.done=gi(this.history.done,i),t.history.undone=gi(this.history.undone,i)}},iterLinkedDocs:function(e){Kr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):tl(e)},lineSeparator:function(){return this.lineSep||"\n"}}),Ca.prototype.eachLine=Ca.prototype.iter;var La="iter insert remove copy getEditor constructor".split(" ");for(var Ta in Ca.prototype)Ca.prototype.hasOwnProperty(Ta)&&Pi(La,Ta)<0&&(e.prototype[Ta]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ca.prototype[Ta]));Ai(Ca);var Ma=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Na=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Aa=e.e_stop=function(e){Ma(e),Na(e)},Ea=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={});(r[t]||(r[t]=[])).push(n)}},Oa=[],Ia=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else for(var r=Si(e,t,!1),i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}},Pa=e.signal=function(e,t){var n=Si(e,t,!0);if(n.length)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)},Ra=null,Da=30,Ha=e.Pass={toString:function(){return"CodeMirror.Pass"}},Wa={scroll:!1},Ba={origin:"*mouse"},_a={origin:"+move"};Ei.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Fa=e.countColumn=function(e,t,n,r,i){null==t&&(-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length));for(var o=r||0,a=i||0;;){var l=e.indexOf("  ",o);if(0>l||l>=t)return a+(t-o);a+=l-o,a+=n-a%n,o=l+1}},za=e.findColumn=function(e,t,n){for(var r=0,i=0;;){var o=e.indexOf(" ",r);-1==o&&(o=e.length);var a=o-r;if(o==e.length||i+a>=t)return r+Math.min(a,t-i);if(i+=o-r,r=o+1,(i+=n-i%n)>=t)return r}},ja=[""],Ua=function(e){e.select()};No?Ua=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:xo&&(Ua=function(e){try{e.select()}catch(t){}});var qa,Ga=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ya=e.isWordChar=function(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Ga.test(e))},$a=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;qa=document.createRange?function(e,t,n,r){var i=document.createRange();return i.setEnd(r||e,n),i.setStart(e,t),i}:function(e,t,n){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch(i){return r}return r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r};var Va=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)};xo&&11>bo&&(Gi=function(){try{return document.activeElement}catch(e){return document.body}});var Ka,Xa,Za=e.rmClass=function(e,t){var n=e.className,r=Yi(t).exec(n);if(r){var i=n.slice(r.index+r[0].length);e.className=n.slice(0,r.index)+(i?r[1]+i:"")}},Ja=e.addClass=function(e,t){var n=e.className;Yi(t).test(n)||(e.className+=(n?" ":"")+t)},Qa=!1,el=function(){if(xo&&9>bo)return!1;var e=ji("div");return"draggable"in e||"dragDrop"in e}(),tl=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var o=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)},nl=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},rl=function(){var e=ji("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),il=null,ol=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)ol[e+48]=ol[e+96]=String(e);for(e=65;90>=e;e++)ol[e]=String.fromCharCode(e);for(e=1;12>=e;e++)ol[e+111]=ol[e+63235]="F"+e}();var al,ll=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?r.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",r="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,l=/[Lb1n]/,s=/[1n]/,c="L";return function(n){if(!i.test(n))return!1;for(var u=n.length,f=[],h=0;u>h;++h)f.push(r=e(n.charCodeAt(h)));h=0;for(var d=c;u>h;++h){"m"==(r=f[h])?f[h]=d:d=r}h=0;for(var p=c;u>h;++h){"1"==(r=f[h])&&"r"==p?f[h]="n":a.test(r)&&(p=r,"r"==r&&(f[h]="R"))}for(h=1,d=f[0];u-1>h;++h){"+"==(r=f[h])&&"1"==d&&"1"==f[h+1]?f[h]="1":","!=r||d!=f[h+1]||"1"!=d&&"n"!=d||(f[h]=d),d=r}for(h=0;u>h;++h){if(","==(r=f[h]))f[h]="N";else if("%"==r){for(var m=h+1;u>m&&"%"==f[m];++m);for(var g=h&&"!"==f[h-1]||u>m&&"1"==f[m]?"1":"N",v=h;m>v;++v)f[v]=g;h=m-1}}for(h=0,p=c;u>h;++h){var r=f[h];"L"==p&&"1"==r?f[h]="L":a.test(r)&&(p=r)}for(h=0;u>h;++h)if(o.test(f[h])){for(m=h+1;u>m&&o.test(f[m]);++m);var y="L"==(h?f[h-1]:c),x="L"==(u>m?f[m]:c);for(g=y||x?"L":"R",v=h;m>v;++v)f[v]=g;h=m-1}var b,w=[];for(h=0;u>h;)if(l.test(f[h])){var k=h;for(++h;u>h&&l.test(f[h]);++h);w.push(new t(0,k,h))}else{var S=h,C=w.length;for(++h;u>h&&"L"!=f[h];++h);for(v=S;h>v;)if(s.test(f[v])){v>S&&w.splice(C,0,new t(1,S,v));var L=v;for(++v;h>v&&s.test(f[v]);++v);w.splice(C,0,new t(2,L,v)),S=v}else++v;h>S&&w.splice(C,0,new t(1,S,h))}return 1==w[0].level&&(b=n.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift(new t(0,0,b[0].length))),1==Ii(w).level&&(b=n.match(/\s+$/))&&(Ii(w).to-=b[0].length,w.push(new t(0,u-b[0].length,u))),2==w[0].level&&w.unshift(new t(1,w[0].to,w[0].to)),w[0].level!=Ii(w).level&&w.push(new t(w[0].level,u,u)),w}}();return e.version="5.15.2",e})},{}],11:[function(t,n,r){var i;i=function(e){"use strict";var t=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?\xab\xbb\u201c\u201d\u2018\u2019]))/i;e.defineMode("gfm",function(n,r){function i(e){return e.code=!1,null}var o=0,a={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(e){return{code:e.code,codeBlock:e.codeBlock,ateSpace:e.ateSpace}},token:function(e,n){if(n.combineTokens=null,n.codeBlock)return e.match(/^```+/)?(n.codeBlock=!1,null):(e.skipToEnd(),null);if(e.sol()&&(n.code=!1),e.sol()&&e.match(/^```+/))return e.skipToEnd(),n.codeBlock=!0,null;if("`"===e.peek()){e.next();var i=e.pos;e.eatWhile("`");var a=1+e.pos-i;return n.code?a===o&&(n.code=!1):(o=a,n.code=!0),null}if(n.code)return e.next(),null;if(e.eatSpace())return n.ateSpace=!0,null;if((e.sol()||n.ateSpace)&&(n.ateSpace=!1,!1!==r.gitHubSpice)){if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+@)?(?:[a-f0-9]{7,40}\b)/))return n.combineTokens=!0,"link";if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+)?#[0-9]+\b/))return n.combineTokens=!0,"link"}return e.match(t)&&"]("!=e.string.slice(e.start-2,e.start)&&(0==e.start||/\W/.test(e.string.charAt(e.start-1)))?(n.combineTokens=!0,"link"):(e.next(),null)},blankLine:i},l={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:"```",strikethrough:!0};for(var s in r)l[s]=r[s];return l.name="markdown",e.overlayMode(e.getMode(n,l),a)},"markdown"),e.defineMIME("text/x-gfm","gfm")},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror"),t("../markdown/markdown"),t("../../addon/mode/overlay")):"function"==typeof e&&e.amd?e(["../../lib/codemirror","../markdown/markdown","../../addon/mode/overlay"],i):i(CodeMirror)},{"../../addon/mode/overlay":8,"../../lib/codemirror":10,"../markdown/markdown":12}],12:[function(t,n,r){var i;i=function(e){"use strict";e.defineMode("markdown",function(t,n){function r(n){if(e.findModeByName){var r=e.findModeByName(n);r&&(n=r.mime||r.mimes[0])}var i=e.getMode(t,n);return"null"==i.name?null:i}function i(e,t,n){return t.f=t.inline=n,n(e,t)}function o(e,t,n){return t.f=t.block=n,n(e,t)}function a(e){return!e||!/\S/.test(e.string)}function l(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.strikethrough=!1,e.quote=0,e.indentedCode=!1,k&&e.f==c&&(e.f=p,e.block=s),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.prevLine=e.thisLine,e.thisLine=null,null}function s(t,o){var l=t.sol(),s=!1!==o.list,c=o.indentedCode;o.indentedCode=!1,s&&(o.indentationDiff>=0?(o.indentationDiff<4&&(o.indentation-=o.indentationDiff),o.list=null):o.indentation>0?o.list=null:o.list=!1);var f=null;if(o.indentationDiff>=4)return t.skipToEnd(),c||a(o.prevLine)?(o.indentation-=4,o.indentedCode=!0,S.code):null;if(t.eatSpace())return null;if((f=t.match(A))&&f[1].length<=6)return o.header=f[1].length,n.highlightFormatting&&(o.formatting="header"),o.f=o.inline,h(o);if(!(a(o.prevLine)||o.quote||s||c)&&(f=t.match(E)))return o.header="="==f[0].charAt(0)?1:2,n.highlightFormatting&&(o.formatting="header"),o.f=o.inline,h(o);if(t.eat(">"))return o.quote=l?1:o.quote+1,n.highlightFormatting&&(o.formatting="quote"),t.eatSpace(),h(o);if("["===t.peek())return i(t,o,y);if(t.match(L,!0))return o.hr=!0,S.hr;if((a(o.prevLine)||s)&&(t.match(T,!1)||t.match(M,!1))){var d=null;for(t.match(T,!0)?d="ul":(t.match(M,!0),d="ol"),o.indentation=t.column()+t.current().length,o.list=!0;o.listStack&&t.column()<o.listStack[o.listStack.length-1];)o.listStack.pop();return o.listStack.push(o.indentation),n.taskLists&&t.match(N,!1)&&(o.taskList=!0),o.f=o.inline,n.highlightFormatting&&(o.formatting=["list","list-"+d]),h(o)}return n.fencedCodeBlocks&&(f=t.match(I,!0))?(o.fencedChars=f[1],o.localMode=r(f[2]),o.localMode&&(o.localState=e.startState(o.localMode)),o.f=o.block=u,n.highlightFormatting&&(o.formatting="code-block"),o.code=-1,h(o)):i(t,o,o.inline)}function c(t,n){var r=w.token(t,n.htmlState);if(!k){var i=e.innerMode(w,n.htmlState);("xml"==i.mode.name&&null===i.state.tagStart&&!i.state.context&&i.state.tokenize.isInText||n.md_inside&&t.current().indexOf(">")>-1)&&(n.f=p,n.block=s,n.htmlState=null)}return r}function u(e,t){return t.fencedChars&&e.match(t.fencedChars,!1)?(t.localMode=t.localState=null,t.f=t.block=f,null):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),S.code)}function f(e,t){e.match(t.fencedChars),t.block=s,t.f=p,t.fencedChars=null,n.highlightFormatting&&(t.formatting="code-block"),t.code=1;var r=h(t);return t.code=0,r}function h(e){var t=[];if(e.formatting){t.push(S.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var r=0;r<e.formatting.length;r++)t.push(S.formatting+"-"+e.formatting[r]),"header"===e.formatting[r]&&t.push(S.formatting+"-"+e.formatting[r]+"-"+e.header),"quote"===e.formatting[r]&&(!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(S.formatting+"-"+e.formatting[r]+"-"+e.quote):t.push("error"))}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(S.linkHref,"url"):(e.strong&&t.push(S.strong),e.em&&t.push(S.em),e.strikethrough&&t.push(S.strikethrough),e.linkText&&t.push(S.linkText),e.code&&t.push(S.code)),e.header&&t.push(S.header,S.header+"-"+e.header),e.quote&&(t.push(S.quote),!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(S.quote+"-"+e.quote):t.push(S.quote+"-"+n.maxBlockquoteDepth)),!1!==e.list){var i=(e.listStack.length-1)%3;i?1===i?t.push(S.list2):t.push(S.list3):t.push(S.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function d(e,t){return e.match(O,!0)?h(t):void 0}function p(t,r){var i=r.text(t,r);if(void 0!==i)return i;if(r.list)return r.list=null,h(r);if(r.taskList)return"x"!==t.match(N,!0)[1]?r.taskOpen=!0:r.taskClosed=!0,n.highlightFormatting&&(r.formatting="task"),r.taskList=!1,h(r);if(r.taskOpen=!1,r.taskClosed=!1,r.header&&t.match(/^#+$/,!0))return n.highlightFormatting&&(r.formatting="header"),h(r);var l=t.sol(),s=t.next();if(r.linkTitle){r.linkTitle=!1;var u=s;"("===s&&(u=")");var f="^\\s*(?:[^"+(u=(u+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"))+"\\\\]+|\\\\\\\\|\\\\.)"+u;if(t.match(new RegExp(f),!0))return S.linkHref}if("`"===s){var d=r.formatting;n.highlightFormatting&&(r.formatting="code"),t.eatWhile("`");var p=t.current().length;if(0==r.code)return r.code=p,h(r);if(p==r.code){var v=h(r);return r.code=0,v}return r.formatting=d,h(r)}if(r.code)return h(r);if("\\"===s&&(t.next(),n.highlightFormatting)){var y=h(r),x=S.formatting+"-escape";return y?y+" "+x:x}if("!"===s&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),r.inline=r.f=g,S.image;if("["===s&&t.match(/[^\]]*\](\(.*\)| ?\[.*?\])/,!1))return r.linkText=!0,n.highlightFormatting&&(r.formatting="link"),h(r);if("]"===s&&r.linkText&&t.match(/\(.*?\)| ?\[.*?\]/,!1)){n.highlightFormatting&&(r.formatting="link");var y=h(r);return r.linkText=!1,r.inline=r.f=g,y}if("<"===s&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1))return r.f=r.inline=m,n.highlightFormatting&&(r.formatting="link"),(y=h(r))?y+=" ":y="",y+S.linkInline;if("<"===s&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1))return r.f=r.inline=m,n.highlightFormatting&&(r.formatting="link"),(y=h(r))?y+=" ":y="",y+S.linkEmail;if("<"===s&&t.match(/^(!--|\w)/,!1)){var b=t.string.indexOf(">",t.pos);if(-1!=b){var k=t.string.substring(t.start,b);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(k)&&(r.md_inside=!0)}return t.backUp(1),r.htmlState=e.startState(w),o(t,r,c)}if("<"===s&&t.match(/^\/\w*?>/))return r.md_inside=!1,"tag";var C=!1;if(!n.underscoresBreakWords&&"_"===s&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var L=t.pos-2;if(L>=0){var T=t.string.charAt(L);"_"!==T&&T.match(/(\w)/,!1)&&(C=!0)}}if("*"===s||"_"===s&&!C)if(l&&" "===t.peek());else{if(r.strong===s&&t.eat(s)){n.highlightFormatting&&(r.formatting="strong");v=h(r);return r.strong=!1,v}if(!r.strong&&t.eat(s))return r.strong=s,n.highlightFormatting&&(r.formatting="strong"),h(r);if(r.em===s){n.highlightFormatting&&(r.formatting="em");v=h(r);return r.em=!1,v}if(!r.em)return r.em=s,n.highlightFormatting&&(r.formatting="em"),h(r)}else if(" "===s&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return h(r);t.backUp(1)}if(n.strikethrough)if("~"===s&&t.eatWhile(s)){if(r.strikethrough){n.highlightFormatting&&(r.formatting="strikethrough");v=h(r);return r.strikethrough=!1,v}if(t.match(/^[^\s]/,!1))return r.strikethrough=!0,n.highlightFormatting&&(r.formatting="strikethrough"),h(r)}else if(" "===s&&t.match(/^~~/,!0)){if(" "===t.peek())return h(r);t.backUp(2)}return" "===s&&(t.match(/ +$/,!1)?r.trailingSpace++:r.trailingSpace&&(r.trailingSpaceNewLine=!0)),h(r)}function m(e,t){if(">"===e.next()){t.f=t.inline=p,n.highlightFormatting&&(t.formatting="link");var i=h(t);return i?i+=" ":i="",i+S.linkInline}return e.match(/^[^>]+/,!0),S.linkInline}function g(e,t){if(e.eatSpace())return null;var r=e.next();return"("===r||"["===r?(t.f=t.inline=v("("===r?")":"]",0),n.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,h(t)):"error"}function v(e){return function(t,r){if(t.next()===e){r.f=r.inline=p,n.highlightFormatting&&(r.formatting="link-string");var o=h(r);return r.linkHref=!1,o}return t.match(P[e]),r.linkHref=!0,h(r)}}function y(e,t){return e.match(/^([^\]\\]|\\.)*\]:/,!1)?(t.f=x,e.next(),n.highlightFormatting&&(t.formatting="link"),t.linkText=!0,h(t)):i(e,t,p)}function x(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=b,n.highlightFormatting&&(t.formatting="link");var r=h(t);return t.linkText=!1,r}return e.match(/^([^\]\\]|\\.)+/,!0),S.linkText}function b(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=p,S.linkHref+" url")}var w=e.getMode(t,"text/html"),k="null"==w.name;void 0===n.highlightFormatting&&(n.highlightFormatting=!1),void 0===n.maxBlockquoteDepth&&(n.maxBlockquoteDepth=0),void 0===n.underscoresBreakWords&&(n.underscoresBreakWords=!0),void 0===n.taskLists&&(n.taskLists=!1),void 0===n.strikethrough&&(n.strikethrough=!1),void 0===n.tokenTypeOverrides&&(n.tokenTypeOverrides={});var S={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var C in S)S.hasOwnProperty(C)&&n.tokenTypeOverrides[C]&&(S[C]=n.tokenTypeOverrides[C]);var L=/^([*\-_])(?:\s*\1){2,}\s*$/,T=/^[*\-+]\s+/,M=/^[0-9]+([.)])\s+/,N=/^\[(x| )\](?=\s)/,A=n.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,E=/^ *(?:\={1,}|-{1,})\s*$/,O=/^[^#!\[\]*_\\<>` "'(~]+/,I=new RegExp("^("+(!0===n.fencedCodeBlocks?"~~~+|```+":n.fencedCodeBlocks)+")[ \\t]*([\\w+#-]*)"),P={")":/^(?:[^\\\(\)]|\\.|\((?:[^\\\(\)]|\\.)*\))*?(?=\))/,"]":/^(?:[^\\\[\]]|\\.|\[(?:[^\\\[\\]]|\\.)*\])*?(?=\])/},R={startState:function(){return{f:s,prevLine:null,thisLine:null,block:s,htmlState:null,indentation:0,inline:p,text:d,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,code:0,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(w,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listStack:t.listStack.slice(0),quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine){var n=t.header||t.hr;if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0)||n){if(l(t),!n)return null;t.prevLine=null}t.prevLine=t.thisLine,t.thisLine=e,t.taskList=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var r=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length;if(t.indentationDiff=Math.min(r-t.indentation,4),t.indentation=t.indentation+t.indentationDiff,r>0)return null}return t.f(e,t)},innerMode:function(e){return e.block==c?{state:e.htmlState,mode:w}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:R}},blankLine:l,getType:h,fold:"markdown"};return R},"xml"),e.defineMIME("text/x-markdown","markdown")},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror"),t("../xml/xml"),t("../meta")):"function"==typeof e&&e.amd?e(["../../lib/codemirror","../xml/xml","../meta"],i):i(CodeMirror)},{"../../lib/codemirror":10,"../meta":13,"../xml/xml":14}],13:[function(t,n,r){var i;i=function(e){"use strict";e.modeInfo=[{
name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"]},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Jade",mime:"text/x-jade",mode:"jade",ext:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mime:"text/n-triples",mode:"ntriples",ext:["nt"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:["php","php3","php4","php5","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mime:"text/x-yaml",mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var t=0;t<e.modeInfo.length;t++){var n=e.modeInfo[t];n.mimes&&(n.mime=n.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var r=e.modeInfo[n];if(r.mime==t)return r;if(r.mimes)for(var i=0;i<r.mimes.length;i++)if(r.mimes[i]==t)return r}},e.findModeByExtension=function(t){for(var n=0;n<e.modeInfo.length;n++){var r=e.modeInfo[n];if(r.ext)for(var i=0;i<r.ext.length;i++)if(r.ext[i]==t)return r}},e.findModeByFileName=function(t){for(var n=0;n<e.modeInfo.length;n++){var r=e.modeInfo[n];if(r.file&&r.file.test(t))return r}var i=t.lastIndexOf("."),o=i>-1&&t.substring(i+1,t.length);return o?e.findModeByExtension(o):void 0},e.findModeByName=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var r=e.modeInfo[n];if(r.name.toLowerCase()==t)return r;if(r.alias)for(var i=0;i<r.alias.length;i++)if(r.alias[i].toLowerCase()==t)return r}}},"object"==typeof r&&"object"==typeof n?i(t("../lib/codemirror")):"function"==typeof e&&e.amd?e(["../lib/codemirror"],i):i(CodeMirror)},{"../lib/codemirror":10}],14:[function(t,n,r){var i;i=function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},n={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1};e.defineMode("xml",function(r,i){function o(e,t){function n(n){return t.tokenize=n,n(e,t)}var r=e.next();return"<"==r?e.eat("!")?e.eat("[")?e.match("CDATA[")?n(s("atom","]]>")):null:e.match("--")?n(s("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(c(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=s("meta","?>"),"meta"):(T=e.eat("/")?"closeTag":"openTag",t.tokenize=a,"tag bracket"):"&"==r?(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error":(e.eatWhile(/[^&<]/),null)}function a(e,t){var n=e.next();if(">"==n||"/"==n&&e.eat(">"))return t.tokenize=o,T=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return T="equals",null;if("<"==n){t.tokenize=o,t.state=d,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" tag error":"tag error"}return/[\'\"]/.test(n)?(t.tokenize=l(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function l(e){var t=function(t,n){for(;!t.eol();)if(t.next()==e){n.tokenize=a;break}return"string"};return t.isInAttribute=!0,t}function s(e,t){return function(n,r){for(;!n.eol();){if(n.match(t)){r.tokenize=o;break}n.next()}return e}}function c(e){return function(t,n){for(var r;null!=(r=t.next());){if("<"==r)return n.tokenize=c(e+1),n.tokenize(t,n);if(">"==r){if(1==e){n.tokenize=o;break}return n.tokenize=c(e-1),n.tokenize(t,n)}}return"meta"}}function u(e,t,n){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=n,(S.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function f(e){e.context&&(e.context=e.context.prev)}function h(e,t){for(var n;;){if(!e.context)return;if(n=e.context.tagName,!S.contextGrabbers.hasOwnProperty(n)||!S.contextGrabbers[n].hasOwnProperty(t))return;f(e)}}function d(e,t,n){return"openTag"==e?(n.tagStart=t.column(),p):"closeTag"==e?m:d}function p(e,t,n){return"word"==e?(n.tagName=t.current(),M="tag",y):(M="error",p)}function m(e,t,n){if("word"==e){var r=t.current();return n.context&&n.context.tagName!=r&&S.implicitlyClosed.hasOwnProperty(n.context.tagName)&&f(n),n.context&&n.context.tagName==r||!1===S.matchClosing?(M="tag",g):(M="tag error",v)}return M="error",v}function g(e,t,n){return"endTag"!=e?(M="error",g):(f(n),d)}function v(e,t,n){return M="error",g(e,t,n)}function y(e,t,n){if("word"==e)return M="attribute",x;if("endTag"==e||"selfcloseTag"==e){var r=n.tagName,i=n.tagStart;return n.tagName=n.tagStart=null,"selfcloseTag"==e||S.autoSelfClosers.hasOwnProperty(r)?h(n,r):(h(n,r),n.context=new u(n,r,i==n.indented)),d}return M="error",y}function x(e,t,n){return"equals"==e?b:(S.allowMissing||(M="error"),y(e,t,n))}function b(e,t,n){return"string"==e?w:"word"==e&&S.allowUnquoted?(M="string",y):(M="error",y(e,t,n))}function w(e,t,n){return"string"==e?w:y(e,t,n)}var T,M,k=r.indentUnit,S={},C=i.htmlMode?t:n;for(var L in C)S[L]=C[L];for(var L in i)S[L]=i[L];return o.isInText=!0,{startState:function(e){var t={tokenize:o,state:d,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;T=null;var n=t.tokenize(e,t);return(n||T)&&"comment"!=n&&(M=null,t.state=t.state(T||n,e,t),M&&(n="error"==M?n+" error":M)),n},indent:function(t,n,r){var i=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+k;if(i&&i.noIndent)return e.Pass;if(t.tokenize!=a&&t.tokenize!=o)return r?r.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==S.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+k*(S.multilineTagIndentFactor||1);if(S.alignCDATA&&/<!\[CDATA\[/.test(n))return 0;var l=n&&/^<(\/)?([\w_:\.-]*)/.exec(n);if(l&&l[1])for(;i;){if(i.tagName==l[2]){i=i.prev;break}if(!S.implicitlyClosed.hasOwnProperty(i.tagName))break;i=i.prev}else if(l)for(;i;){var s=S.contextGrabbers[i.tagName];if(!s||!s.hasOwnProperty(l[2]))break;i=i.prev}for(;i&&i.prev&&!i.startOfLine;)i=i.prev;return i?i.indent+k:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:S.htmlMode?"html":"xml",helperType:S.htmlMode?"html":"xml",skipAttribute:function(e){e.state==b&&(e.state=y)}}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})},"object"==typeof r&&"object"==typeof n?i(t("../../lib/codemirror")):"function"==typeof e&&e.amd?e(["../../lib/codemirror"],i):i(CodeMirror)},{"../../lib/codemirror":10}],15:[function(e,t,n){n.read=function(e,t,n,r,i){var o,a,l=8*i-r-1,s=(1<<l)-1,c=s>>1,u=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-u)-1,d>>=-u,u+=l;u>0;o=256*o+e[t+f],f+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+f],f+=h,u-=8);if(0===o)o=1-c;else{if(o===s)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},n.write=function(e,t,n,r,i,o){var a,l,s,c=8*o-i-1,u=(1<<c)-1,f=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-a))<1&&(a--,s*=2),(t+=a+f>=1?h/s:h*Math.pow(2,1-f))*s>=2&&(a++,s/=2),a+f>=u?(l=0,a=u):a+f>=1?(l=(t*s-1)*Math.pow(2,i),a+=f):(l=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&l,d+=p,l/=256,i-=8);for(a=a<<i|l,c+=i;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*m}},{}],16:[function(e,t){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],17:[function(t,n,r){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||h.defaults,this.rules=d.normal,this.options.gfm&&(this.options.tables?this.rules=d.tables:this.rules=d.gfm)}function i(e,t){if(this.options=t||h.defaults,this.links=e,this.rules=p.normal,this.renderer=this.options.renderer||new o,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=p.breaks:this.rules=p.gfm:this.options.pedantic&&(this.rules=p.pedantic)}function o(e){this.options=e||{}}function a(e){this.tokens=[],this.token=null,this.options=e||h.defaults,this.options.renderer=this.options.renderer||new o,this.renderer=this.options.renderer,this.renderer.options=this.options}function l(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(e){return e.replace(/&([#\w]+);/g,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function c(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=(i=i.source||i).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(r,i),n):new RegExp(e,t)}}function u(){}function f(e){for(var t,n,r=1;r<arguments.length;r++)for(n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function h(e,n,r){if(r||"function"==typeof n){r||(r=n,n=null);var i,o,s=(n=f({},h.defaults,n||{})).highlight,c=0;try{i=t.lex(e,n)}catch(u){return r(u)}o=i.length;var d=function(e){if(e)return n.highlight=s,r(e);var t;try{t=a.parse(i,n)}catch(o){e=o}return n.highlight=s,e?r(e):r(null,t)};if(!s||s.length<3)return d();if(delete n.highlight,!o)return d();for(;c<i.length;c++)!function(e){"code"!==e.type?--o||d():s(e.text,e.lang,function(t,n){return t?d(t):null==n||n===e.text?--o||d():(e.text=n,e.escaped=!0,void(--o||d()))})}(i[c])}else try{return n&&(n=f({},h.defaults,n)),a.parse(t.lex(e,n),n)}catch(u){if(u.message+="\nPlease report this to https://github.com/chjj/marked.",(n||h.defaults).silent)return"<p>An error occured:</p><pre>"+l(u.message+"",!0)+"</pre>";throw u}}var d={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:u,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:u,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:u,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};d.item=c(d.item,"gm")(/bull/g,d.bullet)(),d.list=c(d.list)(/bull/g,d.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+d.def.source+")")(),d.blockquote=c(d.blockquote)("def",d.def)(),d._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",d.html=c(d.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,d._tag)(),d.paragraph=c(d.paragraph)("hr",d.hr)("heading",d.heading)("lheading",d.lheading)("blockquote",d.blockquote)("tag","<"+d._tag)("def",d.def)(),d.normal=f({},d),d.gfm=f({},d.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),d.gfm.paragraph=c(d.paragraph)("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|"+d.list.source.replace("\\1","\\3")+"|")(),d.tables=f({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=d,t.lex=function(e,n){return new t(n).lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,n){var r,i,o,a,l,s,c,u,f;for(e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),s={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},u=0;u<s.align.length;u++)/^ *-+: *$/.test(s.align[u])?s.align[u]="right":/^ *:-+: *$/.test(s.align[u])?s.align[u]="center":/^ *:-+ *$/.test(s.align[u])?s.align[u]="left":s.align[u]=null;for(u=0;u<s.cells.length;u++)s.cells[u]=s.cells[u].split(/ *\| */);this.tokens.push(s)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),a=o[2],this.tokens.push({type:"list_start",ordered:a.length>1}),r=!1,f=(o=o[0].match(this.rules.item)).length,u=0;f>u;u++)c=(s=o[u]).length,~(s=s.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(c-=s.length,s=this.options.pedantic?s.replace(/^ {1,4}/gm,""):s.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&u!==f-1&&(a===(l=d.bullet.exec(o[u+1])[0])||a.length>1&&l.length>1||(e=o.slice(u+1).join("\n")+e,u=f-1)),i=r||/\n\n(?!\s*$)/.test(s),u!==f-1&&(r="\n"===s.charAt(s.length-1),i||(i=r)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(s,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(!n&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),s={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<s.align.length;u++)/^ *-+: *$/.test(s.align[u])?s.align[u]="right":/^ *:-+: *$/.test(s.align[u])?s.align[u]="center":/^ *:-+ *$/.test(s.align[u])?s.align[u]="left":s.align[u]=null;for(u=0;u<s.cells.length;u++)s.cells[u]=s.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(s)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var p={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:u,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:u,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};p.link=c(p.link)("inside",p._inside)("href",p._href)(),p.reflink=c(p.reflink)("inside",p._inside)(),p.normal=f({},p),p.pedantic=f({},p.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),p.gfm=f({},p.normal,{escape:c(p.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(p.text)("]|","~]|")("|","|https?://|")()}),p.breaks=f({},p.gfm,{br:c(p.br)("{2,}","*")(),text:c(p.gfm.text)("{2,}","*")()}),i.rules=p,i.output=function(e,t,n){return new i(t,n).output(e)},i.prototype.output=function(e){for(var t,n,r,i,o="";e;)if(i=this.rules.escape.exec(e))e=e.substring(i[0].length),o+=i[1];else if(i=this.rules.autolink.exec(e))e=e.substring(i[0].length),"@"===i[2]?(n=":"===i[1].charAt(6)?this.mangle(i[1].substring(7)):this.mangle(i[1]),r=this.mangle("mailto:")+n):r=n=l(i[1]),o+=this.renderer.link(r,null,n);else if(this.inLink||!(i=this.rules.url.exec(e))){if(i=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),e=e.substring(i[0].length),o+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):l(i[0]):i[0];else if(i=this.rules.link.exec(e))e=e.substring(i[0].length),this.inLink=!0,o+=this.outputLink(i,{href:i[2],title:i[3]}),this.inLink=!1;else if((i=this.rules.reflink.exec(e))||(i=this.rules.nolink.exec(e))){if(e=e.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){o+=i[0].charAt(0),e=i[0].substring(1)+e;continue}this.inLink=!0,o+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(e))e=e.substring(i[0].length),o+=this.renderer.strong(this.output(i[2]||i[1]));else if(i=this.rules.em.exec(e))e=e.substring(i[0].length),o+=this.renderer.em(this.output(i[2]||i[1]));else if(i=this.rules.code.exec(e))e=e.substring(i[0].length),o+=this.renderer.codespan(l(i[2],!0));else if(i=this.rules.br.exec(e))e=e.substring(i[0].length),o+=this.renderer.br();else if(i=this.rules.del.exec(e))e=e.substring(i[0].length),o+=this.renderer.del(this.output(i[1]));else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),o+=this.renderer.text(l(this.smartypants(i[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(i[0].length),r=n=l(i[1]),o+=this.renderer.link(r,null,n);return o},i.prototype.outputLink=function(e,t){var n=l(t.href),r=t.title?l(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,l(e[1]))},i.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026"):e},i.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,i=0;r>i;i++)t=e.charCodeAt(i),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},o.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+l(t,!0)+'">'+(n?e:l(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:l(e,!0))+"\n</code></pre>"},o.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},o.prototype.html=function(e){return e},o.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},o.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},o.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},o.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},o.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},o.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},o.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},o.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},o.prototype.strong=function(e){return"<strong>"+e+"</strong>"},o.prototype.em=function(e){return"<em>"+e+"</em>"},o.prototype.codespan=function(e){return"<code>"+e+"</code>"},o.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},o.prototype.del=function(e){return"<del>"+e+"</del>"},o.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(s(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(i){return""}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+">"+n+"</a>"},o.prototype.image=function(e,t,n){var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+(this.options.xhtml?"/>":">")},o.prototype.text=function(e){return e},a.parse=function(e,t,n){return new a(t,n).parse(e)},a.prototype.parse=function(e){this.inline=new i(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,o="",a="";for(n="",e=0;e<this.token.header.length;e++)({header:!0,align:this.token.align[e]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",i=0;i<t.length;i++)n+=this.renderer.tablecell(this.inline.output(t[i]),{header:!1,
align:this.token.align[i]});a+=this.renderer.tablerow(n)}return this.renderer.table(o,a);case"blockquote_start":for(a="";"blockquote_end"!==this.next().type;)a+=this.tok();return this.renderer.blockquote(a);case"list_start":a="";for(var l=this.token.ordered;"list_end"!==this.next().type;)a+=this.tok();return this.renderer.list(a,l);case"list_item_start":for(a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(a);case"loose_item_start":for(a="";"list_item_end"!==this.next().type;)a+=this.tok();return this.renderer.listitem(a);case"html":var s=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(s);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},u.exec=u,h.options=h.setOptions=function(e){return f(h.defaults,e),h},h.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new o,xhtml:!1},h.Parser=a,h.parser=a.parse,h.Renderer=o,h.Lexer=t,h.lexer=t.lex,h.InlineLexer=i,h.inlineLexer=i.output,h.parse=h,void 0!==n&&"object"==typeof r?n.exports=h:"function"==typeof e&&e.amd?e(function(){return h}):this.marked=h}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t){(function(n,r){"use strict";var i=function(e,t,n,i){if(i=i||{},this.dictionary=null,this.rules={},this.dictionaryTable={},this.compoundRules=[],this.compoundRuleCodes={},this.replacementTable=[],this.flags=i.flags||{},e){if(this.dictionary=e,"undefined"!=typeof window&&"chrome"in window&&"extension"in window.chrome&&"getURL"in window.chrome.extension)t||(t=this._readFile(chrome.extension.getURL("lib/typo/dictionaries/"+e+"/"+e+".aff"))),n||(n=this._readFile(chrome.extension.getURL("lib/typo/dictionaries/"+e+"/"+e+".dic")));else{if(i.dictionaryPath)var o=i.dictionaryPath;else if(void 0!==r)o=r+"/dictionaries";else o="./dictionaries";t||(t=this._readFile(o+"/"+e+"/"+e+".aff")),n||(n=this._readFile(o+"/"+e+"/"+e+".dic"))}this.rules=this._parseAFF(t),this.compoundRuleCodes={};for(var a=0,l=this.compoundRules.length;l>a;a++)for(var s=this.compoundRules[a],c=0,u=s.length;u>c;c++)this.compoundRuleCodes[s[c]]=[];for(var a in"ONLYINCOMPOUND"in this.flags&&(this.compoundRuleCodes[this.flags.ONLYINCOMPOUND]=[]),this.dictionaryTable=this._parseDIC(n),this.compoundRuleCodes)0==this.compoundRuleCodes[a].length&&delete this.compoundRuleCodes[a];for(a=0,l=this.compoundRules.length;l>a;a++){var f=this.compoundRules[a],h="";for(c=0,u=f.length;u>c;c++){var d=f[c];h+=d in this.compoundRuleCodes?"("+this.compoundRuleCodes[d].join("|")+")":d}this.compoundRules[a]=new RegExp(h,"i")}}return this};i.prototype={load:function(e){for(var t in e)this[t]=e[t];return this},_readFile:function(t,r){if(r||(r="utf8"),"undefined"!=typeof XMLHttpRequest){var i=new XMLHttpRequest;return i.open("GET",t,!1),i.overrideMimeType&&i.overrideMimeType("text/plain; charset="+r),i.send(null),i.responseText}if(void 0!==e){var o=e("fs");try{if(o.existsSync(t)){var a=o.statSync(t),l=o.openSync(t,"r"),s=new n(a.size);return o.readSync(l,s,0,s.length,null),s.toString(r,0,s.length)}console.log("Path "+t+" does not exist.")}catch(c){return console.log(c),""}}},_parseAFF:function(e){for(var t={},n=(e=this._removeAffixComments(e)).split("\n"),r=0,i=n.length;i>r;r++){var a=(o=n[r]).split(/\s+/),l=a[0];if("PFX"==l||"SFX"==l){for(var s=a[1],c=a[2],f=[],h=r+1,d=r+1+(u=parseInt(a[3],10));d>h;h++){var m=(p=(o=n[h]).split(/\s+/))[2],g=p[3].split("/"),v=g[0];"0"===v&&(v="");var y=this.parseRuleCodes(g[1]),x=p[4],b={};b.add=v,y.length>0&&(b.continuationClasses=y),"."!==x&&(b.match="SFX"===l?new RegExp(x+"$"):new RegExp("^"+x)),"0"!=m&&(b.remove="SFX"===l?new RegExp(m+"$"):m),f.push(b)}t[s]={type:l,combineable:"Y"==c,entries:f},r+=u}else if("COMPOUNDRULE"===l){var u;for(h=r+1,d=r+1+(u=parseInt(a[1],10));d>h;h++){var o,p=(o=n[h]).split(/\s+/);this.compoundRules.push(p[1])}r+=u}else if("REP"===l){3===(p=o.split(/\s+/)).length&&this.replacementTable.push([p[1],p[2]])}else this.flags[l]=a[1]}return t},_removeAffixComments:function(e){return(e=(e=(e=e.replace(/#.*$/gm,"")).replace(/^\s\s*/m,"").replace(/\s\s*$/m,"")).replace(/\n{2,}/g,"\n")).replace(/^\s\s*/,"").replace(/\s\s*$/,"")},_parseDIC:function(e){function t(e,t){e in r&&"object"==typeof r[e]||(r[e]=[]),r[e].push(t)}for(var n=(e=this._removeDicComments(e)).split("\n"),r={},i=1,o=n.length;o>i;i++){var l=n[i].split("/",2),s=l[0];if(l.length>1){var c=this.parseRuleCodes(l[1]);"NEEDAFFIX"in this.flags&&-1!=c.indexOf(this.flags.NEEDAFFIX)||t(s,c);for(var u=0,f=c.length;f>u;u++){var h=c[u],d=this.rules[h];if(d)for(var p=this._applyRule(s,d),m=0,g=p.length;g>m;m++){var v=p[m];if(t(v,[]),d.combineable)for(var y=u+1;f>y;y++){var x=c[y],b=this.rules[x];if(b&&b.combineable&&d.type!=b.type)for(var w=this._applyRule(v,b),k=0,S=w.length;S>k;k++){t(w[k],[])}}}h in this.compoundRuleCodes&&this.compoundRuleCodes[h].push(s)}}else t(s.trim(),[])}return r},_removeDicComments:function(e){return e.replace(/^\t.*$/gm,"")},parseRuleCodes:function(e){if(!e)return[];if(!("FLAG"in this.flags))return e.split("");if("long"===this.flags.FLAG){for(var t=[],n=0,r=e.length;r>n;n+=2)t.push(e.substr(n,2));return t}return"num"===this.flags.FLAG?textCode.split(","):void 0},_applyRule:function(e,t){for(var n=t.entries,r=[],i=0,o=n.length;o>i;i++){var a=n[i];if(!a.match||e.match(a.match)){var l=e;if(a.remove&&(l=l.replace(a.remove,"")),"SFX"===t.type?l+=a.add:l=a.add+l,r.push(l),"continuationClasses"in a)for(var s=0,c=a.continuationClasses.length;c>s;s++){var u=this.rules[a.continuationClasses[s]];u&&(r=r.concat(this._applyRule(l,u)))}}}return r},check:function(e){var t=e.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(this.checkExact(t))return!0;if(t.toUpperCase()===t){var n=t[0]+t.substring(1).toLowerCase();if(this.hasFlag(n,"KEEPCASE"))return!1;if(this.checkExact(n))return!0}var r=t.toLowerCase();if(r!==t){if(this.hasFlag(r,"KEEPCASE"))return!1;if(this.checkExact(r))return!0}return!1},checkExact:function(e){var t=this.dictionaryTable[e];if(void 0===t){if("COMPOUNDMIN"in this.flags&&e.length>=this.flags.COMPOUNDMIN)for(var n=0,r=this.compoundRules.length;r>n;n++)if(e.match(this.compoundRules[n]))return!0;return!1}if("object"==typeof t){for(n=0,r=t.length;r>n;n++)if(!this.hasFlag(e,"ONLYINCOMPOUND",t[n]))return!0;return!1}},hasFlag:function(e,t,n){if(t in this.flags){if(void 0===n)n=Array.prototype.concat.apply([],this.dictionaryTable[e]);if(n&&-1!==n.indexOf(this.flags[t]))return!0}return!1},alphabet:"",suggest:function(e,t){function n(e){for(var t=[],n=0,r=e.length;r>n;n++){for(var i=e[n],o=[],a=0,l=i.length+1;l>a;a++)o.push([i.substring(0,a),i.substring(a,i.length)]);var s=[];for(a=0,l=o.length;l>a;a++){(u=o[a])[1]&&s.push(u[0]+u[1].substring(1))}var f=[];for(a=0,l=o.length;l>a;a++){(u=o[a])[1].length>1&&f.push(u[0]+u[1][1]+u[1][0]+u[1].substring(2))}var h=[];for(a=0,l=o.length;l>a;a++){if((u=o[a])[1])for(var d=0,p=c.alphabet.length;p>d;d++)h.push(u[0]+c.alphabet[d]+u[1].substring(1))}var m=[];for(a=0,l=o.length;l>a;a++){var u;if((u=o[a])[1])for(d=0,p=c.alphabet.length;p>d;d++)h.push(u[0]+c.alphabet[d]+u[1])}t=(t=(t=(t=t.concat(s)).concat(f)).concat(h)).concat(m)}return t}function r(e){for(var t=[],n=0;n<e.length;n++)c.check(e[n])&&t.push(e[n]);return t}function i(e){function i(e,t){return e[1]<t[1]?-1:1}for(var o=n([e]),a=n(o),l=r(o).concat(r(a)),s={},u=0,f=l.length;f>u;u++)l[u]in s?s[l[u]]+=1:s[l[u]]=1;var h=[];for(var u in s)h.push([u,s[u]]);h.sort(i).reverse();var d=[];for(u=0,f=Math.min(t,h.length);f>u;u++)c.hasFlag(h[u][0],"NOSUGGEST")||d.push(h[u][0]);return d}if(t||(t=5),this.check(e))return[];for(var o=0,a=this.replacementTable.length;a>o;o++){var l=this.replacementTable[o];if(-1!==e.indexOf(l[0])){var s=e.replace(l[0],l[1]);if(this.check(s))return[s]}}var c=this;return c.alphabet="abcdefghijklmnopqrstuvwxyz",i(e)}},void 0!==t&&(t.exports=i)}).call(this,e("buffer").Buffer,"/node_modules/typo-js")},{buffer:3,fs:2}],19:[function(e){var r=e("codemirror");r.commands.tabAndIndentMarkdownList=function(e){var n=e.listSelections()[0].head;if(!1!==e.getStateAfter(n.line).list)e.execCommand("indentMore");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var o=Array(e.options.tabSize+1).join(" ");e.replaceSelection(o)}},r.commands.shiftTabAndUnindentMarkdownList=function(e){var n=e.listSelections()[0].head;if(!1!==e.getStateAfter(n.line).list)e.execCommand("indentLess");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var o=Array(e.options.tabSize+1).join(" ");e.replaceSelection(o)}}},{codemirror:10}],20:[function(e,t){"use strict";function r(e){return U?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl")}function i(e,t,n){e=e||{};var r=document.createElement("a");return t=null==t||t,e.title&&t&&(r.title=a(e.title,e.action,n),U&&(r.title=r.title.replace("Ctrl","\u2318"),r.title=r.title.replace("Alt","\u2325"))),r.tabIndex=-1,r.className=e.className,r}function o(){var e=document.createElement("i");return e.className="separator",e.innerHTML="|",e}function a(e,t,n){var i,o=e;return t&&(n[i=Y(t)]&&(o+=" ("+r(n[i])+")")),o}function l(e,t){t=t||e.getCursor("start");var n=e.getTokenAt(t);if(!n.type)return{};for(var r,i,o=n.type.split(" "),a={},l=0;l<o.length;l++)"strong"===(r=o[l])?a.bold=!0:"variable-2"===r?(i=e.getLine(t.line),/^\s*\d+\.\s/.test(i)?a["ordered-list"]=!0:a["unordered-list"]=!0):"atom"===r?a.quote=!0:"em"===r?a.italic=!0:"quote"===r?a.quote=!0:"strikethrough"===r?a.strikethrough=!0:"comment"===r?a.code=!0:"link"===r?a.link=!0:"tag"===r?a.image=!0:r.match(/^header(\-[1-6])?$/)&&(a[r.replace("header","heading")]=!0);return a}function s(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen")),t.getOption("fullScreen")?(V=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=V;var n=t.getWrapperElement();/fullscreen/.test(n.previousSibling.className)?n.previousSibling.className=n.previousSibling.className.replace(/\s*fullscreen\b/,""):n.previousSibling.className+=" fullscreen";var r=e.toolbarElements.fullscreen;/active/.test(r.className)?r.className=r.className.replace(/\s*active\s*/g,""):r.className+=" active";var i=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(i.className)&&N(e)}function c(e){P(e,"bold",e.options.blockStyles.bold)}function u(e){P(e,"italic",e.options.blockStyles.italic)}function f(e){P(e,"strikethrough","~~")}function h(e){function t(e){if("object"!=typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function n(e){return e.state.base.base||e.state.base}function r(e,r,i,o,a){i=i||e.getLineHandle(r),o=o||e.getTokenAt({line:r,ch:1}),a=a||!!i.text&&e.getTokenAt({line:r,ch:i.text.length-1});var l=o.type?o.type.split(" "):[];return a&&n(a).indentedCode?"indented":-1!==l.indexOf("comment")&&(n(o).fencedChars||n(a).fencedChars||t(i)?"fenced":"single")}function i(e,t,n,r){var i=t.line+1,o=n.line+1,a=t.line!==n.line,l=r+"\n",s="\n"+r;a&&o++,a&&0===n.ch&&(s=r+"\n",o--),E(e,!1,[l,s]),e.setSelection({line:i,ch:0},{line:o,ch:0})}var o,a,l,s=e.options.blockStyles.code,c=e.codemirror,u=c.getCursor("start"),f=c.getCursor("end"),h=c.getTokenAt({line:u.line,ch:u.ch||1}),d=c.getLineHandle(u.line),p=r(c,u.line,d,h);if("single"===p){var m=d.text.slice(0,u.ch).replace("`",""),g=d.text.slice(u.ch).replace("`","");c.replaceRange(m+g,{line:u.line,ch:0},{line:u.line,ch:99999999999999}),u.ch--,u!==f&&f.ch--,c.setSelection(u,f),c.focus()}else if("fenced"===p)if(u.line!==f.line||u.ch!==f.ch){for(o=u.line;o>=0&&!t(d=c.getLineHandle(o));o--);var v,y,x,b,k=n(c.getTokenAt({line:o,ch:1})).fencedChars;t(c.getLineHandle(u.line))?(v="",y=u.line):t(c.getLineHandle(u.line-1))?(v="",y=u.line-1):(v=k+"\n",y=u.line),t(c.getLineHandle(f.line))?(x="",b=f.line,0===f.ch&&(b+=1)):0!==f.ch&&t(c.getLineHandle(f.line+1))?(x="",b=f.line+1):(x=k+"\n",b=f.line+1),0===f.ch&&(b-=1),c.operation(function(){c.replaceRange(x,{line:b,ch:0},{line:b+(x?0:1),ch:0}),c.replaceRange(v,{line:y,ch:0},{line:y+(v?0:1),ch:0})}),c.setSelection({line:y+(v?1:0),ch:0},{line:b+(v?1:-1),ch:0}),c.focus()}else{var S=u.line;if(t(c.getLineHandle(u.line))&&("fenced"===r(c,u.line+1)?(o=u.line,S=u.line+1):(a=u.line,S=u.line-1)),void 0===o)for(o=S;o>=0&&!t(d=c.getLineHandle(o));o--);if(void 0===a)for(l=c.lineCount(),a=S;l>a&&!t(d=c.getLineHandle(a));a++);c.operation(function(){c.replaceRange("",{line:o,ch:0},{line:o+1,ch:0}),c.replaceRange("",{line:a-1,ch:0},{line:a,ch:0})}),c.focus()}else if("indented"===p){if(u.line!==f.line||u.ch!==f.ch)o=u.line,a=f.line,0===f.ch&&a--;else{for(o=u.line;o>=0;o--)if(!(d=c.getLineHandle(o)).text.match(/^\s*$/)&&"indented"!==r(c,o,d)){o+=1;break}for(l=c.lineCount(),a=u.line;l>a;a++)if(!(d=c.getLineHandle(a)).text.match(/^\s*$/)&&"indented"!==r(c,a,d)){a-=1;break}}var C=c.getLineHandle(a+1),L=C&&c.getTokenAt({line:a+1,ch:C.text.length-1});L&&n(L).indentedCode&&c.replaceRange("\n",{line:a+1,ch:0});for(var M=o;a>=M;M++)c.indentLine(M,"subtract");c.focus()}else{var N=u.line===f.line&&u.ch===f.ch&&0===u.ch,A=u.line!==f.line;N||A?i(c,u,f,s):E(c,!1,["`","`"])}}function d(e){I(e.codemirror,"quote")}function p(e){O(e.codemirror,"smaller")}function m(e){O(e.codemirror,"bigger")}function g(e){O(e.codemirror,void 0,1)}function v(e){O(e.codemirror,void 0,2)}function y(e){O(e.codemirror,void 0,3)}function x(e){I(e.codemirror,"unordered-list")}function b(e){I(e.codemirror,"ordered-list")}function w(e){R(e.codemirror)}function k(e){var t=e.codemirror,n=l(t),r=e.options,i="http://";return!(r.promptURLs&&(i=prompt(r.promptTexts.link),!i))&&void E(t,n.link,r.insertTexts.link,i)}function S(e){var t=e.codemirror,n=l(t),r=e.options,i="http://";return!(r.promptURLs&&(i=prompt(r.promptTexts.image),!i))&&void E(t,n.image,r.insertTexts.image,i)}function C(e){var t=e.codemirror,n=l(t),r=e.options;E(t,n.table,r.insertTexts.table)}function L(e){var t=e.codemirror,n=l(t),r=e.options;E(t,n.image,r.insertTexts.horizontalRule)}function T(e){var t=e.codemirror;t.undo(),t.focus()}function M(e){var t=e.codemirror;t.redo(),t.focus()}function N(e){var t=e.codemirror,n=t.getWrapperElement(),r=n.nextSibling,i=e.toolbarElements["side-by-side"],o=!1;/editor-preview-active-side/.test(r.className)?(r.className=r.className.replace(/\s*editor-preview-active-side\s*/g,""),i.className=i.className.replace(/\s*active\s*/g,""),n.className=n.className.replace(/\s*CodeMirror-sided\s*/g," ")):(setTimeout(function(){t.getOption("fullScreen")||s(e),r.className+=" editor-preview-active-side"},1),i.className+=" active",n.className+=" CodeMirror-sided",o=!0);var a=n.lastChild;if(/editor-preview-active/.test(a.className)){a.className=a.className.replace(/\s*editor-preview-active\s*/g,"");var l=e.toolbarElements.preview,c=n.previousSibling;l.className=l.className.replace(/\s*active\s*/g,""),c.className=c.className.replace(/\s*disabled-for-preview*/g,"")}var u=function(){r.innerHTML=e.options.previewRender(e.value(),r)};t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=u),o?(r.innerHTML=e.options.previewRender(e.value(),r),t.on("update",t.sideBySideRenderingFunction)):t.off("update",t.sideBySideRenderingFunction),t.refresh()}function A(e){var t=e.codemirror,n=t.getWrapperElement(),r=n.previousSibling,i=!!e.options.toolbar&&e.toolbarElements.preview,o=n.lastChild;o&&/editor-preview/.test(o.className)||((o=document.createElement("div")).className="editor-preview",n.appendChild(o)),/editor-preview-active/.test(o.className)?(o.className=o.className.replace(/\s*editor-preview-active\s*/g,""),i&&(i.className=i.className.replace(/\s*active\s*/g,""),r.className=r.className.replace(/\s*disabled-for-preview*/g,""))):(setTimeout(function(){o.className+=" editor-preview-active"},1),i&&(i.className+=" active",r.className+=" disabled-for-preview")),o.innerHTML=e.options.previewRender(e.value(),o);var a=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(a.className)&&N(e)}function E(e,t,n,r){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var i,o=n[0],a=n[1],l=e.getCursor("start"),s=e.getCursor("end");r&&(a=a.replace("#url#",r)),t?(o=(i=e.getLine(l.line)).slice(0,l.ch),a=i.slice(l.ch),e.replaceRange(o+a,{line:l.line,ch:0})):(i=e.getSelection(),e.replaceSelection(o+i+a),l.ch+=o.length,l!==s&&(s.ch+=o.length)),e.setSelection(l,s),e.focus()}}function O(e,t,n){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var r=e.getCursor("start"),i=e.getCursor("end"),o=r.line;o<=i.line;o++)!function(r){var i=e.getLine(r),o=i.search(/[^#]/);i=void 0!==t?0>=o?"bigger"==t?"###### "+i:"# "+i:6==o&&"smaller"==t?i.substr(7):1==o&&"bigger"==t?i.substr(2):"bigger"==t?i.substr(1):"#"+i:1==n?0>=o?"# "+i:o==n?i.substr(o+1):"# "+i.substr(o+1):2==n?0>=o?"## "+i:o==n?i.substr(o+1):"## "+i.substr(o+1):0>=o?"### "+i:o==n?i.substr(o+1):"### "+i.substr(o+1),e.replaceRange(i,{line:r,ch:0},{line:r,ch:99999999999999})}(o);e.focus()}}function I(e,t){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var n=l(e),r=e.getCursor("start"),i=e.getCursor("end"),o={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},a={quote:"> ","unordered-list":"* ","ordered-list":"1. "},s=r.line;s<=i.line;s++)!function(r){var i=e.getLine(r);i=n[t]?i.replace(o[t],"$1"):a[t]+i,e.replaceRange(i,{line:r,ch:0},{line:r,ch:99999999999999})}(s);e.focus()}}function P(e,t,n,r){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){r=void 0===r?n:r;var i,o=e.codemirror,a=l(o),s=n,c=r,u=o.getCursor("start"),f=o.getCursor("end");a[t]?(s=(i=o.getLine(u.line)).slice(0,u.ch),c=i.slice(u.ch),"bold"==t?(s=s.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),c=c.replace(/(\*\*|__)/,"")):"italic"==t?(s=s.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),c=c.replace(/(\*|_)/,"")):"strikethrough"==t&&(s=s.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),c=c.replace(/(\*\*|~~)/,"")),o.replaceRange(s+c,{line:u.line,ch:0},{line:u.line,ch:99999999999999}),"bold"==t||"strikethrough"==t?(u.ch-=2,u!==f&&(f.ch-=2)):"italic"==t&&(u.ch-=1,u!==f&&(f.ch-=1))):(i=o.getSelection(),"bold"==t?i=(i=i.split("**").join("")).split("__").join(""):"italic"==t?i=(i=i.split("*").join("")).split("_").join(""):"strikethrough"==t&&(i=i.split("~~").join("")),o.replaceSelection(s+i+c),u.ch+=n.length,f.ch=u.ch+i.length),o.setSelection(u,f),o.focus()}}function R(e){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className))for(var t,n=e.getCursor("start"),r=e.getCursor("end"),i=n.line;i<=r.line;i++)t=(t=e.getLine(i)).replace(/^[ ]*([# ]+|\*|\-|[> ]+|[0-9]+(.|\)))[ ]*/,""),e.replaceRange(t,{line:i,ch:0},{line:i,ch:99999999999999})}function D(e,t){for(var n in t)t.hasOwnProperty(n)&&(t[n]instanceof Array?e[n]=t[n].concat(e[n]instanceof Array?e[n]:[]):null!==t[n]&&"object"==typeof t[n]&&t[n].constructor===Object?e[n]=D(e[n]||{},t[n]):e[n]=t[n]);return e}function H(e){for(var t=1;t<arguments.length;t++)e=D(e,arguments[t]);return e}function W(e){var t=/[a-zA-Z0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g,n=e.match(t),r=0;if(null===n)return r;for(var i=0;i<n.length;i++)r+=n[i].charCodeAt(0)>=19968?n[i].length:1;return r}function B(e){(e=e||{}).parent=this;var t=!0;if(!1===e.autoDownloadFontAwesome&&(t=!1),!0!==e.autoDownloadFontAwesome)for(var n=document.styleSheets,r=0;r<n.length;r++)n[r].href&&n[r].href.indexOf("//maxcdn.bootstrapcdn.com/font-awesome/")>-1&&(t=!1);if(t){var i=document.createElement("link");i.rel="stylesheet",i.href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(i)}if(e.element)this.element=e.element;else if(null===e.element)return void console.log("SimpleMDE: Error. No element was found.");if(void 0===e.toolbar)for(var o in e.toolbar=[],K)K.hasOwnProperty(o)&&(-1!=o.indexOf("separator-")&&e.toolbar.push("|"),(!0===K[o]["default"]||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(o))&&e.toolbar.push(o));e.hasOwnProperty("status")||(e.status=["autosave","lines","words","cursor"]),e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)}),e.parsingConfig=H({highlightFormatting:!0},e.parsingConfig||{}),e.insertTexts=H({},X,e.insertTexts||{}),e.promptTexts=Z,e.blockStyles=H({},J,e.blockStyles||{}),e.shortcuts=H({},G,e.shortcuts||{}),null!=e.autosave&&null!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id),this.options=e,this.render(),!e.initialValue||this.options.autosave&&!0===this.options.autosave.foundSavedValue||this.value(e.initialValue)}function _(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("smde_localStorage",1),localStorage.removeItem("smde_localStorage")}catch(e){return!1}return!0}var F=e("codemirror");e("codemirror/addon/edit/continuelist.js"),e("./codemirror/tablist"),e("codemirror/addon/display/fullscreen.js"),e("codemirror/mode/markdown/markdown.js"),e("codemirror/addon/mode/overlay.js"),e("codemirror/addon/display/placeholder.js"),e("codemirror/addon/selection/mark-selection.js"),e("codemirror/mode/gfm/gfm.js"),e("codemirror/mode/xml/xml.js");var z=e("codemirror-spell-checker"),j=e("marked"),U=/Mac/.test(navigator.platform),q={toggleBold:c,toggleItalic:u,drawLink:k,toggleHeadingSmaller:p,toggleHeadingBigger:m,drawImage:S,toggleBlockquote:d,toggleOrderedList:b,toggleUnorderedList:x,toggleCodeBlock:h,togglePreview:A,toggleStrikethrough:f,toggleHeading1:g,toggleHeading2:v,toggleHeading3:y,cleanBlock:w,drawTable:C,drawHorizontalRule:L,undo:T,redo:M,toggleSideBySide:N,toggleFullScreen:s},G={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"},Y=function(e){for(var t in q)if(q[t]===e)return t;return null},$=function(){var t,e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e},V="",K={bold:{name:"bold",action:c,className:"fa fa-bold",title:"Bold","default":!0},italic:{name:"italic",action:u,className:"fa fa-italic",title:"Italic","default":!0},strikethrough:{name:"strikethrough",action:f,className:"fa fa-strikethrough",title:"Strikethrough"},heading:{name:"heading",action:p,className:"fa fa-header",title:"Heading","default":!0},"heading-smaller":{name:"heading-smaller",action:p,className:"fa fa-header fa-header-x fa-header-smaller",title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:m,className:"fa fa-header fa-header-x fa-header-bigger",title:"Bigger Heading"},"heading-1":{name:"heading-1",action:g,className:"fa fa-header fa-header-x fa-header-1",title:"Big Heading"},"heading-2":{name:"heading-2",action:v,className:"fa fa-header fa-header-x fa-header-2",title:"Medium Heading"},"heading-3":{name:"heading-3",action:y,className:"fa fa-header fa-header-x fa-header-3",title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:h,className:"fa fa-code",title:"Code"},quote:{name:"quote",action:d,className:"fa fa-quote-left",title:"Quote","default":!0},"unordered-list":{name:"unordered-list",action:x,className:"fa fa-list-ul",title:"Generic List","default":!0},"ordered-list":{name:"ordered-list",action:b,className:"fa fa-list-ol",title:"Numbered List","default":!0},"clean-block":{name:"clean-block",action:w,className:"fa fa-eraser fa-clean-block",title:"Clean block"},"separator-2":{name:"separator-2"},link:{name:"link",action:k,className:"fa fa-link",title:"Create Link","default":!0},image:{name:"image",action:S,className:"fa fa-picture-o",title:"Insert Image","default":!0},table:{name:"table",action:C,className:"fa fa-table",title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:L,className:"fa fa-minus",title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:A,className:"fa fa-eye no-disable",title:"Toggle Preview","default":!0},"side-by-side":{name:"side-by-side",action:N,className:"fa fa-columns no-disable no-mobile",title:"Toggle Side by Side","default":!0},fullscreen:{name:"fullscreen",action:s,className:"fa fa-arrows-alt no-disable no-mobile",title:"Toggle Fullscreen","default":!0},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://simplemde.com/markdown-guide",className:"fa fa-question-circle",title:"Markdown Guide","default":!0},"separator-5":{name:"separator-5"},undo:{name:"undo",action:T,className:"fa fa-undo no-disable",title:"Undo"},redo:{name:"redo",action:M,className:"fa fa-repeat no-disable",title:"Redo"}},X={link:["[","](#url#)"],image:["![](","#url#)"],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]},Z={link:"URL for the link:",image:"URL of the image:"},J={bold:"**",code:"```",italic:"*"};B.prototype.markdown=function(e){if(j){var t={};return this.options&&this.options.renderingConfig&&!1===this.options.renderingConfig.singleLineBreaks?t.breaks=!1:t.breaks=!0,this.options&&this.options.renderingConfig&&!0===this.options.renderingConfig.codeSyntaxHighlighting&&window.hljs&&(t.highlight=function(e){return window.hljs.highlightAuto(e).value}),j.setOptions(t),j(e)}},B.prototype.render=function(e){if(e||(e=this.element||document.getElementsByTagName("textarea")[0]),!this._rendered||this._rendered!==e){this.element=e;var a,l,t=this.options,n=this,i={};for(var o in t.shortcuts)null!==t.shortcuts[o]&&null!==q[o]&&function(e){i[r(t.shortcuts[e])]=function(){q[e](n)}}(o);if(i.Enter="newlineAndIndentContinueMarkdownList",i.Tab="tabAndIndentMarkdownList",i["Shift-Tab"]="shiftTabAndUnindentMarkdownList",i.Esc=function(e){e.getOption("fullScreen")&&s(n)},document.addEventListener("keydown",function(e){27==(e=e||window.event).keyCode&&n.codemirror.getOption("fullScreen")&&s(n)},!1),!1!==t.spellChecker?(a="spell-checker",(l=t.parsingConfig).name="gfm",l.gitHubSpice=!1,z({codeMirrorInstance:F})):((a=t.parsingConfig).name="gfm",a.gitHubSpice=!1),this.codemirror=F.fromTextArea(e,{mode:a,backdrop:l,theme:"paper",tabSize:null!=t.tabSize?t.tabSize:2,indentUnit:null!=t.tabSize?t.tabSize:2,indentWithTabs:!1!==t.indentWithTabs,lineNumbers:!1,autofocus:!0===t.autofocus,extraKeys:i,lineWrapping:!1!==t.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:t.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:null==t.styleSelectedText||t.styleSelectedText}),!0===t.forceSync){var c=this.codemirror;c.on("change",function(){c.save()})}this.gui={},!1!==t.toolbar&&(this.gui.toolbar=this.createToolbar()),!1!==t.status&&(this.gui.statusbar=this.createStatusbar()),null!=t.autosave&&!0===t.autosave.enabled&&this.autosave(),this.gui.sideBySide=this.createSideBySide(),this._rendered=this.element;var u=this.codemirror;setTimeout(function(){u.refresh()}.bind(u),0)}},B.prototype.autosave=function(){if(_()){var e=this;if(null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to use the autosave feature");null!=e.element.form&&null!=e.element.form&&e.element.form.addEventListener("submit",function(){localStorage.removeItem("smde_"+e.options.autosave.uniqueId)}),!0!==this.options.autosave.loaded&&("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&(this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId)),this.options.autosave.foundSavedValue=!0),this.options.autosave.loaded=!0),localStorage.setItem("smde_"+this.options.autosave.uniqueId,e.value());var t=document.getElementById("autosaved");if(null!=t&&null!=t&&""!=t){var n=new Date,r=n.getHours(),i=n.getMinutes(),o="am",a=r;a>=12&&(a=r-12,o="pm"),0==a&&(a=12),i=10>i?"0"+i:i,t.innerHTML="Autosaved: "+a+":"+i+" "+o}this.autosaveTimeoutId=setTimeout(function(){e.autosave()},this.options.autosave.delay||1e4)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},B.prototype.clearAutosavedValue=function(){if(_()){if(null==this.options.autosave||null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to clear the autosave value");localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},B.prototype.createSideBySide=function(){var e=this.codemirror,t=e.getWrapperElement(),n=t.nextSibling;n&&/editor-preview-side/.test(n.className)||((n=document.createElement("div")).className="editor-preview-side",t.parentNode.insertBefore(n,t.nextSibling));var r=!1,i=!1;return e.on("scroll",function(e){if(r)r=!1;else{i=!0;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight,o=parseFloat(e.getScrollInfo().top)/t,a=(n.scrollHeight-n.clientHeight)*o;n.scrollTop=a}}),n.onscroll=function(){if(i)i=!1;else{r=!0;var t=n.scrollHeight-n.clientHeight,o=parseFloat(n.scrollTop)/t,a=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*o;e.scrollTo(0,a)}},n},B.prototype.createToolbar=function(e){if((e=e||this.options.toolbar)&&0!==e.length){var t;for(t=0;t<e.length;t++)null!=K[e[t]]&&(e[t]=K[e[t]]);var n=document.createElement("div");n.className="editor-toolbar";var r=this,a={};for(r.toolbar=e,t=0;t<e.length;t++)if(("guide"!=e[t].name||!1!==r.options.toolbarGuideIcon)&&!(r.options.hideIcons&&-1!=r.options.hideIcons.indexOf(e[t].name)||("fullscreen"==e[t].name||"side-by-side"==e[t].name)&&$())){if("|"===e[t]){for(var s=!1,c=t+1;c<e.length;c++)"|"===e[c]||r.options.hideIcons&&-1!=r.options.hideIcons.indexOf(e[c].name)||(s=!0);if(!s)continue}!function(e){var t;t="|"===e?o():i(e,r.options.toolbarTips,r.options.shortcuts),e.action&&("function"==typeof e.action?t.onclick=function(t){t.preventDefault(),e.action(r)}:"string"==typeof e.action&&(t.href=e.action,t.target="_blank")),a[e.name||e]=t,n.appendChild(t)}(e[t])}r.toolbarElements=a;var u=this.codemirror;u.on("cursorActivity",function(){var e=l(u);for(var t in a)!function(t){var n=a[t]
;e[t]?n.className+=" active":"fullscreen"!=t&&"side-by-side"!=t&&(n.className=n.className.replace(/\s*active\s*/g,""))}(t)});var f=u.getWrapperElement();return f.parentNode.insertBefore(n,f),n}},B.prototype.createStatusbar=function(e){e=e||this.options.status;var t=this.options,n=this.codemirror;if(e&&0!==e.length){var r,i,o,a=[];for(r=0;r<e.length;r++)if(i=void 0,o=void 0,"object"==typeof e[r])a.push({className:e[r].className,defaultValue:e[r].defaultValue,onUpdate:e[r].onUpdate});else{var l=e[r];"words"===l?(o=function(e){e.innerHTML=W(n.getValue())},i=function(e){e.innerHTML=W(n.getValue())}):"lines"===l?(o=function(e){e.innerHTML=n.lineCount()},i=function(e){e.innerHTML=n.lineCount()}):"cursor"===l?(o=function(e){e.innerHTML="0:0"},i=function(e){var t=n.getCursor();e.innerHTML=t.line+":"+t.ch}):"autosave"===l&&(o=function(e){null!=t.autosave&&!0===t.autosave.enabled&&e.setAttribute("id","autosaved")}),a.push({className:l,defaultValue:o,onUpdate:i})}var s=document.createElement("div");for(s.className="editor-statusbar",r=0;r<a.length;r++){var c=a[r],u=document.createElement("span");u.className=c.className,"function"==typeof c.defaultValue&&c.defaultValue(u),"function"==typeof c.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(u,c)),s.appendChild(u)}var f=this.codemirror.getWrapperElement();return f.parentNode.insertBefore(s,f.nextSibling),s}},B.prototype.value=function(e){return void 0===e?this.codemirror.getValue():(this.codemirror.getDoc().setValue(e),this)},B.toggleBold=c,B.toggleItalic=u,B.toggleStrikethrough=f,B.toggleBlockquote=d,B.toggleHeadingSmaller=p,B.toggleHeadingBigger=m,B.toggleHeading1=g,B.toggleHeading2=v,B.toggleHeading3=y,B.toggleCodeBlock=h,B.toggleUnorderedList=x,B.toggleOrderedList=b,B.cleanBlock=w,B.drawLink=k,B.drawImage=S,B.drawTable=C,B.drawHorizontalRule=L,B.undo=T,B.redo=M,B.togglePreview=A,B.toggleSideBySide=N,B.toggleFullScreen=s,B.prototype.toggleBold=function(){c(this)},B.prototype.toggleItalic=function(){u(this)},B.prototype.toggleStrikethrough=function(){f(this)},B.prototype.toggleBlockquote=function(){d(this)},B.prototype.toggleHeadingSmaller=function(){p(this)},B.prototype.toggleHeadingBigger=function(){m(this)},B.prototype.toggleHeading1=function(){g(this)},B.prototype.toggleHeading2=function(){v(this)},B.prototype.toggleHeading3=function(){y(this)},B.prototype.toggleCodeBlock=function(){h(this)},B.prototype.toggleUnorderedList=function(){x(this)},B.prototype.toggleOrderedList=function(){b(this)},B.prototype.cleanBlock=function(){w(this)},B.prototype.drawLink=function(){k(this)},B.prototype.drawImage=function(){S(this)},B.prototype.drawTable=function(){C(this)},B.prototype.drawHorizontalRule=function(){L(this)},B.prototype.undo=function(){T(this)},B.prototype.redo=function(){M(this)},B.prototype.togglePreview=function(){A(this)},B.prototype.toggleSideBySide=function(){N(this)},B.prototype.toggleFullScreen=function(){s(this)},B.prototype.isPreviewActive=function(){var n=this.codemirror.getWrapperElement().lastChild;return/editor-preview-active/.test(n.className)},B.prototype.isSideBySideActive=function(){var n=this.codemirror.getWrapperElement().nextSibling;return/editor-preview-active-side/.test(n.className)},B.prototype.isFullscreenActive=function(){return this.codemirror.getOption("fullScreen")},B.prototype.getState=function(){return l(this.codemirror)},B.prototype.toTextArea=function(){var e=this.codemirror,t=e.getWrapperElement();t.parentNode&&(this.gui.toolbar&&t.parentNode.removeChild(this.gui.toolbar),this.gui.statusbar&&t.parentNode.removeChild(this.gui.statusbar),this.gui.sideBySide&&t.parentNode.removeChild(this.gui.sideBySide)),e.toTextArea(),this.autosaveTimeoutId&&(clearTimeout(this.autosaveTimeoutId),this.autosaveTimeoutId=void 0,this.clearAutosavedValue())},t.exports=B},{"./codemirror/tablist":19,codemirror:10,"codemirror-spell-checker":4,"codemirror/addon/display/fullscreen.js":5,"codemirror/addon/display/placeholder.js":6,"codemirror/addon/edit/continuelist.js":7,"codemirror/addon/mode/overlay.js":8,"codemirror/addon/selection/mark-selection.js":9,"codemirror/mode/gfm/gfm.js":11,"codemirror/mode/markdown/markdown.js":12,"codemirror/mode/xml/xml.js":14,marked:17}]},{},[20])(20)}),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CourseView=function(superClass){function CourseView(){return CourseView.__super__.constructor.apply(this,arguments)}return extend(CourseView,superClass),CourseView.prototype.default_controller=pi.controllers.CourseView,CourseView.prototype.postinitialize=function(){if(CourseView.__super__.postinitialize.apply(this,arguments),this.content.rich_text_viewer.clear=function(){return this.empty()},utils.browser.info().mobile)return this.hide_contents()},CourseView.prototype.loaded=function(){return CourseView.__super__.loaded.apply(this,arguments),this.materials.activate_items(),this.resources.activate_items()},CourseView.prototype.switched=function(){var ref1,ref2;return CourseView.__super__.switched.apply(this,arguments),null!=(ref1=this.viewer)&&ref1.deactivate(),null!=(ref2=this.player)?ref2.deactivate():void 0},CourseView.prototype.reloaded=function(){var ref1,ref2;return CourseView.__super__.reloaded.apply(this,arguments),null!=(ref1=this.viewer)&&ref1.activate(),null!=(ref2=this.player)?ref2.activate():void 0},CourseView.prototype.ensure_selected=function(material,clear){var ref;if(null==clear&&(clear=!1),(ref=this.materials.where({record:{id:material.id,section_id:material.section_id}})).length)return clear&&this.materials.clear_selection(!0),ref[0].host.select_item(ref[0])},CourseView.prototype.hide_contents=function(){return this.addClass("no-contents")},CourseView.prototype.show_contents=function(){return this.removeClass("no-contents")},CourseView.prototype.show_material=function(material1){var name,ref1,ref2,ref3;return this.material=material1,null!=(ref1=this.player)&&ref1.clear(),null!=(ref2=this.viewer)&&ref2.hide(),pi.app.activity_watcher.remove_frame_layer(),"function"==typeof this[name="show_"+this.material.category]&&this[name](),this.ensure_selected(this.material,!0),null!=(ref3=this.viewer)?ref3.show():void 0},CourseView.prototype.set_next=function(mat){return mat?this.content.next_btn.enable():this.content.next_btn.disable()},CourseView.prototype.set_prev=function(mat){return mat?this.content.prev_btn.enable():this.content.prev_btn.disable()},CourseView.prototype.show_document=function(){return this.viewer=this.content.pdf_viewer,this.player=this.viewer.pdf,this.player.load(this.material.view_url,this.material.view_url_cors)},CourseView.prototype.show_audio=function(){return this.player=this.viewer=this.content.audio_player,this.player.load(this.material.view_url,this.material.view_url_cors),this.handle_player_state()},CourseView.prototype.show_image=function(){return this.player=this.viewer=this.content.image_viewer,this.player.load(this.material.view_url)},CourseView.prototype.show_video=function(){return this.material.is_external&&null!=this.content[this.material.external_type+"_player"]?(this.player=this.viewer=this.content[this.material.external_type+"_player"],this.player.load(this.material.external)):"netology"===this.material.external_type?this.show_netology():(this.player=this.viewer=this.content.video_player,this.player.load(this.material.view_url,this.material.poster_url,this.material.view_url_cors)),this.handle_player_state()},CourseView.prototype.show_other=function(){if(pi.app.activity_watcher.use_frame_layer(),"embed"===this.material.external_type)return this.show_iframe()},CourseView.prototype.show_html=function(){return pi.app.activity_watcher.use_frame_layer(),this.show_iframe()},CourseView.prototype.show_iframe=function(){return pi.app.activity_watcher.use_frame_layer(),this.player=this.viewer=this.content.iframe_player,this.player.load(this.material.view_url)},CourseView.prototype.show_netology=function(){return pi.app.activity_watcher.use_frame_layer(),this.player=this.viewer=this.content.net_player,this.player.load(this.material.expiring_url+"&width="+this.content.width()+"&height="+(this.content.height()-50))},CourseView.prototype.show_flash=function(){return pi.app.activity_watcher.use_frame_layer(),this.player=this.viewer=this.content.swf_player,this.player.load(this.material.view_url)},CourseView.prototype.show_rich_text=function(){var mde;return this.player=this.viewer=this.content.rich_text_viewer,this.material.markdown?(mde=new SimpleMDE,this.player.html(mde.options.previewRender(this.material.description))):this.player.html(JST.parse_code(JST.sanitize(this.material.description)))},CourseView.alias("show_archive","show_iframe"),CourseView.alias("show_table","show_document"),CourseView.alias("show_presentation","show_document"),CourseView.prototype.handle_player_state=function(){var watcher;return watcher=pi.app.activity_watcher,this.player.on("state",function(e){switch(utils.info("video state",e.data),!1){case!("playing"===e.data):return watcher.wakeup(),watcher.stop();case!("paused"===e.data||"ended"===e.data||"disposed"===e.date):return watcher.start({once:1e4})}})},CourseView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseTakeView=function(superClass){function CourseTakeView(){return CourseTakeView.__super__.constructor.apply(this,arguments)}return extend(CourseTakeView,superClass),CourseTakeView.prototype.default_controller=pi.controllers.CourseTake,CourseTakeView}(pi.CourseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TransferContentView=function(superClass){function TransferContentView(){return TransferContentView.__super__.constructor.apply(this,arguments)}return extend(TransferContentView,superClass),TransferContentView.prototype.default_controller=pi.controllers.TransferContent,TransferContentView.prototype.transfer=function(list,content,section_id){var from,out_item,to;return this.list=list,from=this.find_list(content.section_id),to=this.find_list(section_id),content.section_id=section_id,out_item=from.items.find(function(i){return i.record.id===content.id}),from.remove_item(out_item),to.add_item(content),[from,to]},TransferContentView.prototype.show_error=function(message){var label;return(label=this.content.allow_force_complete.node.childNodes[0]).childNodes[0]&&label.childNodes[0].remove(),label.append(message),this.content.allow_force_complete.show()},TransferContentView.prototype.find_list=function(section_id){return this.list.items.find(function(elem){return elem.record.id===section_id}).list},TransferContentView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ListenersView=function(superClass){function ListenersView(){return ListenersView.__super__.constructor.apply(this,arguments)}return extend(ListenersView,superClass),ListenersView.prototype.default_controller=pi.controllers.Listeners,ListenersView.include(pi.CourseTypesFilterView),ListenersView.requires("labels_list"),ListenersView.prototype.filtered=function(){return utils.debug("filter data")},ListenersView.alias("filter","filtered"),ListenersView.prototype.ensure_session=function(id){var ref;return null!=(ref=this.session_select)?ref.value(id):void 0},ListenersView.prototype.buttons_loaded=function(id){if(null!=this.transfer_btn&&(null==id||""===id||pi.app.program_session_ids.includes(parseInt(id))?this.transfer_btn.hide():this.transfer_btn.show()),null!=this.add_listeners_btn)return pi.app.program_session_ids.includes(parseInt(id))?this.add_listeners_btn.hide():this.add_listeners_btn.show()},ListenersView.prototype.reload=function(){return this.buttons_loaded(this.controller.session_id),ListenersView.__super__.reload.apply(this,arguments)},ListenersView.prototype.labels_loaded=function(labels){return null!=labels?this.labels_list.data_provider(labels):this.labels_list.clear()},ListenersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ListenersTotalsView=function(superClass){function ListenersTotalsView(){return ListenersTotalsView.__super__.constructor.apply(this,arguments)}return extend(ListenersTotalsView,superClass),ListenersTotalsView.prototype.default_controller=pi.controllers.ListenersTotals,ListenersTotalsView.include(pi.CourseTypesFilterView),ListenersTotalsView.prototype.filtered=function(){return utils.debug("filter data")},ListenersTotalsView.alias("filter","filtered"),ListenersTotalsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.PaymentHistoryView=function(superClass){function PaymentHistoryView(){return PaymentHistoryView.__super__.constructor.apply(this,arguments)}return extend(PaymentHistoryView,superClass),PaymentHistoryView.prototype.default_controller=pi.controllers.PaymentHistory,PaymentHistoryView.prototype.filtered=function(){return utils.debug("filter data")},PaymentHistoryView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.LabelsEditView=function(superClass){function LabelsEditView(){return LabelsEditView.__super__.constructor.apply(this,arguments)}return extend(LabelsEditView,superClass),LabelsEditView.prototype.default_controller=pi.controllers.LabelsEdit,LabelsEditView.include(pi.BaseView.Loadable),LabelsEditView.prototype.loaded=function(params){return null==params&&(params={}),this.removeClass("is-readonly","is-selecting","is-updating"),this.mode=params.mode||"select","update"===this.mode?(this.list.selectable.disable(),this.addClass("is-readonly","is-updating")):"select"===this.mode?(this.list.selectable.disable(),this.addClass("is-readonly","is-selecting")):this.list.selectable.enable(),LabelsEditView.__super__.loaded.apply(this,arguments)},LabelsEditView.prototype.label_updated=function(){return this.list.finish_edit()},LabelsEditView.prototype.unloaded=function(){var i,item,len,ref;for(LabelsEditView.__super__.unloaded.apply(this,arguments),i=0,len=(ref=this.list.items).length;i<len;i++)(item=ref[i]).deactivate(),item.list.add_item_btn.deactivate();return this.list.finish_edit(),this.list.add_item_btn.deactivate(),this.list.clear_selection()},LabelsEditView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.LabelsFilterView=function(superClass){function LabelsFilterView(){return LabelsFilterView.__super__.constructor.apply(this,arguments)}return extend(LabelsFilterView,superClass),LabelsFilterView.include(pi.BaseView.Loadable),LabelsFilterView.prototype.default_controller=pi.controllers.LabelFilter,LabelsFilterView.prototype.loaded=function(params){return null!=params&&(params.clear&&this.list.clear_selection(),params.checked_subgroups&&(this.checked_subgroups=params.checked_subgroups)),LabelsFilterView.__super__.loaded.apply(this,arguments)},LabelsFilterView.prototype.load_labels=function(data){return pi.BaseView.Listable.prototype.load.call(this,data)},LabelsFilterView.prototype.hide_loading=function(){return this.list.removeClass("is-loading"),this.list.removeClass("is-empty")},LabelsFilterView.prototype.show_empty_labels=function(){return this.list.removeClass("is-loading"),this.list.addClass("is-empty")},LabelsFilterView.prototype.select_labels=function(){var item,j,len,ref,results;for(results=[],j=0,len=(ref=this.list.items).length;j<len;j++)item=ref[j],results.push(function(_this){return function(item){return item.list.items.filter(function(i){return _this.checked_subgroups.includes(i.record.id)}).forEach(function(i){return item.list.select_item(i)})}}(this)(item));return results},LabelsFilterView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UserEditView=function(superClass){function UserEditView(){return UserEditView.__super__.constructor.apply(this,arguments)}return extend(UserEditView,superClass),UserEditView.include(pi.BaseView.Loadable),UserEditView.requires("form"),UserEditView.prototype.default_controller=pi.controllers.UserEdit,UserEditView.prototype.loaded=function(user){return this.form.value(user),user.email?this.form.email.disable():this.form.email.enable(),UserEditView.__super__.loaded.apply(this,arguments)},UserEditView.prototype.unloaded=function(){return this.form.clear(),UserEditView.__super__.unloaded.apply(this,arguments)},UserEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.UsersImportView=function(superClass){function UsersImportView(){return UsersImportView.__super__.constructor.apply(this,arguments)}return extend(UsersImportView,superClass),UsersImportView.prototype.default_controller=pi.controllers.UsersImport,UsersImportView.requires("form"),UsersImportView.prototype.loading=function(val){return val?this.addClass("is-loading"):this.removeClass("is-loading")},UsersImportView.prototype.postinitialize=function(){if(UsersImportView.__super__.postinitialize.apply(this,arguments),!0===utils.browser.os().macos)return this.addClass("is-macos")},UsersImportView.prototype.loaded=function(){return this.removeClass("is-loading"),LocalFileReader.isSupported||this.addClass("not-supported"),UsersImportView.__super__.loaded.apply(this,arguments)},UsersImportView.prototype.unloaded=function(){return this.form.clear(),UsersImportView.__super__.unloaded.apply(this,arguments)},UsersImportView.prototype.error=function(){if(this.options.error_message)return UsersImportView.__super__.error.call(this,this.options.error_message)},UsersImportView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.UsersView=function(superClass){function UsersView(){return UsersView.__super__.constructor.apply(this,arguments)}return extend(UsersView,superClass),UsersView.prototype.default_controller=pi.controllers.Users,UsersView.prototype.loaded=function(){var ref,ref1;return UsersView.__super__.loaded.apply(this,arguments),null!=pi.app.view.labels&&(pi.app.view.labels.list.removeClass("is-empty"),pi.app.view.labels.list.removeClass("is-loading")),hash.get().administration?null!=(ref=this.all_users)?ref.removeClass("is-hidden"):void 0:null!=(ref1=this.administration)?ref1.removeClass("is-hidden"):void 0},UsersView.prototype.filtered=function(){return utils.debug("filter data")},UsersView.prototype.show_actions=function(data){var mentor_btn,user;return this.action_group.show(data),user=this.list.selected_record(),mentor_btn=this.action_group.children()[0],3===user.role_id&&1===this.list.selected_size()?pi.Nod.create(mentor_btn).show():pi.Nod.create(mentor_btn).hide()},UsersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UsersInviteView=function(superClass){function UsersInviteView(){return UsersInviteView.__super__.constructor.apply(this,arguments)}return extend(UsersInviteView,superClass),UsersInviteView.include(pi.BaseView.Loadable,pi.BaseView.Listable),UsersInviteView.prototype.default_controller=pi.controllers.UsersInvite,UsersInviteView.prototype.bind_resource=function(resource){this.list.restful.bind(resource,!0)},UsersInviteView.prototype.unloaded=function(){return this.list.restful.bind(null),this.list.clear(),UsersInviteView.__super__.unloaded.apply(this,arguments)},UsersInviteView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MentoredUsersView=function(superClass){function MentoredUsersView(){return MentoredUsersView.__super__.constructor.apply(this,arguments)}return extend(MentoredUsersView,superClass),MentoredUsersView.prototype.default_controller=pi.controllers.MentoredUsers,MentoredUsersView.prototype.filtered=function(){return utils.debug("filter data")},MentoredUsersView.prototype.load_labels=function(data){return this.labels=pi.app.view.labels,pi.BaseView.Listable.prototype.load.call(this.labels,data)},MentoredUsersView.prototype.hide_loading=function(){return pi.app.view.labels.list.removeClass("is-loading"),pi.app.view.labels.list.removeClass("is-empty")},MentoredUsersView.prototype.show_empty_labels=function(){return pi.app.view.labels.list.removeClass("is-loading"),pi.app.view.labels.list.addClass("is-empty")},MentoredUsersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SelectUsersView=function(superClass){function SelectUsersView(){return SelectUsersView.__super__.constructor.apply(this,arguments)}return extend(SelectUsersView,superClass),SelectUsersView.include(pi.BaseView.Loadable,pi.BaseView.Listable),SelectUsersView.prototype.default_controller=pi.controllers.SelectUsers,SelectUsersView.prototype.loaded=function(data){var users;return SelectUsersView.__super__.loaded.apply(this,arguments),(null!=(users=data.users)?users.length:void 0)>0&&(this._ids=users.map(function(user){return user.id}),this.disable_selected()),this.list.scroll_end.enable()},SelectUsersView.prototype.unloaded=function(){var i,len,ref;for(SelectUsersView.__super__.unloaded.apply(this,arguments),this._ids=null,this.list.clear_selection(),i=0,len=(ref=this.list.items).length;i<len;i++)ref[i].enable();return this.list.scroll_end.disable()},SelectUsersView.prototype.load=function(data){return pi.BaseView.Listable.prototype.load.call(this,data),this.disable_selected()},SelectUsersView.prototype.load_labels=function(data){return pi.BaseView.Listable.prototype.load.call(this.labels,data),this.disable_selected()},SelectUsersView.prototype.reload=function(data){return pi.BaseView.Listable.prototype.reload.call(this,data),this.disable_selected()},SelectUsersView.prototype.hide_loading=function(){return this.labels.list.removeClass("is-loading"),this.labels.list.removeClass("is-empty")},SelectUsersView.prototype.show_empty_labels=function(){return this.labels.list.removeClass("is-loading"),this.labels.list.addClass("is-empty")},SelectUsersView.prototype.disable_selected=function(){var i,item,len,ref,ref1,results;if(null!=this._ids){for(results=[],i=0,len=(ref=this.list.items).length;i<len;i++)ref1=(item=ref[i]).record.id,indexOf.call(this._ids,ref1)>=0&&results.push(item.disable());return results}},SelectUsersView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UserTransferOwnershipView=function(superClass){function UserTransferOwnershipView(){return UserTransferOwnershipView.__super__.constructor.apply(this,arguments)}return extend(UserTransferOwnershipView,superClass),UserTransferOwnershipView.include(pi.BaseView.Loadable),UserTransferOwnershipView.requires("form"),UserTransferOwnershipView.prototype.default_controller=pi.controllers.UserTransferOwnership,UserTransferOwnershipView.prototype.loaded=function(from){return this.from=from,UserTransferOwnershipView.__super__.loaded.apply(this,arguments),this.form.value({source:this.from})},UserTransferOwnershipView.prototype.load_target_user=function(target){return this.target=target,this.form.value({target:this.target})},UserTransferOwnershipView.prototype.unloaded=function(){return UserTransferOwnershipView.__super__.unloaded.apply(this,arguments),this.form.clear()},UserTransferOwnershipView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.UsersMessageView=function(superClass){function UsersMessageView(){return UsersMessageView.__super__.constructor.apply(this,arguments)}return extend(UsersMessageView,superClass),UsersMessageView.include(pi.BaseView.Loadable),UsersMessageView.requires("form"),UsersMessageView.prototype.default_controller=pi.controllers.UsersMessage,UsersMessageView.prototype.loaded=function(to){var n;return this.to=to,UsersMessageView.__super__.loaded.apply(this,arguments),"User"===this.to[0].constructor.name?this.to=this.to.map(function(u){return u.id}):(n={},this.course_session_ids=this.to.map(function(cs){if(!n[cs.course_session_id])return n[cs.course_session_id]=!0,cs.course_session_id}),this.to=this.to.map(function(cs){return cs.user_id}))},UsersMessageView.prototype.unloaded=function(){return this.form.clear()},UsersMessageView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.RecordingsView=function(superClass){function RecordingsView(){return RecordingsView.__super__.constructor.apply(this,arguments)}return extend(RecordingsView,superClass),RecordingsView.prototype.default_controller=pi.controllers.Recordings,RecordingsView.prototype.filtered=function(){return utils.debug("filter data")},RecordingsView.alias("filter","filtered"),RecordingsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ShareRecordingView=function(superClass){function ShareRecordingView(){return ShareRecordingView.__super__.constructor.apply(this,arguments)}return extend(ShareRecordingView,superClass),ShareRecordingView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ShareRecordingView.requires("form"),ShareRecordingView.prototype.default_controller=pi.controllers.ShareRecording,ShareRecordingView.prototype.loaded=function(data){if(ShareRecordingView.__super__.loaded.apply(this,arguments),null!=data)return this.load_participants(data)},ShareRecordingView.prototype.load_participants=function(data){return this.list.restful.bind(data.participants(),!0)},ShareRecordingView.prototype.unloaded=function(){return ShareRecordingView.__super__.unloaded.apply(this,arguments),this.list.clear(),this.total_entries(0),this.list.restful.bind(null)},ShareRecordingView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.RecordingShowView=function(superClass){function RecordingShowView(){return RecordingShowView.__super__.constructor.apply(this,arguments)}return extend(RecordingShowView,superClass),RecordingShowView.prototype.default_controller=pi.controllers.RecordingShow,RecordingShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DevicesDocumentShowView=function(superClass){function DevicesDocumentShowView(){return DevicesDocumentShowView.__super__.constructor.apply(this,arguments)}return extend(DevicesDocumentShowView,superClass),DevicesDocumentShowView.prototype.default_controller=pi.controllers.TBController,DevicesDocumentShowView.prototype.postinitialize=function(){if(DevicesDocumentShowView.__super__.postinitialize.apply(this,arguments),this.doc=pi.app.document,"vimeo"===this.doc.external_type)return this.vimeo_player.load(this.doc.external)},DevicesDocumentShowView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,
child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DocumentEditView=function(superClass){function DocumentEditView(){return DocumentEditView.__super__.constructor.apply(this,arguments)}return extend(DocumentEditView,superClass),DocumentEditView.prototype.default_controller=pi.controllers.DocumentEdit,DocumentEditView.prototype.loaded=function(doc){if(DocumentEditView.__super__.loaded.apply(this,arguments),null!=doc)return this.form.value(doc),doc.new_folder?(this.find(".title-edit").hide(),this.find(".title-new-folder").show()):(this.find(".title-new-folder").hide(),this.find(".title-edit").show())},DocumentEditView.prototype.unloaded=function(){return DocumentEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},DocumentEditView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.DocumentsView=function(superClass){function DocumentsView(){return DocumentsView.__super__.constructor.apply(this,arguments)}return extend(DocumentsView,superClass),DocumentsView.prototype.default_controller=pi.controllers.Documents,DocumentsView.prototype.filtered=function(){return utils.debug("filter data")},DocumentsView.alias("filter","filtered"),DocumentsView.prototype.reset_search=function(){return this.search_txt.value(""),this.search_txt.deactivate(),this._query="",this.searched("")},DocumentsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MoveDocumentView=function(superClass){function MoveDocumentView(){return MoveDocumentView.__super__.constructor.apply(this,arguments)}return extend(MoveDocumentView,superClass),MoveDocumentView.include(pi.BaseView.Listable),MoveDocumentView.include(pi.BaseView.Loadable),MoveDocumentView.prototype.default_controller=pi.controllers.MoveDocument,MoveDocumentView.prototype.reload=function(data){var i,item,len;if(this.list.items.length&&this.list.clear(!1,!0),null!=data)for(i=0,len=data.length;i<len;i++)(item=data[i]).is_folder&&this.list.add_item(item,!0);return this.list.update("load",!1)},MoveDocumentView.prototype.unloaded=function(){return MoveDocumentView.__super__.unloaded.apply(this,arguments),this.list.clear_selection()},MoveDocumentView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ShareDocumentView=function(superClass){function ShareDocumentView(){return ShareDocumentView.__super__.constructor.apply(this,arguments)}return extend(ShareDocumentView,superClass),ShareDocumentView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ShareDocumentView.requires("form"),ShareDocumentView.prototype.default_controller=pi.controllers.ShareDocument,ShareDocumentView.prototype.loaded=function(data){if(ShareDocumentView.__super__.loaded.apply(this,arguments),null!=data)return this.load_participants(data),this.set_labels_selection(data)},ShareDocumentView.prototype.load_participants=function(folder){return this.list.restful.bind(folder.participants(),!0)},ShareDocumentView.prototype.set_labels_selection=function(folder){var group_id,i,item,len,list,ref,share,values;for(list=this.form.labels.list,values={},i=0,len=(ref=folder.loaded_shares).length;i<len;i++)share=ref[i],null!=(item=list.find("[data-item-id='"+share.target_id+"']"))&&(values[item.pid]=!0,0===item.pid.indexOf("label")&&(group_id=$r.Label.get(share.target_id).group_id,list.find("[data-item-id='"+group_id+"']").activate()));return this.form.value(values)},ShareDocumentView.prototype.unloaded=function(){return ShareDocumentView.__super__.unloaded.apply(this,arguments),this.list.clear(),this.form.clear(),this.total_entries(0),this.list.restful.bind(null)},ShareDocumentView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var app,pi;(pi=context.pi).utils,app=pi.app,pi.DocumentShowView=function(superClass){function DocumentShowView(){return DocumentShowView.__super__.constructor.apply(this,arguments)}return extend(DocumentShowView,superClass),DocumentShowView.prototype.default_controller=pi.controllers.DocumentShow,DocumentShowView.prototype.loaded=function(doc){return this.doc=doc,this.doc instanceof $r.Question||!this.doc.download_url?this.bottom_info.addClass("no-download"):this.bottom_info.removeClass("no-download"),null!=this["show_"+this.doc.category]?this["show_"+this.doc.category]():this.show_info()},DocumentShowView.prototype.show_document=function(){var _this;return this.viewer=this.document_viewer.pdf,app.view.popup.open(this.document_viewer,{close:(_this=this,function(){return _this.handle_close()})}),this.show_bottom_info(),this.viewer.load(this.doc.view_url,this.doc.view_url_cors)},DocumentShowView.prototype.show_audio=function(){var _this;return this.viewer=this.audio_player,app.view.popup.open(this.viewer,{close:(_this=this,function(){return _this.handle_close()})}),this.show_bottom_info(),this.viewer.load(this.doc.view_url,this.doc.view_url_cors)},DocumentShowView.prototype.show_image=function(){var _this;return this.viewer=this.image_viewer,app.view.popup.open(this.viewer,{close:(_this=this,function(){return _this.handle_close()})}),this.show_bottom_info(),this.viewer.load(this.doc.view_url)},DocumentShowView.prototype.show_video=function(){var _this;return"youtube"===this.doc.external_type?(this.viewer=this.youtube_player,this.viewer.load(this.doc.external)):"vimeo"===this.doc.external_type?(this.viewer=this.vimeo_player,this.viewer.load(this.doc.external)):"netology"===this.doc.external_type?(this.viewer=this.net_player,this.viewer.load(this.doc.expiring_url+"&width=640&height=480")):(this.viewer=this.video_player,this.viewer.load(this.doc.view_url,this.doc.poster_url,this.doc.view_url_cors)),app.view.popup.open(this.viewer,{close:(_this=this,function(){return _this.handle_close()})}),this.show_bottom_info()},DocumentShowView.prototype.show_bottom_info=function(){if(this.doc.name)return this.bottom_info.visible?void 0:(this.bottom_info.render(this.doc),this.bottom_info.show(),app.view.popup.append(this.bottom_info))},DocumentShowView.prototype.hide_bottom_info=function(){if(this.bottom_info.visible)return this.bottom_info.render(null),this.bottom_info.hide(),this.bottom_info.detach()},DocumentShowView.prototype.show_info=function(){var _this;return this.viewer=this.info_viewer,app.view.popup.open(this.info_viewer,{close:(_this=this,function(){return _this.handle_close()})}),this.viewer.render(this.doc)},DocumentShowView.prototype.unloaded=function(){var ref;return this.viewer===this.info_viewer?this.viewer.render(null):null!=(ref=this.viewer)&&ref.clear(),this.hide_bottom_info(),DocumentShowView.__super__.unloaded.apply(this,arguments)},DocumentShowView.alias("show_table","show_document"),DocumentShowView.alias("show_presentation","show_document"),DocumentShowView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DocumentsUploadView=function(superClass){function DocumentsUploadView(){return DocumentsUploadView.__super__.constructor.apply(this,arguments)}return extend(DocumentsUploadView,superClass),DocumentsUploadView.prototype.default_controller=pi.controllers.DocumentsUpload,DocumentsUploadView.prototype.postinitialize=function(){return DocumentsUploadView.__super__.postinitialize.apply(this,arguments),this.addClass("is-multiple")},DocumentsUploadView}(pi.UploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AccountEditView=function(superClass){function AccountEditView(){return AccountEditView.__super__.constructor.apply(this,arguments)}return extend(AccountEditView,superClass),AccountEditView.include(pi.BaseView.Loadable,pi.BaseView.Coverable),AccountEditView.prototype.default_controller=pi.controllers.AccountEdit,AccountEditView.requires("form"),AccountEditView.prototype.loaded=function(account){var ref;if(AccountEditView.__super__.loaded.apply(this,arguments),null!=account)return this.form.value(account),null!=(null!=(ref=account.menu)?ref.links:void 0)&&this.form.links_list.data_provider(account.menu.links),this.form.logo.load(account.logo_large_url)},AccountEditView.prototype.logo_loaded=function(file_obj){return this.cover_loaded(this.form.logo,file_obj)},AccountEditView.prototype.show_result_connection=function(val){return this.form.ldap_settings.ldap_form.result_connection.value(val)},AccountEditView.prototype.delete_logo=function(){return this.delete_cover(this.form.logo)},AccountEditView.prototype.clear_yakassa_fields=function(){return["yandex_shop_id","yandex_scid","ya_password","yandex_api_key","ya_password_old","ya_password_confirmation","cb"].map((_this=this,function(field){return _this.form[field].clear()}));var _this},AccountEditView.prototype.unloaded=function(){return AccountEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.logo.deactivate()},AccountEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AccountShowView=function(superClass){function AccountShowView(){return AccountShowView.__super__.constructor.apply(this,arguments)}return extend(AccountShowView,superClass),AccountShowView.prototype.default_controller=pi.controllers.AccountShow,AccountShowView.prototype.loaded=function(data){return this.render(data)},AccountShowView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProfileConfirmPhoneView=function(superClass){function ProfileConfirmPhoneView(){return ProfileConfirmPhoneView.__super__.constructor.apply(this,arguments)}return extend(ProfileConfirmPhoneView,superClass),ProfileConfirmPhoneView.prototype.default_controller=pi.controllers.ProfileConfirmPhone,ProfileConfirmPhoneView.prototype.unloading=function(){return this.removeClass("is-loading")},ProfileConfirmPhoneView.prototype.loading=function(){return this.addClass("is-loading")},ProfileConfirmPhoneView.prototype.unloaded=function(){return this.form.clear,this.loading(),ProfileConfirmPhoneView.__super__.unloaded.apply(this,arguments)},ProfileConfirmPhoneView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProfileCredentialEditView=function(superClass){function ProfileCredentialEditView(){return ProfileCredentialEditView.__super__.constructor.apply(this,arguments)}return extend(ProfileCredentialEditView,superClass),ProfileCredentialEditView.include(pi.BaseView.Loadable),ProfileCredentialEditView.requires("form"),ProfileCredentialEditView.prototype.default_controller=pi.controllers.ProfileCredentialEdit,ProfileCredentialEditView.prototype.loaded=function(app){if(this.app=app,ProfileCredentialEditView.__super__.loaded.apply(this,arguments),null!=this.app)return this.form.value(this.meeting)},ProfileCredentialEditView.prototype.unloaded=function(){return ProfileCredentialEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.app=null},ProfileCredentialEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProfileCredentialsView=function(superClass){function ProfileCredentialsView(){return ProfileCredentialsView.__super__.constructor.apply(this,arguments)}return extend(ProfileCredentialsView,superClass),ProfileCredentialsView.prototype.default_controller=pi.controllers.ProfileCredentials,ProfileCredentialsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProfileEditView=function(superClass){function ProfileEditView(){return ProfileEditView.__super__.constructor.apply(this,arguments)}return extend(ProfileEditView,superClass),ProfileEditView.include(pi.BaseView.Coverable),ProfileEditView.prototype.default_controller=pi.controllers.ProfileEdit,ProfileEditView.requires("form"),ProfileEditView.prototype.loaded=function(user){if(ProfileEditView.__super__.loaded.apply(this,arguments),null!=user)return this.form.value(user),this.form.avatar.load(user.avatar_large_url),user.email?this.form.email.disable():this.form.email.enable()},ProfileEditView.prototype.avatar_loaded=function(file_obj){return this.cover_loaded(this.form.avatar,file_obj)},ProfileEditView.prototype.delete_avatar=function(){return this.delete_cover(this.form.avatar)},ProfileEditView.prototype.unloaded=function(){return ProfileEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.avatar.deactivate()},ProfileEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProfileView=function(superClass){function ProfileView(){return ProfileView.__super__.constructor.apply(this,arguments)}return extend(ProfileView,superClass),ProfileView.prototype.default_controller=pi.controllers.Profile,ProfileView.prototype.loaded=function(data){return this.render(data)},ProfileView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialDropboxView=function(superClass){function MaterialDropboxView(){return MaterialDropboxView.__super__.constructor.apply(this,arguments)}return extend(MaterialDropboxView,superClass),MaterialDropboxView.prototype.default_controller=pi.controllers.MaterialDropbox,MaterialDropboxView.prototype.load=function(data){if(null!=data)return this.list.add_item(data,!0),this.list.update(),this.activate()},MaterialDropboxView.prototype.loaded=function(){return this.show()},MaterialDropboxView.prototype.activate=function(){return pi.BaseView.prototype.activate.call(this)},MaterialDropboxView.prototype.deactivate=function(){return pi.BaseView.prototype.deactivate.call(this)},MaterialDropboxView.prototype.unloaded=function(){return this.hide(),this.deactivate(),this.list.clear()},MaterialDropboxView}(pi.UploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialEmbedAttachView=function(superClass){function MaterialEmbedAttachView(){return MaterialEmbedAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialEmbedAttachView,superClass),MaterialEmbedAttachView.prototype.default_controller=pi.controllers.MaterialEmbedAttach,MaterialEmbedAttachView.prototype.error=function(flag){return null==flag&&(flag=!0),flag?this.addClass("is-error"):this.removeClass("is-error")},MaterialEmbedAttachView.prototype.loaded=function(){return this.show()},MaterialEmbedAttachView.prototype.unloaded=function(){return this.form.clear(),this.error(!1),this.hide()},MaterialEmbedAttachView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialGoogleImageView=function(superClass){function MaterialGoogleImageView(){return MaterialGoogleImageView.__super__.constructor.apply(this,arguments)}return extend(MaterialGoogleImageView,superClass),MaterialGoogleImageView.include(pi.BaseView.Loadable),MaterialGoogleImageView.prototype.default_controller=pi.controllers.MaterialGoogleImage,MaterialGoogleImageView.prototype.loaded=function(){return this.show(),this.list.scroll_end.enable()},MaterialGoogleImageView.prototype.unloaded=function(){return this.form.clear(),this.list.scroll_end.disable(),this.list.clear(),this.hide()},MaterialGoogleImageView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialHtmlAttachView=function(superClass){function MaterialHtmlAttachView(){return MaterialHtmlAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialHtmlAttachView,superClass),MaterialHtmlAttachView.prototype.default_controller=pi.controllers.MaterialHtmlAttach,MaterialHtmlAttachView.prototype.error=function(flag){return null==flag&&(flag=!0),flag?this.addClass("is-error"):this.removeClass("is-error")},MaterialHtmlAttachView.prototype.loaded=function(){return this.show()},MaterialHtmlAttachView.prototype.unloaded=function(){return this.form.clear(),this.error(!1),this.hide()},MaterialHtmlAttachView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialDocumentAttachView=function(superClass){function MaterialDocumentAttachView(){return MaterialDocumentAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialDocumentAttachView,superClass),MaterialDocumentAttachView.include(pi.BaseView.Loadable),MaterialDocumentAttachView.prototype.default_controller=pi.controllers.MaterialDocumentAttach,MaterialDocumentAttachView.prototype.loaded=function(){return this.show(),this.list.enable()},MaterialDocumentAttachView.prototype.selected=function(item){if(item.is_folder)return this.list.clear_selection(!0,!0)},MaterialDocumentAttachView.prototype.unloaded=function(){return this.list.disable(),this.hide()},MaterialDocumentAttachView.prototype.reset_search=function(){return this.search_txt.value(""),this.search_txt.deactivate(),this._query="",this.searched("")},MaterialDocumentAttachView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialUploadView=function(superClass){function MaterialUploadView(){return MaterialUploadView.__super__.constructor.apply(this,arguments)}return extend(MaterialUploadView,superClass),MaterialUploadView.prototype.default_controller=pi.controllers.MaterialUpload,MaterialUploadView.prototype.loaded=function(){return this.show()},MaterialUploadView.prototype.activate=function(){return pi.BaseView.prototype.activate.call(this)},MaterialUploadView.prototype.deactivate=function(){return pi.BaseView.prototype.deactivate.call(this)},MaterialUploadView.prototype.unloaded=function(){return this.hide(),this.deactivate(),this.list.restful.resources=null,this.list.clear(),this.form.clear()},MaterialUploadView}(pi.UploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialVimeoAttachView=function(superClass){function MaterialVimeoAttachView(){return MaterialVimeoAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialVimeoAttachView,superClass),MaterialVimeoAttachView.prototype.default_controller=pi.controllers.MaterialVimeoAttach,MaterialVimeoAttachView.prototype.error=function(flag){return null==flag&&(flag=!0),flag?this.addClass("is-error"):this.removeClass("is-error")},MaterialVimeoAttachView.prototype.loaded=function(){return this.show()},MaterialVimeoAttachView.prototype.unloaded=function(){return this.form.clear(),this.error(!1),this.hide()},MaterialVimeoAttachView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialYoutubeAttachView=function(superClass){function MaterialYoutubeAttachView(){return MaterialYoutubeAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialYoutubeAttachView,superClass),MaterialYoutubeAttachView.include(pi.BaseView.Loadable),MaterialYoutubeAttachView.prototype.default_controller=pi.controllers.MaterialYoutubeAttach,MaterialYoutubeAttachView.prototype.load=function(data){var i,item,len,ref;if(null!=(null!=data?data.items:void 0)){for(i=0,len=(ref=data.items).length;i<len;i++)item=ref[i],this.list.add_item(item,!0);this.list.update()}if(1===this.list.items.length)return this.list.select_item(this.list.items[0])},MaterialYoutubeAttachView.prototype.loaded=function(){return this.show()},MaterialYoutubeAttachView.prototype.unloaded=function(){return this.form.clear(),this.list.clear(),this.hide()},MaterialYoutubeAttachView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialAttachView=function(superClass){function MaterialAttachView(){return MaterialAttachView.__super__.constructor.apply(this,arguments)}return extend(MaterialAttachView,superClass),MaterialAttachView.prototype.default_controller=pi.controllers.MaterialAttach,MaterialAttachView}(pi.CoverUploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MaterialsView=function(superClass){function MaterialsView(){return MaterialsView.__super__.constructor.apply(this,arguments)}return extend(MaterialsView,superClass),MaterialsView.prototype.default_controller=pi.controllers.Materials,MaterialsView.prototype.loaded=function(){return 0===this.list.size()&&this.list.add_item_btn.activate(),MaterialsView.__super__.loaded.apply(this,arguments)},MaterialsView.prototype.hide_add_links=function(host){return host.host.add_content_btn.show(),host.host.add_btn.hide(),host.host.add_scorm_btn.hide(),host.host.add_quiz_btn.hide(),host.host.add_task_btn.hide()},MaterialsView.prototype.show_add_links=function(host){return host.host.add_content_btn.hide(),host.host.add_btn.show(),host.host.add_scorm_btn.show(),host.host.add_quiz_btn.show(),host.host.add_task_btn.show()},MaterialsView.prototype.filtered=function(){return utils.debug("filter data")},MaterialsView.prototype.clear=function(){return this.form.clear(),MaterialsView.__super__.clear.apply(this,arguments)},MaterialsView.prototype.recount_content_positions_after_move=function(item){var content_list,new_item;if(content_list=this.find_list(item.section_id))return this.recount_content_positions_in_list(content_list),new_item=content_list.items.find(function(elem){return elem.record.id===item.id}),content_list.select_item(new_item)},MaterialsView.prototype.recount_content_positions_in_list=function(list){var content_with_new_postions;if(list)return content_with_new_postions=list.records().map(function(section_content){return section_content.recount_content_positions()}),list.clear(!0),content_with_new_postions.forEach(function(content){return list.add_item(content)})},MaterialsView.prototype.find_list=function(section_id){var item;if(item=this.list.items.find(function(elem){return elem.record.id===section_id}))return item.list},MaterialsView.prototype.edit_element=function(item){return item.info.hide(),item.form.show()},MaterialsView.prototype.ensure_form_hidden=function(){return this.list.edit_item(null)},MaterialsView.prototype.upload_material=function(file,form){return form.deactivate()},MaterialsView.prototype.toggle_action_group=function(data){return data[0].record instanceof $r.SectionContent&&this.list.items.length>1?this.action_group.transfer_content_btn.show():this.action_group.transfer_content_btn.hide(),data[0].record instanceof $r.SectionContent&&data[0].record.entity().is_editor_js?this.action_group.edit_btn.hide():this.action_group.edit_btn.show(),pi.app.course.copyright_protected&&data[0].record instanceof $r.ScormPackage?this.action_group.hide():this.action_group.show(data)},MaterialsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MaterialShow=function(superClass){function MaterialShow(){return MaterialShow.__super__.constructor.apply(this,arguments)}return extend(MaterialShow,superClass),MaterialShow.prototype.default_controller=pi.controllers.MaterialShow,MaterialShow.prototype.show_material=function(material){var ref,ref1,ref2;if(this.material=material,null!=(ref=this.player)&&ref.clear(),null!=(ref1=this.viewer)&&ref1.hide(),pi.app.activity_watcher.remove_frame_layer(),this.material.is_external&&null!=this.content.vimeo_player)return this.player=this.viewer=this.content.vimeo_player,this.player.load(this.material.external),this.handle_player_state(),null!=(ref2=this.viewer)?ref2.show():void 0},MaterialShow.prototype.handle_player_state=function(){var watcher;return watcher=pi.app.activity_watcher,this.player.on("state",function(e){switch(utils.info("video state",e.data),!1){case!("playing"===e.data):return watcher.wakeup(),watcher.stop();case!("paused"===e.data||"ended"===e.data||"disposed"===e.date):return watcher.start({once:1e4})}})},MaterialShow}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ResourcesUploadView=function(superClass){function ResourcesUploadView(){return ResourcesUploadView.__super__.constructor.apply(this,arguments)}return extend(ResourcesUploadView,superClass),ResourcesUploadView.prototype.default_controller=pi.controllers.ResourcesUpload,ResourcesUploadView}(pi.UploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ChooseTaskStatScoreView=function(superClass){function ChooseTaskStatScoreView(){return ChooseTaskStatScoreView.__super__.constructor.apply(this,arguments)}return extend(ChooseTaskStatScoreView,superClass),ChooseTaskStatScoreView.prototype.default_controller=pi.controllers.ChooseTaskStatScore,ChooseTaskStatScoreView.prototype.trigger=function(){return null!=this.slider&&this.slider.value(this.slider.input.value()),ChooseTaskStatScoreView.__super__.trigger.apply(this,arguments)},ChooseTaskStatScoreView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TaskEditView=function(superClass){function TaskEditView(){return TaskEditView.__super__.constructor.apply(this,arguments)}return extend(TaskEditView,superClass),TaskEditView.include(pi.BaseView.Loadable,pi.TaskAttachmentForm),TaskEditView.requires("form"),TaskEditView.prototype.default_controller=pi.controllers.TaskEdit,TaskEditView.prototype.loaded=function(task){if(TaskEditView.__super__.loaded.apply(this,arguments),null!=task)return this.form.value(task)},TaskEditView.prototype.enable_preview=function(){
return this.form.preview_btn.enable()},TaskEditView.prototype.disable_preview=function(){return this.form.preview_btn.disable()},TaskEditView.prototype.unloaded=function(){return TaskEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.list.clear()},TaskEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ResultsView=function(superClass){function ResultsView(){return ResultsView.__super__.constructor.apply(this,arguments)}return extend(ResultsView,superClass),ResultsView.prototype.default_controller=pi.controllers.Results,ResultsView.requires("labels_list"),ResultsView.prototype.ensure_session=function(id){var ref;return null!=(ref=this.session_select)?ref.value(id):void 0},ResultsView.prototype.labels_loaded=function(labels){return null!=labels?this.labels_list.data_provider(labels):this.labels_list.clear()},ResultsView.prototype.toggle_action_group=function(data){return 0===data.length||data.some(function(el){return"QuizStat"!==el.type})?this.action_group.hide():this.action_group.show(data)},ResultsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.TaskShowView=function(superClass){function TaskShowView(){return TaskShowView.__super__.constructor.apply(this,arguments)}return extend(TaskShowView,superClass),TaskShowView.include(pi.TaskAttachmentForm),TaskShowView.prototype.default_controller=pi.controllers.TaskShow,TaskShowView.prototype.postinitialize=function(){return TaskShowView.__super__.postinitialize.apply(this,arguments)},TaskShowView.prototype.filtered=function(){return utils.debug("filter data")},TaskShowView.prototype.show_edit_form=function(comment){return comment.edit_form.show(),comment.content.hide()},TaskShowView.prototype.hide_edit_form=function(comment){return comment.edit_form.hide(),comment.content.show()},TaskShowView.prototype.change_last_answer_status=function(status){var item,placeholder;return placeholder=this.answers_list.items[0].status.placeholder,item=this.answers_list.items[0].status.dropdown.items.find(function(item){return item.record.value===status}),"declined"===status&&(placeholder.removeClass("accepted"),placeholder.addClass("declined")),"accepted"===status&&(placeholder.removeClass("declined"),placeholder.addClass("accepted")),placeholder.node.innerText=item.node.textContent},TaskShowView.prototype.change_last_answer_score=function(score){return this.answers_list.items[0].score.placeholder.node.innerText=score},TaskShowView.prototype.load_answers=function(answers){return this.answers_list.data_provider(answers),this.form=this.find(".task-answer-form")},TaskShowView.prototype.refresh_answers_list=function(response){var answer_item,menu_item,record,ts;return ts=response.task_stat,(menu_item=this.list.items.find(function(i){return i.record.user_id===ts.user_id}))?menu_item.record.set(ts):(ts=pi.resources.TaskStat.build(ts),this.list.add_item(ts),menu_item=this.list.items[this.list.items.length-1]),record=menu_item.record,this.list.update_item(menu_item,record),(answer_item=this.answers_list.items.find(function(i){return i.record.attempt===ts.attempt}))||(this.answers_list.add_item(ts),answer_item=this.answers_list.items[this.answers_list.items.length-1]),answer_item.record,this.answers_list.update_item(answer_item,record)},TaskShowView.prototype.ensure_selected=function(stat){var ref;if((ref=this.list.where({record:{id:stat.id}})).length)return this.list.select_item(ref[0],!0)},TaskShowView.alias("filter","filtered"),TaskShowView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TaskTakeView=function(superClass){function TaskTakeView(){return TaskTakeView.__super__.constructor.apply(this,arguments)}var MAX_FILES_SIZE;return extend(TaskTakeView,superClass),MAX_FILES_SIZE=33554432,TaskTakeView.include(pi.TaskAttachmentForm),TaskTakeView.prototype.default_controller=pi.controllers.TaskTake,TaskTakeView.prototype.postinitialize=function(){var _check_enabled;if(TaskTakeView.__super__.postinitialize.apply(this,arguments),this.form=this.list.find(".task-answer-form"),null!=this.form)return _check_enabled=this._check_enabled.bind(this),bowser.msie?this.form.text.on("keyup",_check_enabled):this.form.text.on("input",_check_enabled)},TaskTakeView.prototype._check_enabled=function(){return this.form.text.editor.getHTML().length>0&&!this.is_files_limit_reached()?this.form.submit_btn.enable():this.form.submit_btn.disable()},TaskTakeView.prototype.loading=function(flag){if(this.form&&this.form.submit_btn)return flag?(this.form.submit_btn.disable(),this.form.loader.reset(),this.form.loader.start(),this.form.loader.simulate()):(this.form.submit_btn.enable(),this.form.loader.stop())},TaskTakeView.prototype.is_files_limit_reached=function(){return this.form.list.items.reduce(function(total,item){return total+(item.record._destroy||null==item.record.file?0:item.record.file.size)},0)>MAX_FILES_SIZE},TaskTakeView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CourseStatsView=function(superClass){function CourseStatsView(){return CourseStatsView.__super__.constructor.apply(this,arguments)}return extend(CourseStatsView,superClass),CourseStatsView.prototype.default_controller=pi.controllers.CourseStats,CourseStatsView.prototype.filtered=function(){return utils.debug("filter data")},CourseStatsView.prototype.ensure_course_type=function(id){var ref;if((ref=$("@types_list").where({record:{id:id}})).length)return $("@types_list").select_item(ref[0],!0)},CourseStatsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseStatShowView=function(superClass){function CourseStatShowView(){return CourseStatShowView.__super__.constructor.apply(this,arguments)}return extend(CourseStatShowView,superClass),CourseStatShowView.prototype.default_controller=pi.controllers.CourseStatShow,CourseStatShowView.include(pi.BaseView.Loadable,pi.BaseView.Listable),CourseStatShowView.requires("info"),CourseStatShowView.prototype.load_stat=function(course_stat){return this.info.restful.bind(course_stat,!0)},CourseStatShowView.prototype.unloaded=function(){return CourseStatShowView.__super__.unloaded.apply(this,arguments),this.info.restful.bind(null),this.list.clear()},CourseStatShowView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CourseStatsTransferView=function(superClass){function CourseStatsTransferView(){return CourseStatsTransferView.__super__.constructor.apply(this,arguments)}return extend(CourseStatsTransferView,superClass),CourseStatsTransferView.include(pi.BaseView.Listable),CourseStatsTransferView.include(pi.BaseView.Loadable),CourseStatsTransferView.prototype.default_controller=pi.controllers.CourseStatsTransfer,CourseStatsTransferView.prototype.loaded=function(){var i,item,len,ref;for(i=0,len=(ref=this.list.items).length;i<len;i++)null!=(item=ref[i])&&pi.app.program_session_ids.includes(item.record.id)&&this.list.remove_item(item);return CourseStatsTransferView.__super__.loaded.apply(this,arguments)},CourseStatsTransferView.prototype.unloaded=function(){return CourseStatsTransferView.__super__.unloaded.apply(this,arguments),this.list.clear_selection(),this.list.search("")},CourseStatsTransferView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizCopyCoursesView=function(superClass){function QuizCopyCoursesView(){return QuizCopyCoursesView.__super__.constructor.apply(this,arguments)}return extend(QuizCopyCoursesView,superClass),QuizCopyCoursesView.include(pi.BaseView.Loadable),QuizCopyCoursesView.prototype.default_controller=pi.controllers.QuizCopyCourses,QuizCopyCoursesView.prototype.loaded=function(){return this.show(),this.list.scroll_end.enable()},QuizCopyCoursesView.prototype.unloaded=function(){return this.hide(),this.list.scroll_end.disable(),QuizCopyCoursesView.__super__.unloaded.apply(this,arguments)},QuizCopyCoursesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizCopyQuestionsView=function(superClass){function QuizCopyQuestionsView(){return QuizCopyQuestionsView.__super__.constructor.apply(this,arguments)}return extend(QuizCopyQuestionsView,superClass),QuizCopyQuestionsView.include(pi.BaseView.Loadable),QuizCopyQuestionsView.prototype.default_controller=pi.controllers.QuizCopyQuestions,QuizCopyQuestionsView.prototype.quiz_loaded=function(quiz){var ref;return this.quiz_name.text(quiz.name),this.course_name.text(null!=(ref=$r.Course.get(quiz.course_id))?ref.name:void 0)},QuizCopyQuestionsView.prototype.loaded=function(){var ref;return null!=(ref=this.copy_btn)&&ref.disable(),this.show()},QuizCopyQuestionsView.prototype.unloaded=function(){return this.hide(),this.list.clear(),this.search_txt.clear()},QuizCopyQuestionsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizCopyQuizzesView=function(superClass){function QuizCopyQuizzesView(){return QuizCopyQuizzesView.__super__.constructor.apply(this,arguments)}return extend(QuizCopyQuizzesView,superClass),QuizCopyQuizzesView.include(pi.BaseView.Loadable),QuizCopyQuizzesView.prototype.default_controller=pi.controllers.QuizCopyQuizzes,QuizCopyQuizzesView.prototype.course_loaded=function(course){return this.course_name.text(course.name)},QuizCopyQuizzesView.prototype.loaded=function(){var ref;return null!=(ref=this.copy_btn)&&ref.disable(),this.show()},QuizCopyQuizzesView.prototype.unloaded=function(){return this.hide(),this.list.clear(),this.search_txt.clear()},QuizCopyQuizzesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuestionCopyView=function(superClass){function QuestionCopyView(){return QuestionCopyView.__super__.constructor.apply(this,arguments)}return extend(QuestionCopyView,superClass),QuestionCopyView.include(pi.BaseView.Loadable),QuestionCopyView.prototype.default_controller=pi.controllers.QuestionCopy,QuestionCopyView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizCopyView=function(superClass){function QuizCopyView(){return QuizCopyView.__super__.constructor.apply(this,arguments)}return extend(QuizCopyView,superClass),QuizCopyView.include(pi.BaseView.Loadable),QuizCopyView.prototype.default_controller=pi.controllers.QuizCopy,QuizCopyView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizEditView=function(superClass){function QuizEditView(){return QuizEditView.__super__.constructor.apply(this,arguments)}return extend(QuizEditView,superClass),QuizEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable),QuizEditView.requires("form"),QuizEditView.prototype.default_controller=pi.controllers.QuizEdit,QuizEditView.prototype.loaded=function(quiz){var _this;if(QuizEditView.__super__.loaded.apply(this,arguments),null!=quiz)return this.form.value(quiz),this.form.options_field.attempts_sg.update_steppers(quiz.has_attempts),quiz.has_attempts?this.form.options_field.attempts_rg.enable():this.form.options_field.attempts_rg.disable(),2===quiz.navigation?this.form.options_field.pool_size_st.enable():this.form.options_field.pool_size_st.disable(),this.enable_show_answers(quiz.show_results),this.enable_show_quiz_categories(),this.enable_show_correct_answers_only(quiz.show_answers,quiz.show_results),this.form.options_field.pool_size_st.on(pi.InputEvent.Change,(_this=this,function(e){var val;return val=0|e.data,quiz.pool_size=val||1,_this.form.passing_grade_sg.update_max_score(quiz.max_score())})),this.form.time_limit_sg.update_steppers(quiz.has_time_limit),this.form.passing_grade_sg.update_steppers(quiz.has_passing_grade),quiz.edit_time_limit_disabled?(this.form.time_limit_sg.cb.disable(),this.form.time_limit_sg.steppers.forEach(function(elem){return elem.disable()}),this.form.time_limit_sg.tip.show()):(this.form.time_limit_sg.cb.enable(),this.form.time_limit_sg.tip.hide()),this.load_questions(quiz),this.load_categories(quiz),this.resolve_page_by_categories(),this.define_select_type(quiz)},QuizEditView.prototype.load_questions=function(quiz){var max_score;return this.add_categories_to_forms(this.list.items,quiz.question_categories().all()),this.list.restful.bind(quiz.questions(),!0),(max_score=quiz.max_score())&&this.form.passing_grade_sg.update_max_score(max_score),this.search_txt.reset()},QuizEditView.prototype.define_select_type=function(quiz){if(this.hide_arrows(),this.list.selectable.is_radio=!1,this.action_group.add_to_category.show(),this.action_group.clear_select.show(),0===quiz.question_categories().all().length)return this.show_arrows(),this.list.selectable.is_radio=!0,this.action_group.add_to_category.hide(),this.action_group.clear_select.hide()},QuizEditView.prototype.edit_category=function(item){return this.list.clear_selection(),this.categories.list.edit_item(item)},QuizEditView.prototype.reload_questions=function(quiz){var i,item,len,ref;for(i=0,len=(ref=this.list.items).length;i<len;i++)item=ref[i],this.list.update_item(item,item.record);return this.form.passing_grade_sg.update_max_score(quiz.max_score()),this.add_categories_to_forms(this.list.items,quiz.question_categories().all()),this.search_txt.reset()},QuizEditView.prototype.load_categories=function(quiz){return this.categories.list.restful.bind(quiz.question_categories(),!0),this.search_txt.reset()},QuizEditView.prototype.add_categories_to_forms=function(forms,categories){var category,form,i,j,len,len1,results;if(0!==forms.length){for(results=[],i=0,len=forms.length;i<len;i++)if(form=forms[i],0===categories.length)form.form.show_category_list.hide(),results.push(form.form.score.enable());else{for(form.form.categories.list.clear(),j=0,len1=categories.length;j<len1;j++)category=categories[j],form.form.categories.list.add_item(category);results.push(form.form.score.disable())}return results}},QuizEditView.prototype.ensure_sorted=function(){return this.list.sort({position:"asc"})},QuizEditView.prototype.show_categories_list=function(button){return button.host.categories.show(),pi.Nod.win.scrollToNod(button.host.categories),button.hide()},QuizEditView.prototype.select_category=function(category_list){var selected_category;return selected_category=category_list.list.selected_item().record,category_list.host.value({question_category_name:selected_category.name,question_category_id:selected_category.id,score:selected_category.score}),category_list.hide(),category_list.host.show_category_list.show()},QuizEditView.prototype.activate_categories_item=function(index){var item;return item=this.categories.list.items[index],this.categories.list.edit_item(item)},QuizEditView.prototype.activate_item=function(index){var item,item_y,wh;if(item=this.list.items[index],this.add_categories_to_forms([item],this.categories.list.records()),this.list.edit_item(item),null!=item)return(wh=pi.Nod.win.height())+pi.Nod.win.scrollTop()<(item_y=item.y()+item.find(".form-wrapper").height())?pi.Nod.win.scrollY(item_y-wh):void 0},QuizEditView.prototype.enable_preview=function(){return this.preview_btn.enable(),this.import_btn.enable()},QuizEditView.prototype.disable_preview=function(){return this.preview_btn.disable(),this.import_btn.disable()},QuizEditView.prototype.question_updated=function(quiz,question){return this.list.find_by_id(question.id).node.click(),this.form.passing_grade_sg.update_max_score(quiz.max_score()),quiz.pool_size||this.form.options_field.pool_size_st.value(quiz.questions().all().length),this.add_categories_to_forms([this.list.find_by_id(question.id)],quiz.question_categories().all())},QuizEditView.prototype.remove_question=function(host){if(host.host.remove_item(host),this.list.active_form)return this.list.active_form._active_item.form._invalids=[]},QuizEditView.prototype.enable_show_correct_answers_only=function(show_answers,show_results){return show_answers&&show_results?this.form.options_field.show_correct_answers_only_cb.enable():(this.form.options_field.show_correct_answers_only_cb.disable(),this.form.options_field.show_correct_answers_only_cb.clear())},QuizEditView.prototype.enable_show_quiz_categories=function(){var input;return"1"===(input=this.form.options_field.enable_show_quiz_categories_cb).value()?(input.disable(),this.categories.show()):(input.enable(),this.categories.hide())},QuizEditView.prototype.show_question_categories=function(data){return data?this.categories.show():this.categories.hide()},QuizEditView.prototype.resolve_page_by_categories=function(){return 0===this.categories.list.items.length?(this.form.options_field.pool_size_st.parent().show(),this.form.options_field.import_gift.show(),this.import_btn.removeClass("hidden")):(this.resolve_category_pool_size(this.controller.quiz.navigation),this.import_btn.addClass("hidden"),this.form.options_field.pool_size_st.parent().hide(),this.form.options_field.import_gift.hide())},QuizEditView.prototype.resolve_category_pool_size=function(navigation){var category,i,len,ref,results;if(0!==this.categories.list.items.length){for(this.recount_category_questions(navigation),results=[],i=0,len=(ref=this.categories.list.items).length;i<len;i++)category=ref[i],2!==Number(navigation)?results.push(category.form.pool_size_cq.disable()):results.push(category.form.pool_size_cq.enable());return results}},QuizEditView.prototype.recount_category_questions=function(navigation){var category,i,len,qestion_count,ref,results;if(0!==this.categories.list.items.length){for(results=[],i=0,len=(ref=this.categories.list.items).length;i<len;i++)category=ref[i],qestion_count=qestion_count=2!==Number(navigation)?category.record.questions().all().length:category.record.pool_size,results.push(category.category_question_count.html(qestion_count+""));return results}},QuizEditView.prototype.resolve_pool_size_st=function(data){return this.resolve_category_pool_size(data),2===Number(data)?this.form.options_field.pool_size_st.enable():this.form.options_field.pool_size_st.disable()},QuizEditView.prototype.enable_show_answers=function(show_results){return show_results?(this.form.options_field.show_answers_cb.enable(),this.enable_show_correct_answers_only("1"===this.form.options_field.show_answers_cb.value(),show_results)):(this.form.options_field.show_answers_cb.disable(),this.form.options_field.show_correct_answers_only_cb.disable(),this.form.options_field.show_answers_cb.clear(),this.form.options_field.show_correct_answers_only_cb.clear())},QuizEditView.alias("question_removed","question_updated"),QuizEditView.prototype.unloaded=function(){return QuizEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.options_field.deactivate(),this.list.restful.bind(null),this.categories.list.restful.bind(null),this.search_txt.reset(),this.list.clear(),this.categories.list.clear()},QuizEditView.prototype.show_arrows=function(){return this.action_group.node.querySelectorAll(".move-btb").forEach(function(btn){return btn.classList.remove("is-hidden")})},QuizEditView.prototype.hide_arrows=function(){return this.action_group.node.querySelectorAll(".move-btb").forEach(function(btn){return btn.classList.add("is-hidden")})},QuizEditView.prototype.toggle_action_group=function(data){return data[0].record.is_editor_js?this.action_group.edit_btn.hide():this.action_group.edit_btn.show(),this.action_group.show(data)},QuizEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.GiftUploadView=function(superClass){function GiftUploadView(){return GiftUploadView.__super__.constructor.apply(this,arguments)}return extend(GiftUploadView,superClass),GiftUploadView.prototype.default_controller=pi.controllers.GiftUpload,GiftUploadView.requires("form"),GiftUploadView.prototype.loading=function(){},GiftUploadView.prototype.unloaded=function(){return this.form.clear(),GiftUploadView.__super__.unloaded.apply(this,arguments)},GiftUploadView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizImportView=function(superClass){function QuizImportView(){return QuizImportView.__super__.constructor.apply(this,arguments)}return extend(QuizImportView,superClass),QuizImportView.prototype.default_controller=pi.controllers.QuizImport,QuizImportView.requires("form"),QuizImportView.prototype.loading=function(){},QuizImportView.prototype.loaded=function(section){return QuizImportView.__super__.loaded.apply(this,arguments),this.form.value({id:section.id})},QuizImportView.prototype.unloaded=function(){return this.form.clear(),QuizImportView.__super__.unloaded.apply(this,arguments)},QuizImportView.prototype.error=function(){if(this.options.error_message)return QuizImportView.__super__.error.call(this,this.options.error_message)},QuizImportView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizzesView=function(superClass){function QuizzesView(){return QuizzesView.__super__.constructor.apply(this,arguments)}return extend(QuizzesView,superClass),QuizzesView.include(pi.BaseView.Loadable),QuizzesView.prototype.default_controller=pi.controllers.Quizzes,QuizzesView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizViewView=function(superClass){function QuizViewView(){return QuizViewView.__super__.constructor.apply(this,arguments)}return extend(QuizViewView,superClass),QuizViewView.prototype.default_controller=pi.controllers.QuizView,QuizViewView.include(pi.BaseView.Loadable),QuizViewView.requires("form"),QuizViewView.prototype.loaded=function(){return QuizViewView.__super__.loaded.apply(this,arguments),this.total_num=pi.app.quiz.questions_num},QuizViewView.prototype.load_question=function(question,position){return null!=this.prev_btn&&(1===position?this.prev_btn.disable():this.prev_btn.enable(),position===this.total_num?this.next_btn.disable():this.next_btn.enable()),this.form.restful.bind(question,!0)},QuizViewView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizTakeView=function(superClass){function QuizTakeView(){return QuizTakeView.__super__.constructor.apply(this,arguments)}return extend(QuizTakeView,superClass),QuizTakeView.prototype.default_controller=pi.controllers.QuizTake,QuizTakeView.requires("stat"),QuizTakeView.prototype.start_timer=function(){var ref;return null!=(ref=this.stat.timer)?ref.start():void 0},QuizTakeView.prototype.enable_submit=function(){var ref;return null!=(ref=this.form.submit_btn)?ref.enable():void 0},QuizTakeView.prototype.disable_submit=function(){var ref;return null!=(ref=this.form.submit_btn)?ref.disable():void 0},QuizTakeView.prototype.quiz_finished=function(quiz_stat){var ref;return this.addClass("is-finished"),null!=(ref=this.stat.timer)&&ref.stop(),this.finish_msg.render(quiz_stat,!0),this.form.hide(),this.finish_msg.show()},QuizTakeView}(pi.QuizViewView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizStatsView=function(superClass){function QuizStatsView(){return QuizStatsView.__super__.constructor.apply(this,arguments)}return extend(QuizStatsView,superClass),QuizStatsView.prototype.default_controller=pi.controllers.QuizStats,QuizStatsView.requires("labels_list"),QuizStatsView.prototype.ensure_session=function(id){var ref;return null!=(ref=this.session_select)?ref.value(id):void 0},QuizStatsView.prototype.labels_loaded=function(labels){return null!=labels?this.labels_list.data_provider(labels):this.labels_list.clear()},QuizStatsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizStatShowView=function(superClass){function QuizStatShowView(){return QuizStatShowView.__super__.constructor.apply(this,arguments)}return extend(QuizStatShowView,superClass),QuizStatShowView.prototype.default_controller=pi.controllers.QuizStatShow,QuizStatShowView.include(pi.BaseView.Loadable,pi.BaseView.Listable),QuizStatShowView.requires("info"),QuizStatShowView.prototype.load_stat=function(quiz_stat){var ref1;return this.info.restful.bind(quiz_stat,!0),null!=(ref1=this.show_answers_btn)?ref1.enable():void 0},QuizStatShowView.prototype.ensure_updated=function(params){var ref;if((ref=this.list.where({record:params})).length)return this.list.update_item(ref[0],ref[0].record)},QuizStatShowView.prototype.unloaded=function(){var ref1,ref2;return QuizStatShowView.__super__.unloaded.apply(this,arguments),null!=(ref1=this.show_answers_btn)&&ref1.selectable.deselect(),null!=(ref2=this.show_answers_btn)&&ref2.disable(),this.info.restful.bind(null),this.list.clear()},QuizStatShowView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizStatListenerShowView=function(superClass){function QuizStatListenerShowView(){return QuizStatListenerShowView.__super__.constructor.apply(this,arguments)}return extend(QuizStatListenerShowView,superClass),QuizStatListenerShowView.prototype.default_controller=pi.controllers.QuizStatListenerShow,QuizStatListenerShowView.prototype.loaded=function(data){return QuizStatListenerShowView.__super__.loaded.apply(this,arguments),this.info.render(data)},QuizStatListenerShowView.prototype.load_stat=function(quiz_stat){var ref,ref1,ref2,ref3;return(null!=(ref=quiz_stat.quiz())?ref.show_answers:void 0)?this.removeClass("no-answers"):this.addClass("no-answers"),null!=(ref1=this.info.stat_info)&&ref1.restful.bind(quiz_stat,!0),null!=(ref2=this.info.attempts_select)&&ref2.value(quiz_stat.id),null!=(ref3=this.show_answers_btn)?ref3.enable():void 0},QuizStatListenerShowView.prototype.unloaded=function(){var ref,ref1;return pi.LeftbarView.prototype.unloaded.call(this),null!=(ref=this.show_answers_btn)&&ref.selectable.deselect(),null!=(ref1=this.show_answers_btn)&&ref1.disable(),this.info.render(null),this.list.clear()},QuizStatListenerShowView}(pi.QuizStatShowView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.app,pi.ReportBaseView=function(superClass){function ReportBaseView(){return ReportBaseView.__super__.constructor.apply(this,arguments)}return extend(ReportBaseView,superClass),ReportBaseView.include(pi.BaseView.Loadable),ReportBaseView.prototype.reload=function(){return!0},ReportBaseView.prototype.ensure_session=function(id){return this.session_select.value(id)},ReportBaseView.prototype.labels_loaded=function(labels){return null!=labels?this.labels_list.data_provider(labels):this.labels_list.clear()},ReportBaseView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){
this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportsAccountVisitsView=function(superClass){function ReportsAccountVisitsView(){return ReportsAccountVisitsView.__super__.constructor.apply(this,arguments)}return extend(ReportsAccountVisitsView,superClass),ReportsAccountVisitsView.prototype.default_controller=pi.controllers.ReportsAccountVisits,ReportsAccountVisitsView.include(pi.BaseView.VisitsReports),ReportsAccountVisitsView.prototype.reports_name="visits_reports",ReportsAccountVisitsView}(pi.ReportBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ReportsActivityView=function(superClass){function ReportsActivityView(){return ReportsActivityView.__super__.constructor.apply(this,arguments)}return extend(ReportsActivityView,superClass),ReportsActivityView.prototype.default_controller=pi.controllers.ReportsActivity,ReportsActivityView.prototype.filtered=function(){return utils.debug("filter data")},ReportsActivityView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportQuizBaseView=function(superClass){function ReportQuizBaseView(){return ReportQuizBaseView.__super__.constructor.apply(this,arguments)}return extend(ReportQuizBaseView,superClass),ReportQuizBaseView.requires("quiz_select"),ReportQuizBaseView.prototype.ensure_quiz=function(id){return this.quiz_select.value(id)},ReportQuizBaseView}(pi.ReportBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportCourseView=function(superClass){function ReportCourseView(){return ReportCourseView.__super__.constructor.apply(this,arguments)}return extend(ReportCourseView,superClass),ReportCourseView.prototype.default_controller=pi.controllers.ReportCourse,ReportCourseView.requires("list"),ReportCourseView}(pi.ReportBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportCourseVisitsView=function(superClass){function ReportCourseVisitsView(){return ReportCourseVisitsView.__super__.constructor.apply(this,arguments)}return extend(ReportCourseVisitsView,superClass),ReportCourseVisitsView.prototype.default_controller=pi.controllers.ReportCourseVisits,ReportCourseVisitsView.include(pi.BaseView.VisitsReports),ReportCourseVisitsView.prototype.reports_name="course_visits_reports",ReportCourseVisitsView}(pi.ReportBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportQuestionsView=function(superClass){function ReportQuestionsView(){return ReportQuestionsView.__super__.constructor.apply(this,arguments)}return extend(ReportQuestionsView,superClass),ReportQuestionsView.prototype.default_controller=pi.controllers.ReportQuestions,ReportQuestionsView.include(pi.BaseView.Listable),ReportQuestionsView.prototype.postinitialize=function(){if(ReportQuestionsView.__super__.postinitialize.apply(this,arguments),!pi.tools.LocalDownload.available())return this.export_btn.disable()},ReportQuestionsView.prototype.reload=function(){return!0},ReportQuestionsView.prototype.load_data=function(data){return pi.BaseView.Listable.prototype.reload.call(this,data)},ReportQuestionsView}(pi.ReportQuizBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportQuizView=function(superClass){function ReportQuizView(){return ReportQuizView.__super__.constructor.apply(this,arguments)}return extend(ReportQuizView,superClass),ReportQuizView.prototype.default_controller=pi.controllers.ReportQuiz,ReportQuizView.requires("list"),ReportQuizView}(pi.ReportQuizBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportQuizVisitsView=function(superClass){function ReportQuizVisitsView(){return ReportQuizVisitsView.__super__.constructor.apply(this,arguments)}return extend(ReportQuizVisitsView,superClass),ReportQuizVisitsView.prototype.default_controller=pi.controllers.ReportQuizVisits,ReportQuizVisitsView.include(pi.BaseView.VisitsReports),ReportQuizVisitsView.prototype.reports_name="quiz_visits_reports",ReportQuizVisitsView}(pi.ReportQuizBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportsUsersView=function(superClass){function ReportsUsersView(){return ReportsUsersView.__super__.constructor.apply(this,arguments)}return extend(ReportsUsersView,superClass),ReportsUsersView.prototype.default_controller=pi.controllers.ReportsUsers,ReportsUsersView}(pi.UsersView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ReportsUsersShowView=function(superClass){function ReportsUsersShowView(){return ReportsUsersShowView.__super__.constructor.apply(this,arguments)}return extend(ReportsUsersShowView,superClass),ReportsUsersShowView.prototype.default_controller=pi.controllers.ReportsUsersShow,ReportsUsersShowView.include(pi.BaseView.Loadable),ReportsUsersShowView.prototype.reload=function(){},ReportsUsersShowView.prototype.ensure_course_content_type=function(){},ReportsUsersShowView.prototype.ensure_course_type=function(){},ReportsUsersShowView}(pi.BaseView),pi.ReportsUsersShowListView=function(superClass){function ReportsUsersShowListView(){return ReportsUsersShowListView.__super__.constructor.apply(this,arguments)}return extend(ReportsUsersShowListView,superClass),ReportsUsersShowListView.prototype.default_controller=pi.controllers.ReportsUsersShowList,ReportsUsersShowListView.include(pi.BaseView.Listable,pi.BaseView.Loadable),ReportsUsersShowListView.prototype.initialize=function(){if(ReportsUsersShowListView.__super__.initialize.apply(this,arguments),null!=this.controller)return this.controller.setup(this.options.controller_id)},ReportsUsersShowListView.prototype.toggle_action_group=function(course_stat){return course_stat.can_manage_participants?this.action_group.show(course_stat):this.action_group.hide()},ReportsUsersShowListView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AccountsForCustomizationView=function(superClass){function AccountsForCustomizationView(){return AccountsForCustomizationView.__super__.constructor.apply(this,arguments)}return extend(AccountsForCustomizationView,superClass),AccountsForCustomizationView.include(pi.PopupView),AccountsForCustomizationView.prototype.default_controller=pi.controllers.AccountsForCustomization,AccountsForCustomizationView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminCopyCoursesView=function(superClass){function AdminCopyCoursesView(){return AdminCopyCoursesView.__super__.constructor.apply(this,arguments)}return extend(AdminCopyCoursesView,superClass),AdminCopyCoursesView.prototype.default_controller=pi.controllers.AdminCopyCourses,AdminCopyCoursesView.prototype.unloaded=function(){return this.form.courses_ids_txt.clear()},AdminCopyCoursesView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminAccountEditView=function(superClass){function AdminAccountEditView(){return AdminAccountEditView.__super__.constructor.apply(this,arguments)}return extend(AdminAccountEditView,superClass),AdminAccountEditView.requires("form"),AdminAccountEditView.include(pi.BaseView.Loadable),AdminAccountEditView.prototype.default_controller=pi.controllers.AdminAccountEdit,AdminAccountEditView.prototype.CURRENT_VERSION=1,AdminAccountEditView.prototype.contract_loaded=function(target,file_obj){return this.form.value(utils.wrap("contract_file_id",file_obj.id)),this.update_contract(file_obj.file_name)},AdminAccountEditView.prototype.delete_contract=function(){return this.form.value(utils.wrap("contract_file_id",0)),this.update_contract("")},AdminAccountEditView.prototype.loaded=function(account){if(AdminAccountEditView.__super__.loaded.apply(this,arguments),null!=account)return this.form.value(account),this.form.options.is_full&&(this.update_contract(account.contract_file_name),this.handle_provider_changed(account.meetings_provider),this.handle_system_version(account.system_version),this.handle_ldap_integration(account.use_ad_integration),this.handle_saml_sso_auth(account.saml_sso_auth),this.handle_login_auth(account.allow_login_auth),this.initialize_list_filter(),this.initialize_meetbase_list_filter()),(account.master()||account.slave())&&this.form.convert_to_master_btn.hide(),account.can_change_type?void 0:this.form.switch_account_type.hide()},AdminAccountEditView.prototype.update_contract=function(file){return this.form.cover.contract.text(file)},AdminAccountEditView.prototype.handle_provider_changed=function(provider){return"teachbase"===provider?this.form.clickmeeting_settings.hide():this.form.clickmeeting_settings.show()},AdminAccountEditView.prototype.handle_system_version=function(num){return num===this.CURRENT_VERSION?(this.form.decoration_fields.switch_to_next_version.show(),this.form.decoration_fields.switch_to_prev_version.hide()):(this.form.decoration_fields.switch_to_next_version.hide(),this.form.decoration_fields.switch_to_prev_version.show()),this.handle_calendar(num)},AdminAccountEditView.prototype.handle_calendar=function(num){return num===this.CURRENT_VERSION?(this.form.cb_use_calendar.hide(),this.form.cb_use_calendar.value(0)):this.form.cb_use_calendar.show()},AdminAccountEditView.prototype.handle_saml_sso_auth=function(val){var samlForm;return samlForm=this.form.saml_settings.saml_form,val?samlForm.enable():samlForm.disable()},AdminAccountEditView.prototype.handle_login_auth=function(val){var loginAuthForm;return loginAuthForm=this.form.login_auth.login_auth_form,val?loginAuthForm.enable():loginAuthForm.disable()},AdminAccountEditView.prototype.handle_ldap_integration=function(val){return!0===val?this.form.ldap_settings.ldap_form.enable():this.form.ldap_settings.ldap_form.disable()},AdminAccountEditView.prototype.show_result_connection=function(val){return this.form.ldap_settings.ldap_form.result_connection.value(val)},AdminAccountEditView.prototype.initialize_list_filter=function(){var _ref;return this.list_filter=this.form.decoration_fields.list_filter,_ref=this.list_filter.where({record:{type:"header"}}),this.list_filter.select_item(_ref[0]),this.toggle_field("header")},AdminAccountEditView.prototype.initialize_meetbase_list_filter=function(){var _ref;return this.meetbase_list_filter=this.form.meetbase.meetbase_list_filter,_ref=this.meetbase_list_filter.where({record:{type:"zoom"}}),this.meetbase_list_filter.select_item(_ref[0]),this.toggle_meetbase_field("zoom")},AdminAccountEditView.prototype.toggle_field=function(select_field){var _this;return["header","footer","styles","react_styles","custom_images","react_custom"].map((_this=this,function(field){return _this.form.decoration_fields[field].hide()})),this.form.decoration_fields[select_field].show()},AdminAccountEditView.prototype.toggle_meetbase_field=function(select_field){var _this;return["zoom","clickmeeting","webinar_ru","trueconf"].forEach((_this=this,function(field){return _this.form.meetbase[field].hide()})),this.form.meetbase[select_field].show()},AdminAccountEditView.prototype.clear_list_filter=function(){return this._active_item=this.list_filter.selected_item(),this._active_item&&this.list_filter.deselect_item(this._active_item),this._active_item=null},AdminAccountEditView.prototype.clear_meetbase_list_filter=function(){return this._active_item=this.meetbase_list_filter.selected_item(),this._active_item&&this.meetbase_list_filter.deselect_item(this._active_item),this._active_item=null},AdminAccountEditView.prototype.unloaded=function(){if(AdminAccountEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.options.is_full)return this.form.decoration_fields.deactivate(),this.form.meetbase.deactivate(),this.clear_list_filter(),this.clear_meetbase_list_filter()},AdminAccountEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminAccountsView=function(superClass){function AdminAccountsView(){return AdminAccountsView.__super__.constructor.apply(this,arguments)}return extend(AdminAccountsView,superClass),AdminAccountsView.prototype.default_controller=pi.controllers.AdminAccounts,AdminAccountsView.prototype.filtered=function(){return utils.debug("filter data")},AdminAccountsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminNetologyCoursesView=function(superClass){function AdminNetologyCoursesView(){return AdminNetologyCoursesView.__super__.constructor.apply(this,arguments)}return extend(AdminNetologyCoursesView,superClass),AdminNetologyCoursesView.include(pi.BaseView.Loadable,pi.BaseView.Listable),AdminNetologyCoursesView.prototype.default_controller=pi.controllers.AdminNetologyCourses,AdminNetologyCoursesView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminAccountSelectView=function(superClass){function AdminAccountSelectView(){return AdminAccountSelectView.__super__.constructor.apply(this,arguments)}return extend(AdminAccountSelectView,superClass),AdminAccountSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),AdminAccountSelectView.prototype.default_controller=pi.controllers.AdminAccountSelect,AdminAccountSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).AdminSendAccountsReportView=function(superClass){function AdminSendAccountsReportView(){return AdminSendAccountsReportView.__super__.constructor.apply(this,arguments)}return extend(AdminSendAccountsReportView,superClass),AdminSendAccountsReportView.prototype.default_controller=pi.controllers.AdminSendAccountsReport,AdminSendAccountsReportView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminAccountShowView=function(superClass){function AdminAccountShowView(){return AdminAccountShowView.__super__.constructor.apply(this,arguments)}return extend(AdminAccountShowView,superClass),AdminAccountShowView.prototype.default_controller=pi.controllers.AdminAccountShow,AdminAccountShowView.prototype.loaded=function(account){return AdminAccountShowView.__super__.loaded.apply(this,arguments),this.resolve_toggle_button(account)},AdminAccountShowView.prototype.load_lists=function(managers,orders,subs){return this.load_list(this.managers_list,managers),this.load_list(this.orders_list,orders),this.load_list(this.sub_list,subs)},AdminAccountShowView.prototype.load_list=function(component,data){var i,item,len;for(i=0,len=data.length;i<len;i++)item=data[i],component.add_item(item,!0);return component.update()},AdminAccountShowView.prototype.resolve_toggle_button=function(account){return account.status===$r.AdminAccount.STATUSES().enabled?this.content.disable_btn.show():account.status===$r.AdminAccount.STATUSES().disabled?this.content.enable_btn.show():void 0},AdminAccountShowView.prototype.unloaded=function(){return AdminAccountShowView.__super__.unloaded.apply(this,arguments),this.managers_list.clear(),this.orders_list.clear(),this.sub_list.clear()},AdminAccountShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminCourseShareView=function(superClass){function AdminCourseShareView(){return AdminCourseShareView.__super__.constructor.apply(this,arguments)}return extend(AdminCourseShareView,superClass),AdminCourseShareView.prototype.default_controller=pi.controllers.AdminCourseShare,AdminCourseShareView.prototype.unloaded=function(){return this.form.target_account_ids_txt.clear()},AdminCourseShareView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminOrderConfirmView=function(superClass){function AdminOrderConfirmView(){return AdminOrderConfirmView.__super__.constructor.apply(this,arguments)}return extend(AdminOrderConfirmView,superClass),AdminOrderConfirmView.requires("form"),AdminOrderConfirmView.prototype.default_controller=pi.controllers.AdminOrderConfirm,AdminOrderConfirmView.prototype.loaded=function(order){if(AdminOrderConfirmView.__super__.loaded.apply(this,arguments),null!=order)return this.form.value(order)},AdminOrderConfirmView.prototype.unloaded=function(){return AdminOrderConfirmView.__super__.unloaded.apply(this,arguments),this.form.clear()},AdminOrderConfirmView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminOrderCreateView=function(superClass){function AdminOrderCreateView(){return AdminOrderCreateView.__super__.constructor.apply(this,arguments)}return extend(AdminOrderCreateView,superClass),AdminOrderCreateView.requires("form"),AdminOrderCreateView.include(pi.BaseView.Loadable),AdminOrderCreateView.prototype.default_controller=pi.controllers.AdminOrderCreate,AdminOrderCreateView.prototype.loaded=function(order){if(AdminOrderCreateView.__super__.loaded.apply(this,arguments),null!=order)return this.form.value(order)},AdminOrderCreateView.prototype.unloaded=function(){return AdminOrderCreateView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.agreement.render(null)},AdminOrderCreateView.prototype.handle_type_changed=function(type){var selected_account;if(selected_account=$r.AdminAccount.get(this.form.value().account_id))return this.form.agreement.renderable.render({type:type,account:selected_account})},AdminOrderCreateView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminOrderEditView=function(superClass){function AdminOrderEditView(){return AdminOrderEditView.__super__.constructor.apply(this,arguments)}return extend(AdminOrderEditView,superClass),AdminOrderEditView.requires("form"),AdminOrderEditView.prototype.default_controller=pi.controllers.AdminOrderEdit,AdminOrderEditView.prototype.loaded=function(order){if(AdminOrderEditView.__super__.loaded.apply(this,arguments),null!=order)return this.form.value(order),this.form.docs_info.render(order)},AdminOrderEditView.prototype.unloaded=function(){return AdminOrderEditView.__super__.unloaded.apply(this,arguments),this.form.docs_info.render(null),this.form.clear()},AdminOrderEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminOrdersView=function(superClass){function AdminOrdersView(){return AdminOrdersView.__super__.constructor.apply(this,arguments)}return extend(AdminOrdersView,superClass),AdminOrdersView.prototype.default_controller=pi.controllers.AdminOrders,AdminOrdersView.prototype.filtered=function(){return utils.debug("filter data")},AdminOrdersView.alias("filter","filtered"),AdminOrdersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminOrderShowView=function(superClass){function AdminOrderShowView(){return AdminOrderShowView.__super__.constructor.apply(this,arguments)}return extend(AdminOrderShowView,superClass),AdminOrderShowView.prototype.default_controller=pi.controllers.AdminOrderShow,AdminOrderShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminProductsOrderEditView=function(superClass){function AdminProductsOrderEditView(){return AdminProductsOrderEditView.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrderEditView,superClass),AdminProductsOrderEditView.requires("form"),AdminProductsOrderEditView.include(pi.BaseView.Loadable),AdminProductsOrderEditView.prototype.default_controller=pi.controllers.AdminProductsOrderEdit,AdminProductsOrderEditView.prototype.loaded=function(order){if(AdminProductsOrderEditView.__super__.loaded.apply(this,arguments),null!=order)return this.form.value(order)},AdminProductsOrderEditView.prototype.unloaded=function(){return AdminProductsOrderEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},AdminProductsOrderEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminProductsOrdersView=function(superClass){function AdminProductsOrdersView(){return AdminProductsOrdersView.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrdersView,superClass),AdminProductsOrdersView.prototype.default_controller=pi.controllers.AdminProductsOrders,AdminProductsOrdersView.prototype.filtered=function(){return utils.debug("filter data")},AdminProductsOrdersView.alias("filter","filtered"),AdminProductsOrdersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminProductsOrderShowView=function(superClass){function AdminProductsOrderShowView(){return AdminProductsOrderShowView.__super__.constructor.apply(this,arguments)}return extend(AdminProductsOrderShowView,superClass),AdminProductsOrderShowView.prototype.default_controller=pi.controllers.AdminProductsOrderShow,AdminProductsOrderShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminProductsStoreEditView=function(superClass){function AdminProductsStoreEditView(){return AdminProductsStoreEditView.__super__.constructor.apply(this,arguments)}return extend(AdminProductsStoreEditView,superClass),AdminProductsStoreEditView.requires("form"),AdminProductsStoreEditView.include(pi.BaseView.Loadable),AdminProductsStoreEditView.prototype.default_controller=pi.controllers.AdminProductsStoreEdit,AdminProductsStoreEditView.prototype.loaded=function(store){if(AdminProductsStoreEditView.__super__.loaded.apply(this,arguments),null!=store)return this.form.value(store)},AdminProductsStoreEditView.prototype.unloaded=function(){return AdminProductsStoreEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},AdminProductsStoreEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminProductsStoresView=function(superClass){function AdminProductsStoresView(){return AdminProductsStoresView.__super__.constructor.apply(this,arguments)}return extend(AdminProductsStoresView,superClass),AdminProductsStoresView.prototype.default_controller=pi.controllers.AdminProductsStores,AdminProductsStoresView.prototype.filtered=function(){return utils.debug("filter data")},AdminProductsStoresView.alias("filter","filtered"),AdminProductsStoresView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminPromoCodeEditView=function(superClass){function AdminPromoCodeEditView(){return AdminPromoCodeEditView.__super__.constructor.apply(this,arguments)}return extend(AdminPromoCodeEditView,superClass),AdminPromoCodeEditView.requires("form"),AdminPromoCodeEditView.include(pi.BaseView.Loadable),AdminPromoCodeEditView.prototype.default_controller=pi.controllers.AdminPromoCodeEdit,AdminPromoCodeEditView.prototype.loaded=function(promo_code){return AdminPromoCodeEditView.__super__.loaded.apply(this,arguments),promo_code._persisted?(this.form.value(promo_code),this.form.val_txt.value(promo_code.value),this.form.type_rg.value(promo_code.type)):this.form.type_rg.value("percent")},AdminPromoCodeEditView.prototype.unloaded=function(){return AdminPromoCodeEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},AdminPromoCodeEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminPromoCodesView=function(superClass){function AdminPromoCodesView(){return AdminPromoCodesView.__super__.constructor.apply(this,arguments)}return extend(AdminPromoCodesView,superClass),AdminPromoCodesView.prototype.default_controller=pi.controllers.AdminPromoCodes,AdminPromoCodesView.prototype.filtered=function(){return utils.debug("filter data")},AdminPromoCodesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){
function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminReportsBaseView=function(superClass){function AdminReportsBaseView(){return AdminReportsBaseView.__super__.constructor.apply(this,arguments)}return extend(AdminReportsBaseView,superClass),AdminReportsBaseView.prototype.loaded=function(){return this.enable(),this.show()},AdminReportsBaseView.alias("reloaded","loaded"),AdminReportsBaseView.prototype.switched=function(){return this.hide(),this.disable()},AdminReportsBaseView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminReportsView=function(superClass){function AdminReportsView(){return AdminReportsView.__super__.constructor.apply(this,arguments)}return extend(AdminReportsView,superClass),AdminReportsView.prototype.default_controller=pi.controllers.AdminReports,AdminReportsView.requires("nav"),AdminReportsView.prototype.loaded=function(){var first_item;if(AdminReportsView.__super__.loaded.apply(this,arguments),first_item=this.nav.items[0],!this.nav.selected_item())return this.nav.select_item(first_item)},AdminReportsView.prototype.switched_to=function(new_context_id,view){var ref;if(this.clear_active_item(),ref=this.nav.where({record:{id:new_context_id}}),this.title.text(null!=view?view.options.title:void 0),null!=ref.length)return this._active_item=ref[0],this.nav.select_item(this._active_item)},AdminReportsView.prototype.clear_active_item=function(){return this._active_item&&this.nav.deselect_item(this._active_item),this._active_item=null},AdminReportsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminReportsNorthStarView=function(superClass){function AdminReportsNorthStarView(){return AdminReportsNorthStarView.__super__.constructor.apply(this,arguments)}return extend(AdminReportsNorthStarView,superClass),AdminReportsNorthStarView.prototype.default_controller=pi.controllers.AdminReportsNorthStar,AdminReportsNorthStarView.include(pi.BaseView.Loadable),AdminReportsNorthStarView.prototype.draw_data=function(data,range){var chart,i,len,ref,results;for(null==data&&(data={}),null==range&&(range="day"),(data=data.north_star_reports)&&data.length?this.activate():this.deactivate(),results=[],i=0,len=(ref=this.charts).length;i<len;i++)chart=ref[i],results.push(function(chart){if(chart.clear(),null!=data)return chart.load_data(data,"sub_users_count",{range:range})}(chart));return results},AdminReportsNorthStarView}(pi.AdminReportsBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminReportsPageLoadView=function(superClass){function AdminReportsPageLoadView(){return AdminReportsPageLoadView.__super__.constructor.apply(this,arguments)}return extend(AdminReportsPageLoadView,superClass),AdminReportsPageLoadView.prototype.default_controller=pi.controllers.AdminReportsPageLoad,AdminReportsPageLoadView.include(pi.BaseView.Loadable),AdminReportsPageLoadView.requires("browsers_chart","os_chart","page_load_stats","slow_pages","slow_ajax"),AdminReportsPageLoadView.prototype.draw_data=function(data,range){return null==data&&(data={}),null==range&&(range="hour"),utils.info(data),this.draw_browsers(data.browser_reports),this.draw_os(data.os_reports),this.page_load_stats.renderable.render(data.perf_report),this.slow_pages.data_provider(data.slow_page_reports),this.slow_ajax.data_provider(data.slow_ajax_reports)},AdminReportsPageLoadView.prototype.draw_browsers=function(data){var chart_data,i,len,r;if(this.browsers_chart.clear(),null!=data){for(chart_data={},i=0,len=data.length;i<len;i++)chart_data[(r=data[i]).browser_name]=r.total;return this.browsers_chart.load_object(chart_data)}},AdminReportsPageLoadView.prototype.draw_os=function(data){var chart_data,i,len,r;if(this.os_chart.clear(),null!=data){for(chart_data={},i=0,len=data.length;i<len;i++)chart_data[(r=data[i]).os]=r.total;return this.os_chart.load_object(chart_data)}},AdminReportsPageLoadView}(pi.AdminReportsBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminReportsVisitsView=function(superClass){function AdminReportsVisitsView(){return AdminReportsVisitsView.__super__.constructor.apply(this,arguments)}return extend(AdminReportsVisitsView,superClass),AdminReportsVisitsView.prototype.default_controller=pi.controllers.AdminReportsVisits,AdminReportsVisitsView.include(pi.BaseView.Loadable,pi.BaseView.VisitsReports),AdminReportsVisitsView}(pi.AdminReportsBaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminSubscriptionEditView=function(superClass){function AdminSubscriptionEditView(){return AdminSubscriptionEditView.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptionEditView,superClass),AdminSubscriptionEditView.requires("form"),AdminSubscriptionEditView.include(pi.BaseView.Loadable),AdminSubscriptionEditView.prototype.default_controller=pi.controllers.AdminSubscriptionEdit,AdminSubscriptionEditView.prototype.loaded=function(data){if(AdminSubscriptionEditView.__super__.loaded.apply(this,arguments),null!=data)return this.form.value(data)},AdminSubscriptionEditView.prototype.unloaded=function(){return AdminSubscriptionEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.agreement.render(null)},AdminSubscriptionEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminSubscriptionsView=function(superClass){function AdminSubscriptionsView(){return AdminSubscriptionsView.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptionsView,superClass),AdminSubscriptionsView.prototype.default_controller=pi.controllers.AdminSubscriptions,AdminSubscriptionsView.prototype.filtered=function(){return utils.debug("filter data")},AdminSubscriptionsView.alias("filter","filtered"),AdminSubscriptionsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminSubscriptionShowView=function(superClass){function AdminSubscriptionShowView(){return AdminSubscriptionShowView.__super__.constructor.apply(this,arguments)}return extend(AdminSubscriptionShowView,superClass),AdminSubscriptionShowView.prototype.default_controller=pi.controllers.AdminSubscriptionShow,AdminSubscriptionShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.SystemColorThemesEditView=function(superClass){function SystemColorThemesEditView(){return SystemColorThemesEditView.__super__.constructor.apply(this,arguments)}return extend(SystemColorThemesEditView,superClass),SystemColorThemesEditView.include(pi.BaseView.Coverable),SystemColorThemesEditView.requires("form"),SystemColorThemesEditView.include(pi.BaseView.Loadable),SystemColorThemesEditView.prototype.default_controller=pi.controllers.SystemColorThemesEditController,SystemColorThemesEditView.prototype.loaded=function(record){var ref;if(SystemColorThemesEditView.__super__.loaded.apply(this,arguments),null!=record)return this.form.value(record),this.form.logo.load(record.logo_url),null!=(ref=this.form.icon)&&ref.load(record.icon_url),this.form.favicon.load(record.favicon_url)},SystemColorThemesEditView.prototype.unloaded=function(){return SystemColorThemesEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},SystemColorThemesEditView.prototype.sync_colors=function(color,key){var form_values;return(form_values=this.form.value())[key]=color,this.form.value(form_values)},SystemColorThemesEditView.prototype.delete_logo=function(){return this.delete_cover(this.form.logo)},SystemColorThemesEditView.prototype.delete_cover=function(target){return this.form.value(utils.wrap(target.name()+"_temp_file_id",0)),target.load(null)},SystemColorThemesEditView.prototype.logo_loaded=function(file_obj){return this.cover_loaded(this.form.logo,file_obj)},SystemColorThemesEditView.prototype.delete_cover=function(target){return this.form.value(utils.wrap(target.name()+"_temp_file_id",0)),target.load(null)},SystemColorThemesEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SystemColorThemesView=function(superClass){function SystemColorThemesView(){return SystemColorThemesView.__super__.constructor.apply(this,arguments)}return extend(SystemColorThemesView,superClass),SystemColorThemesView.prototype.default_controller=pi.controllers.SystemColorThemesController,SystemColorThemesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminTariffPlanEditView=function(superClass){function AdminTariffPlanEditView(){return AdminTariffPlanEditView.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlanEditView,superClass),AdminTariffPlanEditView.requires("form"),AdminTariffPlanEditView.prototype.default_controller=pi.controllers.AdminTariffPlanEdit,AdminTariffPlanEditView.prototype.loaded=function(tariff){if(AdminTariffPlanEditView.__super__.loaded.apply(this,arguments),null!=tariff)return tariff._persisted&&this.form.free_cbx.disable(),this.form.value(tariff)},AdminTariffPlanEditView.prototype.unloaded=function(){return AdminTariffPlanEditView.__super__.unloaded.apply(this,arguments),this.form.free_cbx.enable(),this.form.clear()},AdminTariffPlanEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminTariffPlansView=function(superClass){function AdminTariffPlansView(){return AdminTariffPlansView.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlansView,superClass),AdminTariffPlansView.prototype.default_controller=pi.controllers.AdminTariffPlans,AdminTariffPlansView.prototype.filtered=function(){return utils.debug("filter data")},AdminTariffPlansView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminTariffPlanSelectView=function(superClass){function AdminTariffPlanSelectView(){return AdminTariffPlanSelectView.__super__.constructor.apply(this,arguments)}return extend(AdminTariffPlanSelectView,superClass),AdminTariffPlanSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),AdminTariffPlanSelectView.prototype.default_controller=pi.controllers.AdminTariffPlanSelect,AdminTariffPlanSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminTourEditView=function(superClass){function AdminTourEditView(){return AdminTourEditView.__super__.constructor.apply(this,arguments)}return extend(AdminTourEditView,superClass),AdminTourEditView.include(pi.BaseView.Loadable),AdminTourEditView.requires("form"),AdminTourEditView.prototype.default_controller=pi.controllers.AdminTourEdit,AdminTourEditView.prototype.loaded=function(tour){if(AdminTourEditView.__super__.loaded.apply(this,arguments),null!=tour)return this.form.value(tour),tour._persisted&&(this.form.temp_cb.disable(),this.form.role_rg.disable()),this.list.restful.bind(tour.steps(),!0)},AdminTourEditView.prototype.unloaded=function(){return AdminTourEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.temp_cb.enable(),this.form.role_rg.enable(),this.list.restful.bind(null)},AdminTourEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminTourImportView=function(superClass){function AdminTourImportView(){return AdminTourImportView.__super__.constructor.apply(this,arguments)}return extend(AdminTourImportView,superClass),AdminTourImportView.prototype.default_controller=pi.controllers.AdminTourImport,AdminTourImportView.requires("form"),AdminTourImportView.prototype.loading=function(){},AdminTourImportView.prototype.loaded=function(section){return AdminTourImportView.__super__.loaded.apply(this,arguments),this.form.value({id:section.id})},AdminTourImportView.prototype.unloaded=function(){return this.form.clear(),AdminTourImportView.__super__.unloaded.apply(this,arguments)},AdminTourImportView.prototype.error=function(){if(this.options.error_message)return AdminTourImportView.__super__.error.call(this,this.options.error_message)},AdminTourImportView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminToursView=function(superClass){function AdminToursView(){return AdminToursView.__super__.constructor.apply(this,arguments)}return extend(AdminToursView,superClass),AdminToursView.prototype.default_controller=pi.controllers.AdminTours,AdminToursView.prototype.filtered=function(){return utils.debug("filter data")},AdminToursView.alias("filter","filtered"),AdminToursView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminUserEditView=function(superClass){function AdminUserEditView(){return AdminUserEditView.__super__.constructor.apply(this,arguments)}return extend(AdminUserEditView,superClass),AdminUserEditView.include(pi.BaseView.Loadable),AdminUserEditView.requires("form"),AdminUserEditView.prototype.default_controller=pi.controllers.AdminUserEdit,AdminUserEditView.prototype.loaded=function(user){return this.form.value(user),AdminUserEditView.__super__.loaded.apply(this,arguments)},AdminUserEditView.prototype.unloaded=function(){return this.form.clear(),AdminUserEditView.__super__.unloaded.apply(this,arguments)},AdminUserEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AdminUsersView=function(superClass){function AdminUsersView(){return AdminUsersView.__super__.constructor.apply(this,arguments)}return extend(AdminUsersView,superClass),AdminUsersView.prototype.default_controller=pi.controllers.AdminUsers,AdminUsersView.prototype.filtered=function(){return utils.debug("filter data")},AdminUsersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminUsersInviteView=function(superClass){function AdminUsersInviteView(){return AdminUsersInviteView.__super__.constructor.apply(this,arguments)}return extend(AdminUsersInviteView,superClass),AdminUsersInviteView.prototype.default_controller=pi.controllers.AdminUsersInvite,AdminUsersInviteView}(pi.UsersInviteView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AdminUserShowView=function(superClass){function AdminUserShowView(){return AdminUserShowView.__super__.constructor.apply(this,arguments)}return extend(AdminUserShowView,superClass),AdminUserShowView.prototype.default_controller=pi.controllers.AdminUserShow,AdminUserShowView.prototype.load_lists=function(accounts){return this.load_list(this.list,accounts)},AdminUserShowView.prototype.load_list=function(component,data){var i,item,len;for(i=0,len=data.length;i<len;i++)item=data[i],component.add_item(item,!0);return component.update()},AdminUserShowView.prototype.unloaded=function(){return AdminUserShowView.__super__.unloaded.apply(this,arguments),this.list.clear()},AdminUserShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AccountRegView=function(superClass){function AccountRegView(){return AccountRegView.__super__.constructor.apply(this,arguments)}return extend(AccountRegView,superClass),AccountRegView.prototype.default_controller=pi.controllers.AccountReg,AccountRegView.include(pi.BaseView.Loadable),AccountRegView.requires("form"),AccountRegView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AnswerStatsExportEditView=function(superClass){function AnswerStatsExportEditView(){return AnswerStatsExportEditView.__super__.constructor.apply(this,arguments)}return extend(AnswerStatsExportEditView,superClass),AnswerStatsExportEditView.include(pi.BaseView.Loadable),AnswerStatsExportEditView.requires("form"),AnswerStatsExportEditView.prototype.default_controller=pi.controllers.AnswerStatsExportEdit,AnswerStatsExportEditView.prototype.loaded=function(setting){if(this.setting=setting,AnswerStatsExportEditView.__super__.loaded.apply(this,arguments),null!=this.setting)return this.fill_form(),this.need_to_update_setting=!0},AnswerStatsExportEditView.prototype.fill_form=function(){var _this;if(Object.entries(this.setting.answer_stats_export).forEach((_this=this,function(arg){var key;return key=arg[0],arg[1]?_this.form.answer_stats_export[key].cb.select():_this.form.answer_stats_export[key].cb.deselect()})),"object"==typeof this.setting.answer_stats_export.quiz_stat&&Object.entries(this.setting.answer_stats_export.quiz_stat).forEach(function(_this){return function(arg){var key;return key=arg[0],!0===arg[1]?(_this.form.answer_stats_export.quiz_stat.cb.select(),_this.form.answer_stats_export.quiz_stat[key].cb.select()):_this.form.answer_stats_export.quiz_stat[key].cb.deselect()}}(this)),"object"==typeof this.setting.answer_stats_export.question)return Object.entries(this.setting.answer_stats_export.question).forEach(function(_this){return function(arg){var key;return key=arg[0],!0===arg[1]?(_this.form.answer_stats_export.question.cb.select(),_this.form.answer_stats_export.question[key].cb.select()):_this.form.answer_stats_export.question[key].cb.deselect()}}(this))},AnswerStatsExportEditView.prototype.toggle_quiz_stat_cb=function(value){return value?Object.entries(this.setting.answer_stats_export.quiz_stat).forEach((_this=this,function(arg){var key;return key=arg[0],arg[1],_this.form.answer_stats_export.quiz_stat[key].cb.enable()})):Object.entries(this.setting.answer_stats_export.quiz_stat).forEach(function(_this){return function(arg){var key;return key=arg[0],arg[1],_this.form.answer_stats_export.quiz_stat[key].cb.deselect(),_this.form.answer_stats_export.quiz_stat[key].cb.disable()}}(this));var _this},AnswerStatsExportEditView.prototype.toggle_question_cb=function(value){return value?Object.entries(this.setting.answer_stats_export.question).forEach((_this=this,function(arg){var key;return key=arg[0],arg[1],_this.form.answer_stats_export.question[key].cb.enable()})):Object.entries(this.setting.answer_stats_export.question).forEach(function(_this){return function(arg){var key;return key=arg[0],arg[1],_this.form.answer_stats_export.question[key].cb.deselect(),_this.form.answer_stats_export.question[key].cb.disable()}}(this));var _this},AnswerStatsExportEditView.prototype.toggle_labels_cb=function(value,key){return+value?this.form.answer_stats_export.labels.link.show():this.form.answer_stats_export.labels.link.hide(),this.toggle_stat_cb(value,key)},AnswerStatsExportEditView.prototype.toggle_stat_cb=function(value,key){var expression;if(this.need_to_update_setting)return expression="this.setting.answer_stats_export."+key+" = "+value,eval(expression)},AnswerStatsExportEditView.prototype.unloaded=function(){return this.setting=null,AnswerStatsExportEditView.__super__.unloaded.apply(this,arguments)},AnswerStatsExportEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ChooseLabelsView=function(superClass){function ChooseLabelsView(){return ChooseLabelsView.__super__.constructor.apply(this,arguments)}return extend(ChooseLabelsView,superClass),ChooseLabelsView.prototype.default_controller=pi.controllers.ChooseLabels,ChooseLabelsView.prototype.loaded=function(params){var cb,j,len,ref,results;if(ChooseLabelsView.__super__.loaded.apply(this,arguments),this.setting=params.setting,this.report=params.report,this.setting[this.report].labels instanceof Array){for(results=[],j=0,len=(ref=this.form.list.items).length;j<len;j++)cb=ref[j],this.setting[this.report].labels.indexOf(cb.pid.split("id-").pop())>-1?results.push(cb.select()):results.push(cb.deselect());return results}if(!0===this.setting[this.report].labels)return this.form.list.items.forEach(function(cb){return cb.select()})},ChooseLabelsView.prototype.close=function(){var _this;return Object.entries(this.form.value()).forEach((_this=this,function(arg){var i,id,key,value;if(key=arg[0],value=arg[1],id=key.split("id-").pop(),1==!!+value){if(!(_this.setting[_this.report].labels instanceof Array))return _this.setting[_this.report].labels=[id];if(indexOf.call(_this.setting[_this.report].labels,id)<0)return _this.setting[_this.report].labels.push(id)}else if(_this.setting[_this.report].labels instanceof Array&&-1!==(i=_this.setting[_this.report].labels.indexOf(id)))return _this.setting[_this.report].labels.splice(i,1)})),ChooseLabelsView.__super__.close.apply(this,arguments)},ChooseLabelsView.prototype.unloaded=function(){return ChooseLabelsView.__super__.unloaded.apply(this,arguments),this.form.clear()},ChooseLabelsView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CourseStatsExportEditView=function(superClass){function CourseStatsExportEditView(){return CourseStatsExportEditView.__super__.constructor.apply(this,arguments)}return extend(CourseStatsExportEditView,superClass),CourseStatsExportEditView.include(pi.BaseView.Loadable),CourseStatsExportEditView.requires("form"),CourseStatsExportEditView.prototype.default_controller=pi.controllers.CourseStatsExportEdit,CourseStatsExportEditView.prototype.loaded=function(setting){if(this.setting=setting,CourseStatsExportEditView.__super__.loaded.apply(this,arguments),null!=this.setting)return this.fill_form(),this.need_to_update_setting=!0},CourseStatsExportEditView.prototype.fill_form=function(){var _this;if(Object.entries(this.setting.course_stats_export).forEach((_this=this,function(arg){var key;return key=arg[0],arg[1]?_this.form.course_stats_export[key].cb.select():_this.form.course_stats_export[key].cb.deselect()})),"object"==typeof this.setting.course_stats_export.quizzes)return Object.entries(this.setting.course_stats_export.quizzes).forEach(function(_this){return function(arg){var key;return key=arg[0],!0===arg[1]?(_this.form.course_stats_export.quizzes.cb.select(),_this.form.course_stats_export.quizzes[key].cb.select()):_this.form.course_stats_export.quizzes[key].cb.deselect()}}(this))},CourseStatsExportEditView.prototype.toggle_stat_quizzes_cb=function(value){return value?Object.entries(this.setting.course_stats_export.quizzes).forEach((_this=this,function(arg){var key;return key=arg[0],arg[1],_this.form.course_stats_export.quizzes[key].cb.enable()})):Object.entries(this.setting.course_stats_export.quizzes).forEach(function(_this){return function(arg){var key;return key=arg[0],arg[1],_this.form.course_stats_export.quizzes[key].cb.deselect(),_this.form.course_stats_export.quizzes[key].cb.disable()}}(this));var _this},CourseStatsExportEditView.prototype.toggle_labels_cb=function(value,key){return+value?this.form.course_stats_export.labels.link.show():this.form.course_stats_export.labels.link.hide(),this.toggle_stat_cb(value,key)},CourseStatsExportEditView.prototype.toggle_stat_cb=function(value,key){var expression;if(this.need_to_update_setting)return expression="this.setting.course_stats_export."+key+" = "+value,eval(expression)},CourseStatsExportEditView.prototype.unloaded=function(){return this.setting=null,CourseStatsExportEditView.__super__.unloaded.apply(this,arguments)},CourseStatsExportEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SurveyEditView=function(superClass){function SurveyEditView(){return SurveyEditView.__super__.constructor.apply(this,arguments)}return extend(SurveyEditView,superClass),SurveyEditView.include(pi.BaseView.Loadable,pi.BaseView.Listable),SurveyEditView.requires("form"),SurveyEditView.prototype.default_controller=pi.controllers.SurveyEdit,SurveyEditView.prototype.loaded=function(survey){if(SurveyEditView.__super__.loaded.apply(this,arguments),null!=survey)return this.form.value(survey),this.load_fields(survey),this.info.render(survey)},SurveyEditView.prototype.load_fields=function(survey){return this.list.restful.bind(survey.fields(),!0)},SurveyEditView.prototype.ensure_sorted=function(){return this.list.sort({position:"asc"})},SurveyEditView.prototype.activate_item=function(index){var item;if(item=this.list.items[index],this.list.edit_item(item),null!=item)return pi.Nod.win.scrollToNod(item)},SurveyEditView.prototype.enable_preview=function(){},SurveyEditView.prototype.disable_preview=function(){},SurveyEditView.prototype.unloaded=function(){return SurveyEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.options_field.deactivate(),this.list.restful.bind(null),this.list.clear(),this.info.render(null)},SurveyEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SurveyFillView=function(superClass){function SurveyFillView(){return SurveyFillView.__super__.constructor.apply(this,arguments)}return extend(SurveyFillView,superClass),SurveyFillView.include(pi.BaseView.Loadable),SurveyFillView.requires("form"),SurveyFillView.prototype.default_controller=pi.controllers.SurveyFill,SurveyFillView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}
for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductBuyView=function(superClass){function ProductBuyView(){return ProductBuyView.__super__.constructor.apply(this,arguments)}return extend(ProductBuyView,superClass),ProductBuyView.prototype.default_controller=pi.controllers.ProductBuy,ProductBuyView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductEditView=function(superClass){function ProductEditView(){return ProductEditView.__super__.constructor.apply(this,arguments)}return extend(ProductEditView,superClass),ProductEditView.include(pi.BaseView.Loadable,pi.BaseView.Coverable,pi.BaseView.Listable),ProductEditView.requires("form"),ProductEditView.prototype.default_controller=pi.controllers.ProductEdit,ProductEditView.prototype.postinitialize=function(){return ProductEditView.__super__.postinitialize.apply(this,arguments),this.survey_field=this.find(".survey-field")},ProductEditView.prototype.loaded=function(product1){var ref,ref1,ref2;if(this.product=product1,ProductEditView.__super__.loaded.apply(this,arguments),null!=this.product)return this.product._persisted?this.removeClass("is-new"):this.addClass("is-new"),this.form.value(this.product),this.list.restful.bind(null),null!=(ref=this.form.cover)&&ref.load(this.product.cover_url),null!=(ref1=this.form.bg)&&ref1.load(this.product.bg_url),null!=(ref2=this.form.survey)&&ref2.restful.bind(this.product,!0),this.load_participants(this.product),this.product.free&&this.form.amount_txt.disable(),this.link_update()},ProductEditView.prototype.link_update=function(){return this.form.link.hide(),this.form.link.copy_txt.text(""),this.product._persisted?(this.form.link.copy_txt.text(this.product.url),this.form.link.show()):this.form.link.copy_txt.text("")},ProductEditView.prototype.slug_updated=function(){return this.form.link.value(this.product.url,this.product.slug),this.form.link.cancel()},ProductEditView.prototype.unloaded=function(){var ref;return ProductEditView.__super__.unloaded.apply(this,arguments),this.product.participants().off("update",this.participants_handler()),null!=(ref=this.form.survey)&&ref.restful.bind(null),this.form.amount_txt.enable(),this.form.clear(),this.list.restful.bind(null),this.list.clear()},ProductEditView.prototype.participants_handler=function(){return this._participants_handler||(this._participants_handler=(_this=this,function(){var ref,ref1;return _this.product.participants().all().length?null!=(ref=_this.search_txt)?ref.show():void 0:null!=(ref1=_this.search_txt)?ref1.hide():void 0}));var _this},ProductEditView.prototype.load_participants=function(product){return this.list.restful.bind(product.participants(),!0),product.participants().on("update",this.participants_handler()),this.participants_handler()()},ProductEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ProductsView=function(superClass){function ProductsView(){return ProductsView.__super__.constructor.apply(this,arguments)}return extend(ProductsView,superClass),ProductsView.prototype.default_controller=pi.controllers.Products,ProductsView.prototype.filtered=function(){return utils.debug("filter data")},ProductsView.prototype.load=function(data){return!this._first_loaded&&data&&(data.length||this.list.addClass("is-empty"),this._first_loaded=!0),ProductsView.__super__.load.apply(this,arguments)},ProductsView.alias("filter","filtered"),ProductsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ProductsOrdersView=function(superClass){function ProductsOrdersView(){return ProductsOrdersView.__super__.constructor.apply(this,arguments)}return extend(ProductsOrdersView,superClass),ProductsOrdersView.prototype.default_controller=pi.controllers.ProductsOrders,ProductsOrdersView.prototype.filtered=function(){return utils.debug("filter data")},ProductsOrdersView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductsOrderShowView=function(superClass){function ProductsOrderShowView(){return ProductsOrderShowView.__super__.constructor.apply(this,arguments)}return extend(ProductsOrderShowView,superClass),ProductsOrderShowView.prototype.default_controller=pi.controllers.ProductsOrderShow,ProductsOrderShowView.prototype.unloaded=function(){return ProductsOrderShowView.__super__.unloaded.apply(this,arguments)},ProductsOrderShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductResView=function(superClass){function ProductResView(){return ProductResView.__super__.constructor.apply(this,arguments)}return extend(ProductResView,superClass),ProductResView.prototype.default_controller=pi.controllers.ProductRes,ProductResView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductsPromoCodeEditView=function(superClass){function ProductsPromoCodeEditView(){return ProductsPromoCodeEditView.__super__.constructor.apply(this,arguments)}return extend(ProductsPromoCodeEditView,superClass),ProductsPromoCodeEditView.requires("form"),ProductsPromoCodeEditView.include(pi.BaseView.Loadable),ProductsPromoCodeEditView.prototype.default_controller=pi.controllers.ProductsPromoCodeEdit,ProductsPromoCodeEditView.prototype.loaded=function(data){if(ProductsPromoCodeEditView.__super__.loaded.apply(this,arguments),null!=data)return this.form.value(data),null==data.type?this.form.type_rg.value("percent"):void 0},ProductsPromoCodeEditView.prototype.unloaded=function(){return ProductsPromoCodeEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},ProductsPromoCodeEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ProductsPromoCodesView=function(superClass){function ProductsPromoCodesView(){return ProductsPromoCodesView.__super__.constructor.apply(this,arguments)}return extend(ProductsPromoCodesView,superClass),ProductsPromoCodesView.prototype.default_controller=pi.controllers.ProductsPromoCodes,ProductsPromoCodesView.prototype.filtered=function(){return utils.debug("filter data")},ProductsPromoCodesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductsSimpleBuyView=function(superClass){function ProductsSimpleBuyView(){return ProductsSimpleBuyView.__super__.constructor.apply(this,arguments)}return extend(ProductsSimpleBuyView,superClass),ProductsSimpleBuyView.prototype.default_controller=pi.controllers.ProductsSimpleBuy,ProductsSimpleBuyView.include(pi.BaseView.Loadable),ProductsSimpleBuyView.prototype.clear_errors=function(){return this.hasOwnProperty("user_exists_error")?this.user_exists_error.hide():this.form.user_exists_error.hide(),this.hide_promo_messages()},ProductsSimpleBuyView.prototype.hide_promo_messages=function(){var ref,ref1,ref2,ref3;return this.hasOwnProperty("invalid_code_error")?(null!=(ref=this.invalid_code_error)&&ref.hide(),null!=(ref1=this.success_promo)?ref1.hide():void 0):(null!=(ref2=this.form.invalid_code_error)&&ref2.hide(),null!=(ref3=this.form.success_promo)?ref3.hide():void 0)},ProductsSimpleBuyView.prototype.update_order=function(order){return this.hasOwnProperty("order_amount")?this.order_amount.html(order.amount_rubles):this.form.order_amount.html(order.amount_rubles)},ProductsSimpleBuyView.prototype.update_receipt_info=function(json){return this.ya_merchant_input.value(JSON.stringify(json))},ProductsSimpleBuyView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProductsStoreEditView=function(superClass){function ProductsStoreEditView(){return ProductsStoreEditView.__super__.constructor.apply(this,arguments)}return extend(ProductsStoreEditView,superClass),ProductsStoreEditView.include(pi.BaseView.Loadable,pi.BaseView.Coverable),ProductsStoreEditView.requires("form"),ProductsStoreEditView.prototype.default_controller=pi.controllers.ProductsStoreEdit,ProductsStoreEditView.prototype.loaded=function(store){if(this.store=store,ProductsStoreEditView.__super__.loaded.apply(this,arguments),null!=this.store)return this.form.value(this.store),this.form.cover.load(this.store.cover_url),this.form.bg.load(this.store.bg_url),this.form.link.copy_txt.text(this.store.url),this.form.link.show()},ProductsStoreEditView.prototype.slug_updated=function(){return this.form.link.value(this.store.url,this.store.slug),this.form.link.cancel()},ProductsStoreEditView.prototype.unloaded=function(){return ProductsStoreEditView.__super__.unloaded.apply(this,arguments),this.form.clear()},ProductsStoreEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.StoreView=function(superClass){function StoreView(){return StoreView.__super__.constructor.apply(this,arguments)}return extend(StoreView,superClass),StoreView.prototype.default_controller=pi.controllers.Store,StoreView.prototype.filtered=function(){return utils.debug("filter data")},StoreView.prototype.load=function(data){return!this._first_loaded&&data&&(data.length||this.list.addClass("is-empty"),this._first_loaded=!0),StoreView.__super__.load.apply(this,arguments)},StoreView.alias("filter","filtered"),StoreView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ClickmeetingMeetingApplicationsView=function(superClass){function ClickmeetingMeetingApplicationsView(){return ClickmeetingMeetingApplicationsView.__super__.constructor.apply(this,arguments)}return extend(ClickmeetingMeetingApplicationsView,superClass),ClickmeetingMeetingApplicationsView.prototype.default_controller=pi.controllers.ClickmeetingMeetingApplications,ClickmeetingMeetingApplicationsView.prototype.filtered=function(){return utils.debug("filter data")},ClickmeetingMeetingApplicationsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CourseApplicationsView=function(superClass){function CourseApplicationsView(){return CourseApplicationsView.__super__.constructor.apply(this,arguments)}return extend(CourseApplicationsView,superClass),CourseApplicationsView.prototype.default_controller=pi.controllers.CourseApplications,CourseApplicationsView.prototype.filtered=function(){return utils.debug("filter data")},CourseApplicationsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MeetBaseMeetingApplicationsView=function(superClass){function MeetBaseMeetingApplicationsView(){return MeetBaseMeetingApplicationsView.__super__.constructor.apply(this,arguments)}return extend(MeetBaseMeetingApplicationsView,superClass),MeetBaseMeetingApplicationsView.prototype.default_controller=pi.controllers.MeetBaseMeetingApplications,MeetBaseMeetingApplicationsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MeetingApplicationsView=function(superClass){function MeetingApplicationsView(){return MeetingApplicationsView.__super__.constructor.apply(this,arguments)}return extend(MeetingApplicationsView,superClass),MeetingApplicationsView.prototype.default_controller=pi.controllers.MeetingApplications,MeetingApplicationsView.prototype.filtered=function(){return utils.debug("filter data")},MeetingApplicationsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ProductApplicationsView=function(superClass){function ProductApplicationsView(){return ProductApplicationsView.__super__.constructor.apply(this,arguments)}return extend(ProductApplicationsView,superClass),ProductApplicationsView.prototype.default_controller=pi.controllers.ProductApplications,ProductApplicationsView.prototype.filtered=function(){return utils.debug("filter data")},ProductApplicationsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ApplicationShowView=function(superClass){function ApplicationShowView(){return ApplicationShowView.__super__.constructor.apply(this,arguments)}return extend(ApplicationShowView,superClass),ApplicationShowView.include(pi.BaseView.Loadable),ApplicationShowView.prototype.default_controller=pi.controllers.ApplicationShow,ApplicationShowView.prototype.loaded=function(app){return"pending"!==app.status?this.addClass("no-confirm"):this.removeClass("no-confirm"),ApplicationShowView.__super__.loaded.apply(this,arguments)},ApplicationShowView.prototype.load_lists=function(answers){return this.load_list(this.answers_list,answers)},ApplicationShowView.prototype.load_list=function(component,data){var i,item,len;for(i=0,len=data.length;i<len;i++)item=data[i],component.add_item(item,!0);return component.update()},ApplicationShowView.prototype.unloaded=function(){return ApplicationShowView.__super__.unloaded.apply(this,arguments),this.answers_list.clear()},ApplicationShowView}(pi.InfoPopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ScormPackageEditView=function(superClass){function ScormPackageEditView(){return ScormPackageEditView.__super__.constructor.apply(this,arguments)}return extend(ScormPackageEditView,superClass),ScormPackageEditView.include(pi.BaseView.Loadable),ScormPackageEditView.requires("form"),ScormPackageEditView.prototype.default_controller=pi.controllers.ScormPackageEdit,ScormPackageEditView.prototype.loaded=function(scorm_package){var params;if(ScormPackageEditView.__super__.loaded.apply(this,arguments),null!=scorm_package&&(this.form.value(scorm_package),null!=scorm_package.resource_url))return params={file_file_name:scorm_package.name,updated_at:scorm_package.updated_at,status:"finished"},this.add_attachment(params)},ScormPackageEditView.prototype.add_attachment=function(data){if("stopped"!==data.status)return"finished"===data.status?(this.form.uploaded_file.name.node.innerText="",this.form.uploaded_file.time.node.innerText="",this.form.uploaded_file.name.append(data.file_file_name),this.form.uploaded_file.time.append(this.parse_time(data.updated_at)),this.form.uploaded_file.show()):(this.form.uploaded_file.hide(),this.form.uploading_file.name.append(data.file_file_name),this.form.uploading_file.show(),this.form.upload_button.hide())},ScormPackageEditView.prototype.show_upload_button=function(){return this.form.uploading_file.name.text(""),this.form.uploading_file.hide(),this.form.uploaded_file.name.text(""),this.form.uploaded_file.time.text(""),this.form.uploaded_file.hide(),this.form.upload_button.show()},ScormPackageEditView.prototype.parse_time=function(str){var options;return options={year:"numeric",month:"numeric",day:"numeric",timezone:"UTC",hour:"numeric",minute:"numeric"},new Date(str).toLocaleString("ru",options)},ScormPackageEditView.prototype.unloaded=function(){return ScormPackageEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.show_upload_button()},ScormPackageEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ScormPackageShowView=function(superClass){function ScormPackageShowView(){return ScormPackageShowView.__super__.constructor.apply(this,arguments)}return extend(ScormPackageShowView,superClass),ScormPackageShowView.prototype.default_controller=pi.controllers.ScormPackageShow,ScormPackageShowView.prototype.wrapper_id="scorm-player",ScormPackageShowView.prototype.postinitialize=function(){var _this;return ScormPackageShowView.__super__.postinitialize.apply(this,arguments),this.scorm_player.attrs({id:this.wrapper_id}),window.addEventListener("resize",(_this=this,function(){return _this.adapt_player_height()})),this.scorm_player.on("fullscreenchange,webkitfullscreenchange,mozfullscreenchange,MSFullscreenChange",function(_this){return function(){return _this.scorm_player.toggleClass("fs")}}(this))},ScormPackageShowView.prototype.adapt_player_height=function(fh){var height;return this.frame_height=fh||this.frame_height,height=Math.max(this.frame_height,window.innerHeight,600),this.scorm_player.styles({height:height+"px"})},ScormPackageShowView.prototype.fullscreen=function(){var elem;return(elem=this.scorm_player.node).requestFullScreen?elem.requestFullScreen():elem.mozRequestFullScreen?elem.mozRequestFullScreen():elem.webkitRequestFullScreen?elem.webkitRequestFullScreen():void 0},ScormPackageShowView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ScormPackageTakeView=function(superClass){function ScormPackageTakeView(){return ScormPackageTakeView.__super__.constructor.apply(this,arguments)}return extend(ScormPackageTakeView,superClass),ScormPackageTakeView.prototype.default_controller=pi.controllers.ScormPackageTake,ScormPackageTakeView}(pi.ScormPackageShowView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ScormUploadView=function(superClass){function ScormUploadView(){return ScormUploadView.__super__.constructor.apply(this,arguments)}return extend(ScormUploadView,superClass),ScormUploadView.prototype.default_controller=pi.controllers.ScormUpload,ScormUploadView}(pi.UploadView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.RatingsView=function(superClass){function RatingsView(){return RatingsView.__super__.constructor.apply(this,arguments)}return extend(RatingsView,superClass),RatingsView.prototype.default_controller=pi.controllers.Ratings,RatingsView.prototype.ensure_session=function(id){var ref;return null!=(ref=this.session_select)?ref.value(id):void 0},RatingsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramEditView=function(superClass){function ProgramEditView(){return ProgramEditView.__super__.constructor.apply(this,arguments)}return extend(ProgramEditView,superClass),ProgramEditView.include(pi.BaseView.Loadable,pi.BaseView.Coverable,pi.BaseView.Listable),ProgramEditView.requires("form"),ProgramEditView.prototype.default_controller=pi.controllers.ProgramEdit,ProgramEditView.prototype.loaded=function(program1){return this.program=program1,ProgramEditView.__super__.loaded.apply(this,arguments),this.form.value(this.program),this.form.options_field.cover.load(this.program.cover_url),this.form.options_field.bg.load(this.program.bg_url),this.list.restful.bind(null),this.handle_nav_changed(this.program.navigation),this.program.infinitely||this.program.finished?this.form.finished_at_field.disable():this.form.finished_at_field.enable(),this.init_period_fields(),this.load_courses(this.program)},ProgramEditView.prototype.load_program=function(program1){return this.program=program1,ProgramEditView.__super__.load_program.apply(this,arguments),this.form.value(this.program),this.list.restful.bind(null),this.program.infinitely||this.program.finished?this.form.finished_at_field.disable():this.form.finished_at_field.enable(),this.init_period_fields(),this.load_courses(this.program)},ProgramEditView.prototype.load_courses=function(program){return this.list.restful.bind(program.courses(),!0)},ProgramEditView.prototype.empty_list_error=function(){return pi.Nod.win.scrollToNod(this.list),this.list_errors.addClass("inline"),this.list_errors.show()},ProgramEditView.prototype.handle_infinite_changed=function(infinitely){if(!this.program.finished)return infinitely?this.form.finished_at_field.disable():this.form.finished_at_field.enable()},ProgramEditView.prototype.init_period_fields=function(){if(this.program.is_periodic?this.form.period_cb.select():this.form.period.disable(),this.program.has_listeners)return this.form.period_cb.disable(),this.form.period.disable()},ProgramEditView.prototype.handle_period_change=function(with_period){return with_period?(this.form.period.enable(),this.form.infinite_cb.disable(),this.form.started_at_field.disable(),this.form.finished_at_field.disable()):(this.form.period.disable(),this.form.infinite_cb.enable(),this.form.started_at_field.enable(),this.form.finished_at_field.enable(),this.form.period.clear())},ProgramEditView.prototype.handle_nav_changed=function(nav){return nav===$r.CourseSession.INTERVAL_NAV?(this.form.options_field.interval.enable(),this.form.options_field.interval.show()):(this.form.options_field.interval.disable(),this.form.options_field.interval.hide())},ProgramEditView.prototype.unloaded=function(){return ProgramEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.enable(),this.form.finished_at_field.enable(),this.form.started_at_field.enable(),this.form.infinite_cb.enable(),this.form.period_cb.enable(),this.form.period.enable(),this.form.options_field.deactivate(),this.list_errors.hide(),this.list.restful.bind(null),this.list.clear()},ProgramEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramsView=function(superClass){function ProgramsView(){return ProgramsView.__super__.constructor.apply(this,arguments)}return extend(ProgramsView,superClass),ProgramsView.prototype.default_controller=pi.controllers.Programs,ProgramsView.prototype.postinitialize=function(){return ProgramsView.__super__.postinitialize.apply(this,arguments),this.list_filter=this.find(".list-filter")},ProgramsView.prototype.filtered=function(data){var ref;if(data?hash.add({filter:data}):hash.remove("filter"),data)return(ref=this.list_filter.where({record:{type:data}})).length?this.list_filter.select_item(ref[0],!0):void 0},ProgramsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ModeratedProgramsView=function(superClass){function ModeratedProgramsView(){return ModeratedProgramsView.__super__.constructor.apply(this,arguments)}return extend(ModeratedProgramsView,superClass),ModeratedProgramsView.prototype.default_controller=pi.controllers.ModeratedPrograms,ModeratedProgramsView.include(pi.CourseTypesFilterView),ModeratedProgramsView.prototype.postinitialize=function(){return ModeratedProgramsView.__super__.postinitialize.apply(this,arguments),this.list_filter=this.find(".list-filter")},ModeratedProgramsView.prototype.filtered=function(data){var ref;if(data?hash.add({filter:data}):hash.remove("filter"),data)return(ref=this.list_filter.where({record:{type:data}})).length?this.list_filter.select_item(ref[0],!0):void 0},ModeratedProgramsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramEditParticipantsView=function(superClass){function ProgramEditParticipantsView(){return ProgramEditParticipantsView.__super__.constructor.apply(this,arguments)}return extend(ProgramEditParticipantsView,superClass),ProgramEditParticipantsView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ProgramEditParticipantsView.prototype.default_controller=pi.controllers.ProgramEditParticipants,ProgramEditParticipantsView.prototype.load_program=function(program){if(this.program=program,null!=this.program)return this.list.restful.bind(this.program.participants(),!0)},ProgramEditParticipantsView.prototype.unloaded=function(){return ProgramEditParticipantsView.__super__.unloaded.apply(this,arguments),this.list.restful.bind(null),this.list.clear()},ProgramEditParticipantsView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SelectCoursesView=function(superClass){function SelectCoursesView(){return SelectCoursesView.__super__.constructor.apply(this,arguments)}return extend(SelectCoursesView,superClass),SelectCoursesView.include(pi.BaseView.Loadable,pi.BaseView.Listable),SelectCoursesView.prototype.default_controller=pi.controllers.SelectCourses,SelectCoursesView.prototype.loaded=function(data){var courses;return SelectCoursesView.__super__.loaded.apply(this,arguments),(null!=(courses=data.courses)?courses.length:void 0)>0&&(this._ids=courses.map(function(course){return course.id}),this.disable_selected()),this.list.scroll_end.enable()},SelectCoursesView.prototype.unloaded=function(){var i,len,ref;for(SelectCoursesView.__super__.unloaded.apply(this,arguments),this._ids=null,this.list.clear_selection(),i=0,len=(ref=this.list.items).length;i<len;i++)ref[i].enable();return this.list.scroll_end.disable()},SelectCoursesView.prototype.load=function(data){return pi.BaseView.Listable.prototype.load.call(this,data),this.disable_selected()},SelectCoursesView.prototype.reload=function(data){return pi.BaseView.Listable.prototype.reload.call(this,data),this.disable_selected()},SelectCoursesView.prototype.disable_selected=function(){var i,item,len,ref,ref1,results;if(null!=this._ids){for(results=[],i=0,len=(ref=this.list.items).length;i<len;i++)ref1=(item=ref[i]).record.id,indexOf.call(this._ids,ref1)>=0&&results.push(item.disable());return results}},SelectCoursesView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){
this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramSelectView=function(superClass){function ProgramSelectView(){return ProgramSelectView.__super__.constructor.apply(this,arguments)}return extend(ProgramSelectView,superClass),ProgramSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),ProgramSelectView.prototype.default_controller=pi.controllers.ProgramSelect,ProgramSelectView.prototype.loaded=function(){return ProgramSelectView.__super__.loaded.apply(this,arguments),this.list.scroll_end.enable()},ProgramSelectView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.scroll_end.disable(),ProgramSelectView.__super__.unloaded.apply(this,arguments)},ProgramSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramShowView=function(superClass){function ProgramShowView(){return ProgramShowView.__super__.constructor.apply(this,arguments)}return extend(ProgramShowView,superClass),ProgramShowView.prototype.default_controller=pi.controllers.ProgramShow,ProgramShowView.prototype.loaded=function(){return this.check_arrows(pi.app.program),ProgramShowView.__super__.loaded.apply(this,arguments)},ProgramShowView.prototype.check_arrows=function(program){var listeners;return listeners=program.participants().where({role_id:1}),1===program.program_navigation&&0===listeners.length||0===program.program_navigation?this.show_arrows():this.hide_arrows()},ProgramShowView.prototype.show_arrows=function(){return this.action_group.node.querySelectorAll(".move-btb").forEach(function(btn){return btn.classList.remove("is-hidden")})},ProgramShowView.prototype.hide_arrows=function(){return this.action_group.node.querySelectorAll(".move-btb").forEach(function(btn){return btn.classList.add("is-hidden")})},ProgramShowView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AssignmentRuleEditView=function(superClass){function AssignmentRuleEditView(){return AssignmentRuleEditView.__super__.constructor.apply(this,arguments)}return extend(AssignmentRuleEditView,superClass),AssignmentRuleEditView.include(pi.BaseView.Loadable),AssignmentRuleEditView.requires("form"),AssignmentRuleEditView.prototype.default_controller=pi.controllers.AssignmentRuleEdit,AssignmentRuleEditView.prototype.loaded=function(data){if(AssignmentRuleEditView.__super__.loaded.apply(this,arguments),null!=data)return this.form.value(data),data._persisted?this.apply_btn.show():this.apply_btn.hide()},AssignmentRuleEditView.prototype.load_labels_list=function(component,data){var item,j,len;for(data instanceof Array||(data=[data]),component.clear(),j=0,len=data.length;j<len;j++)item=data[j],component.add_item(item,!0);return component.update()},AssignmentRuleEditView.prototype.load_events_list=function(component,data){var item,j,len,loaded_ids;for(loaded_ids=component.items.map(function(e){return e.record.id}),data instanceof Array||(data=[data]),j=0,len=data.length;j<len;j++)item=data[j],-1===loaded_ids.indexOf(item.id)&&component.add_item(item,!0);return component.update()},AssignmentRuleEditView.prototype.unloaded=function(){return AssignmentRuleEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.labels_list.clear(),this.sessions_list.clear(),this.programs_list.clear()},AssignmentRuleEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AssignmentRulesView=function(superClass){function AssignmentRulesView(){return AssignmentRulesView.__super__.constructor.apply(this,arguments)}return extend(AssignmentRulesView,superClass),AssignmentRulesView.prototype.default_controller=pi.controllers.AssignmentRules,AssignmentRulesView.prototype.loaded=function(){return AssignmentRulesView.__super__.loaded.apply(this,arguments)},AssignmentRulesView.prototype.filtered=function(){return utils.debug("filter data")},AssignmentRulesView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ProgramSessionEditView=function(superClass){function ProgramSessionEditView(){return ProgramSessionEditView.__super__.constructor.apply(this,arguments)}return extend(ProgramSessionEditView,superClass),ProgramSessionEditView.requires("form"),ProgramSessionEditView.prototype.default_controller=pi.controllers.ProgramSessionEdit,ProgramSessionEditView.prototype.load_session=function(session){if(this.session=session,null!=this.session)return this.form.value(this.session),this.session.infinitely||this.session.finished?this.form.finished_at_field.disable():this.form.finished_at_field.enable(),this.form.finish.show(),this.session.finished&&this.form.finish.hide(),this.init_period_fields()},ProgramSessionEditView.prototype.handle_infinite_changed=function(infinitely){if(!this.session.finished)return infinitely?this.form.finished_at_field.disable():this.form.finished_at_field.enable()},ProgramSessionEditView.prototype.init_period_fields=function(){if(this.session.period?(this.form.period_cb.select(),this.form.infinite_cb.disable(),this.form.started_at_field.disable(),this.form.finished_at_field.disable()):this.form.find(".period-wrapper").hide(),this.form.period_cb.disable(),this.session.has_listeners)return this.form.period.disable()},ProgramSessionEditView.prototype.unloaded=function(){return ProgramSessionEditView.__super__.unloaded.apply(this,arguments),this.form.clear(),this.form.enable(),this.form.finish.show(),this.form.finished_at_field.enable(),this.form.started_at_field.enable(),this.form.infinite_cb.enable()},ProgramSessionEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CompetencesEditView=function(superClass){function CompetencesEditView(){return CompetencesEditView.__super__.constructor.apply(this,arguments)}return extend(CompetencesEditView,superClass),CompetencesEditView.prototype.default_controller=pi.controllers.CompetencesEdit,CompetencesEditView.include(pi.BaseView.Loadable),CompetencesEditView.prototype.loaded=function(params){return null==params&&(params={}),this.removeClass("is-readonly","is-selecting","is-updating"),this.mode=params.mode||"select","select"===this.mode?(this.list.selectable.disable(),this.addClass("is-readonly","is-selecting")):this.list.selectable.enable(),CompetencesEditView.__super__.loaded.apply(this,arguments)},CompetencesEditView.prototype.competence_updated=function(){return this.list.finish_edit()},CompetencesEditView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuestionCategoriesEditView=function(superClass){function QuestionCategoriesEditView(){return QuestionCategoriesEditView.__super__.constructor.apply(this,arguments)}return extend(QuestionCategoriesEditView,superClass),QuestionCategoriesEditView.prototype.default_controller=pi.controllers.QuestionCategoriesEdit,QuestionCategoriesEditView.prototype.loaded=function(params){var i,item,len,ref;for(null==params&&(params={}),this.reload_question=!1,this.context_controller=params.context_controller,i=0,len=(ref=params.categories).length;i<len;i++)item=ref[i],this.list.add_item(item);return QuestionCategoriesEditView.__super__.loaded.apply(this,arguments)},QuestionCategoriesEditView.prototype.unloaded=function(params){return null==params&&(params={}),QuestionCategoriesEditView.__super__.unloaded.apply(this,arguments),this.list.clear(),this.reload_question&&this.context_controller.reload_questions(),this.reload_question=!1},QuestionCategoriesEditView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CongregationAddIntersectionView=function(superClass){function CongregationAddIntersectionView(){return CongregationAddIntersectionView.__super__.constructor.apply(this,arguments)}return extend(CongregationAddIntersectionView,superClass),CongregationAddIntersectionView.include(pi.BaseView.Listable),CongregationAddIntersectionView.prototype.default_controller=pi.controllers.CongregationAddIntersection,CongregationAddIntersectionView.prototype.group_cb_checked=function(id){var item;return item=this.list.find_by_id(id),this.list.select_item(item)},CongregationAddIntersectionView.prototype.group_cb_unchecked=function(id){var item;return item=this.list.find_by_id(id),this.list.deselect_item(item)},CongregationAddIntersectionView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.items.forEach(function(item){return pi.Nod.create(item.node.childNodes[0]).deselect()}),CongregationAddIntersectionView.__super__.unloaded.apply(this,arguments)},CongregationAddIntersectionView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CongregationEditView=function(superClass){function CongregationEditView(){return CongregationEditView.__super__.constructor.apply(this,arguments)}return extend(CongregationEditView,superClass),CongregationEditView.requires("form"),CongregationEditView.prototype.default_controller=pi.controllers.CongregationEdit,CongregationEditView.prototype.loaded=function(rules){return this.rules=rules,this.set_values(),CongregationEditView.__super__.loaded.apply(this,arguments)},CongregationEditView.prototype.set_values=function(){var groups,labels;return groups=[],labels=[],this.rules.forEach(function(r){return(Object.values(r.labels).flat().length?labels:groups).push(r)}),groups=groups.flatMap(function(r){return Object.keys(r.labels)}),labels=labels.flatMap(function(r){return Object.values(r.labels)}),this.set_form_values(groups,labels)},CongregationEditView.prototype.set_form_values=function(groups,labels){var values,_this;return groups=groups.flat().map(function(id){return"group-"+id}),(labels=labels.flat().map(function(id){return"label-"+id})).forEach((_this=this,function(l){return _this.label_cb_checked(l)})),values={},groups.concat(labels).forEach(function(key){return values[key]=!0}),this.form.value(values)},CongregationEditView.prototype.group_cb_checked=function(pid){var i,label,len,ref,results;for(results=[],i=0,len=(ref=this.form.labels.list.items.find(function(l){return l.pid===pid}).list.items).length;i<len;i++)label=ref[i],results.push(pi.Nod.create(label.node.children[0]).deselect());return results},CongregationEditView.prototype.label_cb_checked=function(pid){var group,group_id,id,label;if(id=Number(pid.split("-").pop()),(label=$r.Label.get(id))&&(group_id=label.group_id,group=this.find_group(group_id)))return group.activate(),pi.Nod.create(group.node.children[0]).deselect()},CongregationEditView.prototype.find_group=function(id){return this.form.labels.list.items.find(function(l){return l.pid==="group-"+id})},CongregationEditView.prototype.result=function(){var arr,_this;return arr=[],this.form.labels.list.items.forEach((_this=this,function(group){var group_id,rule,rule_id,subgroups;return group_id=group.options.item_id,rule_id=(rule=_this.rules.find(function(r){return r.labels[group_id]}))&&rule.id,group.cb.__selected__?arr.push({id:rule_id,groups:[{id:group_id,select_all:!0}]}):(subgroups=[],group.list.items.forEach(function(subgroup){if(subgroup.cb.__selected__)return subgroups.push(subgroup.options.item_id)}),subgroups.length?arr.push({id:rule_id,groups:[{id:group_id,subgroups:subgroups}]}):void 0)})),arr},CongregationEditView.prototype.unloaded=function(){return this.form.clear(),CongregationEditView.__super__.unloaded.apply(this,arguments)},CongregationEditView}(pi.LeftbarView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MeetBaseSelectView=function(superClass){function MeetBaseSelectView(){return MeetBaseSelectView.__super__.constructor.apply(this,arguments)}return extend(MeetBaseSelectView,superClass),MeetBaseSelectView.include(pi.BaseView.Loadable,pi.BaseView.Listable),MeetBaseSelectView.prototype.default_controller=pi.controllers.MeetBaseSelect,MeetBaseSelectView.prototype.loaded=function(){return MeetBaseSelectView.__super__.loaded.apply(this,arguments),this.list.scroll_end.enable()},MeetBaseSelectView.prototype.unloaded=function(){return this.list.clear_selection(),this.list.scroll_end.disable(),MeetBaseSelectView.__super__.unloaded.apply(this,arguments)},MeetBaseSelectView}(pi.PopupView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.WebinarApplyView=function(superClass){function WebinarApplyView(){return WebinarApplyView.__super__.constructor.apply(this,arguments)}return extend(WebinarApplyView,superClass),WebinarApplyView.prototype.default_controller=pi.controllers.WebinarApplyController,WebinarApplyView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.WebinarRegisterView=function(superClass){function WebinarRegisterView(){return WebinarRegisterView.__super__.constructor.apply(this,arguments)}return extend(WebinarRegisterView,superClass),WebinarRegisterView.include(pi.BaseView.Loadable),WebinarRegisterView.prototype.default_controller=pi.controllers.WebinarApplyController,WebinarRegisterView.prototype.loaded=function(){return this.show()},WebinarRegisterView.prototype.unloaded=function(){return this.hide()},WebinarRegisterView}(pi.BaseView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.RestoreCourseStatsView=function(superClass){function RestoreCourseStatsView(){return RestoreCourseStatsView.__super__.constructor.apply(this,arguments)}return extend(RestoreCourseStatsView,superClass),RestoreCourseStatsView.prototype.default_controller=pi.controllers.RestoreCourseStatsController,RestoreCourseStatsView}(pi.ListView)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi=context.pi||{},utils=pi.utils,pi.Base.Bubbleable=function(superClass){function Bubbleable(){return Bubbleable.__super__.constructor.apply(this,arguments)}return extend(Bubbleable,superClass),Bubbleable.prototype.id="bubbleable",Bubbleable.prototype.initialize=function(target){var _this;return this.target=target,Bubbleable.__super__.initialize.apply(this,arguments),this.bubbling=!1,this.bubble_object=this.target.options.bubble_object?$(this.target.options.bubble_object):this.target.view(),this.scroll_object=pi.Nod.root,this.target.on("hidden,enabled",(_this=this,function(e){return e.data===("hidden"===e.type)?_this.unwatch():_this.watch()})),this.target.enabled&&this.target.visible&&this.watch(),this},Bubbleable.prototype.scroll_active_listener=function(){return this._scroll_active_listener||(this._scroll_active_listener=debounce(300,(_this=this,function(){if(_this.orig_top>_this.scroll_object.scrollTop())return _this.stop_bubbling()})));var _this},Bubbleable.prototype.scroll_inactive_listener=function(){return this._scroll_inactive_listener||(this._scroll_inactive_listener=debounce(300,(_this=this,function(){var _y;if((_y=_this.target.y())>0&&_y<_this.scroll_object.scrollTop())return _this.start_bubbling()})));var _this},Bubbleable.prototype.resize_handler=function(){return this._resize_handler||(this._resize_handler=utils.debounce(500,(_this=this,function(){return _this.target.moveX(Math.max(Math.min(_this.bubble_object.position().x-_this.delta,pi.Nod.win.width()-_this.target.width()),0))})));var _this},Bubbleable.prototype.watch=function(){if(!this.watching)return this.watching=!0,pi.Nod.win.on("scroll",this.scroll_inactive_listener()),this.scroll_inactive_listener()()},Bubbleable.prototype.unwatch=function(){if(this.watching)return this.bubbling||pi.Nod.win.off("scroll",this.scroll_inactive_listener()),this.stop_bubbling(),this.watching=!1},Bubbleable.prototype.start_bubbling=function(){var ref,_this;if(!this.bubbling)return pi.Nod.win.off("scroll",this.scroll_inactive_listener()),this.bubble_object&&(this.delta=this.bubble_object.position().x-this.target.position().x,this.target.moveX(this.target.position().x),pi.Nod.win.on("resize",this.resize_handler())),this.orig_top=this.target.y()+this.target.height(),this.target.addClass("is-bubbling"),null!=(ref=this.target.parent())&&ref.style("overflow","visible"),this.bubbling=!0,after(500,(_this=this,function(){return pi.Nod.win.on("scroll",_this.scroll_active_listener())}))},Bubbleable.prototype.stop_bubbling=function(){var ref,_this;if(this.bubbling&&(pi.Nod.win.off("scroll",this.scroll_active_listener()),null!=(ref=this.target.parent())&&ref.style("overflow",null),this.target.removeClass("is-bubbling"),this.bubbling=!1,this.bubble_object&&(this.target.style("left",null),pi.Nod.win.off("resize",this.resize_handler())),this.watching))return after(500,(_this=this,function(){return pi.Nod.win.on("scroll",_this.scroll_inactive_listener())}))},Bubbleable}(pi.Plugin)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ActionGroup=function(superClass){function ActionGroup(){return ActionGroup.__super__.constructor.apply(this,arguments)}return extend(ActionGroup,superClass),ActionGroup.include_plugins(pi.Base.Bubbleable),ActionGroup.prototype.postinitialize=function(){return ActionGroup.__super__.postinitialize.apply(this,arguments),null!=this.options.resolver&&(this.resolver=pi.resolvers[utils.camelCase(this.options.resolver)]),this.parent().style("display","none")},ActionGroup.prototype.show=function(data){return this._tid&&clearTimeout(this._tid),null!=this.resolver&&this.resolver.resolve(this,data),this.parent().style("display","inline-block"),this._tid=utils.after(100,(_this=this,function(){return ActionGroup.__super__.show.apply(_this,arguments)}));var _this},ActionGroup.prototype.hide=function(){return this._tid&&clearTimeout(this._tid),null!=this.resolver&&this.resolver.off(this),ActionGroup.__super__.hide.apply(this,arguments),this._tid=utils.after(500,(_this=this,function(){return _this.parent().style("display","none")}));var _this},ActionGroup}(pi.Base)}(this),pi.Guesser.rules_for("action_group",["pi-action-group"],null,function(nod){return"action_group"===nod.attr("pid")||"action_group"===nod.data("pid")})}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ActiveThumb=function(superClass){function ActiveThumb(){return ActiveThumb.__super__.constructor.apply(this,arguments)}return extend(ActiveThumb,superClass),ActiveThumb.prototype.postinitialize=function(){return ActiveThumb.__super__.postinitialize.apply(this,arguments),this.image=this.find("img")},ActiveThumb.prototype.load=function(url){return url?(this.image.one("load",(_this=this,function(){return _this.activate()})),this.image.one("error",function(_this){return function(e){return utils.local_error(e),_this.deactivate()}}(this)),this.image.node.src=url):this.deactivate();var _this},ActiveThumb.prototype.deactivate=function(){return ActiveThumb.__super__.deactivate.apply(this,arguments),this.image.node.src=""},ActiveThumb}(pi.Base),pi.Guesser.rules_for("active_thumb",["pi-thumb"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AddItemLink=function(superClass){function AddItemLink(){return AddItemLink.__super__.constructor.apply(this,arguments)}return extend(AddItemLink,superClass),AddItemLink.requires("link","form","submit_btn","cancel_btn"),AddItemLink.prototype.postinitialize=function(){return this.form.former.options.clear_hidden=!1,this.on("click",function(e){return e.cancel()}),this.link.on("click",(_this=this,function(){return _this.activate()}));var _this},AddItemLink.prototype.activate=function(){var _this;return this.submit_btn.on("click",(_this=this,function(){return _this.submit()})),this.cancel_btn.on("click",function(_this){return function(){return _this.deactivate()}}(this)),AddItemLink.__super__.activate.apply(this,arguments)},AddItemLink.prototype.deactivate=function(){return this.link.show(),this.form.clear(),this.cancel_btn.off(),this.submit_btn.off(),AddItemLink.__super__.deactivate.apply(this,arguments)},AddItemLink.prototype.submit=function(){if(this.form.read_values(),!0===this.form.validate())return this.trigger("submit",this.form.value()),this.deactivate()},AddItemLink}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AddMaterial=function(superClass){function AddMaterial(){return AddMaterial.__super__.constructor.apply(this,arguments)}return extend(AddMaterial,superClass),AddMaterial.prototype.activate=function(){return this.form.material_default_choose&&(this.form.material_default_choose.value("file"),this.form.removeClass("is-text")),AddMaterial.__super__.activate.apply(this,arguments)},AddMaterial.prototype.deactivate=function(){return this.form.markdown_editor&&this.form.markdown_editor.clear(),AddMaterial.__super__.deactivate.apply(this,arguments)},AddMaterial}(pi.AddItemLink)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AttentionModal=function(superClass){function AttentionModal(){return AttentionModal.__super__.constructor.apply(this,arguments)}return extend(AttentionModal,superClass),AttentionModal.prototype.initialize=function(){return this.message_cont=this.find(".message"),AttentionModal.__super__.initialize.apply(this,arguments)},AttentionModal.prototype.init=function(message){return this.message_cont.remove_children(),this.message_cont.append(message)},AttentionModal.prototype.clear=function(){return this.message_cont.remove_children()},AttentionModal.prototype.confirm=function(){return this.host.popup.handle_close()},AttentionModal}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.AutocompleteEgrul=function(superClass){function AutocompleteEgrul(){return AutocompleteEgrul.__super__.constructor.apply(this,arguments)}return extend(AutocompleteEgrul,superClass),AutocompleteEgrul.prototype.postinitialize=function(){return AutocompleteEgrul.__super__.postinitialize.apply(this,arguments),this.token=document.getElementById("dadata_token").value,this.endpoint=document.getElementById("dadata_endpoint").value,pi.Net.headers.Authorization="Token "+this.token,pi.Net.headers["Content-Type"]="application/json",pi.Net.headers.Accept="application/json",this.auto\u0441omplete=new autoComplete({selector:".autocomplete-input",minChars:1,source:(_this=this,function(term,response){var xhr;try{return xhr.abort()}catch(error){error,xhr=pi.Net.post(_this.endpoint,{query:term}).then(function(data){if(null!=(null!=data?data.errorMessage:void 0))throw Error(data.errorMessage);return response(data.suggestions||[])})}}),renderItem:function(item,search){var re;return search=search.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),re=new RegExp("("+search.split(" ").join("|")+")","gi"),JST["templates/shared/autocomplete_suggestion_item"]({item:item,search:item.value.replace(re,"<b>$1</b>")})},onSelect:function(_this){return function(e,term,item){_this.fill_agreement_fields(item)}}(this)});var _this},AutocompleteEgrul.prototype.fill_agreement_fields=function(selected_item){return["company","individual_entrepreneur","tax_number","kpp","ogrn","legal_address","opf","owner_name","owner_position"].forEach((_this=this,function(item){_this.find("#"+item).value(selected_item.getAttribute(item))}));var _this},AutocompleteEgrul.prototype.destroy=function(){return this.auto\u0441omplete.destroy()},AutocompleteEgrul.prototype.match_addresses=function(flag){if(!0===flag)return this.find("#address").value(this.find("#legal_address").value())},AutocompleteEgrul.prototype.legal_address_changed=function(){return this.match_addresses("true"===this.find("#coincides_with_the_legal_address").value())},AutocompleteEgrul}(pi.BaseInput)}(this),pi.Guesser.rules_for("autocomplete_egrul",["pi-autocomplete-egrul"])}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,/^(a|button)$/i,pi.Callout=function(superClass){function Callout(){return Callout.__super__.constructor.apply(this,arguments)}return extend(Callout,superClass),Callout.prototype.postinitialize=function(){return Callout.__super__.postinitialize.apply(this,arguments)},Callout.prototype.show=function(){var _this;return this.on("click",this.click_handler()),after(0,(_this=this,function(){return pi.Nod.root.one("click",function(e){return _this.hide(),e.stopImmediatePropagation()},_this,function(e){return e.target===_this||!(e.target instanceof pi.Callout)})})),Callout.__super__.show.apply(this,arguments)},Callout.prototype.click_handler=function(){return this._click_handler||(this._click_handler=function(e){if(!(e.target instanceof pi.Callout))return e.stopImmediatePropagation()})},Callout.prototype.hide=function(){return this.off("click",this.click_handler()),Callout.__super__.hide.apply(this,arguments)},Callout}(pi.Base),pi.Guesser.rules_for("callout",["pi-callout"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},slice=[].slice;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.BaseChart=function(superClass){function BaseChart(){return BaseChart.__super__.constructor.apply(this,arguments)}return extend(BaseChart,superClass),BaseChart.prototype.preinitialize=function(){return BaseChart.__super__.preinitialize.apply(this,arguments),this.has_renderable=!0},BaseChart.prototype.postinitialize=function(){var _colors,_names,i,j,key,len,ref;if(BaseChart.__super__.postinitialize.apply(this,arguments),this.type||(this.type=this.options.type),null!=this.options.keys&&(this.keys=this.options.keys.split(/\s+/)),this.keys)for(null!=this.options.names&&(_names=this.options.names.split(/\s*\|\|\s*/)),null!=this.options.colors&&(_colors=this.options.colors.split(/\s+/)),_names&&(this.names={}),_colors&&(this.colors={}),i=j=0,len=(ref=this.keys).length;j<len;i=++j)key=ref[i],_names&&(this.names[key]=_names[i]),_colors&&(this.colors[key]=_colors[i]);return this._build_chart()},BaseChart.prototype.load_object=function(data,options){var _keys,columns,key,val;for(key in null==options&&(options={}),columns=[],_keys=null!=options.keys&&utils.to_a(options.keys),data)hasProp.call(data,key)&&(val=data[key],(!_keys||indexOf.call(_keys,key)>=0)&&columns.push([key].concat(utils.to_a(val))));return this.chart.load({columns:columns})},BaseChart.prototype.unload=function(){var ids;return ids=1<=arguments.length?slice.call(arguments,0):[],this.chart.unload({ids:ids})},BaseChart.prototype.clear=function(){return this.chart.destroy(),this._build_chart()},BaseChart.prototype.dispose=function(){return this.chart.destroy(),BaseChart.__super__.dispose.apply(this,arguments)},
BaseChart.prototype._build_chart=function(){return this.chart=c3.generate(this._build_options())},BaseChart.prototype._build_options=function(){return{bindto:this.node,legend:{show:!!this.options.legend},axis:this._parse_axes(this.options.axis),data:{type:this.type,labels:!!this.options.labels,colors:this.colors,names:this.names,columns:[]}}},BaseChart.prototype._parse_axes=function(val){var ref;return val&&"object"==typeof val?val:{x:{show:(ref=val?"x"===val?[!0,!1]:"y"===val?[!1,!0]:[!1,!1]:[!0,!0])[0]},y:{show:ref[1]}}},BaseChart}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _to_ratio,pi,utils;pi=context.pi,utils=pi.utils,_to_ratio=function(num){return(num=""+100*num).replace(/(\.[1-9]{0,2})\d+$/,"$1").replace(/\.$/,"")},pi.PieChart=function(superClass){function PieChart(){return PieChart.__super__.constructor.apply(this,arguments)}return extend(PieChart,superClass),PieChart.prototype._build_options=function(){var opts;return(opts=PieChart.__super__._build_options.apply(this,arguments)).tooltip=utils.merge(opts.tooltip||(opts.tooltip={}),{format:{value:function(value,ratio){return value+" ("+_to_ratio(ratio)+"%)"}}}),opts},PieChart}(pi.BaseChart)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ConfirmModal=function(superClass){function ConfirmModal(){return ConfirmModal.__super__.constructor.apply(this,arguments)}return extend(ConfirmModal,superClass),ConfirmModal.prototype.initialize=function(){return this.message_cont=this.find(".message"),ConfirmModal.__super__.initialize.apply(this,arguments)},ConfirmModal.prototype.init=function(message,_submit,_cancel){return this._submit=_submit,this._cancel=_cancel,this.message_cont.remove_children(),this.message_cont.append(message)},ConfirmModal.prototype.clear=function(){return this.message_cont.remove_children(),this._cancel=null,this._submit=null},ConfirmModal.prototype.cancel=function(){return"function"==typeof this._cancel?this._cancel():void 0},ConfirmModal.prototype.confirm=function(){return"function"==typeof this._submit?this._submit():void 0},ConfirmModal}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.CopyText=function(superClass){function CopyText(){return CopyText.__super__.constructor.apply(this,arguments)}return extend(CopyText,superClass),CopyText.prototype.postinitialize=function(){return CopyText.__super__.postinitialize.apply(this,arguments),this.on("click",this.click_handler())},CopyText.prototype.click_handler=function(){return this._click_handler||(this._click_handler=(_this=this,function(){return _this.copy()}));var _this},CopyText.prototype.copy=function(){utils.selectElementText(this.node);try{if(document.execCommand("copy")&&this.options.message)return pi.app.view.success.show(this.options.message)}catch(error){error}},CopyText.prototype.value=function(val){return null!=val?this.text(val):CopyText.__super__.value.apply(this,arguments)},CopyText}(pi.Base),pi.Guesser.rules_for("copy_text",["pi-copy-text"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.StepperGroup=function(superClass){function StepperGroup(){return StepperGroup.__super__.constructor.apply(this,arguments)}return extend(StepperGroup,superClass),StepperGroup.prototype.postinitialize=function(){var fn,i,len,ref,_this;for(StepperGroup.__super__.postinitialize.apply(this,arguments),this._stepper_by_type={},ref=this.steppers,_this=this,fn=function(stepper){if(stepper.options.type)return _this._stepper_by_type[stepper.options.type]=stepper},i=0,len=ref.length;i<len;i++)fn(ref[i]);return this.update_steppers(0|this.cb.value()),this.cb.on(pi.InputEvent.Change,function(_this){return function(e){return _this.update_steppers(e.data),_this.trigger(pi.InputEvent.Change,_this.value())}}(this))},StepperGroup.prototype.clear=function(){var i,len,ref,stepper;for(i=0,len=(ref=this.steppers).length;i<len;i++)(stepper=ref[i]).clear(),stepper.disable();return this.cb.clear(),this.trigger(pi.InputEvent.Clear)},StepperGroup.prototype.update_steppers=function(val){var i,len,ref,results,stepper;for(results=[],i=0,len=(ref=this.steppers).length;i<len;i++)stepper=ref[i],val?results.push(stepper.enable()):(stepper.disable(),results.push(stepper.value(0)));return results},StepperGroup.prototype.value=function(val){var data,key,ref,ref1,results,stepper,type;if(null!=val){for(key in results=[],data=this._prepare_val(val))hasProp.call(data,key)&&(val=data[key],results.push(null!=(ref=this._stepper_by_type[key])?ref.value(val):void 0));return results}if(null===val)return this.clear();if(this.cb.__selected__){for(type in data={},ref1=this._stepper_by_type)stepper=ref1[type],data[type]=stepper.value();return this._read_val(data)}},StepperGroup.prototype._prepare_val=function(){return{}},StepperGroup.prototype._read_val=function(){return null},StepperGroup}(pi.BaseInput)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SessionUsersLimit=function(superClass){function SessionUsersLimit(){return SessionUsersLimit.__super__.constructor.apply(this,arguments)}return extend(SessionUsersLimit,superClass),SessionUsersLimit.prototype.postinitialize=function(){return SessionUsersLimit.__super__.postinitialize.apply(this,arguments),this.listen(".pi-stepper",pi.InputEvent.Change,(_this=this,function(e){var ref;return e.cancel(),_this._score=0|e.data,null!=(ref=_this._stepper_by_type.score)&&ref.value(0|_this._score),_this.trigger(pi.InputEvent.Change,_this.value())}));var _this},SessionUsersLimit.prototype._prepare_val=function(val){var data;return(data={}).score=0|val,data},SessionUsersLimit.prototype._read_val=function(data){return data.score},SessionUsersLimit}(pi.StepperGroup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.DateTime=function(superClass){function DateTime(){return DateTime.__super__.constructor.apply(this,arguments)}return extend(DateTime,superClass),DateTime.requires("date"),DateTime.prototype.postinitialize=function(){return DateTime.__super__.postinitialize.apply(this,arguments),this.datepicker=new Pikaday(utils.extend({field:this.date.input.node,minDate:this._parseDate(this.options.min)||new Date,maxDate:this._parseDate(this.options.max)||null},pi.configs.pikaday[context.I18n.locale]))},DateTime.prototype.enable=function(){var ref,ref1;return DateTime.__super__.enable.apply(this,arguments),null!=(ref=this.date)&&ref.enable(),null!=(ref1=this.time)?ref1.enable():void 0},DateTime.prototype.disable=function(){var ref,ref1;return DateTime.__super__.disable.apply(this,arguments),null!=(ref=this.date)&&ref.disable(),null!=(ref1=this.time)?ref1.disable():void 0},DateTime.prototype._parseDate=function(date){return new Date(date)},DateTime}(pi.BaseInput)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DocumentBreadcrumbs=function(superClass){function DocumentBreadcrumbs(){return DocumentBreadcrumbs.__super__.constructor.apply(this,arguments)}return extend(DocumentBreadcrumbs,superClass),DocumentBreadcrumbs.prototype.postinitialize=function(){return DocumentBreadcrumbs.__super__.postinitialize.apply(this,arguments),this.item=this.find(".breadcrumbs-menu"),this.template=this.options.template,this.reload()},DocumentBreadcrumbs.prototype.reload=function(data){var basic_crumb,_this;if(this.clear(),basic_crumb=JST[this.template](),this.item.html(basic_crumb),data)return pi.net.get.call(null,"/api/documents/"+data+"/parents.json").then((_this=this,function(response){var document,i,j,len,len1,ref,results;for(len=response.documents.length,results=[],i=j=0,len1=(ref=response.documents).length;j<len1;i=++j)document=ref[i],i===len-1?results.push(_this.add_current(document)):results.push(_this.add_item(document));return results}))},DocumentBreadcrumbs.prototype.add_item=function(data){var temp;return temp=JST[this.template](data),this.item.append(temp)},DocumentBreadcrumbs.prototype.add_current=function(data){return data.current=!0,this.add_item(data)},DocumentBreadcrumbs.prototype.clear=function(){var list;if(list=this.item.find("li"))return list.remove()},DocumentBreadcrumbs}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.DropInput=function(superClass){function DropInput(){return DropInput.__super__.constructor.apply(this,arguments)}return extend(DropInput,superClass),DropInput.prototype.value=function(){return(this.input=this.find("input"))?this._serializer(this.input.value()):null},DropInput}(pi.BaseInput),pi.Guesser.rules_for("drop_input",["pi-drop-input"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.EditableItem=function(superClass){function EditableItem(){return EditableItem.__super__.constructor.apply(this,arguments)}return extend(EditableItem,superClass),EditableItem.prototype.initialize=function(){var _this;return this.form=new pi.Form(this.find(".editable-form").node),this.link=new pi.Base(this.find(".editable-link").node),this.close_btn=new pi.Base(this.find(".close-button").node),this.submit_btn=new pi.Base(this.find(".submit-btn").node),this.on("click",function(e){return e.cancel()}),this.link.on("click",(_this=this,function(){return _this.open()})),this.close_btn.on("click",function(_this){return function(){return _this.close()}}(this)),this.submit_btn.on("click",function(_this){return function(){return _this.trigger("submit"),_this.close()}}(this)),EditableItem.__super__.initialize.apply(this,arguments)},EditableItem.prototype.open=function(){return this.link.hide(),this.form.show(),this.activate()},EditableItem.prototype.close=function(){return this.form.hide(),this.form.clear(),this.link.show(),this.deactivate()},EditableItem.prototype.value=function(val){return null==val&&(val=null),this.form.value(val)},EditableItem}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.CodeEditor=function(superClass){function CodeEditor(){return CodeEditor.__super__.constructor.apply(this,arguments)}return extend(CodeEditor,superClass),CodeEditor.requires("input","preview"),CodeEditor.prototype.initialize=function(){return this.each("button",function(b){return b.addEventListener("click",function(e){return e.preventDefault()})})},CodeEditor.prototype.process=function(){var text,_this;if(text=this.input.value())return this.addClass("has-preview"),pi.tools.Highlight.get().process(text).then((_this=this,function(data){return _this.preview.html('<span class="pi-code hljs '+data.language+'">\n  <pre><code>'+data.value+"</code></pre>\n</span>"),_this.compiled=!0,_this.input.one("changed",function(){return _this.compiled=!1})}))},CodeEditor.prototype.value=function(){var buffer,code;if(code=this.preview.html())return(buffer=pi.Nod.create(code)).attrs({contenteditable:!1}),buffer.append('<span class="code-src" style="display: none">'+this.input.value()+"</span>"),buffer.outerHTML()},CodeEditor.prototype.submit=function(){return(this.compiled?Promise.resolve():this.process()).then((_this=this,function(){return _this.trigger("submited",_this.value()),_this.clear()}));var _this},CodeEditor.prototype.clear=function(){return this.input.clear(),this.compiled=!1,this.preview.empty(),this.removeClass("has-preview")},CodeEditor}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _math_rxp,pi;(pi=context.pi).utils,_math_rxp=/^(\$|\().*(\$|\()$/im,pi.MathEditor=function(superClass){function MathEditor(){return MathEditor.__super__.constructor.apply(this,arguments)}return extend(MathEditor,superClass),MathEditor.requires("input","preview"),MathEditor.prototype.initialize=function(){return this.each("button",function(b){return b.addEventListener("click",function(e){return e.preventDefault()})})},MathEditor.prototype.process=function(){var text,_this;if(text=this.input.value())return this.preview.html(this._mathify(text)),this.addClass("has-preview"),pi.tools.Math.get().process(this.preview.node).then((_this=this,function(){return _this.compiled=!0,_this.input.one("changed",function(){return _this.compiled=!1})}))},MathEditor.prototype.value=function(){var buffer,math;if(null!=(math=this.preview.find(".MathJax")))return math=math.first("nobr"),(buffer=pi.Nod.create("span")).addClass("pi-math"),buffer.attrs({contenteditable:!1}),this.preview.find(".MathJax_Display")&&buffer.addClass("display"),buffer.append('<span class="math-view">'+math.outerHTML()+"</span>"),buffer.append('<span class="math-src" style="display: none">'+this.input.value()+"</span>"),buffer.outerHTML()},MathEditor.prototype.submit=function(){return(this.compiled?Promise.resolve():this.process()).then((_this=this,function(){return _this.trigger("submited",_this.value()),_this.clear()}));var _this},MathEditor.prototype.clear=function(){return this.input.clear(),this.compiled=!1,this.preview.empty(),this.removeClass("has-preview")},MathEditor.prototype._mathify=function(str){return _math_rxp.test(str)?str:"$"+str+"$"},MathEditor}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ExtendedConfirmModal=function(superClass){function ExtendedConfirmModal(){return ExtendedConfirmModal.__super__.constructor.apply(this,arguments)}return extend(ExtendedConfirmModal,superClass),ExtendedConfirmModal.prototype.initialize=function(){return this.message_cont=this.find(".message"),ExtendedConfirmModal.__super__.initialize.apply(this,arguments)},ExtendedConfirmModal.prototype.init=function(message,_danger_submit,_submit,_cancel){return this._danger_submit=_danger_submit,this._submit=_submit,this._cancel=_cancel,this.message_cont.remove_children(),this.message_cont.append(message)},ExtendedConfirmModal.prototype.clear=function(){return this.message_cont.remove_children(),this._cancel=null,this._submit=null,this._danger_submit=null},ExtendedConfirmModal.prototype.cancel=function(){return"function"==typeof this._cancel?this._cancel():void 0},ExtendedConfirmModal.prototype.confirm=function(){return"function"==typeof this._submit?this._submit():void 0},ExtendedConfirmModal.prototype.confirm_danger=function(){return"function"==typeof this._danger_submit?this._danger_submit():void 0},ExtendedConfirmModal}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.FeedbackForm=function(superClass){function FeedbackForm(){return FeedbackForm.__super__.constructor.apply(this,arguments)}return extend(FeedbackForm,superClass),FeedbackForm.prototype.clear=function(){return this.form.clear(),this.remove_screenshot()},FeedbackForm.prototype.cancel=function(){return pi.app.feedback.hide(),this.clear()},FeedbackForm.prototype.attach_screenshot=function(){return pi.app.feedback.render().then((_this=this,function(canvas){return _this.screen.append(canvas),_this.addClass("has-screenshot")}));var _this},FeedbackForm.prototype.remove_screenshot=function(){return this.screen.empty(),pi.app.feedback.clear_screen(),this.removeClass("has-screenshot")},FeedbackForm.prototype.submit=function(data){return this.loader.reset(),this.loader.start(),this.loader.simulate(),pi.app.feedback.submit(data).then((_this=this,function(){var ref;return _this.loader.stop(),null!=(ref=pi.app.view.success)&&ref.show(_this.options.message),_this.cancel()}))["catch"](function(_this){return function(e){var ref;return _this.loader.stop(),utils.error(e),null!=(ref=pi.app.view.error)?ref.show(_this.options.error):void 0}}(this));var _this},FeedbackForm}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.HelpCallout=function(superClass){function HelpCallout(){return HelpCallout.__super__.constructor.apply(this,arguments)}return extend(HelpCallout,superClass),HelpCallout.prototype.postinitialize=function(){var _this;return this.root_handler=(_this=this,function(){return _this.deactivate()}),HelpCallout.__super__.postinitialize.apply(this,arguments)},HelpCallout.prototype.activate=function(){return this.on("click",this.click_handler()),pi.Nod.root.one("click",this.root_handler),HelpCallout.__super__.activate.apply(this,arguments)},HelpCallout.prototype.click_handler=function(){return this._click_handler||(this._click_handler=function(e){if(!utils.clickable(e.target.node))return e.cancel()})},HelpCallout.prototype.deactivate=function(){return this.off("click",this.click_handler()),pi.Nod.root.off("click",this.root_handler),HelpCallout.__super__.deactivate.apply(this,arguments)},HelpCallout}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.IframeViewer=function(superClass){function IframeViewer(){return IframeViewer.__super__.constructor.apply(this,arguments)}return extend(IframeViewer,superClass),IframeViewer.prototype.load=function(url){var _this;return this.addClass("is-loading"),this.frame_id="iframe_"+utils.uid(),this.frame=this._build_iframe(this.frame_id),this.frame.addClass("iframe-viewer-frame"),this.append(this.frame),this.frame.one("load",(_this=this,function(){return _this.removeClass("is-loading")})),this.frame.one("error",function(_this){return function(e){return utils.local_error(e),_this.removeClass("is-loading"),_this.addClass("is-error")}}(this)),this.frame.node.src=url},IframeViewer.prototype._build_iframe=function(id){var iframe;return(iframe=pi.Nod.create("iframe")).attrs({id:id,name:id,width:"100%",height:"100%",border:0}),iframe.styles({width:"100%",height:"100%",border:"none"}),iframe},IframeViewer.prototype.clear=function(){var ref;return null!=(ref=this.frame)?ref.remove():void 0},IframeViewer}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MarkdownEditor=function(superClass){function MarkdownEditor(){return MarkdownEditor.__super__.constructor.apply(this,arguments)}return extend(MarkdownEditor,superClass),MarkdownEditor.prototype.postinitialize=function(){var toolbar;if(toolbar=["bold","italic","strikethrough","heading","unordered-list","ordered-list","|","link","image","quote","code","preview"],this.input=this.find("textarea"),MarkdownEditor.__super__.postinitialize.apply(this,arguments),this.simplemde=new SimpleMDE({element:this.input.node,forceSync:!0,initialValue:this.data("text-value")+"",toolbar:toolbar,tabSize:4,spellChecker:!1}),this.host.host)return this.host.host.editor=this.simplemde},MarkdownEditor.prototype.disable_preview=function(){if(this.simplemde.isPreviewActive())return this.simplemde.togglePreview()},MarkdownEditor.prototype.clear=function(){return this.simplemde.value(""),this.disable_preview()},MarkdownEditor}(pi.BaseInput)}(this),pi.Guesser.rules_for("markdown_editor",["pi-markdown-editor"],null)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.MaterialSelector=function(superClass){function MaterialSelector(){return MaterialSelector.__super__.constructor.apply(this,arguments)}return extend(MaterialSelector,superClass),MaterialSelector.prototype.postinitialize=function(){return MaterialSelector.__super__.postinitialize.apply(this,arguments)},MaterialSelector.prototype.clear=function(){return this.render({})},MaterialSelector.prototype.value=function(val){return null===val?this.clear():void 0===val?null!=this.input?this.input.value():null:(this.render(val),this.trigger(pi.InputEvent.Change,this.value()),val)},MaterialSelector}(pi.BaseInput),pi.Guesser.rules_for("material_selector",["pi-material-selector"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuestionCategoryForm=function(superClass){function QuestionCategoryForm(){return QuestionCategoryForm.__super__.constructor.apply(this,arguments)}return extend(QuestionCategoryForm,superClass),QuestionCategoryForm.requires("form"),QuestionCategoryForm}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuestionForm=function(superClass){function QuestionForm(){return QuestionForm.__super__.constructor.apply(this,arguments)}return extend(QuestionForm,superClass),QuestionForm.requires("form"),QuestionForm.prototype.postinitialize=function(){var _this;return QuestionForm.__super__.postinitialize.apply(this,arguments),this._options=this.form.options_list,this._select=this.form.type_select,this._prev_type=this.form.value().type,this._incomplete=this.form.incomplete_answer,this.form.categories.hide(),this.update_listeners(this._prev_type),"1"===this._incomplete.value()&&this.form.round_up.enable(),this._select.on(pi.InputEvent.Change,(_this=this,function(e){return e.data!==_this._prev_type&&_this.render_options(e.data),!1})),this._incomplete.on(pi.InputEvent.Change,function(_this){return function(e){return e.data?_this.form.round_up.enable():(_this.form.round_up.clear(),_this.form.round_up.disable())}}(this))},QuestionForm.prototype.render_options=function(type){var data,options;return this.removeClass(this._prev_type),type===$r.Question.OPEN_ANSWER||type===$r.Question.NUMERIC||type===$r.Question.TRUE_FALSE?this._options._renderer=new pi.Renderers.Jst("templates/questions/"+type+"_options"):this._options._renderer=new pi.Renderers.Jst("templates/questions/list_type_options"),this.form.read_values(),options=this.form.value().data||[],Array.isArray(options)||(options=[]),this._prev_type===$r.Question.MATCH&&this._convert_from_match(options),type===$r.Question.MATCH&&this._convert_to_match(options),type===$r.Question.SHORT&&(options=options.filter(function(opt){return!!opt.name})),0===options.length&&options.push({__list_index__:0}),type!==$r.Question.SHORT&&1===options.length&&options.push({__list_index__:1}),type===$r.Question.SINGLE_CHOICE&&this._convert_to_radio(options),type!==$r.Question.OPEN_ANSWER&&(data={data:options,type:type}),this._options.render(data),this.update_listeners(type),this._prev_type=type,this.addClass(type)},QuestionForm.prototype.update_listeners=function(type){var ref;return type===$r.Question.SINGLE_CHOICE||type===$r.Question.TRUE_FALSE?this._options.listen(".option-check",pi.InputEvent.Change,this.radio_listener()):this._options.off(pi.InputEvent.Change,this.radio_listener()),type===$r.Question.POSITION?this._options.list.on("update",this.ordering_listener(),this,function(e){return"item_removed"===e.data.type}):null!=(ref=this._options.list)?ref.off("update",this.ordering_listener()):void 0},QuestionForm.prototype.radio_listener=function(){return this._radio_listener||(this._radio_listener=(_this=this,function(e){var i,len,old_val,ref,ref1;for(old_val=e.target.value(),i=0,len=(ref=_this.all(".option-check")).length;i<len;i++)null!=(ref1=ref[i]._nod)&&ref1.clear();return e.target.value(old_val)}));var _this},QuestionForm.prototype.ordering_listener=function(){return this._ordering_listener||(this._ordering_listener=(_this=this,function(){var options,ref;return _this.form.read_values(),options=_this.form.value().data||[],null!=(ref=_this._options.list)?ref.data_provider(options,!0):void 0}));var _this},QuestionForm.prototype._convert_from_match=function(options){var i,len,opt,results;for(results=[],i=0,len=options.length;i<len;i++)opt=options[i],results.push(opt.name=opt.left);return results},QuestionForm.prototype._convert_to_match=function(options){var i,len,opt,results;for(results=[],i=0,len=options.length;i<len;i++)opt=options[i],results.push(opt.left=opt.name);return results},QuestionForm.prototype._convert_to_radio=function(options){var flag,i,len,opt,results;for(flag=!1,results=[],i=0,len=options.length;i<len;i++)opt=options[i],!flag&&opt.correct?results.push(flag=!0):results.push(opt.correct=!1);return results},QuestionForm}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizPassingGrade=function(superClass){function QuizPassingGrade(){return QuizPassingGrade.__super__.constructor.apply(this,arguments)}return extend(QuizPassingGrade,superClass),QuizPassingGrade.prototype.postinitialize=function(){return QuizPassingGrade.__super__.postinitialize.apply(this,arguments),this._max_score=this.options.max_score||0,this._score=0,this._percent=0,this.listen(".pi-stepper",pi.InputEvent.Change,(_this=this,function(e){return e.cancel(),"score"===e.target.options.type?(_this._score=0|e.data,_this.update_percent()):(_this._percent=0|e.data,_this.update_score()),_this.trigger(pi.InputEvent.Change,_this.value())}));var _this},QuizPassingGrade.prototype.update_max_score=function(val){return this._max_score=val,this.value(this._score)},QuizPassingGrade.prototype.update_score=function(){var ref;return null!=(ref=this._stepper_by_type.score)?ref.value(this._max_score?this._max_score*(this._percent/100)|0:this._score):void 0},QuizPassingGrade.prototype.update_percent=function(){var ref;return null!=(ref=this._stepper_by_type.percent)?ref.value(this._max_score?this._score/this._max_score*100|0:this._percent):void 0},QuizPassingGrade.prototype.clear=function(){return this._score=0,this._percent=0,QuizPassingGrade.__super__.clear.apply(this,arguments)},QuizPassingGrade.prototype._prepare_val=function(val){var data;return(data={}).score=this._score=0|val,data.percent=this._percent=this._max_score?this._score/this._max_score*100|0:0,data},QuizPassingGrade.prototype._read_val=function(data){return data.score},QuizPassingGrade}(pi.StepperGroup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.QuizTimeLimit=function(superClass){function QuizTimeLimit(){return QuizTimeLimit.__super__.constructor.apply(this,arguments)}return extend(QuizTimeLimit,superClass),QuizTimeLimit.prototype.postinitialize=function(){return QuizTimeLimit.__super__.postinitialize.apply(this,arguments),this.listen(".pi-stepper",pi.InputEvent.Change,(_this=this,function(e){return e.cancel(),_this.trigger(pi.InputEvent.Change,_this.value())}));var _this},QuizTimeLimit.prototype._prepare_val=function(val){var data;return(data={}).m=val%60,data.h=val/60|0,data},QuizTimeLimit.prototype._read_val=function(data){return 60*(0|data.h)+(0|data.m)},QuizTimeLimit}(pi.StepperGroup)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _fmt,pi,utils;pi=context.pi,utils=pi.utils,_fmt={hour:function(ts){return utils.time.format(new Date(ts),"%H:%M")},day:function(ts){return utils.time.format(new Date(ts),"%d.%m")},month:function(ts){return utils.time.format(new Date(ts),"%Y-%m")}},pi.ReportLineChart=function(superClass){function ReportLineChart(){return ReportLineChart.__super__.constructor.apply(this,arguments)}
return extend(ReportLineChart,superClass),ReportLineChart.prototype.postinitialize=function(){return this.type="area-spline",ReportLineChart.__super__.postinitialize.apply(this,arguments)},ReportLineChart.prototype.clear=function(){return this.chart.destroy(),this._build_chart()},ReportLineChart.prototype.dispose=function(){return this.chart.destroy(),ReportLineChart.__super__.dispose.apply(this,arguments)},ReportLineChart.prototype.load_data=function(data,key,options){var _ts,_vals,fmt,i,len,point;for(null==options&&(options={}),null==data&&this.clear(),_ts=[],_vals=[],fmt=_fmt[options.range||"day"],i=0,len=data.length;i<len;i++)point=data[i],_ts.push(fmt(+new Date(point.time))),_vals.push(point[key]);return _ts.unshift("time"),_vals.unshift(key),this.chart.load({columns:[_ts,_vals]})},ReportLineChart.prototype._build_options=function(){var opts;return(opts=ReportLineChart.__super__._build_options.apply(this,arguments)).axis=utils.merge(opts.axis||(opts.axis={}),{x:{type:"category",tick:{culling:{min:1},multiline:!1}}}),opts.data.x="time",opts},ReportLineChart}(pi.BaseChart)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.NorthStarChart=function(superClass){function NorthStarChart(){return NorthStarChart.__super__.constructor.apply(this,arguments)}return extend(NorthStarChart,superClass),NorthStarChart.prototype.postinitialize=function(){return this.type="area-spline",NorthStarChart.__super__.postinitialize.apply(this,arguments)},NorthStarChart.prototype.clear=function(){return this.chart.destroy(),this._build_chart()},NorthStarChart.prototype.dispose=function(){return this.chart.destroy(),NorthStarChart.__super__.dispose.apply(this,arguments)},NorthStarChart.prototype.load_data=function(data,key,options){var _ts,_vals,chart_min_value,fmt,i,len,point;for(null==options&&(options={}),null==data&&this.clear(),_ts=[],_vals=[],fmt=function(ts){return utils.time.format(new Date(ts),"%d.%m.%Y")},i=0,len=data.length;i<len;i++)point=data[i],_ts.push(fmt(+new Date(point.time))),_vals.push(parseInt(point[key]));return(chart_min_value=Math.min.apply(null,_vals)-1e3)<0&&(chart_min_value=0),_ts.unshift("time"),_vals.unshift(key),this.chart.axis.min(chart_min_value),this.chart.load({columns:[_ts,_vals]})},NorthStarChart.prototype._build_options=function(){var opts;return(opts=NorthStarChart.__super__._build_options.apply(this,arguments)).axis=utils.merge(opts.axis||(opts.axis={}),{x:{type:"category",tick:{culling:{min:1},multiline:!1}}}),opts.data.x="time",opts},NorthStarChart}(pi.BaseChart)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SelectAll=function(superClass){function SelectAll(){return SelectAll.__super__.constructor.apply(this,arguments)}return extend(SelectAll,superClass),SelectAll.prototype.postinitialize=function(){return SelectAll.__super__.postinitialize.apply(this,arguments),this.on("item_click",(_this=this,function(e){return _this.trigger(e.data.item.record.action)}));var _this},SelectAll}(pi.List),pi.Guesser.rules_for("select_all",["select-all"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SlugLink=function(superClass){function SlugLink(){return SlugLink.__super__.constructor.apply(this,arguments)}return extend(SlugLink,superClass),SlugLink.prototype.postinitialize=function(){return SlugLink.__super__.postinitialize.apply(this,arguments),this.copy_field=this.find(".copy-field")},SlugLink.prototype.edit=function(){return this.copy_field.hide(),this.edit_field.show()},SlugLink.prototype.cancel=function(){return this.edit_field.hide(),this.copy_field.show()},SlugLink.prototype.value=function(link,slug){return this.copy_txt.value(link),this.edit_field.value(slug)},SlugLink}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SortButton=function(superClass){function SortButton(){return SortButton.__super__.constructor.apply(this,arguments)}return extend(SortButton,superClass),SortButton.prototype.initialize=function(){var _this;return this.state=this.hasClass("is-sort-desc")?"desc":this.hasClass("is-sort-asc")?"asc":"",pi.event.one("piecified",(_this=this,function(){return _this._attach_list($(""+_this.options.list))})),SortButton.__super__.initialize.apply(this,arguments)},SortButton.prototype._attach_list=function(list){return this.list=list,this.list.on("sort_update",(_this=this,function(event){if(_this.clear(),event.data.fields===_this.options.field&&(_this.toggle(),event.data.reverse))return _this.toggle()}));var _this},SortButton.prototype.toggle=function(){var _state;return _state=this.state,this.clear(),this.state="desc"===_state?(this.addClass("is-sort-asc"),"asc"):(this.addClass("is-sort-desc"),"desc"),this.value()},SortButton.prototype.clear=function(){return"desc"===this.state?this.removeClass("is-sort-desc"):"asc"===this.state&&this.removeClass("is-sort-asc"),this.state=""},SortButton.prototype.value=function(){return{sort_by:this.options.field,order:this.state}},SortButton}(pi.Button)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.StatusMessage=function(superClass){function StatusMessage(){return StatusMessage.__super__.constructor.apply(this,arguments)}return extend(StatusMessage,superClass),StatusMessage.prototype.initialize=function(){return this.delay=this.options.delay||0,StatusMessage.__super__.initialize.apply(this,arguments)},StatusMessage.prototype.show=function(message,delay){var _this;if(message)return StatusMessage.__super__.show.apply(this,arguments),null!=this._tid&&clearTimeout(this._tid),this.text(message),after(200,(_this=this,function(){return _this.activate(delay)}))},StatusMessage.prototype.activate=function(delay){return StatusMessage.__super__.activate.apply(this,arguments),this._tid=after(delay||this.delay,(_this=this,function(){return _this.hide()}));var _this},StatusMessage.prototype.hide=function(){return clearTimeout(this._tid),this.visible=!1,this.deactivate(),after(200,(_this=this,function(){if(!_this.visible)return _this.addClass("is-hidden")}));var _this},StatusMessage}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SurveyFieldForm=function(superClass){function SurveyFieldForm(){return SurveyFieldForm.__super__.constructor.apply(this,arguments)}return extend(SurveyFieldForm,superClass),SurveyFieldForm.requires("form"),SurveyFieldForm.prototype.postinitialize=function(){return SurveyFieldForm.__super__.postinitialize.apply(this,arguments),this._options=this.form.options_list,this._select=this.form.type_select,this._prev_type=this.form.value().type,this._select.on(pi.InputEvent.Change,(_this=this,function(e){return e.data!==_this._prev_type&&_this.render_options(e.data),!1}));var _this},SurveyFieldForm.prototype.render_options=function(type){var data,options;return this.removeClass(this._prev_type),this.form.read_values(),options=this.form.value().data||[],Array.isArray(options)||(options=[]),data=null,type!==$r.SurveyField.TEXT&&(0===(options=options.filter(function(opt){return!!opt.name})).length&&options.push({__list_index__:0}),1===options.length&&options.push({__list_index__:1}),data={data:options,type:type}),this._options.render(data),this._prev_type=type,this.addClass(type)},SurveyFieldForm}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TaskCheckForm=function(superClass){function TaskCheckForm(){return TaskCheckForm.__super__.constructor.apply(this,arguments)}return extend(TaskCheckForm,superClass),TaskCheckForm.prototype.accept=function(){var ref;return this.cancel(),this.state="accept",this.addClass("is-accept"),null!=(ref=this.form.slider)?ref.update_thumb():void 0},TaskCheckForm.prototype.decline=function(){return this.cancel(),this.state="decline",this.addClass("is-decline")},TaskCheckForm.prototype.submit=function(type){var data;return data=this.form.read_values(),this.trigger(type,data)},TaskCheckForm.prototype.cancel=function(){if(this.state)return this.removeClass("is-"+this.state)},TaskCheckForm}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.TaskStatSlider=function(superClass){function TaskStatSlider(){return TaskStatSlider.__super__.constructor.apply(this,arguments)}return extend(TaskStatSlider,superClass),TaskStatSlider.prototype.postinitialize=function(){return this.thumb=this.find(".slider-thumb"),this.labels=Array.prototype.map.call(this.all(".slider-labels label"),function(el){return pi.Nod.create(el)}),TaskStatSlider.__super__.postinitialize.apply(this,arguments),this.on("click",(_this=this,function(e){var label;if(label=_this._nearest_label_by_x(e.pageX-_this.x()))return _this.value(label.text())}));var _this},TaskStatSlider.prototype.value=function(val){return null!=val?(TaskStatSlider.__super__.value.apply(this,arguments),this.update_thumb(val)):TaskStatSlider.__super__.value.apply(this,arguments)},TaskStatSlider.prototype.update_thumb=function(val){var label;return null==val&&(val=this.value()),label=this._nearest_label_by_value(0|val),this.thumb.left(label.offset().x-this.thumb.width()/2+label.width()/2)},TaskStatSlider.prototype._nearest_label_by_value=function(val){var i,j,len,ref;for(i=j=0,len=(ref=this.labels).length;j<len&&!((0|ref[i].text())>val);i=++j);return i>0?this.labels[i-1]:this.labels[0]},TaskStatSlider.prototype._nearest_label_by_x=function(x){var i,j,label,len,ref;if(!(x<0)){for(i=j=0,len=(ref=this.labels).length;j<len&&!((label=ref[i]).offset().x>x);i=++j);return i>0&&label.offset().x-x>x-this.labels[i-1].offset().x?this.labels[i-1]:label}},TaskStatSlider}(pi.BaseInput)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var doc,pi,utils,win;pi=context.pi,utils=pi.utils,win=win||window,doc=win.document,pi.TextEditor=function(superClass){function TextEditor(){return TextEditor.__super__.constructor.apply(this,arguments)}return extend(TextEditor,superClass),TextEditor.prototype.postinitialize=function(){if(this.input=this.find("textarea"),TextEditor.__super__.postinitialize.apply(this,arguments),this.editor=context.wysiwyg({element:this.input.node,onSelection:utils.curry(this.handle_state,[],this)}),this.element=pi.Nod.create(this.editor.getElement()),this.options.allow_paste||this.element.on("paste",this.paste_handler()),(0|this.options.limit)>0&&(this.limit=0|this.options.limit,this.init_limiter()),!0===this.options.enter)return this.init_enter_handler()},TextEditor.prototype.init_limiter=function(){return this.limit_txt=pi.Nod.create('<span class="pi-entries-counter search">'+this.limit+"</span>"),this.append(this.limit_txt),this.element.on("input,keydown",(_this=this,function(e){return _this.invalidate_limit(e)}));var _this},TextEditor.prototype.init_enter_handler=function(){return this.element.on("keydown",(_this=this,function(e){if((e.ctrlKey||e.metaKey)&&(13===e.keyCode||10===e.keyCode))return _this.trigger("enter")}));var _this},TextEditor.prototype.toggle=function(type){return this.editor[type](),this.toggleClass("is-"+type),this.element.focus()},TextEditor.prototype.list=function(ordered){return this.editor.insertList(ordered),this.element.focus()},TextEditor.prototype.font_size=function(size){return this.editor.fontSize(size),this.element.focus()},TextEditor.prototype.handle_state=function(){var tags;return(tags={}).B=document.queryCommandState("bold"),tags.I=document.queryCommandState("italic"),tags.U=document.queryCommandState("underline"),tags.STRIKE=document.queryCommandState("strikethrough"),this._toggle_state(tags)},TextEditor.prototype.paste_handler=function(){return this._paste_handler||(this._paste_handler=(_this=this,function(e){var clp,len,nod,text;return e.preventDefault(),e.cancel(),clp=e.event.clipboardData,len=_this._raw_length(),null!=clp?(text=clp.getData("text/plain"),_this.limit&&text.length+len>_this.limit&&(text=text.slice(0,+(_this.limit-len-1)+1||9e9)),doc.execCommand("insertText",!1,text)):(text=win.clipboardData.getData("text"),_this.limit&&text.length+len>_this.limit?void(text=text.slice(0,+(_this.limit-len-1)+1||9e9)):text?win.getSelection?(nod=pi.Nod.create("<div>"+text+"</div>"),win.getSelection().getRangeAt(0).insertNode(nod.node)):doc.selection.createRange().pasteHTML(text):void 0)}));var _this},TextEditor.prototype.clear=function(){return this._toggle_state({}),TextEditor.__super__.clear.apply(this,arguments)},TextEditor.prototype.value=function(val){var res;return res=TextEditor.__super__.value.apply(this,arguments),null!=val&&this.editor.setHTML(val),this.invalidate_limit(),res},TextEditor.prototype.insert_html=function(html,range){var nod;return range||(range=this.getSelection()),doc.selection?range.pasteHTML(" "+html+" "):doc.getSelection?((nod=pi.Nod.create("span")).append(range.extractContents()),range.insertNode(nod.node),nod.html(html),nod.append("<span>&nbsp;</span>"),nod.prepend("<span>&nbsp;</span>")):void 0},TextEditor.prototype.focus=function(){return this.element.focus()},TextEditor.prototype.blur=function(){return this.element.blur()},TextEditor.prototype.invalidate_limit=function(e){var len,val;if(this.limit_txt)return len=this._raw_length(),e&&len>=this.limit&&"keydown"===e.type&&e.printable()&&(e.preventDefault(),e.cancel()),val=Math.max(0,this.limit-len),this.limit_txt.text(val)},TextEditor.prototype._raw_length=function(){return JST.strip_html(this.element.html()).length},TextEditor.prototype.get_selection=function(){return doc.selection?doc.selection.createRange():doc.getSelection?("None"===doc.getSelection().type&&utils.selectElementText(this.element.node),doc.getSelection().getRangeAt(0)):void 0},TextEditor.prototype._toggle_state=function(tags){return this._toggle_klass("is-bold",!!tags.B),this._toggle_klass("is-italic",!!tags.I),this._toggle_klass("is-underline",!!tags.U),this._toggle_klass("is-strikethrough",!!tags.STRIKE)},TextEditor.prototype._toggle_klass=function(klass,flag){return flag?this.addClass(klass):this.removeClass(klass)},TextEditor}(pi.BaseInput)}(this),pi.Guesser.rules_for("text_editor",["pi-text-editor"],null)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var INTERVAL,SYNC_COUNT,_format,_pad,pi,utils;pi=context.pi,utils=pi.utils,INTERVAL=500,SYNC_COUNT=10,_pad=function(n){return n<10?"0"+n:""+n},_format=function(milliseconds){var h,m,s;return s=milliseconds/1e3|0,s-=3600*(h=s/3600|0),s-=60*(m=s/60|0),_pad(h)+":"+_pad(m)+":"+_pad(s)},pi.Timer=function(superClass){function Timer(){return Timer.__super__.constructor.apply(this,arguments)}return extend(Timer,superClass),Timer.prototype.initialize=function(){return this._start_ts=1e3*(0|this.options.start_ts),this._limit=this._position=1e3*(0|this.options.limit),this._danger_zone=1e3*(0|this.options.danger),this._is_danger=!1,this._tid=null,this._ticks_count=0,this._tz=(new Date).getTimezoneOffset(),this._tz_offset=60*(new Date).getTimezoneOffset()*1e3,Timer.__super__.initialize.apply(this,arguments)},Timer.prototype.postinitialize=function(){return Timer.__super__.postinitialize.apply(this,arguments),!0===this.options.autostart?this.start():(this.update_start_position(),this.redraw())},Timer.prototype.update_start_position=function(){var delta,ts;if(this._start_ts&&(utils.debug("Start time: "+new Date(this._start_ts)),delta=(ts=+new Date)-this._start_ts,this._start_ts=ts,this._position-=delta,this._position<0))return this._position=0},Timer.prototype.start=function(){if(this.update_start_position(),0===this._position)return this.trigger("stop"),void this.redraw();var _this;this.removeClass("is-danger"),this._last_ts=+new Date,this._last_position=this._position,this.activate(),this._tid=setInterval((_this=this,function(){return _this.tick()}),INTERVAL),this.redraw(),this.trigger("start")},Timer.prototype.stop=function(){if(this.active)return clearInterval(this._tid),this.deactivate(),this.trigger("stop")},Timer.prototype.sync=function(){var calculated_shift,real_shift,ts;return real_shift=(ts=+new Date)-this._last_ts,calculated_shift=this._last_position-this._position,Math.abs(real_shift-calculated_shift)>INTERVAL/2&&(this._position=this._last_position-real_shift,utils.debug("time shift: "+(real_shift-calculated_shift))),this._ticks_count=0,this._last_ts=ts,this._last_position=this._position},Timer.prototype.tick=function(){if(this._position-=INTERVAL,this._ticks_count++,this._ticks_count>SYNC_COUNT&&this.sync(),this.redraw(),this._position<INTERVAL)return this.stop()},Timer.prototype.redraw=function(){return!this._is_danger&&this._position<this._danger_zone&&this.addClass("is-danger"),this.text(_format(this._position))},Timer}(pi.Base),pi.Guesser.rules_for("timer",["pi-timer"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.Uploader=function(superClass){function Uploader(){return Uploader.__super__.constructor.apply(this,arguments)}return extend(Uploader,superClass),Uploader.prototype.postinitialize=function(){return Uploader.__super__.postinitialize.apply(this,arguments)},Uploader.prototype.clear=function(){return this.render({}),this.input=this.find("input")},Uploader.prototype.value=function(val){return null===val?this.clear():void 0===val?null!=this.input?this.input.value():null:(this.render(val),this.input=this.find("input"),this.trigger(pi.InputEvent.Change,this.value()),val)},Uploader}(pi.BaseInput),pi.Guesser.rules_for("uploader",["pi-uploader"])}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.AudioPlayer=function(superClass){function AudioPlayer(){return AudioPlayer.__super__.constructor.apply(this,arguments)}return extend(AudioPlayer,superClass),AudioPlayer.prototype.load=function(url,cors_url){return cors_url&&!0===utils.browser.info().msie&&(0|utils.browser.info().version)<10&&(url=cors_url),this.audio=pi.Nod.create("audio"),this.append(this.audio),this.player=audiojs.create(this.audio.node,{preload:"auto",play:utils.curry(this.trigger,["state","playing"],this),pause:utils.curry(this.trigger,["state","paused"],this)}),this.player.load(url)},AudioPlayer.prototype.clear=function(){return this.off(),this.remove_children()},AudioPlayer}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.HlsPlayer=function(superClass){function HlsPlayer(){return HlsPlayer.__super__.constructor.apply(this,arguments)}return extend(HlsPlayer,superClass),HlsPlayer.prototype.postinitialize=function(){if(HlsPlayer.__super__.postinitialize.apply(this,arguments),null!=this.options.url)return this.load(this.options.url,this.options.poster)},HlsPlayer.prototype.load=function(url,poster){var _techOrder,sources;if(sources=[],_techOrder=[],this.on("contextmenu",function(e){return e.cancel()}),videojs.Html5.canPlaySource({type:"application/vnd.apple.mpegURL"})?(sources.push({src:url,type:"application/vnd.apple.mpegURL"}),_techOrder.push("html5")):(sources.push({src:url,type:"video/mp4"}),_techOrder.push("flash")),!sources.length)throw Error("VideoPlayerError: Source is undefined");return this._load_player(sources,_techOrder,poster)},HlsPlayer.prototype._load_player=function(sources,tech,poster){return this.video=pi.Nod.create("video"),this.video.addClass("video-js","vjs-default-skin","vjs-big-play-centered"),this.append(this.video),this.player=videojs(this.video.node,{preload:"none",controls:!0,width:"100%",height:"100%",techOrder:tech}),poster&&this.player.poster(poster),this.player.on("play",utils.curry(this.trigger,["state","playing"],this)),this.player.on("pause",utils.curry(this.trigger,["state","paused"],this)),this.player.on("ended",utils.curry(this.trigger,["state","ended"],this)),this.player.src(sources)},HlsPlayer.prototype.clear=function(){return this.trigger("state","disposed"),this.off(),this.player.trigger("dispose"),this.player.trigger=function(){},this.player.dispose()},HlsPlayer}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.IframeViewer=function(superClass){function IframeViewer(){return IframeViewer.__super__.constructor.apply(this,arguments)}return extend(IframeViewer,superClass),IframeViewer.prototype.load=function(url){var styles,_this;return this.addClass("is-loading"),styles={width:"100%",height:"100%",border:"none"},0===url.search("//www.google.com/maps/d/embed\\?mid=")&&(styles.marginTop="-46px",styles.height="calc(100% + 46px)"),this.frame_id="iframe_"+utils.uid(),this.frame=this._build_iframe(this.frame_id,styles),this.frame.addClass("iframe-viewer-frame"),this.append(this.frame),this.frame.one("load",(_this=this,function(){return _this.removeClass("is-loading")})),this.frame.one("error",function(_this){return function(e){return utils.local_error(e),_this.removeClass("is-loading"),_this.addClass("is-error")}}(this)),this.frame.node.src=url,console.log(this.frame.styles)},IframeViewer.prototype._build_iframe=function(id,styles){var iframe;return(iframe=pi.Nod.create("iframe")).attrs({id:id,name:id,width:"100%",height:"100%",border:0}),iframe.styles(styles),iframe},IframeViewer.prototype.clear=function(){var ref;return null!=(ref=this.frame)?ref.remove():void 0},IframeViewer}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.ImageViewer=function(superClass){function ImageViewer(){return ImageViewer.__super__.constructor.apply(this,arguments)}return extend(ImageViewer,superClass),ImageViewer.prototype.postinitialize=function(){return ImageViewer.__super__.postinitialize.apply(this,arguments),this.resize_object=this.options.resize_object&&"window"!==this.options.resize_object?void 0:pi.Nod.win},ImageViewer.prototype.load=function(url){var _this;return this.addClass("is-loading"),this.img=pi.Nod.create("img"),this.img.addClass("image-viewer-img"),this.img.one("load",(_this=this,function(){return _this.removeClass("is-loading"),pi.Nod.win.on("resize",_this.resize_handler()),_this._iw=_this.img.node.width,_this._ih=_this.img.node.height,_this._r=_this._iw/_this._ih,_this.resize_image(),_this.append(_this.img)})),this.img.one("error",function(_this){return function(e){return utils.local_error(e),_this.removeClass("is-loading"),_this.addClass("is-error")}}(this)),this.img.node.src=url},ImageViewer.prototype.resize_image=function(){var h,ih,iw,kh,kw,w;if(null!=this.img){var _this;if(w=this.resize_object.width(),h=this.resize_object.height(),0!==w&&0!==h)return kh=h/this._ih,kw=w/this._iw,kh<1||kw<1?kw<kh?ih=(iw=w)/this._r:(ih=h,iw=this._r*ih):(iw=this._iw,ih=this._ih),this.size(iw,ih);after(100,(_this=this,function(){return _this.resize_image()}))}},ImageViewer.prototype.resize_handler=function(){return this._resize_handler||(this._resize_handler=utils.debounce(500,(_this=this,function(){return _this.resize_image()})));var _this},ImageViewer.prototype.clear=function(){return this.removeClass("is-error"),pi.Nod.win.off("resize",this.resize_handler()),this.img.remove()},ImageViewer}(pi.Base)}(this)}.call(this),function(){var bind=function(fn,me){return function(){return fn.apply(me,arguments)}},extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var DISABLE_TEXT,MAX_TEXT_ITEMS,PRELOAD_EPS_PAGES,_browser,_isIe,pi,utils;pi=context.pi,utils=pi.utils,_browser=utils.browser.info(),_isIe=!0===_browser.msie,MAX_TEXT_ITEMS=500,DISABLE_TEXT=!0,PRELOAD_EPS_PAGES=2,pi.PdfViewer=function(superClass){function PdfViewer(){return this.render_page=bind(this.render_page,this),PdfViewer.__super__.constructor.apply(this,arguments)}return extend(PdfViewer,superClass),PdfViewer.include_plugins(pi.List.ScrollEnd),PdfViewer.requires("current_page_txt","total_pages_txt","fit_width_btn","fit_height_btn"),PdfViewer.cache={},PdfViewer.load_pdf=function(url){var _ts,pdf,_this;return null!=(pdf=this.cache[url])?utils.resolved_promise(pdf):(_ts=new Date,PDFJS.getDocument(url).promise["catch"](function(e){throw e}).then((_this=this,function(pdf){return _this.cache[url]=pdf,utils.debug("Load pdf time: "+ +(new Date-_ts)),pdf})))},PdfViewer.prototype.preinitialize=function(){var b,l,r,ref,t;if(PdfViewer.__super__.preinitialize.apply(this,arguments),this.options.scroll_end=!1,null==this.options.scroll_object&&(this.options.scroll_object="window"),this.resize_object=this.options.resize_object&&"window"!==this.options.resize_object?$(this.options.resize_object):pi.Nod.win,this._offset={top:0,right:0,bottom:0,left:0},null!=this.options.offset)return t=(ref=this.options.offset.split(" "))[0],r=ref[1],b=ref[2],l=ref[3],this._offset.top=0|t,this._offset.right=0|r,this._offset.bottom=0|b,this._offset.left=0|l},PdfViewer.prototype.postinitialize=function(){var _this;return PdfViewer.__super__.postinitialize.apply(this,arguments),this.scale=1,this._maxPageW=this._maxPageH=this._contW=this._contMaxH=this._w=this._h=this._oldW=this._oldH=0,this._fit="height",this.scroll_object=this.scroll_end.scroll_object,this.fit_width_btn.on("click",(_this=this,function(){return _this.fit("width")})),this.fit_height_btn.on("click",function(_this){return function(){return _this.fit("height")}}(this)),this.current_page_txt.on("keypress",function(e){var pressed_char;if(pressed_char=e.key||e.charCode&&String.fromCharCode(e.charCode),isNaN(pressed_char))return e.preventDefault()}),this.current_page_txt.on("keyup",function(_this){return function(e){if("Enter"===e.key||13===e.keyCode)return _this.to_the_page(_this.current_page_txt.value())}}(this))},PdfViewer.prototype.clear=function(){return this._promise=null,this.removeClass("is-error"),this.scroll_end.disable(),this._maxPageW=this._maxPageH=this._contW=this._contMaxH=this._w=this._h=this._oldW=this._oldH=0,pi.Nod.win.off("resize",this.resize_handler()),this.scroll_object.off("scroll",this.scroll_handler()),this.off("scroll_end"),PdfViewer.__super__.clear.apply(this,arguments),this._check_empty()},PdfViewer.prototype.load=function(url,cors_url){return cors_url&&_isIe&&(0|_browser.version)<10&&(url=cors_url),this.addClass("is-loading"),this.constructor.load_pdf(url)["catch"]((_this=this,function(e){throw _this.trigger("error",e),_this.addClass("is-error"),e})).then(function(_this){return function(pdf1){return _this.pdf=pdf1,_this.pdf.disabledText=DISABLE_TEXT,_this.total_pages=_this.pdf.pdfInfo.numPages,_this.total_pages_txt.text(_this.total_pages),_this.current_page_txt.value(1),_this.active_page=1,pi.Nod.win.on("resize",_this.resize_handler()),_this.scroll_object.on("scroll",_this.scroll_handler()),_this.on("scroll_end",function(){var ref;return null!=(ref=_this._promise)?ref.then(function(){return utils.debug("scroll_end"),_this.render_page()}):void 0}),_this._promise=_this.render_page().then(function(){return _this.removeClass("is-loading")})}}(this));var _this},PdfViewer.prototype.fit=function(type){var active_page,_this;if(active_page=this.active_page,type||(type=this._fit),this._oldW!==this._w||this._oldH!==this._h||this._fit!==type)return this._fit=type,this._oldW=this._w,this._oldH=this._h,this._contW=this._contMaxH=0,this._update_scale(),this.resize_items().then((_this=this,function(){return _this.to_the_page(active_page)}))},PdfViewer.prototype.to_the_page=function(page_number){var j,ref,ref1;if(!(page_number<1)){if(page_number=Math.min(this.total_pages,page_number),this.items.length<page_number)for(j=ref=this.items.length+1,ref1=page_number;ref<=ref1?j<=ref1:j>=ref1;ref<=ref1?++j:--j)this._add_page_container();return utils.after(0,(_this=this,function(){return _this.scroll_object.scrollToNod(_this.items[page_number-1],{animated:!1})}));var _this}},PdfViewer.prototype._delta=function(){return"height"===this._fit?Math.abs(this._h-this._oldH)/this._oldH:Math.abs(this._w-this._oldW)/this._oldW},PdfViewer.prototype.resize_handler=function(){return this._resize_handler||(this._resize_handler=utils.debounce(500,(_this=this,function(){if(_this._store_container_dim(),_this._delta()>.2)return utils.debug("fit pdf on resize"),_this.fit()})));var _this},PdfViewer.prototype.scroll_handler=function(){return this._scroll_handler||(this._scroll_handler=utils.debounce(500,(_this=this,function(){var container,i,j,ref,ref1
;if(container=pi.Nod.create(document.elementFromPoint(_this.scroll_object.x()+(_this._w+_this._offset.left+_this._offset.right)/2|0,_this.scroll_object.y()+(_this._h+_this._offset.top+_this._offset.bottom)/2|0)).parent(".pdfjs-page")){for(_this.active_page=container.page_number,_this.current_page_txt.value(_this.active_page),i=j=ref=_this.active_page-PRELOAD_EPS_PAGES,ref1=_this.active_page+PRELOAD_EPS_PAGES;ref<=ref1?j<=ref1:j>=ref1;i=ref<=ref1?++j:--j)_this.render_page(i);return _this.trigger("active_page",_this.active_page)}})));var _this},PdfViewer.prototype._store_container_dim=function(){var _h,_w;return _w=this.resize_object.width()-this._offset.left-this._offset.right,_h=this.resize_object.height()-this._offset.top-this._offset.bottom,(this._w!==_w||this._h!==_h)&&(this._w=_w,this._h=_h,!0)},PdfViewer.prototype._add_page_container=function(){var canvas,page_container,page_number,text_layout;return page_number=this.items.length+1,canvas=pi.Nod.create("<canvas class='pdfjs-canvas pi' data-pid='canvas'></canvas>"),text_layout=pi.Nod.create("<div class='pdfjs-text-layer pi' data-pid='text_layout'></div>"),(page_container=pi.Nod.create("<li class='item pdfjs-page is-loading' data-page='"+page_number+"'></div>")).append(canvas),page_container.append(text_layout),this.add_item_at(page_container,this.items.length),this.items[page_number-1].page_number=page_number,this.items[page_number-1].size(this._contW,this._contMaxH),this.items[page_number-1]},PdfViewer.prototype._update_scale=function(){return this._w&&this._h||(this._store_container_dim(),this._oldH=this._h,this._oldW=this._w),"width"===this._fit?this.scale=this._w/this._maxPageW:"height"===this._fit?this.scale=this._h/this._maxPageH:void 0},PdfViewer.prototype.resize_items=function(){var item,j,len,promisez,ref;for(promisez=[],j=0,len=(ref=this.items).length;j<len;j++)(item=ref[j]).page_rendered?promisez.push(this.render_item(item)):item.size(this._contW,this._contMaxH);return Promise.all(promisez)},PdfViewer.prototype.render_page=function(page_number){var page_cont,_this;if(this.pdf&&!(page_number=page_number||this.items.length+1,utils.debug("Try render page: "+page_number),page_number>=this.total_pages&&this.scroll_end.disable(),page_number>this.total_pages||page_number<=0||(page_cont=this.items[page_number-1]||this._add_page_container()).page_rendered))return page_cont.page_rendered=!0,page_cont.__start_ts=new Date,this.pdf.getPage(page_number)["catch"]((_this=this,function(e){throw page_cont.page_rendered=!1,_this.trigger("error",e),e})).then(function(_this){return function(page){var data,viewport;return utils.debug("Fetch page time: "+ +(new Date-page_cont.__start_ts)),page_cont.__start_ts=new Date,data={page:page},viewport=page.getViewport(1),data.width=viewport.width,data.height=viewport.height,(_this._maxPageH<viewport.height||_this._maxPageW<viewport.width)&&(_this._maxPageW=Math.max(_this._maxPageW,viewport.width),_this._maxPageH=Math.max(_this._maxPageH,viewport.height),_this._update_scale()),page_cont.record=data,_this.pdf.disabledText||PDFJS.disableWorker||_isIe||page.getTextContent()["catch"](function(e){throw _this.trigger("error",e),utils.warning(e),e}).then(function(text_content){var size;return(size=text_content.items.length)>MAX_TEXT_ITEMS&&_this.resolve_text_overhead(_this.pdf,size),page_cont.record.text_content=text_content,_this.render_item_text(page_cont)}),_this.render_item(page_cont),page_cont.removeClass("is-loading")}}(this))},PdfViewer.prototype.render_item=function(item){var _canvas,_context,_render_context,h,output_scale,page,viewport,w,_this;if(null!=item.record.page)return page=item.record.page,viewport=page.getViewport(this.scale),w=Math.floor(viewport.width),h=Math.floor(viewport.height),w>this._contW&&(this._contW=w,this.width(w)),h>this._contMaxH&&(this._contMaxH=h),_context=(_canvas=item.canvas.node).getContext("2d"),output_scale=getOutputScale(_context),_canvas.width=w*output_scale.sx|0,_canvas.height=h*output_scale.sy|0,item.size(w,h),item.text_layout.x=item.canvas.offset().x,item.text_layout.y=item.canvas.offset().y,_context._scaleX=output_scale.sx,_context._scaleY=output_scale.sy,output_scale.scaled&&_context.scale(output_scale.sx,output_scale.sy),_render_context={canvasContext:_context,viewport:viewport},page.render(_render_context).then((_this=this,function(){var ref;if(null!=(ref=item.record)?ref.text_content:void 0)return _this.render_item_text(item,viewport)})).then(function(_this){return function(){if(null!=item.record)return utils.debug("Render page time: "+ +(new Date-item.__start_ts)),1===item.page_number?(_this.render_page(),_this.scroll_end.enable()):void 0}}(this))["catch"](function(e){return utils.error(e)})},PdfViewer.prototype.render_item_text=function(item,viewport){var _settings;if(null!=item.record)return viewport||(viewport=item.record.page.getViewport(this.scale)),item.text_layout.empty(),_settings={textLayerDiv:item.text_layout.node,viewport:viewport,pageIndex:item.page_number},new TextLayerBuilder(_settings).setTextContent(item.record.text_content)},PdfViewer.prototype.resolve_text_overhead=function(pdf){if(pdf.textOverhead||(pdf.textOverhead=0),pdf.textOverhead++,pdf.textOverhead/pdf.pdfInfo.numPages>.1)return utils.info("Too much text( Disable text selection"),pdf.disabledText=!0,this.clear_text()},PdfViewer.prototype.clear_text=function(){var item,j,len,ref,results;for(results=[],j=0,len=(ref=this.items).length;j<len;j++)(item=ref[j]).text_layout.empty(),results.push(item.record.text_content=null);return results},PdfViewer}(pi.List)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.SwfViewer=function(superClass){function SwfViewer(){return SwfViewer.__super__.constructor.apply(this,arguments)}return extend(SwfViewer,superClass),SwfViewer.prototype.initialize=function(){return SwfViewer.__super__.initialize.apply(this,arguments),this.cont=this.find("#"+this.player_id)},SwfViewer.prototype.clear=function(){return this.cont.empty()},SwfViewer}(pi.SwfPlayer)}(this)}.call(this),function(){!function(context){"use strict";var FONT_SIZE,INTERVAL_TIME,LEFT,RIGHT,TOP,pi;(pi=context.pi).utils,TOP=0,LEFT=1,RIGHT=2,INTERVAL_TIME=1e4,FONT_SIZE=40,pi.VideoWatermarks=function(){function VideoWatermarks(){}return VideoWatermarks.included=function(){return!0},VideoWatermarks.prototype._wm_interval_id=null,VideoWatermarks.prototype.add_watermarks=function(_video_h,_video_w){var ref;if(this._video_h=_video_h,this._video_w=_video_w,null!=(ref=pi.app.course)?ref.watermarks:void 0)return this.wm?this._wm_adapt_position():(this.wm=pi.Nod.create("div").append(pi.app.user.email).addClass("watermarks"),this._wm_set_position(TOP),this._wm_resize_listener=this._wm_adapt_position.bind(this),this.append(this.wm),window.addEventListener("resize",this._wm_resize_listener))},VideoWatermarks.prototype.wm_move_start=function(){var ref;if(null!=(ref=pi.app.course)?ref.watermarks:void 0)return clearInterval(this._wm_interval_id),this._wm_interval_id=setInterval(this._wm_next_position.bind(this),INTERVAL_TIME)},VideoWatermarks.prototype.wm_move_stop=function(){var ref;if(null!=(ref=pi.app.course)?ref.watermarks:void 0)return clearInterval(this._wm_interval_id)},VideoWatermarks.prototype._wm_next_position=function(){return this._wm_set_position((Math.floor(1.99*Math.random())+1+this._wm_position)%3)},VideoWatermarks.prototype._wm_set_position=function(p){if(this.wm){switch(this.wm.removeClass("wm-top","wm-left","wm-right"),p){case TOP:this.wm.addClass("wm-top"),this._wm_position=TOP;break;case LEFT:this.wm.addClass("wm-left"),this._wm_position=LEFT;break;case RIGHT:this.wm.addClass("wm-right"),this._wm_position=RIGHT}return this._wm_adapt_position(),this._wm_randomize_margin()}},VideoWatermarks.prototype._wm_adapt_position=function(){var fs,padding;if(null!=this._video_h&&null!=this._video_w)return document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement?(this.node_h=window.innerHeight,this.node_w=window.innerWidth):(this.node_h=this.node.offsetHeight,this.node_w=this.node.offsetWidth),padding=0,this.node_h/this.node_w>this._video_h/this._video_w?(fs=FONT_SIZE/this._video_w*this.node_w+"px",this._wm_position===TOP&&(padding=(this.node_h-this.node_w/this._video_w*this._video_h)/2+"px")):(fs=FONT_SIZE/this._video_h*this.node_h+"px",this._wm_position!==LEFT&&this._wm_position!==RIGHT||(padding=(this.node_w-this.node_h/this._video_h*this._video_w)/2+"px")),this.wm.styles({fontSize:fs,paddingTop:padding,marginLeft:0})},VideoWatermarks.prototype._wm_randomize_margin=function(){var leftOffset,margin,video_actual_w,wm_w;return margin=0,wm_w=this.wm.node.offsetWidth,this._wm_position===TOP&&(this.node_h/this.node_w>this._video_h/this._video_w?margin=Math.random()*(this.node_w-wm_w)+"px":(video_actual_w=this.node_h/this._video_h*this._video_w,leftOffset=(this.node_w-video_actual_w)/2,margin=Math.random()*(video_actual_w-wm_w)+leftOffset+"px")),this.wm.styles({marginLeft:margin})},VideoWatermarks.prototype.wm_clear=function(){if(this.wm)return window.removeEventListener("resize",this._wm_resize_listener),clearInterval(this._wm_interval_id),this.wm.detach()},VideoWatermarks}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _isFF,_isIE9,_isOpera,pi,utils;pi=context.pi,utils=pi.utils,_isFF=utils.browser.info().firefox,_isOpera=utils.browser.info().opera,_isIE9=!0===utils.browser.info().msie&&(0|utils.browser.info().version)<10,pi.VideoPlayer=function(superClass){function VideoPlayer(){return VideoPlayer.__super__.constructor.apply(this,arguments)}return extend(VideoPlayer,superClass),VideoPlayer.include(pi.VideoWatermarks),VideoPlayer.prototype.postinitialize=function(){if(VideoPlayer.__super__.postinitialize.apply(this,arguments),null!=this.options.url)return this.load(this.options.url,this.options.poster,this.options.cors_url||this.options.url)},VideoPlayer.prototype.load=function(url,poster,cors_url){var _has_webm,_techOrder,sources;if(sources=[],this.on("contextmenu",function(e){return e.cancel()}),cors_url&&_isIE9?sources.push({src:cors_url,type:"video/mp4"}):"object"==typeof url?(null!=url.mp4&&(!0,sources.push({src:url.mp4,type:"video/mp4"})),null!=url.webm&&(_has_webm=!0,sources.push({src:url.webm,type:"video/webm"}))):(!0,sources.push({src:url,type:"video/mp4"})),!sources.length)throw Error("VideoPlayerError: Source is undefined");return _techOrder=_isFF||_isOpera?_has_webm?(sources.length=0,sources.push({src:url.webm,type:"video/webm"}),["html5"]):["flash"]:["html5","flash"],this._load_player(sources,_techOrder,poster)},VideoPlayer.prototype._load_player=function(sources,tech,poster){var _this;return this.video=pi.Nod.create("video"),this.video.addClass("video-js","vjs-default-skin","vjs-big-play-centered"),this.append(this.video),this.player=videojs(this.video.node,{preload:"none",controls:!0,width:"100%",height:"100%",techOrder:tech}),poster&&this.player.poster(poster),this.player.on("play",(_this=this,function(){return _this.wm_move_start(),_this.trigger("state","playing")})),this.player.on("pause",function(_this){return function(){return _this.wm_move_stop(),_this.trigger("state","paused")}}(this)),this.player.on("ended",utils.curry(this.trigger,["state","ended"],this)),this.player.on("loadedmetadata",function(_this){return function(){return _this.add_watermarks(_this.video.node.videoHeight,_this.video.node.videoWidth)}}(this)),this.player.src(sources)},VideoPlayer.prototype.clear=function(){return this.trigger("state","disposed"),this.off(),this.wm_clear(),this.player.trigger("dispose"),this.player.trigger=function(){},this.player.dispose()},VideoPlayer}(pi.Base)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.VimeoViewer=function(superClass){function VimeoViewer(){return VimeoViewer.__super__.constructor.apply(this,arguments)}return extend(VimeoViewer,superClass),VimeoViewer.include(pi.VideoWatermarks),VimeoViewer.prototype.load=function(id,opts){return null==opts&&(opts={}),this.addClass("is-loading"),this.video_id=id,this.player_id="vimeo_"+utils.uid(),this.frame=this._build_iframe(this.player_id),pi.tools.ScriptLoader.load("vimeo","//player.vimeo.com/api/player.js")["catch"]((_this=this,function(e){return _this.addClass("is-error"),utils.error(e)})).then(function(_this){return function(){return _this.frame.attr({src:"//player.vimeo.com/video/"+_this.video_id+"/?api=1&badge=0&player_id="+_this.player_id}),_this.frame.attr({webkitallowfullscreen:"",mozallowfullscreen:"",allowfullscreen:""}),_this.append(_this.frame),_this.api=new Vimeo.Player(_this.frame.node),_this.api.ready().then(function(){return Promise.all([_this.api.getVideoHeight(),_this.api.getVideoWidth()]).then(function(arg){var h,w;return h=arg[0],w=arg[1],_this.add_watermarks(h,w)})["catch"](console.log),_this.api.on("pause",function(){return _this.wm_move_stop(),_this.trigger("state","paused")}),_this.api.on("play",function(){return _this.wm_move_start(),_this.trigger("state","playing")}),_this.api.on("ended",utils.curry(_this.trigger,["state","ended"],_this))})}}(this));var _this},VimeoViewer.prototype.play=function(){var ref;return null!=(ref=this.api)?ref.play()["catch"](console.log):void 0},VimeoViewer.prototype.pause=function(){var ref;return null!=(ref=this.api)?ref.pause()["catch"](console.log):void 0},VimeoViewer.prototype.seek=function(ts){var ref;return null!=(ref=this.api)?ref.setCurrentTime(ts)["catch"](console.log):void 0},VimeoViewer.prototype.clear=function(){return this.trigger("state","disposed"),this.off(),this.api=null,this.wm_clear(),this.remove_children()},VimeoViewer}(pi.IframeViewer)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var Y_RXP,_ystatus,pi,utils;pi=context.pi,utils=pi.utils,_ystatus={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"cued"},Y_RXP=/(?:youtu\.be\/|youtube\.com\/(?:watch\?(?:.*&)?v=|(?:embed|v)\/))([^\?&"'>]+)/,pi.YoutubeViewer=function(superClass){function YoutubeViewer(){return YoutubeViewer.__super__.constructor.apply(this,arguments)}return extend(YoutubeViewer,superClass),YoutubeViewer.include(pi.VideoWatermarks),YoutubeViewer.prototype.load=function(id,opts){var nod,_this;return null==opts&&(opts={}),this.addClass("is-loading"),(nod=pi.Nod.create("div")).styles({width:"100%",height:"100%",display:"block"}),this.append(nod),opts.modestbranding=1,opts.rel=0,opts.fs=0,opts.hl=I18n.locale,pi.tools.ScriptLoader.load("yt","https://www.youtube.com/iframe_api")["catch"]((_this=this,function(e){return _this.addClass("is-error"),utils.error(e)})).then(function(_this){return function(){return YT.ready(function(){return _this.api=new YT.Player(nod.node,{videoId:_this._extract_id(id),playerVars:opts,events:{onReady:function(){return _this.add_watermarks(),_this.__link=$("a"),_this._cmid=setInterval(function(){return _this._prevent_context_menu()},200),_this.removeClass("is-loading")},onStateChange:_this.handle_state_changed()}})})}}(this))},YoutubeViewer.prototype.play=function(){var ref;return null!=(ref=this.api)?ref.playVideo():void 0},YoutubeViewer.prototype.pause=function(){var ref;return null!=(ref=this.api)?ref.pauseVideo():void 0},YoutubeViewer.prototype.stop=function(){var ref;return null!=(ref=this.api)?ref.stopVideo():void 0},YoutubeViewer.prototype.handle_state_changed=function(){return this._handler_state_changed||(this._handler_state_changed=(_this=this,function(e){switch(e.data){case 1:_this.wm_move_start();break;case 0:case 2:_this.wm_move_stop()}return _this.trigger("state",_ystatus[e.data])}));var _this},YoutubeViewer.prototype.clear=function(){var ref;return this._cmid&&clearInterval(this._cmid),this.trigger("state","disposed"),this.off(),null!=(ref=this.api)&&ref.destroy(),this.wm_clear(),this.remove_children()},YoutubeViewer.prototype.deactivate=function(){return clearInterval(this._cmid),this._cmid=null,YoutubeViewer.__super__.deactivate.apply(this,arguments)},YoutubeViewer.prototype.activate=function(){var _this;return this.__link&&!this._cmid&&(this._cmid=setInterval((_this=this,function(){return _this._prevent_context_menu()}),200)),YoutubeViewer.__super__.activate.apply(this,arguments)},YoutubeViewer.prototype._extract_id=function(id){var matches;return(matches=id.match(Y_RXP))?matches[1]:id},YoutubeViewer.prototype._prevent_context_menu=function(){if(this.__link&&this.__link.node!==document.activeElement)return this.__link.focus()},YoutubeViewer}(pi.IframeViewer)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi;(pi=context.pi).utils,pi.BaseChart.Restful=function(superClass){function Restful(){return Restful.__super__.constructor.apply(this,arguments)}return extend(Restful,superClass),Restful.prototype.id="restful",Restful.prototype.bind=function(resource){return Restful.__super__.bind.call(this,resource,!0)},Restful.prototype.redraw=function(data){return null!=data?this.target.load_object(data,{keys:this.target.keys}):this.target.clear()},Restful}(pi.Base.Restful)}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.ClickDragManager=function(){function ClickDragManager(){if(constructor.instance)throw Error("Singleton Error!");this._drop_areas_=[],this._dragging=!1,constructor.instance=this}return ClickDragManager.instance=null,ClickDragManager.prototype.add_drop=function(drop){if(this._drop_areas_.push(drop),this._dragging)return drop.activate()},ClickDragManager.prototype.remove_drop=function(drop){var index;if((index=this._drop_areas_.indexOf(drop))>-1)return this._drop_areas_.splice(index,1)},ClickDragManager.prototype.activate=function(target){var ref;if(null!=this._active_target&&null!=(ref=this._active_target.selectable)&&ref.deselect(),this._active_target=target,!this._dragging)return this.activate_drops()},ClickDragManager.prototype.deactivate=function(target){if(this._active_target===target)return this._active_target=null,this.deactivate_drops()},ClickDragManager.prototype.drop=function(drop_area){var ref,ref1;if(null!=this._active_target&&!this._active_target._disposed)return null!=(ref=this._active_target.__drop__)&&ref.dropout(),this._active_target.addClass("is-dropped"),drop_area.drop(this._active_target),null!=(ref1=this._active_target.selectable)&&ref1.deselect(),this.deactivate_drops()},ClickDragManager.prototype.activate_drops=function(){var drop,i,len,ref,results;for(results=[],i=0,len=(ref=this._drop_areas_).length;i<len;i++)drop=ref[i],results.push(drop.target.activate());return results},ClickDragManager.prototype.deactivate_drops=function(){var drop,i,len,ref,results;for(results=[],i=0,len=(ref=this._drop_areas_).length;i<len;i++)drop=ref[i],results.push(drop.target.deactivate());return results},ClickDragManager}(),pi.app.drag=new pi.ClickDragManager}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var DRAG,pi;(pi=context.pi).utils,DRAG=pi.app.drag,pi.Base.ClickDraggable=function(superClass){function ClickDraggable(){return ClickDraggable.__super__.constructor.apply(this,arguments)}return extend(ClickDraggable,superClass),ClickDraggable.prototype.id="click_draggable",ClickDraggable.prototype.initialize=function(target){var _this;return this.target=target,ClickDraggable.__super__.initialize.apply(this,arguments),this.target.has_selectable||this.target.attach_plugin(pi.Base.Selectable),this._origin=this.target.parent(),this._origin.has_click_droppable&&(this._origin=null),this.target.on("selected",this.selected_handler()),this.target.one("creation_complete",(_this=this,function(){var ref;return null!=(ref=_this.target.cancel_btn)?ref.on("click",function(e){return _this.cancel_drop(),e.cancel()}):void 0})),this},ClickDraggable.prototype.selected_handler=function(){return this._selected_handler||(this._selected_handler=(_this=this,function(e){return!0===e.data?DRAG.activate(_this.target):DRAG.deactivate(_this.target),e.cancel()}));var _this},ClickDraggable.prototype.cancel_drop=function(){if(null!=this._origin&&null!=this.target.__drop__)return this.target.__drop__.dropout(),this._origin.append(this.target),this.target.removeClass("is-dropped"),this.target.selectable.deselect()},ClickDraggable}(pi.Plugin)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var DRAG,pi;(pi=context.pi).utils,DRAG=pi.app.drag,pi.Base.ClickDroppable=function(superClass){function ClickDroppable(){return ClickDroppable.__super__.constructor.apply(this,arguments)}return extend(ClickDroppable,superClass),ClickDroppable.prototype.id="click_droppable",ClickDroppable.prototype.initialize=function(target){var _this;return this.target=target,ClickDroppable.__super__.initialize.apply(this,arguments),DRAG.add_drop(this),this.target.one("creation_complete",(_this=this,function(){var ref;if(_this.target.children().length)return _this.target.addClass("has-drop"),_this.has_drop=!0,null!=(ref=_this.target.children()[0]._nod)?ref.__drop__=_this:void 0})),this.target.on("click",this.click_handler()),this},ClickDroppable.prototype.click_handler=function(){return this._click_handler||(this._click_handler=(_this=this,function(){if(!_this.has_drop)return DRAG.drop(_this)}));var _this},ClickDroppable.prototype.drop=function(item){return item.__drop__=this,this.target.addClass("has-drop"),this.has_drop=!0,this.target.append(item)},ClickDroppable.prototype.dropout=function(){return this.target.removeClass("has-drop"),this.has_drop=!1},ClickDroppable.prototype.dispose=function(){return DRAG.remove_drop(this)},ClickDroppable}(pi.Plugin)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.TextEditor.Code=function(superClass){function Code(){return Code.__super__.constructor.apply(this,arguments)}return extend(Code,superClass),Code.prototype.id="code",Code.prototype.initialize=function(target){var _this;return this.target=target,Code.__super__.initialize.apply(this,arguments),this.target.addClass("is-code"),this.target.delegate_to(this,"edit_code","insert_code"),this.target.listen(".pi-code","dblclick",(_this=this,function(e){var ref,ref1,src;if(utils.info(e.target),src=null!=(ref=e.target)&&null!=(ref1=ref.find(".code-src"))?ref1.text():void 0)return _this.selection=e.target,_this.target.code_callout.editor.clear(),_this.target.code_callout.editor.input.value(src),_this.target.code_callout.show(),_this.target.code_callout.editor.input.focus()})),this},Code.prototype.edit_code=function(){return this.selection=this.target.get_selection(),this.target.code_callout.show(),this.target.code_callout.editor.input.focus()},Code.prototype.insert_code=function(html){return this.selection instanceof pi.Nod?this.selection.parent().node.replaceChild(pi.Nod.create(html).node,this.selection.node):this.target.insert_html(html,this.selection)},Code}(pi.Plugin)}(this),pi.TextEditor.include_plugins(pi.TextEditor.Code)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.TextEditor.Math=function(superClass){function Math(){return Math.__super__.constructor.apply(this,arguments)}return extend(Math,superClass),Math.prototype.id="math",Math.prototype.initialize=function(target){var _this;return this.target=target,Math.__super__.initialize.apply(this,arguments),this.target.addClass("is-math"),this.target.delegate_to(this,"edit_math","insert_math"),this.target.listen(".pi-math","dblclick",(_this=this,function(e){var ref,ref1,src;if(utils.info(e.target),src=null!=(ref=e.target)&&null!=(ref1=ref.find(".math-src"))?ref1.text():void 0)return _this.selection=e.target,_this.target.math_callout.editor.clear(),_this.target.math_callout.editor.input.value(src),_this.target.math_callout.show(),_this.target.math_callout.editor.input.focus()})),this},Math.prototype.edit_math=function(){return this.selection=this.target.get_selection(),this.target.math_callout.show(),this.target.math_callout.editor.input.focus()},Math.prototype.insert_math=function(html){return this.selection instanceof pi.Nod?this.selection.parent().node.replaceChild(pi.Nod.create(html).node,this.selection.node):this.target.insert_html(html,this.selection)},Math}(pi.Plugin)}(this),pi.TextEditor.include_plugins(pi.TextEditor.Math)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var LINK_RXP,pi;(pi=context.pi).utils,LINK_RXP=/^http.+(youtu\.be\/|youtube\.com\/(watch\?(.*&)?v=|(embed|v)\/))([^\?&"'>]+)/,pi.TextEditor.Youtube=function(superClass){function Youtube(){return Youtube.__super__.constructor.apply(this,arguments)}return extend(Youtube,superClass),Youtube.prototype.id="yt",Youtube.prototype.initialize=function(target){return this.target=target,Youtube.__super__.initialize.apply(this,arguments),this.target.addClass("is-youtube"),this.target.delegate_to(this,"insert_yt","edit_yt"),this},Youtube.prototype.edit_yt=function(){return this.selection=this.target.get_selection(),this.target.yt_callout.show(),this.target.yt_callout.input.focus()},Youtube.prototype.insert_yt=function(html){var matches;return(matches=html.match(LINK_RXP))&&(html='<iframe width="560" height="315" src="https://www.youtube.com/embed/'+matches[5]+'" frameborder="0" allowfullscreen></iframe>'),this.selection instanceof pi.Nod?this.selection.parent().node.replaceChild(pi.Nod.create(html).node,this.selection.node):this.target.insert_html(html,this.selection)},Youtube}(pi.Plugin)}(this),pi.TextEditor.include_plugins(pi.TextEditor.Youtube)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _null,pi;(pi=context.pi).utils,_null=function(){},pi.List.ActiveForm=function(superClass){function ActiveForm(){return ActiveForm.__super__.constructor.apply(this,arguments)}return extend(ActiveForm,superClass),ActiveForm.prototype.id="active_form",ActiveForm.prototype.initialize=function(list){var _this;return this.list=list,ActiveForm.__super__.initialize.apply(this,arguments),this.selectable=this.list.nested_select||this.list.selectable||{enable:_null,disable:_null,clear_selection:_null},this.list.delegate_to(this,"edit_item","finish_edit"),this.list.on("update",(_this=this,function(e){return _this.list_updated(e.data)})),this},ActiveForm.prototype.edit_item=function(item){if(this._active_item&&this._active_item.active&&(this._active_item.deactivate(),this._active_item.removeClass("is-editing")),this._active_item=item,this._active_item)return this._was_selectable=this.selectable.enabled,this.selectable.disable(),this.selectable.clear_selection(),this.list.addClass("is-editing"),item.activate(),item.addClass("is-editing"),item.one("active",this.item_handler(),this,function(e){return!1===e.data}),this.activate_md_editor(item)},ActiveForm.prototype.activate_md_editor=function(item){if(item.editor)return item.editor.value(item.editor.value())},ActiveForm.prototype.finish_edit=function(){if(this._active_item&&this._active_item.active)return this._active_item.deactivate(),this._active_item.removeClass("is-editing"),this._active_item=null},ActiveForm.prototype.list_updated=function(data){return"clear"===data.type?(this.item_handler().call(this),!1):("item_removed"===data.type&&data.item===this._active_item?this.item_handler().call(this):"item_updated"===data.type&&data.item===this._active_item&&data.item.deactivate(),!1)},ActiveForm.prototype.item_handler=function(){return this._item_handler||(this._item_handler=(_this=this,function(){return _this._was_selectable&&_this.selectable.enable(),_this.list.removeClass("is-editing")}));var _this},ActiveForm}(pi.Plugin)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var _is_continuation,pi,utils;pi=context.pi,utils=pi.utils,_is_continuation=function(prev,query){var ref;return prev&&0===(null!=(ref=utils.escapeRegexp(query).match(utils.escapeRegexp(prev)))?ref.index:void 0)},pi.List.LabelsSearch=function(superClass){function LabelsSearch(){return LabelsSearch.__super__.constructor.apply(this,arguments)}return extend(LabelsSearch,superClass),LabelsSearch.prototype.id="labels_search",LabelsSearch.prototype.initialize=function(list1){var _this;return this.list=list1,LabelsSearch.__super__.initialize.apply(this,arguments),this.list.delegate_to(this,"search"),this.searching=!1,this.list.on("update",(_this=this,function(e){return _this.item_updated(e.data.item)}),this,function(_this){return function(e){return("item_added"===e.data.type||"item_updated"===e.data.type)&&e.data.item.host===_this.list}}(this)),this},LabelsSearch.prototype.item_updated=function(item){return!!this.matcher&&(this._scope_items.indexOf(item)<0&&this._scope_items.unshift(item),this.matcher(item)?this._scope_items.indexOf(item)<0&&(this._scope_items.push(item),item.addClass("is-match")):this.searching&&this._scope_items.indexOf(item)>-1&&item.removeClass("is-match"),!1)},LabelsSearch.prototype.start_search=function(){if(!this.searching)return this.searching=!0,this.list.addClass("is-searching"),this._scope_items=this.all_items(),this._prevq="",this.list.trigger("search_start")},LabelsSearch.prototype.stop_search=function(){var i,len,ref;if(this.searching){for(this.searching=!1,this.list.removeClass("is-searching"),i=0,len=(ref=this._scope_items).length;i<len;i++)ref[i].removeClass("is-match");return this._scope_items=null,this.matcher=null}},LabelsSearch.prototype.scope_items=function(){return this._scope_items.filter(function(item){return!item._disposed})},LabelsSearch.prototype.all_items=function(){var i,items,len,list,ref;for(items=[],i=0,
len=(ref=this.list.find_cut(".pi-list")).length;i<len;i++)list=ref[i],items=items.concat(list._nod.items);return items},LabelsSearch.prototype.search=function(q){var i,item,len,scope;if(null==q&&(q=""),""===q)return this.stop_search();for(this.searching||this.start_search(),scope=_is_continuation(this._prevq,q)?this.scope_items():this.all_items(),this._prevq=q,this.matcher=utils.matchers.nod(utils.escapeRegexp(q)),this._scope_items=[],i=0,len=scope.length;i<len;i++)item=scope[i],this.matcher(item)?(item.addClass("is-match"),this._scope_items.push(item)):item.removeClass("is-match");return this.list.trigger("search_update")},LabelsSearch}(pi.Plugin)}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupAdminOrdersResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupAdminOrdersResolver=function(){function ActionGroupAdminOrdersResolver(){}return ActionGroupAdminOrdersResolver.prototype.resolve=function(nod,data){return null==data&&(data=[]),data.length&&("abort"===data[0].record.status||data[0].record.is_expired&&"success"!==data[0].record.status)?nod.removeClass("undeleted"):nod.addClass("undeleted")},ActionGroupAdminOrdersResolver.prototype.off=function(){return!0},ActionGroupAdminOrdersResolver}(),pi.resolvers.ActionGroupAdminOrdersResolver=new ActionGroupAdminOrdersResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupAdminProductsOrdersResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupAdminProductsOrdersResolver=function(){function ActionGroupAdminProductsOrdersResolver(){}return ActionGroupAdminProductsOrdersResolver.prototype.resolve=function(nod,data){return null==data&&(data=[]),data.length&&"success"===data[0].record.status?nod.addClass("undeleted"):nod.removeClass("undeleted")},ActionGroupAdminProductsOrdersResolver.prototype.off=function(){return!0},ActionGroupAdminProductsOrdersResolver}(),pi.resolvers.ActionGroupAdminProductsOrdersResolver=new ActionGroupAdminProductsOrdersResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupAppResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupAppResolver=function(){function ActionGroupAppResolver(){}return ActionGroupAppResolver.prototype.resolve=function(nod,data){if(null!=data?data.length:void 0)return"pending"!==data[0].record.status?nod.addClass("no-confirm"):nod.removeClass("no-confirm")},ActionGroupAppResolver.prototype.off=function(){return!0},ActionGroupAppResolver}(),pi.resolvers.ActionGroupAppResolver=new ActionGroupAppResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupCourseEditResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupCourseEditResolver=function(){function ActionGroupCourseEditResolver(){}return ActionGroupCourseEditResolver.prototype.resolve=function(nod,data){var is_immoveable,item;if(null==data&&(data=[]),data&&(item=data[0].record))if(nod.removeClass("no-move"),nod.removeClass("no-edit"),nod.removeClass("no-delete"),is_immoveable=pi.app.course.seq_sessions_count>0,item instanceof $r.Section){if(is_immoveable&&nod.addClass("no-move"),pi.app.course.copyright_protected&&item.has_protected_content())return nod.addClass("no-delete")}else{if(item.copyright_protected)return nod.addClass("no-edit"),nod.addClass("no-delete");if(item.is_editor_js)return nod.addClass("no-edit")}},ActionGroupCourseEditResolver.prototype.off=function(){return!0},ActionGroupCourseEditResolver}(),pi.resolvers.ActionGroupCourseEditResolver=new ActionGroupCourseEditResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupCoursesResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupCoursesResolver=function(){function ActionGroupCoursesResolver(){}return ActionGroupCoursesResolver.prototype.resolve=function(nod,record){if(!pi.app.user.admin)return record.is_shared?nod.addClass("only-for-shared"):nod.removeClass("only-for-shared")},ActionGroupCoursesResolver.prototype.off=function(){return!0},ActionGroupCoursesResolver}(),pi.resolvers.ActionGroupCoursesResolver=new ActionGroupCoursesResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupDocumentsResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupDocumentsResolver=function(){function ActionGroupDocumentsResolver(){}return ActionGroupDocumentsResolver.prototype.resolve=function(nod,data){var item;if(data)return data.length>1?(nod.addClass("no-edit"),nod.addClass("no-download"),nod.addClass("no-share")):(item=data[0],nod.removeClass("no-edit"),item.is_folder?item["public"]?(nod.addClass("no-edit"),nod.addClass("no-move"),nod.addClass("no-share"),nod.addClass("no-download")):(nod.removeClass("no-share"),nod.removeClass("no-move"),nod.addClass("no-download")):(nod.removeClass("no-download"),nod.removeClass("no-move"),nod.addClass("no-share")))},ActionGroupDocumentsResolver.prototype.off=function(){return!0},ActionGroupDocumentsResolver}(),pi.resolvers.ActionGroupDocumentsResolver=new ActionGroupDocumentsResolver}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupMeetingsResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupMeetingsResolver=function(){function ActionGroupMeetingsResolver(){}return ActionGroupMeetingsResolver.prototype.resolve=function(nod,data){return null==data&&(data={}),data.finished_at?nod.addClass("no-edit"):nod.removeClass("no-edit")},ActionGroupMeetingsResolver.prototype.off=function(){return!0},ActionGroupMeetingsResolver}(),pi.resolvers.ActionGroupMeetingsResolver=new ActionGroupMeetingsResolver}(this)}.call(this),function(){var hasProp={}.hasOwnProperty;!function(context){"use strict";var ActionGroupQuestions,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupQuestions=function(){function ActionGroupQuestions(){}return ActionGroupQuestions.prototype.resolve=function(nod,data){var key,res,results;for(key in null==data&&(data=[]),res={edit:!0,"delete":!0},data.length>1&&(res.edit=!1,res["delete"]=!1),results=[],res)hasProp.call(res,key)&&(res[key]?results.push(nod.removeClass("no-"+key)):results.push(nod.addClass("no-"+key)));return results},ActionGroupQuestions.prototype.off=function(){return!0},ActionGroupQuestions}(),pi.resolvers.ActionGroupQuestions=new ActionGroupQuestions}(this)}.call(this),function(){!function(context){"use strict";var ActionGroupResolver,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupResolver=function(){function ActionGroupResolver(){}return ActionGroupResolver.prototype.resolve=function(nod,data){return data instanceof Array&&data.length>1?nod.addClass("no-edit"):nod.removeClass("no-edit")},ActionGroupResolver.prototype.off=function(){return!0},ActionGroupResolver}(),pi.resolvers.ActionGroupResolver=new ActionGroupResolver}(this)}.call(this),function(){var hasProp={}.hasOwnProperty;!function(context){"use strict";var ActionGroupUsers,pi;(pi=context.pi).resolvers||(pi.resolvers={}),pi.utils,ActionGroupUsers=function(){function ActionGroupUsers(){}return ActionGroupUsers.prototype.resolve=function(nod,data){var isLocked,key,res,results;for(key in null==data&&(data=[]),res={edit:!0,"delete":!0,labels:!0,notify:!0,transfer:!0,mail:!0},data.length>1&&(res.edit=res.transfer=!1),isLocked=data[0].record.is_locked,res.lock=!isLocked,res.unlock=isLocked,data.every(function(item){return item.record.is_locked===isLocked})||(res.lock=res.unlock=!1),data.filter(function(item){return item.record.id===pi.app.user.id}).length&&(res.edit=res["delete"]=res.notify=res.lock=res.unlock=!1),data.filter(function(item){return null!==item.record.email}).length||(res.notify=res.mail=!1),2===pi.app.user.role_id&&data.filter(function(item){return item.record.role_id>1&&item.record.id!==pi.app.user.id}).length>0&&(res.edit=res["delete"]=res.labels=res.transfer=!1),results=[],res)hasProp.call(res,key)&&(res[key]?results.push(nod.removeClass("no-"+key)):results.push(nod.addClass("no-"+key)));return results},ActionGroupUsers.prototype.off=function(){return!0},ActionGroupUsers}(),pi.resolvers.ActionGroupUsers=new ActionGroupUsers}(this)}.call(this),function(){pi.Nod.root.ready(function(){return pi.Nod.root.each(".after-load",function(node){return node.classList.remove("after-load")})})}.call(this),function(){var timer=null;pi.NodEvent.add(window,"scroll",function(){timer&&clearTimeout(timer),timer=setTimeout(function(){document.body.classList.remove("is-scrolling"),timer=null},200),document.body.classList.add("is-scrolling")})}(),function(){pi.Nod.root.ready(function(){var nod;if(null!=(nod=$(".main-progress")))return nod.style({width:"100%"}),after(500,function(){return nod.style({opacity:0}),after(500,function(){return nod.remove()})})})}.call(this),function(){pi.Nod.root.ready(function(){var ref,ref1,ref2;if(null!=(null!=(ref=pi.tools)?ref.ActivityWatcher:void 0)&&null==pi.app.disable_activity&&(pi.app.activity_watcher=new pi.tools.ActivityWatcher,!1!==window.ACTIVITY_DIMNESS&&pi.app.activity_watcher.on("active",function(e){return e.data?pi.Nod.body.removeClass("no-activity"):pi.Nod.body.addClass("no-activity")}),after(0,function(){return pi.app.activity_watcher.start()}),null!=pi.app.user))return pi.app.visitor=new pi.tools.Visitor(pi.utils.merge(window.TRACK_PARAMS||{},{user_id:null!=(ref1=pi.app.user)?ref1.id:void 0,account_id:null!=(ref2=pi.app.user)?ref2.account_id:void 0})),after(0,function(){return pi.app.visitor.init()})})}.call(this),function(){pi.Net.headers["X-CSRF-Token"]=window.AUTH_TOKEN,pi.Net.method_override=!0,pi.Nod.root.ready(function(){var _start_ts,messages,ref,ref1;if(_start_ts=+new Date,null!=(null!=(ref=pi.tools)?ref.Tourer:void 0)&&(pi.app.tour=new pi.tools.Tourer),null!=(null!=(ref1=pi.tools)?ref1.Confirmator:void 0)&&(pi.app.confirmator=pi.tools.Confirmator),pi.app.initialize(),pi.__init_time__=+new Date-_start_ts,null!=(messages=pi.app.flash_messages))return pi.Nod.win.one("load",function(){var ref2,ref3;if(messages.success&&null!=(ref2=pi.app.view.success)&&ref2.show(messages.success,4e3),messages.error)return null!=(ref3=pi.app.view.error)?ref3.show(messages.error,4e3):void 0})})}.call(this),function(){var ref,ref1;null!=(ref=$("#primary"))&&null!=(ref1=ref.find('[href="'+window.location.pathname+'"]'))&&ref1.addClass("is-active")}.call(this),function(){document.cookie="tz="+(new Date).getTimezoneOffset()/-60+"; path=/"}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var doc,hidden,pi,utils,visibilityChange;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),hidden=!1,visibilityChange=void 0,"undefined"!=typeof document.hidden?(hidden="hidden",visibilityChange="visibilitychange"):"undefined"!=typeof document.mozHidden?(hidden="mozHidden",visibilityChange="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(hidden="msHidden",visibilityChange="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(hidden="webkitHidden",visibilityChange="webkitvisibilitychange"),doc=pi.Nod.create(document),pi.tools.ActivityWatcher=function(superClass){function ActivityWatcher(idle_time){var _this;null==idle_time&&(idle_time=60),ActivityWatcher.__super__.constructor.apply(this,arguments),this.idle_time(idle_time),this._tid=!1,this.running=!1,this.active=!0,this._idle=(_this=this,function(e){return _this.idle(e)}),this._wake=function(_this){return function(e){return _this.wakeup(e)}}(this),this._wake_frame=function(_this){return function(e){return _this.wakeup_frame(e)}}(this),this._idle_frame=function(_this){return function(e){return _this.idle_frame(e)}}(this)}return extend(ActivityWatcher,superClass),ActivityWatcher.prototype.start=function(options){if(null==options&&(options={}),!this.running)return this._setup_events(),this._once=options.once,this.running=!0,this.wakeup()},ActivityWatcher.prototype.idle_time=function(idle_time){return this._idle_time=1e3*idle_time,this.restart_timer()},ActivityWatcher.prototype.stop=function(){if(this.running)return this._remove_events(),this.remove_frame_layer(),clearTimeout(this._tid),this._tid=!1,this.running=!1},ActivityWatcher.prototype.wakeup=function(e){return this.active||(utils.debug("waked up by "+(null!=e?e.type:void 0)),this.trigger("active",!0)),this.active=!0,this.restart_timer()},ActivityWatcher.prototype.idle=function(e){return this.active&&(this.trigger("active",!1),null!=e&&utils.debug("idle by event "+e.type)),this.active=!1,this.restart_timer()},ActivityWatcher.prototype.restart_timer=function(){if(this.running)return clearTimeout(this._tid),this._tid=after(this._interval(),this._idle)},ActivityWatcher.prototype._setup_events=function(){return pi.Nod.root.on("mousemove,keydown",this._wake),pi.Nod.win.on("scroll",this._wake),!1===hidden?(pi.Nod.win.on("blur",this._idle),pi.Nod.win.on("focus",this._wake)):doc.on(visibilityChange,this.visibility_handler())},ActivityWatcher.prototype._remove_events=function(){return pi.Nod.root.off("mousemove,keydown",this._wake),pi.Nod.win.off("scroll",this._wake),!1===hidden?(pi.Nod.win.off("blur",this._idle),pi.Nod.win.off("focus",this._wake)):doc.off(visibilityChange,this.visibility_handler())},ActivityWatcher.prototype.use_frame_layer=function(){return this.use_frame=!0,this._setup_frame_layer(),this.restart_frame_timer()},ActivityWatcher.prototype.remove_frame_layer=function(){if(this.use_frame)return this.use_frame=!1,clearTimeout(this._fid),this._remove_frame_layer()},ActivityWatcher.prototype.restart_frame_timer=function(){if(this.running)return clearTimeout(this._fid),this._fid=after(this._interval()/2,this._idle_frame)},ActivityWatcher.prototype.wakeup_frame=function(e){return this.wakeup(e),this._frame.hide(),this.restart_frame_timer()},ActivityWatcher.prototype.idle_frame=function(){return this._frame.show(),this.restart_frame_timer()},ActivityWatcher.prototype._setup_frame_layer=function(){return pi.Nod.body.prepend(this._frame_layer()),this._frame.on("mouseover",this._wake_frame)},ActivityWatcher.prototype._remove_frame_layer=function(){return this._frame_layer().detach(),this._frame.off()},ActivityWatcher.prototype._frame_layer=function(){return this._frame?this._frame:(this._frame=pi.Nod.create("div"),this._frame.styles({position:"absolute",top:0,bottom:0,left:0,right:0,"z-index":1e6,display:"block"}),this._frame)},ActivityWatcher.prototype.visibility_handler=function(){return this._visibility_handler||(this._visibility_handler=(_this=this,function(e){return document[hidden]?_this.idle(e):_this.wakeup(e)}));var _this},ActivityWatcher.prototype._interval=function(){var ref;return null!=this._once?(ref=this._once,this._once=null,ref):this._idle_time},ActivityWatcher}(pi.EventDispatcher)}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),pi.tools.BannerManager=function(){function BannerManager(banners){var _this;this.banners=null!=banners?banners:[],pi.Nod.root.ready((_this=this,function(){return _this.init()}))}return BannerManager.prototype.init=function(){var banner,i,len,ref,results;if(this.banners.length){for(results=[],i=0,len=(ref=this.banners).length;i<len;i++){if(banner=ref[i],!this.is_stale(banner)){this.show(banner);break}results.push(void 0)}return results}},BannerManager.prototype.is_stale=function(banner){return!!Cookies.get("banner_"+banner.id)},BannerManager.prototype.show=function(banner1){var _this;return this.banner=banner1,this.banner_nod=pi.Nod.create(JST["templates/shared/banner"](this.banner)),pi.Nod.body.prepend(this.banner_nod),this.banner_nod.listen("a","click",(_this=this,function(){return _this.commit()})),pi.Nod.body.addClass("has-banner")},BannerManager.prototype.commit=function(){var _this;return Cookies.set("banner_"+this.banner.id,1,{expires:this.banner.expires||3}),pi.Nod.body.removeClass("has-banner"),utils.after(300,(_this=this,function(){return _this.banner_nod.remove(),_this.banner_nod=null})),this.banner=null},BannerManager}()}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),pi.tools.CloudPayments=function(){function CloudPayments(){}return CloudPayments.pay=function(order){var data,receipt;return data={},receipt={Items:[{label:order.product_name,price:order.amount_int,quantity:1,amount:order.amount_int,method:order.cp_method_type,object:order.cp_subject_type,vat:order.cp_vat_rate,measurementUnit:order.cp_unit}],email:pi.app.user.email,phone:pi.app.user.phone,amounts:{electronic:order.amount_int}},data={cloudPayments:{customerReceipt:receipt}},pi.app.order.recurring_payment&&(data.cloudPayments.recurrent={interval:"Month",period:1,customerReceipt:receipt}),pi.tools.ScriptLoader.load("cloudp","//widget.cloudpayments.ru/bundles/cloudpayments")["catch"](utils.error).then(function(){var widget;return widget=new cp.CloudPayments,new Promise(function(resolve,reject){return widget.charge({publicId:order.cp_key_id,description:order.product_name,amount:order.amount_int,currency:"RUB",invoiceId:order.id,accountId:pi.app.user.email,inn:order.tax_number,type:"Income",data:data},resolve,reject)})})},CloudPayments}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.tools||(pi.tools={}),pi.tools.CodeGenerator=function(){function CodeGenerator(){}return CodeGenerator.generate=function(length){var chars,j,out,ref,rnum;for(chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",out="",j=0,ref=length;0<=ref?j<=ref:j>=ref;0<=ref?++j:--j)rnum=Math.floor(Math.random()*chars.length),out+=chars.substring(rnum,rnum+1);return out},CodeGenerator}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.tools||(pi.tools={}),pi.tools.Confirmator=function(){function Confirmator(){}return Confirmator.send=function(){if(null!=pi.app.user)return pi.app.user.reconfirmation_email().then(function(data){if(null!=data.message)return pi.app.view.success.show(data.message)})["catch"](function(data){if(null!=data.message)return pi.app.view.error.show(data.message)})},Confirmator}()}(this)}.call(this),function(a){function b(a,b,e){return 4===arguments.length?c.apply(this,arguments):void d(a,{declarative:!0,deps:b,declare:e})}function c(a,b,c,e){d(a,{declarative:!1,deps:b,executingRequire:c,execute:e})}function d(a,b){b.name=a,a in p||(p[a]=b),b.normalizedDeps=b.deps}function e(a,b){if(b[a.groupIndex]=b[a.groupIndex]||[],-1==q.call(b[a.groupIndex],a)){b[a.groupIndex].push(a);for(var c=0,d=a.normalizedDeps.length;d>c;c++){var f=a.normalizedDeps[c],g=p[f];if(g&&!g.evaluated){var h=a.groupIndex+(g.declarative!=a.declarative);if(void 0===g.groupIndex||g.groupIndex<h){if(void 0!==g.groupIndex&&(b[g.groupIndex].splice(q.call(b[g.groupIndex],g),1),0==b[g.groupIndex].length))throw new TypeError("Mixed dependency cycle detected");g.groupIndex=h}e(g,b)}}}}function f(a){var b=p[a];b.groupIndex=0;var c=[];e(b,c);for(var d=!!b.declarative==c.length%2,f=c.length-1;f>=0;f--){for(var g=c[f],i=0;i<g.length;i++){var k=g[i];d?h(k):j(k)}d=!d}}function g(a){return u[a]||(u[a]={name:a,dependencies:[],exports:{},importers:[]})}function h(b){if(!b.module){var c=b.module=g(b.name),d=b.module.exports,e=b.declare.call(a,function(a,b){if(c.locked=!0,"object"==typeof a)for(var e in a)d[e]=a[e];else d[a]=b;for(var f=0,g=c.importers.length;g>f;f++){var h=c.importers[f];if(!h.locked)for(var i=0;i<h.dependencies.length;++i)h.dependencies[i]===c&&h.setters[i](d)}return c.locked=!1,b},b.name);c.setters=e.setters,c.execute=e.execute;for(var f=0,i=b.normalizedDeps.length;i>f;f++){var j,k=b.normalizedDeps[f],l=p[k],m=u[k];m?j=m.exports:l&&!l.declarative?j=l.esModule:l?(h(l),j=(m=l.module).exports):j=o(k),m&&m.importers?(m.importers.push(c),c.dependencies.push(m)):c.dependencies.push(null),c.setters[f]&&c.setters[f](j)}}}function i(a){var b,c=p[a];if(c)c.declarative?n(a,[]):c.evaluated||j(c),b=c.module.exports;else if(!(b=o(a)))throw new Error("Unable to load dependency "+a+".");return(!c||c.declarative)&&b&&b.__useDefault?b["default"]:b}function j(b){if(!b.module){var c={},d=b.module={exports:c,id:b.name};if(!b.executingRequire)for(var e=0,f=b.normalizedDeps.length;f>e;e++){var g=b.normalizedDeps[e],h=p[g];h&&j(h)}b.evaluated=!0;var l=b.execute.call(a,function(a){for(var c=0,d=b.deps.length;d>c;c++)if(b.deps[c]==a)return i(b.normalizedDeps[c]);throw new TypeError("Module "+a+" not declared as a dependency.")},c,d);l&&(d.exports=l),(c=d.exports)&&c.__esModule?b.esModule=c:b.esModule=k(c)}}function k(a){var b={};if("object"==typeof a||"function"==typeof a){var c=a&&a.hasOwnProperty;if(r)for(var d in a)m(b,a,d)||l(b,a,d,c);else for(var d in a)l(b,a,d,c)}return b["default"]=a,t(b,"__useDefault",{value:!0}),b}function l(a,b,c,d){(!d||b.hasOwnProperty(c))&&(a[c]=b[c])}function m(a,b,c){try{var d;return(d=Object.getOwnPropertyDescriptor(b,c))&&t(a,c,d),!0}catch(e){return!1}}function n(b,c){var d=p[b];if(d&&!d.evaluated&&d.declarative){c.push(b);for(var e=0,f=d.normalizedDeps.length;f>e;e++){var g=d.normalizedDeps[e];-1==q.call(c,g)&&(p[g]?n(g,c):o(g))}d.evaluated||(d.evaluated=!0,d.module.execute.call(a))}}function o(a){if(w[a])return w[a];if("@node/"==a.substr(0,6))return v(a.substr(6));var b=p[a];if(!b)throw"Module "+a+" not present.";return f(a),n(a,[]),p[a]=void 0,b.declarative&&t(b.module.exports,"__esModule",{value:!0}),w[a]=b.declarative?b.module.exports:b.esModule}var t,p={},q=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},r=!0;try{Object.getOwnPropertyDescriptor({a:0},"a")}catch(s){r=!1}!function(){try{Object.defineProperty({},"a",{})&&(t=Object.defineProperty)}catch(a){t=function(a,b,c){try{a[b]=c.value||c.get.call(a)}catch(d){}}}}();var u={},v="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&require.resolve&&"undefined"!=typeof process&&require,w={"@empty":{}};return function(a,d,e){return function(f){f(function(){for(var g={_nodeRequire:v,register:b,registerDynamic:c,get:o,set:function(a,b){w[a]=b},newModule:function(a){return a}},h=0;h<d.length;h++)!function(a,b){b&&b.__esModule?w[a]=b:w[a]=k(b)}(d[h],arguments[h]);e(g);var i=o(a[0]);if(a.length>1)for(h=1;h<a.length;h++)o(a[h]);return i.__useDefault?i["default"]:i})}}}("undefined"!=typeof self?self:global)(["1"],[],function(a){this.require,this.exports,this.module,a.register("2",[],function(a){"use strict";return{setters:[],execute:function(){a("VERSION","0.1.0")}}}),a.registerDynamic("3",["4"],!0,function(a,b,c){var d=a("4");return c.exports=function(a,b,c){return d.setDesc(a,b,c)},c.exports}),a.registerDynamic("5",["3"],!0,function(a,b,c){return c.exports={"default":a("3"),__esModule:!0},c.exports}),a.registerDynamic("6",["5"],!0,function(a,b,c){"use strict";var d=a("5")["default"];return b["default"]=function(){function a(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),d(a,e.key,e)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),b.__esModule=!0,c.exports}),a.registerDynamic("7",[],!0,function(a,b,c){"use strict";return b["default"]=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},b.__esModule=!0,c.exports}),a.registerDynamic("8",["4","9"],!0,function(a,b,c){var d=a("4"),e=a("9");return c.exports=function(a,b){for(var c,f=e(a),g=d.getKeys(f),h=g.length,i=0;h>i;)if(f[c=g[i++]]===b)return c},c.exports}),a.registerDynamic("a",["9","4"],!0,function(a,b,c){var d=a("9"),e=a("4").getNames,f={}.toString,g="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],h=function(a){try{return e(a)}catch(b){return g.slice()}};return c.exports.get=function(a){return g&&"[object Window]"==f.call(a)?h(a):e(d(a))},c.exports}),a.registerDynamic("b",["4"],!0,function(a,b,c){var d=a("4");return c.exports=function(a){var b=d.getKeys(a),c=d.getSymbols;if(c)for(var e,f=c(a),g=d.isEnum,h=0;f.length>h;)g.call(a,e=f[h++])&&b.push(e);return b},c.exports}),a.registerDynamic("c",["d"],!0,function(a,b,c){var d=a("d");return c.exports=Array.isArray||function(a){return"Array"==d(a)},c.exports}),a.registerDynamic("e",["4","f","10","11","12","13","14","15","16","17","18","8","a","b","c","19","9","1a","1b"],!0,function(a,b,c){"use strict";var d=this,e=a("4"),f=(d=a("f"),a("10")),g=a("11"),h=a("12"),i=a("13"),j=a("14"),k=a("15"),l=a("16"),m=a("17"),n=a("18"),o=a("8"),p=a("a"),q=a("b"),r=a("c"),s=a("19"),t=a("9"),u=a("1a"),v=e.getDesc,w=e.setDesc,x=e.create,y=p.get,z=d.Symbol,A=d.JSON,B=A&&A.stringify,C=!1,D=n("_hidden"),E=e.isEnum,F=k("symbol-registry"),G=k("symbols"),H="function"==typeof z,I=Object.prototype,J=g&&j(function(){return 7!=x(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=v(I,b);d&&delete I[b],w(a,b,c),d&&a!==I&&w(I,b,d)}:w,K=function(a){var b=G[a]=x(z.prototype);return b._k=a,g&&C&&J(I,a,{configurable:!0,set:function(b){f(this,D)&&f(this[D],a)&&(this[D][a]=!1),J(this,a,u(1,b))}}),b},L=function(a){return"symbol"==typeof a},M=function(a,b,c){return c&&f(G,b)?(c.enumerable?(f(a,D)&&a[D][b]&&(a[D][b]=!1),c=x(c,{enumerable:u(0,!1)})):(f(a,D)||w(a,D,u(1,{})),a[D][b]=!0),J(a,b,c)):w(a,b,c)},N=function(a,b){s(a);for(var c,d=q(b=t(b)),e=0,f=d.length;f>e;)M(a,c=d[e++],b[c]);return a},O=function(a,b){return void 0===b?x(a):N(x(a),b)},P=function(a){var b=E.call(this,a);return!(b||!f(this,a)||!f(G,a)||f(this,D)&&this[D][a])||b},Q=function(a,b){var c=v(a=t(a),b);return!c||!f(G,b)||f(a,D)&&a[D][b]||(c.enumerable=!0),c},R=function(a){for(var b,c=y(t(a)),d=[],e=0;c.length>e;)f(G,b=c[e++])||b==D||d.push(b);return d},S=function(a){for(var b,c=y(t(a)),d=[],e=0;c.length>e;)f(G,b=c[e++])&&d.push(G[b]);return d},T=function(a){if(void 0!==a&&!L(a)){for(var b,c,d=[a],e=1,f=arguments;f.length>e;)d.push(f[e++]);return"function"==typeof(b=d[1])&&(c=b),!c&&r(b)||(b=function(a,b){return c&&(b=c.call(this,a,b)),L(b)?void 0:b}),d[1]=b,B.apply(A,d)}},U=j(function(){var a=z();return"[null]"!=B([a])||"{}"!=B({a:a})||"{}"!=B(Object(a))});H||(i((z=function(){if(L(this))throw TypeError("Symbol is not a constructor");return K(m(arguments.length>0?arguments[0]:void 0))}).prototype,"toString",function(){return this._k}),L=function(a){return a instanceof z},e.create=O,e.isEnum=P,e.getDesc=Q,e.setDesc=M,e.setDescs=N,e.getNames=p.get=R,e.getSymbols=S,g&&!a("1b")&&i(I,"propertyIsEnumerable",P,!0));var V={"for":function(a){return f(F,a+="")?F[a]:F[a]=z(a)},keyFor:function(a){return o(F,a)},useSetter:function(){C=!0},useSimple:function(){C=!1}};return e.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(a){var b=n(a);V[a]=H?b:K(b)}),C=!0,h(h.G+h.W,{Symbol:z}),h(h.S,"Symbol",V),h(h.S+h.F*!H,"Object",{create:O,defineProperty:M,defineProperties:N,getOwnPropertyDescriptor:Q,getOwnPropertyNames:R,getOwnPropertySymbols:S}),A&&h(h.S+h.F*(!H||U),"JSON",{stringify:T}),l(z,"Symbol"),l(Math,"Math",!0),l(d.JSON,"JSON",!0),c.exports}),a.registerDynamic("1c",["e","1d","1e"],!0,function(a,b,c){return a("e"),a("1d"),c.exports=a("1e").Symbol,c.exports}),a.registerDynamic("1f",["1c"],!0,function(a,b,c){return c.exports=a("1c"),c.exports}),a.registerDynamic("20",["1f"],!0,function(a,b,c){return c.exports={"default":a("1f"),__esModule:!0},c.exports}),a.registerDynamic("1d",[],!0,function(a,b,c){return c.exports}),a.registerDynamic("21",["22","23"],!0,function(a,b,c){var d=a("22"),e=a("23");return c.exports=function(a){return function(b,c){var f,g,h=String(e(b)),i=d(c),j=h.length;return 0>i||i>=j?a?"":void 0:55296>(f=h.charCodeAt(i))||f>56319||i+1===j||(g=h.charCodeAt(i+1))<56320||g>57343?a?h.charAt(i):f:a?h.slice(i,i+2):g-56320+(f-55296<<10)+65536}},c.exports}),a.registerDynamic("24",["21","25"],!0,function(a,b,c){"use strict";var d=a("21")(!0);return a("25")(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=d(b,c),this._i+=a.length,{value:a,done:!1})}),c.exports}),a.registerDynamic("26",[],!0,function(a,b,c){return c.exports=function(){},c.exports}),a.registerDynamic("27",[],!0,function(a,b,c){return c.exports=function(a,b){return{value:b,done:!!a}},c.exports}),a.registerDynamic("28",["d"],!0,function(a,b,c){var d=a("d");return c.exports=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==d(a)?a.split(""):Object(a)},c.exports}),a.registerDynamic("23",[],!0,function(a,b,c){return c.exports=function(a){if(null==a)throw TypeError("Can't call method on  "+a);return a},c.exports}),a.registerDynamic("9",["28","23"],!0,function(a,b,c){var d=a("28"),e=a("23");return c.exports=function(a){return d(e(a))},c.exports}),a.registerDynamic("29",["4","1a","16","2a","18"],!0,function(a,b,c){"use strict";var d=a("4"),e=a("1a"),f=a("16"),g={};return a("2a")(g,a("18")("iterator"),function(){return this}),c.exports=function(a,b,c){a.prototype=d.create(g,{next:e(1,c)}),f(a,b+" Iterator")},c.exports}),a.registerDynamic("25",["1b","12","13","2a","10","2b","29","16","4","18"],!0,function(a,b,c){"use strict";var d=a("1b"),e=a("12"),f=a("13"),g=a("2a"),h=a("10"),i=a("2b"),j=a("29"),k=a("16"),l=a("4").getProto,m=a("18")("iterator"),n=!([].keys&&"next"in[].keys()),o="@@iterator",p="keys",q="values",r=function(){return this};return c.exports=function(a,b,c,s,t,u,v){j(c,b,s);var w,x,y=function(a){if(!n&&a in C)return C[a];switch(a){case p:case q:return function(){return new c(this,a)}}return function(){return new c(this,a)}},z=b+" Iterator",A=t==q,B=!1,C=a.prototype,D=C[m]||C[o]||t&&C[t],E=D||y(t);if(D){var F=l(E.call(new a));k(F,z,!0),!d&&h(C,o)&&g(F,m,r),A&&D.name!==q&&(B=!0,E=function(){return D.call(this)})}if(d&&!v||!n&&!B&&C[m]||g(C,m,E),i[b]=E,i[z]=r,t)if(w={values:A?E:y(q),keys:u?E:y(p),entries:A?y("entries"):E},v)for(x in w)x in C||f(C,x,w[x]);else e(e.P+e.F*(n||B),b,w);return w},c.exports}),a.registerDynamic("2c",["26","27","2b","9","25"],!0,function(a,b,c){"use strict";var d=a("26"),e=a("27"),f=a("2b"),g=a("9");return c.exports=a("25")(Array,"Array",function(a,b){this._t=g(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,e(1)):e(0,"keys"==b?c:"values"==b?a[c]:[c,a[c]])},"values"),f.Arguments=f.Array,d("keys"),d("values"),d("entries"),c.exports}),a.registerDynamic("2d",["2c","2b"],!0,function(a,b,c){a("2c");var d=a("2b");return d.NodeList=d.HTMLCollection=d.Array,c.exports}),a.registerDynamic("1b",[],!0,function(a,b,c){return c.exports=!0,c.exports}),a.registerDynamic("12",["f","1e","2e"],!0,function(a,b,c){var d=this,e=(d=a("f"),a("1e")),f=a("2e"),g="prototype",h=function(a,b,c){var i,j,k,l=a&h.F,m=a&h.G,n=a&h.S,o=a&h.P,p=a&h.B,q=a&h.W,r=m?e:e[b]||(e[b]={}),s=m?d:n?d[b]:(d[b]||{})[g];for(i in m&&(c=b),c)(j=!l&&s&&i in s)&&i in r||(k=j?s[i]:c[i],r[i]=m&&"function"!=typeof s[i]?c[i]:p&&j?f(k,d):q&&s[i]==k?function(a){var b=function(b){return this instanceof a?new a(b):a(b)};return b[g]=a[g],b}(k):o&&"function"==typeof k?f(Function.call,k):k,o&&((r[g]||(r[g]={}))[i]=k))};return h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,c.exports=h,c.exports}),a.registerDynamic("2f",[],!0,function(a,b,c){return c.exports=function(a,b,c){if(!(a instanceof b))throw TypeError(c+": use the 'new' operator!");return a},c.exports}),a.registerDynamic("30",["19"],!0,function(a,b,c){var d=a("19");return c.exports=function(a,b,c,e){try{return e?b(d(c)[0],c[1]):b(c)}catch(f){var g=a["return"];throw void 0!==g&&d(g.call(a)),f}},c.exports}),a.registerDynamic("31",["2b","18"],!0,function(a,b,c){var d=a("2b"),e=a("18")("iterator"),f=Array.prototype;return c.exports=function(a){return void 0!==a&&(d.Array===a||f[e]===a)},c.exports}),a.registerDynamic("22",[],!0,function(a,b,c){var d=Math.ceil,e=Math.floor;return c.exports=function(a){return isNaN(a=+a)?0:(a>0?e:d)(a)},c.exports}),a.registerDynamic("32",["22"],!0,function(a,b,c){var d=a("22"),e=Math.min;return c.exports=function(a){return a>0?e(d(a),9007199254740991):0},c.exports}),a.registerDynamic("33",["d","18"],!0,function(a,b,c){var d=a("d"),e=a("18")("toStringTag"),f="Arguments"==d(function(){return arguments}());return c.exports=function(a){var b,c,g;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=(b=Object(a))[e])?c:f?d(b):"Object"==(g=d(b))&&"function"==typeof b.callee?"Arguments":g},c.exports}),a.registerDynamic("2b",[],!0,function(a,b,c){return c.exports={},c.exports}),
a.registerDynamic("34",["33","18","2b","1e"],!0,function(a,b,c){var d=a("33"),e=a("18")("iterator"),f=a("2b");return c.exports=a("1e").getIteratorMethod=function(a){return null!=a?a[e]||a["@@iterator"]||f[d(a)]:void 0},c.exports}),a.registerDynamic("35",["2e","30","31","19","32","34"],!0,function(a,b,c){var d=a("2e"),e=a("30"),f=a("31"),g=a("19"),h=a("32"),i=a("34");return c.exports=function(a,b,c,j){var k,l,m,n=i(a),o=d(c,j,b?2:1),p=0;if("function"!=typeof n)throw TypeError(a+" is not iterable!");if(f(n))for(k=h(a.length);k>p;p++)b?o(g(l=a[p])[0],l[1]):o(a[p]);else for(m=n.call(a);!(l=m.next()).done;)e(m,o,l.value,b)},c.exports}),a.registerDynamic("36",["4","37","19","2e"],!0,function(a,b,c){var d=a("4").getDesc,e=a("37"),f=a("19"),g=function(a,b){if(f(a),!e(b)&&null!==b)throw TypeError(b+": can't set as prototype!")};return c.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(b,c,e){try{(e=a("2e")(Function.call,d(Object.prototype,"__proto__").set,2))(b,[]),c=!(b instanceof Array)}catch(f){c=!0}return function(a,b){return g(a,b),c?a.__proto__=b:e(a,b),a}}({},!1):void 0),check:g},c.exports}),a.registerDynamic("38",[],!0,function(a,b,c){return c.exports=Object.is||function(a,b){return a===b?0!==a||1/a==1/b:a!=a&&b!=b},c.exports}),a.registerDynamic("19",["37"],!0,function(a,b,c){var d=a("37");return c.exports=function(a){if(!d(a))throw TypeError(a+" is not an object!");return a},c.exports}),a.registerDynamic("39",["19","3a","18"],!0,function(a,b,c){var d=a("19"),e=a("3a"),f=a("18")("species");return c.exports=function(a,b){var c,g=d(a).constructor;return void 0===g||null==(c=d(g)[f])?b:e(c)},c.exports}),a.registerDynamic("3a",[],!0,function(a,b,c){return c.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},c.exports}),a.registerDynamic("2e",["3a"],!0,function(a,b,c){var d=a("3a");return c.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},c.exports}),a.registerDynamic("3b",[],!0,function(a,b,c){return c.exports=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)},c.exports}),a.registerDynamic("3c",["f"],!0,function(a,b,c){return c.exports=a("f").document&&document.documentElement,c.exports}),a.registerDynamic("37",[],!0,function(a,b,c){return c.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a},c.exports}),a.registerDynamic("3d",["37","f"],!0,function(a,b,c){var d=a("37"),e=a("f").document,f=d(e)&&d(e.createElement);return c.exports=function(a){return f?e.createElement(a):{}},c.exports}),a.registerDynamic("3e",["2e","3b","3c","3d","f","d","3f"],!0,function(a,b,c){return function(b){var d,e,f,g=a("2e"),h=a("3b"),i=a("3c"),j=a("3d"),k=a("f"),l=(b=k.process,k.setImmediate),m=k.clearImmediate,n=k.MessageChannel,o=0,p={},q="onreadystatechange",r=function(){var a=+this;if(p.hasOwnProperty(a)){var b=p[a];delete p[a],b()}},s=function(a){r.call(a.data)};l&&m||(l=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return p[++o]=function(){h("function"==typeof a?a:Function(a),b)},d(o),o},m=function(a){delete p[a]},"process"==a("d")(b)?d=function(a){b.nextTick(g(r,a,1))}:n?(f=(e=new n).port2,e.port1.onmessage=s,d=g(f.postMessage,f,1)):k.addEventListener&&"function"==typeof postMessage&&!k.importScripts?(d=function(a){k.postMessage(a+"","*")},k.addEventListener("message",s,!1)):d=q in j("script")?function(a){i.appendChild(j("script"))[q]=function(){i.removeChild(this),r.call(a)}}:function(a){setTimeout(g(r,a,1),0)}),c.exports={set:l,clear:m}}(a("3f")),c.exports}),a.registerDynamic("d",[],!0,function(a,b,c){var d={}.toString;return c.exports=function(a){return d.call(a).slice(8,-1)},c.exports}),a.registerDynamic("40",["f","3e","d","3f"],!0,function(a,b,c){return function(b){var d,e,f,g=a("f"),h=a("3e").set,i=g.MutationObserver||g.WebKitMutationObserver,j=(b=g.process,g.Promise),k="process"==a("d")(b),l=function(){var a,c,f;for(k&&(a=b.domain)&&(b.domain=null,a.exit());d;)c=d.domain,f=d.fn,c&&c.enter(),f(),c&&c.exit(),d=d.next;e=void 0,a&&a.enter()};if(k)f=function(){b.nextTick(l)};else if(i){var m=1,n=document.createTextNode("");new i(l).observe(n,{characterData:!0}),f=function(){n.data=m=-m}}else f=j&&j.resolve?function(){j.resolve().then(l)}:function(){h.call(g,l)};c.exports=function(a){var c={fn:a,next:void 0,domain:k&&b.domain};e&&(e.next=c),d||(d=c,f()),e=c}}(a("3f")),c.exports}),a.registerDynamic("1a",[],!0,function(a,b,c){return c.exports=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},c.exports}),a.registerDynamic("2a",["4","1a","11"],!0,function(a,b,c){var d=a("4"),e=a("1a");return c.exports=a("11")?function(a,b,c){return d.setDesc(a,b,e(1,c))}:function(a,b,c){return a[b]=c,a},c.exports}),a.registerDynamic("13",["2a"],!0,function(a,b,c){return c.exports=a("2a"),c.exports}),a.registerDynamic("41",["13"],!0,function(a,b,c){var d=a("13");return c.exports=function(a,b){for(var c in b)d(a,c,b[c]);return a},c.exports}),a.registerDynamic("10",[],!0,function(a,b,c){var d={}.hasOwnProperty;return c.exports=function(a,b){return d.call(a,b)},c.exports}),a.registerDynamic("16",["4","10","18"],!0,function(a,b,c){var d=a("4").setDesc,e=a("10"),f=a("18")("toStringTag");return c.exports=function(a,b,c){a&&!e(a=c?a:a.prototype,f)&&d(a,f,{configurable:!0,value:b})},c.exports}),a.registerDynamic("4",[],!0,function(a,b,c){var d=Object;return c.exports={create:d.create,getProto:d.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:d.getOwnPropertyDescriptor,setDesc:d.defineProperty,setDescs:d.defineProperties,getKeys:d.keys,getNames:d.getOwnPropertyNames,getSymbols:d.getOwnPropertySymbols,each:[].forEach},c.exports}),a.registerDynamic("14",[],!0,function(a,b,c){return c.exports=function(a){try{return!!a()}catch(b){return!0}},c.exports}),a.registerDynamic("11",["14"],!0,function(a,b,c){return c.exports=!a("14")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),c.exports}),a.registerDynamic("42",["1e","4","11","18"],!0,function(a,b,c){"use strict";var d=a("1e"),e=a("4"),f=a("11"),g=a("18")("species");return c.exports=function(a){var b=d[a];f&&b&&!b[g]&&e.setDesc(b,g,{configurable:!0,get:function(){return this}})},c.exports}),a.registerDynamic("15",["f"],!0,function(a,b,c){var d=this,e="__core-js_shared__",f=(d=a("f"))[e]||(d[e]={});return c.exports=function(a){return f[a]||(f[a]={})},c.exports}),a.registerDynamic("17",[],!0,function(a,b,c){var d=0,e=Math.random();return c.exports=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++d+e).toString(36))},c.exports}),a.registerDynamic("f",[],!0,function(a,b,c){var d=this;d=c.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();return"number"==typeof __g&&(__g=d),c.exports}),a.registerDynamic("18",["15","17","f"],!0,function(a,b,c){var d=a("15")("wks"),e=a("17"),f=a("f").Symbol;return c.exports=function(a){return d[a]||(d[a]=f&&f[a]||(f||e)("Symbol."+a))},c.exports}),a.registerDynamic("43",["18"],!0,function(a,b,c){var d=a("18")("iterator"),e=!1;try{var f=[7][d]();f["return"]=function(){e=!0},Array.from(f,function(){throw 2})}catch(g){}return c.exports=function(a,b){if(!b&&!e)return!1;var c=!1;try{var f=[7],g=f[d]();g.next=function(){c=!0},f[d]=function(){return g},a(f)}catch(h){}return c},c.exports}),a.registerDynamic("44",[],!0,function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=c.exports={},j=[],k=!1,l=-1;return i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")},i.umask=function(){return 0},c.exports}),a.registerDynamic("45",["44"],!0,function(a,b,c){return c.exports=a("44"),c.exports}),a.registerDynamic("46",["45"],!0,function(b,c,d){return d.exports=a._nodeRequire?process:b("45"),d.exports}),a.registerDynamic("3f",["46"],!0,function(a,b,c){return c.exports=a("46"),c.exports}),a.registerDynamic("47",["4","1b","f","2e","33","12","37","19","3a","2f","35","36","38","18","39","40","11","41","16","42","1e","43","3f"],!0,function(a,b,c){return function(b){"use strict";var c,d=a("4"),e=a("1b"),f=a("f"),g=a("2e"),h=a("33"),i=a("12"),j=a("37"),k=a("19"),l=a("3a"),m=a("2f"),n=a("35"),o=a("36").set,p=a("38"),q=a("18")("species"),r=a("39"),s=a("40"),t="Promise",u="process"==h(b=f.process),v=f[t],w=function(a){var b=new v(function(){});return a&&(b.constructor=Object),v.resolve(b)===b},x=function(){function b(a){var c=new v(a);return o(c,b.prototype),c}var c=!1;try{if(c=v&&v.resolve&&w(),o(b,v),b.prototype=d.create(v.prototype,{constructor:{value:b}}),b.resolve(5).then(function(){})instanceof b||(c=!1),c&&a("11")){var e=!1;v.resolve(d.setDesc({},"then",{get:function(){e=!0}})),c=e}}catch(f){c=!1}return c}(),y=function(a,b){return!(!e||a!==v||b!==c)||p(a,b)},z=function(a){var b=k(a)[q];return null!=b?b:a},A=function(a){var b;return!(!j(a)||"function"!=typeof(b=a.then))&&b},B=function(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=l(b),this.reject=l(c)},C=function(a){try{a()}catch(b){return{error:b}}},D=function(a,c){if(!a.n){a.n=!0;var d=a.c;s(function(){for(var e=a.v,g=1==a.s,h=0,i=function(b){var c,d,f=g?b.ok:b.fail,h=b.resolve,i=b.reject;try{f?(g||(a.h=!0),(c=!0===f?e:f(e))===b.promise?i(TypeError("Promise-chain cycle")):(d=A(c))?d.call(c,h,i):h(c)):i(e)}catch(j){i(j)}};d.length>h;)i(d[h++]);d.length=0,a.n=!1,c&&setTimeout(function(){var c,d,g=a.p;E(g)&&(u?b.emit("unhandledRejection",e,g):(c=f.onunhandledrejection)?c({promise:g,reason:e}):(d=f.console)&&d.error&&d.error("Unhandled promise rejection",e)),a.a=void 0},1)})}},E=function(a){var b,c=a._d,d=c.a||c.c,e=0;if(c.h)return!1;for(;d.length>e;)if((b=d[e++]).fail||!E(b.promise))return!1;return!0},F=function(a){var b=this;b.d||(b.d=!0,(b=b.r||b).v=a,b.s=2,b.a=b.c.slice(),D(b,!0))},G=function(a){var b,c=this;if(!c.d){c.d=!0,c=c.r||c;try{if(c.p===a)throw TypeError("Promise can't be resolved itself");(b=A(a))?s(function(){var d={r:c,d:!1};try{b.call(a,g(G,d,1),g(F,d,1))}catch(e){F.call(d,e)}}):(c.v=a,c.s=1,D(c,!1))}catch(d){F.call({r:c,d:!1},d)}}};x||(v=function(a){l(a);var b=this._d={p:m(this,v,t),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{a(g(G,b,1),g(F,b,1))}catch(c){F.call(b,c)}},a("41")(v.prototype,{then:function(a,b){var c=new B(r(this,v)),d=c.promise,e=this._d;return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,e.c.push(c),e.a&&e.a.push(c),e.s&&D(e,!1),d},"catch":function(a){return this.then(void 0,a)}})),i(i.G+i.W+i.F*!x,{Promise:v}),a("16")(v,t),a("42")(t),c=a("1e")[t],i(i.S+i.F*!x,t,{reject:function(a){var b=new B(this);return(0,b.reject)(a),b.promise}}),i(i.S+i.F*(!x||w(!0)),t,{resolve:function(a){if(a instanceof v&&y(a.constructor,this))return a;var b=new B(this);return(0,b.resolve)(a),b.promise}}),i(i.S+i.F*!(x&&a("43")(function(a){v.all(a)["catch"](function(){})})),t,{all:function(a){var b=z(this),c=new B(b),e=c.resolve,f=c.reject,g=[],h=C(function(){n(a,!1,g.push,g);var c=g.length,h=Array(c);c?d.each.call(g,function(a,d){var g=!1;b.resolve(a).then(function(a){g||(g=!0,h[d]=a,--c||e(h))},f)}):e(h)});return h&&f(h.error),c.promise},race:function(a){var b=z(this),c=new B(b),d=c.reject,e=C(function(){n(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e&&d(e.error),c.promise}})}(a("3f")),c.exports}),a.registerDynamic("1e",[],!0,function(a,b,c){var d=c.exports={version:"1.2.6"};return"number"==typeof __e&&(__e=d),c.exports}),a.registerDynamic("48",["1d","24","2d","47","1e"],!0,function(a,b,c){return a("1d"),a("24"),a("2d"),a("47"),c.exports=a("1e").Promise,c.exports}),a.registerDynamic("49",["48"],!0,function(a,b,c){return c.exports={"default":a("48"),__esModule:!0},c.exports}),a.register("4a",["6","7","20","49"],function(a){var b,c,d,e,f,g;return{setters:[function(a){b=a["default"]},function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]}],execute:function(){"use strict";f=d("instance"),g=function(){function a(){if(c(this,a),a[f])throw"H2CLoader is already defined!";a[f]=this,this.loaded=!1}return b(a,null,[{key:"instance",get:function(){return a[f]||(a[f]=new a)}}]),b(a,[{key:"load",value:function(a){return this.loaded?e.resolve():this._promise?this._promise:(this._promise=new e(function(b,c){var d=document.createElement("script");d.setAttribute("type","text/javascript"),d.src=a;var e=!1;d.onload=d.onreadystatechange=function(){e&&this.readyState&&"complete"!==this.readyState||(e=!0,b())},d.onerror=c,document.body.appendChild(d)}),this._promise)}}]),a}(),a("default",g)}}}),a.register("4b",["2","6","7","20","4a"],function(a){var b,c,d,e,f,g,h;return{setters:[function(a){b=a.VERSION},function(a){c=a["default"]},function(a){d=a["default"]},function(a){e=a["default"]},function(a){f=a["default"]}],execute:function(){"use strict";g=e("canvas"),h=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];d(this,a);var c=b.html2canvas,e=b.proxy;this.options={},this.options.html2canvas=c||"//s3-eu-west-1.amazonaws.com/meetingassets/html2canvas.js",this.options.proxy=e||!1}return c(a,[{key:"canvas",get:function(){return this[g]}}],[{key:"render",value:function(){var b=arguments.length<=0||void 0===arguments[0]?document.body:arguments[0];return new a(arguments.length<=1||void 0===arguments[1]?{}:arguments[1]).render(b)}},{key:"version",get:function(){return b}}]),c(a,[{key:"render",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]?document.body:arguments[0];return f.instance.load(this.options.html2canvas).then(function(){return html2canvas(b,a.options).then(function(b){return a[g]=b})})}}]),a}(),a("default",h)}}}),a.register("1",["4b"],function(){"use strict";var b;return{setters:[function(a){b=a["default"]}],execute:function(){window.screenback=b}}})})(function(a){a()}),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),pi.tools.Feedback=function(){function Feedback(url,options){this.url=url,this.options=null!=options?options:{}}return Feedback.prototype.show=function(){return pi.app.view.feedback_btn.disable(),pi.app.view.feedback_form.show()},Feedback.prototype.hide=function(){return pi.app.view.feedback_form.hide(),pi.app.view.feedback_btn.enable()},Feedback.prototype.user_info=function(){var data,ref,user;return(user=null!=(ref=pi.app)?ref.user:void 0)?((data={}).email=user.email,data.user_id=user.id,data.username=user.name+" "+user.last_name,data.user_role_id=user.role_id,data.account_id=user.account_id,data):{}},Feedback.prototype.browser_info=function(){var data;return null!=pi.app.perf?((data=pi.app.perf.browser_data()).ip=pi.app.perf.options.ip,data.page_url=window.location.href,data.ua=navigator.userAgent,data):{browser:bowser.name,browser_version:bowser.version,ua:navigator.userAgent,page_url:window.location.href}},Feedback.prototype.render=function(){return this.screenback=new screenback(this.options),pi.app.view.feedback_form.hide(),this.screenback.render().then(function(canvas){return pi.app.view.feedback_form.show(),canvas},function(err){throw pi.app.view.feedback_form.show(),err})},Feedback.prototype.clear_screen=function(){return delete this.screenback},Feedback.prototype.submit=function(data){var ref,req_data;return req_data=utils.merge(data,{user_info:this.user_info(),browser_info:this.browser_info()}),null!=(null!=(ref=this.screenback)?ref.canvas:void 0)&&(req_data.screenshot=this.screenback.canvas.toDataURL()),utils.info(req_data),pi.net.post(this.url,req_data).then(function(response){if(null!=(null!=response?response.errorMessage:void 0))throw Error(esponse.errorMessage);return response})},Feedback}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.tools||(pi.tools={}),pi.tools.Highlight=function(){function Highlight(){}return Highlight.instance=null,Highlight.get=function(){return this.instance||(this.instance=new this)},Highlight.prototype.process=function(text){return text?this.loaded().then(function(){return Promise.resolve(hljs.highlightAuto(text))}):Promise.reject()},Highlight.prototype.loaded=function(){return null!=this._ready_promise?this._ready_promise:this._ready_promise=pi.tools.ScriptLoader.load("hljs","//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/highlight.min.js").then(function(){return hljs.configure({tabReplace:"    "})})},Highlight}()}(this)}.call(this),function(){!function(context){"use strict";var _available,pi;(pi=context.pi).utils,pi.tools||(pi.tools={}),_available=!!window.Blob,pi.tools.LocalDownload=function(){function LocalDownload(){}return LocalDownload.available=function(){return _available},LocalDownload.serve=function(data,filename,type){var _link,blob,options,url;if(null==filename&&(filename="export"),_available){if(options={},null!=type&&(options.type=type),blob=new Blob([data],options),navigator.msSaveBlob)navigator.msSaveBlob(blob,filename);else{if(null!=(_link=document.createElement("a")).download)url=URL.createObjectURL(blob),_link.setAttribute("download",filename);else{if("string"!=typeof data)return!1;url="data:application/octet-stream,"+encodeURIComponent(data)}_link.setAttribute("href",url),_link.style.visibility="hidden",document.body.appendChild(_link),_link.click(),document.body.removeChild(_link)}return!0}},LocalDownload.binary_to_octet=function(s){var buf,i,view;for(buf=new ArrayBuffer(s.length),view=new Uint8Array(buf),i=0;i<s.length;)view[i]=255&s.charCodeAt(i),i++;return buf},LocalDownload}()}(this)}.call(this),function(){!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),pi.tools.Math=function(){function Math(){}return Math.instance=null,Math.get=function(){return this.instance||(this.instance=new this)},Math.prototype.process=function(node){return node?this.loaded().then(function(){return new Promise(function(resolve){return MathJax.Hub.Queue(["Typeset",MathJax.Hub,node],resolve)})}):Promise.reject()},Math.prototype.loaded=function(){return null!=this._ready_promise?this._ready_promise:this._ready_promise=new Promise(function(resolve){return resolve=utils.delayed(500,resolve),window.MathJax={skipStartupTypeset:!0,showMathMenu:!1,showMathMenuMSIE:!1,showProcessingMessages:!1,tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],processEscapes:!0},AuthorInit:function(){return MathJax.Hub.Register.StartupHook("End",resolve)}},pi.tools.ScriptLoader.load("mathjax","//cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS_HTML"),!0})},Math}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty,slice=[].slice;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.MeetingApplet=function(superClass){function MeetingApplet(){return MeetingApplet.__super__.constructor.apply(this,arguments)}return extend(MeetingApplet,superClass),MeetingApplet.prototype.defaults={name:"TBSS",code:"org.redfire.screen.ScreenShareApplet",codebase:"/libs/meeting",cache_option:"no",archive:"screen_sharing_app_040215.jar",width:1,height:1,id:"japp"},MeetingApplet.prototype.initialize=function(){return utils.extend(this.options,this.defaults),this.version="1.7",MeetingApplet.__super__.initialize.apply(this,arguments)},MeetingApplet.prototype.writeTo=function(node,fun){var content,oldwrite;return oldwrite=document.write,content="",document.write=function(text){return content+=text},fun.call(null),document.write=oldwrite,node.innerHTML=content},MeetingApplet.prototype.available=function(){return null!=window.deployJava&&deployJava.versionCheck(this.version+"+")},MeetingApplet.prototype.run=function(host,port,mid,uid){var parameters,_this;return this.available()?(parameters={host:host,name:"Teachbase Screen Sharing App",app:"tbshare/"+mid,stream_name:"share_stream?session_id="+uid,port:port,cache_option:"no",videoWidth:"1024",videoHeight:"768",fps:"2"},this.writeTo(this.node,(_this=this,function(){return deployJava.runApplet(_this.options,parameters,_this.version)})),!0):(window.open("http://java.com/en/download/testjava.jsp","_blank"),!1)},MeetingApplet.prototype.stop=function(){return this.remove_children()},MeetingApplet}(pi.Base),context.exCall=function(){var args,mapp,ref;return args=1<=arguments.length?slice.call(arguments,0):[],!(null==(mapp=$(".meeting-applet"))||!args.length)&&(null!=(ref=mapp[args[0]])&&"function"==typeof ref.apply?ref.apply(mapp,args.slice(1)):void 0)}}(this)}.call(this),function(){var hasProp={}.hasOwnProperty;!function(context){"use strict";var WS_APP,pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),WS_APP="tb_perf",pi.tools.PerfWatcher=function(){function PerfWatcher(params){var _this;(null==params&&(params={}),this.options={user_id:params.user_id,ip:params.ip},this.page_id=params.page_id||"",this.enabled=WS_PATH&&!pi.app.user.admin,this.enabled)&&(pi.tools.Socket.available&&(this.socket=pi.app.socket||(pi.app.socket=new pi.tools.MultiSocket(WS_PATH+"/ws/mpx")),this.socket.subscribe(WS_APP)),pi.Nod.win.one("load",(_this=this,function(){return after(1e3,function(){return _this.page_loaded()})})))}return PerfWatcher.prototype.page_loaded=function(){var _timings,load_data,point;try{load_data={connect_time:(_timings=timing.getTimes()).connectTime,redirect_time:_timings.redirectTime,req_time:_timings.requestTime,dom_time:_timings.domReadyTime+_timings.initDomTreeTime,pi_time:pi.__init_time__,load_time:_timings.loadTime}}catch(error1){error1,utils.local_error("perf timing not supported"),load_data={pi_time:pi.__init_time__}}return load_data.page_id=this.page_id,point=utils.merge(utils.merge(this.browser_data(),load_data),this.options),utils.debug("Page load data",point),this.socket?this.write_point("perf_load_page",point):pi.app.user.admin?void 0:pi.Net.post("/api/trackings.json",{series:"perf_load_page",data:point})},PerfWatcher.prototype.ajax_loaded=function(page_id,ts){var load_data,point;return load_data={page_id:page_id,req_time:ts},point=utils.merge(utils.merge(this.browser_data(),load_data),this.options),this.write_point("perf_load_ajax",point)},PerfWatcher.prototype.ws_failed=function(reason){var point;if(this.enabled)return point=utils.merge(utils.merge(this.browser_data(),{reason:reason}),this.options),pi.Net.post("/api/trackings.json",{series:"perf_ws",data:point})},PerfWatcher.prototype.ws_connected=function(ts){var load_data,point;return load_data={connect_time:ts},point=utils.merge(utils.merge(this.browser_data(),load_data),this.options),this.write_point("perf_load_ws",point)},PerfWatcher.prototype.write_point=function(series,point){var _point,data,key,val;if(this.enabled&&this.socket){for(key in data={name:series,columns:[],points:[]},_point=[],point)hasProp.call(point,key)&&(val=point[key],data.columns.push(key),_point.push(val));return data.points.push(_point),this.socket.write(WS_APP,[data])}},PerfWatcher.prototype.browser_data=function(){var _os,_os_info,_version;return null==this.__br_data__&&(_os_info=utils.browser.os(),_os=function(){switch(!1){case!_os_info.windows:return"win";case!_os_info.macos:return"macos";case!_os_info.unix:return"unix";case!(_os_info.iphone||_os_info.ipod||_os_info.ipad):return"ios";case!_os_info.android:return"android";default:return"other"}}(),_version=0|utils.browser.info().version,this.__br_data__={browser:utils.browser.info().name,browser_version:_version,os:_os}),this.__br_data__},PerfWatcher}()}(this)}.call(this),function(){!function(context){"use strict";var pi;(pi=context.pi).utils,pi.tools||(pi.tools={}),pi.tools.ScriptLoader=function(){function ScriptLoader(){}return ScriptLoader.pending={},ScriptLoader.load=function(id,path,options){var _promise;return null==options&&(options={}),id&&this.pending[id]?this.pending[id]:(_promise=new Promise(function(resolve,reject){var flag,nod;return(nod=pi.Nod.create("script")).attr("type","text/javascript"),null!=options.attrs&&nod.attrs(options.attrs),nod.node.src=path,flag=!1,nod.node.onload=nod.node.onreadystatechange=function(){if(!(flag||this.readyState&&"complete"!==this.readyState))return flag=!0,resolve()},nod.node.onerror=reject,pi.Nod.body.append(nod)}),null!=id?this.pending[id]=_promise:_promise)},ScriptLoader}()}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var Channel,LS_KEY,_available,pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),_available=!!window.WebSocket,LS_KEY="tb:_ws_fail",pi.tools.Socket=function(superClass){function Socket(path,options){this.path=path,null==options&&(options={}),Socket.__super__.constructor.apply(this,arguments),this.retry_count=0,this._retry=options.retry||1,this._json=options.json||!0,this._flush=options.flush||!0}return extend(Socket,superClass),Socket.available=_available,Socket.register_fail=function(reason){var ref;return null==reason&&(reason="fail"),!sessionStorage.getItem(LS_KEY)&&(null!=(ref=pi.app.perf)&&ref.ws_failed(reason).then(function(){return sessionStorage.setItem(LS_KEY,1)}),!0)},Socket.prototype.init=function(){return this.connected=!1,this.state="connecting",this._start_ts=+new Date,this.socket=new WebSocket(this.path),this._add_listeners()},Socket.prototype.handle_close=function(){return this._hc||(this._hc=(_this=this,function(e){return _this.connected=!1,_this.state="close",clearTimeout(_this.__retry_clear_id),e.wasClean?(_this.trigger("close",{code:e.code}),_this.dispose()):_this._try_to_reconnect(e)}));var _this},Socket.prototype.handle_open=function(){return this._ho||(this._ho=(_this=this,function(){var ref,ts;return _this.state="open",_this.connected=!0,_this.__retry_clear_id=utils.after(1e3,function(){return _this.retry_count=0}),ts=+new Date-_this._start_ts,null!=(ref=pi.app.perf)&&ref.ws_connected(ts),_this.trigger("open"),_this.flush()}));var _this},Socket.prototype.handle_message=function(){return this._hm||(this._hm=(_this=this,function(e){return _this.trigger("message",e.data)}));var _this},Socket.prototype.write=function(data){return this.connected?this.socket.send(data):this._flush?(this._buffer||(this._buffer=[])).push(data):void 0},Socket.prototype.flush=function(){var i,len,msg,ref;if(this._flush&&this._buffer){for(i=0,len=(ref=this._buffer).length;i<len;i++)msg=ref[i],this.write(msg);return this._buffer=null}},Socket.prototype._try_to_reconnect=function(e){return this.retry_count>=this._retry?(this.constructor.register_fail(),this.trigger("close",{code:e.code}),this.dispose()):(this.retry_count+=1,this._remove_listeners(),utils.after(1e3,(_this=this,function(){return _this.init()})));var _this},Socket.prototype._add_listeners=function(){return this.socket.addEventListener("open",this.handle_open()),this.socket.addEventListener("message",this.handle_message()),this.socket.addEventListener("close",this.handle_close())},Socket.prototype._remove_listeners=function(){return this.socket.removeEventListener("open",this.handle_open()),this.socket.removeEventListener("message",this.handle_message()),this.socket.removeEventListener("close",this.handle_close())},Socket.prototype.dispose=function(){return this._remove_listeners(),this.connected&&this.socket.close(),this.connected=!1,this.state="disposed",this.socket=null,this.off()},Socket}(pi.EventDispatcher),Channel=function(){function Channel(app1,socket){this.app=app1,this.socket=socket,this._buffer=[],this.subscribe()}return Channel.prototype.subscribe=function(){return this.open=!1,this.socket.raw_write(this.app+",sub")},Channel.prototype.write=function(data){var msg;return this.open?(msg=this.app+","+JSON.stringify(data),this.socket.raw_write(msg)):this._buffer.push(data)},Channel.prototype.close=function(){if(this.open)return this.socket.raw_write(this.app+",unsub")},Channel.prototype.handle_message=function(data){var i,len,msg,ref;if("open"===data){for(this.open=!0,i=0,len=(ref=this._buffer).length;i<len;i++)msg=ref[i],this.write(msg);return this._buffer.length=0}return"close"===data?(this.open=!1,this.socket.unsubscribe(this.app)):this.socket.trigger("message:"+this.app,data)},Channel}(),pi.tools.MultiSocket=function(superClass){function MultiSocket(path,options1){this.path=path,this.options=options1,MultiSocket.__super__.constructor.apply(this,arguments),this.channels={}}return extend(MultiSocket,superClass),MultiSocket.prototype.subscribe=function(app){var base;return(base=this.channels)[app]||(base[app]=new Channel(app,this))},MultiSocket.prototype.unsubscribe=function(app){var ref;return null!=(ref=this.channels[app])&&ref.close(),delete this.channels[app]},MultiSocket.prototype.hibernate=function(){var _,ref;if(!this._hibernated){for(_ in this._initialized=!1,this._hibernated=!0,this.socket&&this.socket.dispose(),ref=this.channels)hasProp.call(ref,_)&&(ref[_].open=!1);return this.socket=null}},MultiSocket.prototype.init=function(){var _,c,ref,results;if(!this._initialized){for(_ in this.hibernate(),this._initialized=!0,this._hibernated=!1,this.socket=new pi.tools.Socket(this.path,this.options),this.socket.on("message",this.message_hanlder()),this.socket.init(),results=[],ref=this.channels)hasProp.call(ref,_)&&(c=ref[_],results.push(c.subscribe()));return results}},MultiSocket.prototype.write=function(app,data){var ref;return this._initialized||this.init(),null!=(ref=this.channels[app])?ref.write(data):void 0},MultiSocket.prototype.raw_write=function(msg){return this._initialized||this.init(),this.socket.write(msg)},MultiSocket.prototype.message_hanlder=function(){return this._msg_handler||(this._msg_handler=(_this=this,function(e){var app,data,ref,ref1;return(ref=e.data.split(/^([^,]+),/))[0],app=ref[1],data=ref[2],null!=(ref1=_this.channels[app])?ref1.handle_message(data):void 0}));var _this},MultiSocket}(pi.EventDispatcher)}(this)}.call(this),function(){var extend=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},hasProp={}.hasOwnProperty;!function(context){"use strict";var pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),pi.tools.Tourer=function(superClass){function Tourer(){Tourer.__super__.constructor.apply(this,arguments),this.enabled=!0}return extend(Tourer,superClass),Tourer.prototype.disable=function(){if(this.enabled)return this.enabled=!1},Tourer.prototype.enable=function(){if(!this.enabled)return this.enabled=!0},Tourer.prototype.run_for=function(controller_id,force){var code,j,len,list,ref;if(null==force&&(force=!1),(list=null!=(ref=pi.app.tours_map)?ref[controller_id]:void 0)&&list.length){if(force||!pi.app.user)return this.run(0|list[0]);for(j=0,len=list.length;j<len;j++)if(code=list[j],!pi.app.user.has_tour(code))return this.run(code)}},Tourer.prototype.run=function(id){var _this;if(this.enabled)return this.load(id)["catch"](function(e){return utils.error("Error creating tour",e)}).then((_this=this,function(tour){var ref;if(_this.cancel_tour(),tour)return _this.tour=tour,_this.tour.once("complete",function(){return _this.stop()}),_this.tour.once("cancel",function(){return _this.stop()}),_this.tour.on("show",function(data){return _this.hide_step(data.previous),
_this.show_step(data.step)}),_this.running=!0,_this.tour.start(),_this.trigger("started"),null!=(ref=pi.app.view.help_callout)?ref.deactivate():void 0}))},Tourer.prototype.stop=function(){var ref;if(this.running)return null!=(ref=pi.app.user)&&ref.commit_tour(this.tour.__model__),this.hide_step(this.active_step),this.cancel_tour(),this.hide_overlay(),this.running=!1,this.trigger("stopped")},Tourer.prototype.cancel_tour=function(){var j,len,ref,vid;if(null!=this.tour){if(this.tour.off("complete"),this.tour.off("cancel"),null!=this.tour.__videos__)for(j=0,len=(ref=this.tour.__videos__).length;j<len;j++)vid=ref[j],this.stop_video(vid);return this.tour.cancel(),this.tour=null}},Tourer.prototype.create_tour=function(id,model){var btns,defaults,i,j,lang_opts,len,opts,ref,ref1,st,step,tour;if(Shepherd.Tour&&(null!=(ref=model.steps)?ref.length:void 0)){for(tour=new Shepherd.Tour,defaults={scrollTo:!1,showCancelLink:!0,cancelLinkClasses:"button-close grey-text inline-right",classes:"shepherd shepherd-open shepherd-theme-arrows shepherd-transparent-text"},i=j=0,len=(ref1=model.steps).length;j<len;i=++j)step=ref1[i],btns=[{text:I18n.t("tours.next"),action:tour.next,classes:"pi-button-blue inline"}],i>0&&btns.unshift({text:I18n.t("tours.back"),action:tour.back,classes:"pi-button-grey inline"}),(opts=utils.merge(defaults,{attachTo:step.attachTo})).buttons=btns,lang_opts=step[I18n.locale],utils.extend(opts,lang_opts),lang_opts.video?(opts.text='<div class="shepherd-video"></div>',opts.onshow=function(_this){return function(step){return _this.play_video(step)}}(this),opts.onhide=function(_this){return function(step){return _this.pause_video(step)}}(this)):(null!=step.show&&(opts.onshow=pi.Compiler.str_to_fun(step.show)),null!=step.hide&&(opts.onhide=pi.Compiler.str_to_fun(step.hide))),st=tour.addStep(i,opts),null!=step.video&&(tour.__videos__||(tour.__videos__=[])).push(st);return tour.__model__=model,model.__tour__=tour,tour}},Tourer.prototype.load=function(id){var model,_this;return(model=$r.Tour.get_by({code:id}))?utils.resolved_promise(model.__tour__||this.cancel_tour(id,model)):$r.Tour.show({id:id})["catch"](function(e){return utils.error(e)}).then((_this=this,function(tour){return _this.create_tour(id,tour)}))},Tourer.prototype.hide_step=function(step){return step&&step.options.onhide&&"function"==typeof step.options.onhide&&step.options.onhide.call(null,step)},Tourer.prototype.show_step=function(step){var ref,target;return utils.info("show step",step),this.active_step=step,this.overlay||(this.overlay=this.create_overlay()),step.options.onshow&&"function"==typeof step.options.onshow&&step.options.onshow.call(null,step),null!=(target=null!=(ref=step.options.attachTo)?ref.element:void 0)?(target="string"==typeof target?pi.Nod.body.find(target):pi.Nod.create(target)).insertBefore(this.overlay):pi.Nod.body.prepend(this.overlay),this.overlay.show()},Tourer.prototype.hide_overlay=function(){var ref,ref1;return null!=(ref=this.overlay)&&ref.hide(),null!=(ref1=this.overlay)?ref1.detach():void 0},Tourer.prototype.create_overlay=function(){return this.overlay=pi.Nod.create("div").piecify(),this.overlay.hide(),this.overlay.addClass("pi-overlay","shepherd-overlay"),this.overlay},Tourer.prototype.create_video=function(node){var api;return(api=new pi.YoutubeViewer(node)).addClass("is-loading"),api},Tourer.prototype.stop_video=function(step){var ref,ref1;return null!=(ref=step.options.api)&&ref.stop(),null!=(ref1=step.options.api)?ref1.deactivate():void 0},Tourer.prototype.play_video=function(step){var opts,ref,ref1;return null==(opts=step.options).api&&(step.el||step.render(),opts.api=this.create_video(pi.Nod.create(step.el).find(".shepherd-video").node),opts.api.load(opts.video,{autoplay:!0})),null!=(ref=opts.api)&&ref.play(),null!=(ref1=step.options.api)?ref1.activate():void 0},Tourer.prototype.pause_video=function(step){var ref;return step.options.api.pause(),null!=(ref=step.options.api)?ref.deactivate():void 0},Tourer}(pi.EventDispatcher)}(this)}.call(this),function(){!function(context){"use strict";var FLUSH_TIMEOUT,INTERVAL,WS_APP,WS_HIBERNATE_TIMEOUT,pi,utils;pi=context.pi,utils=pi.utils,pi.tools||(pi.tools={}),INTERVAL=6e4,WS_APP="tb_visits",WS_HIBERNATE_TIMEOUT=2e4,FLUSH_TIMEOUT=5e3,pi.tools.Visitor=function(){function Visitor(params){null==params&&(params={}),this.context=utils.merge({time_spent:0},params),this.watcher=pi.app.activity_watcher}return Visitor.prototype.init=function(){if(this.enabled=WS_PATH&&!pi.app.user.admin,this.enabled)return pi.tools.Socket.available?(this.socket=pi.app.socket||(pi.app.socket=new pi.tools.MultiSocket(WS_PATH+"/ws/mpx")),this.socket.subscribe(WS_APP)):(this.__interval=INTERVAL/2,pi.tools.Socket.register_fail("unsupported")),this.running=!1,this.flush(),this.on()},Visitor.prototype.start=function(){if(!this.running&&this.enabled)return this.context.active=!0,this._start_ts=+new Date,clearTimeout(this._ws_hibernate_tid),clearTimeout(this._flush_tid),this.running=!0,this._ticking?void 0:this.tick()},Visitor.prototype.update_context=function(params,immediately){return null==immediately&&(immediately=!0),this.running&&immediately&&this.flush(),this.context=utils.merge(this.context,params)},Visitor.prototype.studying=function(){return this.update_context({studying:1},!1)},Visitor.prototype.tick=function(){var _this;if(this.running&&this.enabled)return this._ticking=!0,this.flush().then((_this=this,function(){if(_this._ticking=!1,_this.running)return _this._tid=utils.after(_this._interval(),function(){return _this.tick()})}))},Visitor.prototype.stop=function(){var _this;if(this.running&&(clearTimeout(this._tid),this.context.active=!1,this.context.time_spent=+new Date-this._start_ts,this._start_ts=null,this._flush_tid=utils.after(FLUSH_TIMEOUT,(_this=this,function(){return _this.flush()})),this.running=!1,this.socket))return this._ws_hibernate_tid=utils.after(WS_HIBERNATE_TIMEOUT,function(_this){return function(){return _this.socket.hibernate()}}(this))},Visitor.prototype.flush=function(){var base,point;if(this.enabled)return this._start_ts?this.context.time_spent=+new Date-this._start_ts:(base=this.context).time_spent||(base.time_spent=1),this.context.time_spent=Math.min(this.context.time_spent,1.5*this._interval()),point=utils.clone(this.context),this.context.time_spent=0,this._start_ts=+new Date,point.field_user_id=point.user_id,point.field_account_id=point.account_id,this.socket?utils.resolved_promise(this.socket.write(WS_APP,point)):point.time_spent>0?pi.Net.post("/api/trackings.json",{series:"visits",data:point}):void 0},Visitor.prototype.on=function(){if(this.watcher.on("active",this.active_handler()),this.watcher.active)return this.start()},Visitor.prototype.off=function(){return this.stop(),this.watcher.off("active",this.active_handler())},Visitor.prototype.active_handler=function(){return this._ah||(this._ah=(_this=this,function(e){return e.data?(_this._once=1e4,_this.start()):_this.stop()}));var _this},Visitor.prototype._interval=function(){var ref;return null!=this._once?(ref=this._once,this._once=null,ref):this.__interval||INTERVAL},Visitor}()}(this)}.call(this);